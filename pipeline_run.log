Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_features_10.0s.csv
Shape: (304, 39)
Selected feature columns: 30
After NaN/variance filter: (304, 29)
After correlation pruning: (304, 29)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 1):
   PC1: 0.4673   (cum 0.4673)
   PC2: 0.2270   (cum 0.6943)
   PC3: 0.0642   (cum 0.7585)
   PC4: 0.0344   (cum 0.7929)
   PC5: 0.0323   (cum 0.8253)
   PC6: 0.0267   (cum 0.8519)
   PC7: 0.0239   (cum 0.8758)
   PC8: 0.0178   (cum 0.8937)
   PC9: 0.0155   (cum 0.9091)
  PC10: 0.0135   (cum 0.9226)
  PC11: 0.0120   (cum 0.9346)
  PC12: 0.0092   (cum 0.9438)
  PC13: 0.0087   (cum 0.9525)
  PC14: 0.0073   (cum 0.9598)
  PC15: 0.0064   (cum 0.9662)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2530
  acc_y_dyn__quantile_0.3                  0.2496
  acc_x_dyn__quantile_0.9                  0.2457
  acc_y_dyn__avg_amplitude_change          0.2398
  acc_x_dyn__quantile_0.3                  0.2325
  acc_x_dyn__quantile_0.4                  0.2298
  acc_x_dyn__harmonic_mean_of_abs          0.2285
  acc_z_dyn__harmonic_mean_of_abs          0.2216

PC2
  acc_y_dyn__sample_entropy                0.3458
  acc_z_dyn__sample_entropy                0.3445
  acc_x_dyn__sample_entropy                0.3307
  acc_z_dyn__approximate_entropy_0.1       0.3256
  acc_x_dyn__approximate_entropy_0.1       0.3001
  acc_z_dyn__katz_fractal_dimension        0.2623
  acc_y_dyn__katz_fractal_dimension        0.2579
  acc_y_dyn__tsallis_entropy               0.2549

PC3
  acc_y_dyn__variance_of_absolute_differences 0.2812
  acc_x_dyn__quantile_0.6                  0.2776
  acc_y_dyn__avg_amplitude_change          0.2723
  acc_x_dyn__quantile_0.3                  0.2645
  acc_x_dyn__katz_fractal_dimension        0.2588
  acc_x_dyn__harmonic_mean_of_abs          0.2577
  acc_x_dyn__approximate_entropy_0.1       0.2488
  acc_x_dyn__approximate_entropy_0.9       0.2397

PC4
  acc_x_dyn__cardinality                   0.4224
  acc_z_dyn__lower_complete_moment         0.4105
  acc_z_dyn__quantile_0.6                  0.3718
  acc_z_dyn__variance_of_absolute_differences 0.2662
  acc_y_dyn__variance_of_absolute_differences 0.2489
  acc_y_dyn__tsallis_entropy               0.2275
  acc_x_dyn__quantile_0.4                  0.2075
  acc_y_dyn__katz_fractal_dimension        0.1812

PC5
  acc_x_dyn__cardinality                   0.6197
  acc_x_dyn__approximate_entropy_0.1       0.3377
  acc_y_dyn__katz_fractal_dimension        0.3008
  acc_x_dyn__quantile_0.6                  0.2890
  acc_x_dyn__quantile_0.3                  0.2061
  acc_z_dyn__quantile_0.6                  0.1860
  acc_x_dyn__harmonic_mean_of_abs          0.1788
  acc_z_dyn__katz_fractal_dimension        0.1761

PC6
  acc_z_dyn__lower_complete_moment         0.3923
  acc_x_dyn__cardinality                   0.3419
  acc_z_dyn__quantile_0.6                  0.3365
  acc_z_dyn__quantile_0.4                  0.3024
  acc_x_dyn__max                           0.2450
  acc_y_dyn__variance_of_absolute_differences 0.2448
  acc_x_dyn__katz_fractal_dimension        0.2206
  acc_z_dyn__approximate_entropy_0.1       0.2202

PC7
  acc_y_dyn__harmonic_mean_of_abs          0.5029
  acc_y_dyn__quantile_0.4                  0.3783
  acc_y_dyn__quantile_0.3                  0.3477
  acc_x_dyn__cardinality                   0.3052
  acc_z_dyn__quantile_0.4                  0.2576
  acc_z_dyn__variance_of_absolute_differences 0.2335
  acc_x_dyn__variance_of_absolute_differences 0.2305
  acc_x_dyn__max                           0.2264

PC8
  acc_y_dyn__tsallis_entropy               0.4083
  acc_x_dyn__approximate_entropy_0.9       0.3568
  acc_y_dyn__katz_fractal_dimension        0.3114
  acc_x_dyn__max                           0.3089
  acc_x_dyn__variance_of_absolute_differences 0.3008
  acc_y_dyn__sample_entropy                0.2674
  acc_x_dyn__katz_fractal_dimension        0.2523
  acc_y_dyn__variance_of_absolute_differences 0.2473

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 2):
   PC1: 0.4673   (cum 0.4673)
   PC2: 0.2270   (cum 0.6943)
   PC3: 0.0642   (cum 0.7585)
   PC4: 0.0344   (cum 0.7929)
   PC5: 0.0323   (cum 0.8253)
   PC6: 0.0267   (cum 0.8519)
   PC7: 0.0239   (cum 0.8758)
   PC8: 0.0178   (cum 0.8937)
   PC9: 0.0155   (cum 0.9091)
  PC10: 0.0135   (cum 0.9226)
  PC11: 0.0120   (cum 0.9346)
  PC12: 0.0092   (cum 0.9438)
  PC13: 0.0087   (cum 0.9525)
  PC14: 0.0073   (cum 0.9598)
  PC15: 0.0064   (cum 0.9662)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2530
  acc_y_dyn__quantile_0.3                  0.2496
  acc_x_dyn__quantile_0.9                  0.2457
  acc_y_dyn__avg_amplitude_change          0.2398
  acc_x_dyn__quantile_0.3                  0.2325
  acc_x_dyn__quantile_0.4                  0.2298
  acc_x_dyn__harmonic_mean_of_abs          0.2285
  acc_z_dyn__harmonic_mean_of_abs          0.2216

PC2
  acc_y_dyn__sample_entropy                0.3458
  acc_z_dyn__sample_entropy                0.3445
  acc_x_dyn__sample_entropy                0.3307
  acc_z_dyn__approximate_entropy_0.1       0.3256
  acc_x_dyn__approximate_entropy_0.1       0.3001
  acc_z_dyn__katz_fractal_dimension        0.2623
  acc_y_dyn__katz_fractal_dimension        0.2579
  acc_y_dyn__tsallis_entropy               0.2549

PC3
  acc_y_dyn__variance_of_absolute_differences 0.2812
  acc_x_dyn__quantile_0.6                  0.2776
  acc_y_dyn__avg_amplitude_change          0.2723
  acc_x_dyn__quantile_0.3                  0.2645
  acc_x_dyn__katz_fractal_dimension        0.2588
  acc_x_dyn__harmonic_mean_of_abs          0.2577
  acc_x_dyn__approximate_entropy_0.1       0.2488
  acc_x_dyn__approximate_entropy_0.9       0.2397

PC4
  acc_x_dyn__cardinality                   0.4224
  acc_z_dyn__lower_complete_moment         0.4105
  acc_z_dyn__quantile_0.6                  0.3718
  acc_z_dyn__variance_of_absolute_differences 0.2662
  acc_y_dyn__variance_of_absolute_differences 0.2489
  acc_y_dyn__tsallis_entropy               0.2275
  acc_x_dyn__quantile_0.4                  0.2075
  acc_y_dyn__katz_fractal_dimension        0.1812

PC5
  acc_x_dyn__cardinality                   0.6197
  acc_x_dyn__approximate_entropy_0.1       0.3377
  acc_y_dyn__katz_fractal_dimension        0.3008
  acc_x_dyn__quantile_0.6                  0.2890
  acc_x_dyn__quantile_0.3                  0.2061
  acc_z_dyn__quantile_0.6                  0.1860
  acc_x_dyn__harmonic_mean_of_abs          0.1788
  acc_z_dyn__katz_fractal_dimension        0.1761

PC6
  acc_z_dyn__lower_complete_moment         0.3923
  acc_x_dyn__cardinality                   0.3419
  acc_z_dyn__quantile_0.6                  0.3365
  acc_z_dyn__quantile_0.4                  0.3024
  acc_x_dyn__max                           0.2450
  acc_y_dyn__variance_of_absolute_differences 0.2448
  acc_x_dyn__katz_fractal_dimension        0.2206
  acc_z_dyn__approximate_entropy_0.1       0.2202

PC7
  acc_y_dyn__harmonic_mean_of_abs          0.5029
  acc_y_dyn__quantile_0.4                  0.3783
  acc_y_dyn__quantile_0.3                  0.3477
  acc_x_dyn__cardinality                   0.3052
  acc_z_dyn__quantile_0.4                  0.2576
  acc_z_dyn__variance_of_absolute_differences 0.2335
  acc_x_dyn__variance_of_absolute_differences 0.2305
  acc_x_dyn__max                           0.2264

PC8
  acc_y_dyn__tsallis_entropy               0.4083
  acc_x_dyn__approximate_entropy_0.9       0.3568
  acc_y_dyn__katz_fractal_dimension        0.3114
  acc_x_dyn__max                           0.3089
  acc_x_dyn__variance_of_absolute_differences 0.3008
  acc_y_dyn__sample_entropy                0.2674
  acc_x_dyn__katz_fractal_dimension        0.2523
  acc_y_dyn__variance_of_absolute_differences 0.2473

Saved to: data/feature_extraction/analysis/quality_imu_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_features_10.0s.csv
Shape: (338, 50)
Selected feature columns: 44
After NaN/variance filter: (338, 43)
After correlation pruning: (338, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.4723   (cum 0.4723)
   PC2: 0.1592   (cum 0.6316)
   PC3: 0.0831   (cum 0.7147)
   PC4: 0.0758   (cum 0.7905)
   PC5: 0.0477   (cum 0.8382)
   PC6: 0.0399   (cum 0.8781)
   PC7: 0.0347   (cum 0.9128)
   PC8: 0.0251   (cum 0.9379)
   PC9: 0.0172   (cum 0.9551)
  PC10: 0.0112   (cum 0.9663)
  PC11: 0.0092   (cum 0.9755)
  PC12: 0.0084   (cum 0.9839)
  PC13: 0.0055   (cum 0.9894)
  PC14: 0.0038   (cum 0.9932)
  PC15: 0.0029   (cum 0.9961)

Top PCA loadings per component (round 1):

PC1
  ppg_green_range                          0.3032
  ppg_green_p95_p5                         0.3027
  ppg_green_p95                            0.3016
  ppg_green_p90_p10                        0.2948
  ppg_green_p90                            0.2896
  ppg_green_shape_factor                   0.2801
  ppg_green_tke_p95_abs                    0.2596
  ppg_green_iqr                            0.2511

PC2
  ppg_green_skew                           0.4369
  ppg_green_kurtosis                       0.3789
  ppg_green_crest_factor                   0.3551
  ppg_green_median                         0.3285
  ppg_green_trim_mean_10                   0.3052
  ppg_green_p5                             0.2664
  ppg_green_mean_cross_rate                0.2291
  ppg_green_iqr                            0.1986

PC3
  ppg_green_p5                             0.5576
  ppg_green_kurtosis                       0.3892
  ppg_green_trim_mean_10                   0.2844
  ppg_green_median                         0.2813
  ppg_green_ddx_kurtosis                   0.2531
  ppg_green_dx_kurtosis                    0.2133
  ppg_green_shape_factor                   0.2065
  ppg_green_skew                           0.1883

PC4
  ppg_green_ddx_mean                       0.4732
  ppg_green_ddx_kurtosis                   0.4414
  ppg_green_dx_kurtosis                    0.3966
  ppg_green_mean_cross_rate                0.3772
  ppg_green_tke_p95_abs                    0.2901
  ppg_green_tke_mean_abs                   0.2510
  ppg_green_p5                             0.2367
  ppg_green_iqr                            0.1709

PC5
  ppg_green_dx_mean                        0.9499
  ppg_green_mad                            0.1626
  ppg_green_mean_cross_rate                0.1440
  ppg_green_kurtosis                       0.1309
  ppg_green_skew                           0.0816
  ppg_green_median                         0.0788
  ppg_green_ddx_mean                       0.0710
  ppg_green_p90_p10                        0.0678

PC6
  ppg_green_ddx_mean                       0.7436
  ppg_green_mad                            0.3976
  ppg_green_ddx_kurtosis                   0.3150
  ppg_green_tke_mean_abs                   0.2313
  ppg_green_dx_kurtosis                    0.1810
  ppg_green_iqr                            0.1430
  ppg_green_p5                             0.1373
  ppg_green_shape_factor                   0.1237

PC7
  ppg_green_mean_cross_rate                0.7819
  ppg_green_ddx_mean                       0.3876
  ppg_green_mad                            0.1961
  ppg_green_shape_factor                   0.1712
  ppg_green_dx_mean                        0.1693
  ppg_green_iqr                            0.1681
  ppg_green_p5                             0.1557
  ppg_green_crest_factor                   0.1449

PC8
  ppg_green_mad                            0.4970
  ppg_green_kurtosis                       0.4351
  ppg_green_ddx_kurtosis                   0.3617
  ppg_green_mean_cross_rate                0.2930
  ppg_green_skew                           0.2725
  ppg_green_iqr                            0.2625
  ppg_green_dx_kurtosis                    0.2152
  ppg_green_shape_factor                   0.1780

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.4723   (cum 0.4723)
   PC2: 0.1592   (cum 0.6316)
   PC3: 0.0831   (cum 0.7147)
   PC4: 0.0758   (cum 0.7905)
   PC5: 0.0477   (cum 0.8382)
   PC6: 0.0399   (cum 0.8781)
   PC7: 0.0347   (cum 0.9128)
   PC8: 0.0251   (cum 0.9379)
   PC9: 0.0172   (cum 0.9551)
  PC10: 0.0112   (cum 0.9663)
  PC11: 0.0092   (cum 0.9755)
  PC12: 0.0084   (cum 0.9839)
  PC13: 0.0055   (cum 0.9894)
  PC14: 0.0038   (cum 0.9932)
  PC15: 0.0029   (cum 0.9961)

Top PCA loadings per component (round 2):

PC1
  ppg_green_range                          0.3032
  ppg_green_p95_p5                         0.3027
  ppg_green_p95                            0.3016
  ppg_green_p90_p10                        0.2948
  ppg_green_p90                            0.2896
  ppg_green_shape_factor                   0.2801
  ppg_green_tke_p95_abs                    0.2596
  ppg_green_iqr                            0.2511

PC2
  ppg_green_skew                           0.4369
  ppg_green_kurtosis                       0.3789
  ppg_green_crest_factor                   0.3551
  ppg_green_median                         0.3285
  ppg_green_trim_mean_10                   0.3052
  ppg_green_p5                             0.2664
  ppg_green_mean_cross_rate                0.2291
  ppg_green_iqr                            0.1986

PC3
  ppg_green_p5                             0.5576
  ppg_green_kurtosis                       0.3892
  ppg_green_trim_mean_10                   0.2844
  ppg_green_median                         0.2813
  ppg_green_ddx_kurtosis                   0.2531
  ppg_green_dx_kurtosis                    0.2133
  ppg_green_shape_factor                   0.2065
  ppg_green_skew                           0.1883

PC4
  ppg_green_ddx_mean                       0.4732
  ppg_green_ddx_kurtosis                   0.4414
  ppg_green_dx_kurtosis                    0.3966
  ppg_green_mean_cross_rate                0.3772
  ppg_green_tke_p95_abs                    0.2901
  ppg_green_tke_mean_abs                   0.2510
  ppg_green_p5                             0.2367
  ppg_green_iqr                            0.1709

PC5
  ppg_green_dx_mean                        0.9499
  ppg_green_mad                            0.1626
  ppg_green_mean_cross_rate                0.1440
  ppg_green_kurtosis                       0.1309
  ppg_green_skew                           0.0816
  ppg_green_median                         0.0788
  ppg_green_ddx_mean                       0.0710
  ppg_green_p90_p10                        0.0678

PC6
  ppg_green_ddx_mean                       0.7436
  ppg_green_mad                            0.3976
  ppg_green_ddx_kurtosis                   0.3150
  ppg_green_tke_mean_abs                   0.2313
  ppg_green_dx_kurtosis                    0.1810
  ppg_green_iqr                            0.1430
  ppg_green_p5                             0.1373
  ppg_green_shape_factor                   0.1237

PC7
  ppg_green_mean_cross_rate                0.7819
  ppg_green_ddx_mean                       0.3876
  ppg_green_mad                            0.1961
  ppg_green_shape_factor                   0.1712
  ppg_green_dx_mean                        0.1693
  ppg_green_iqr                            0.1681
  ppg_green_p5                             0.1557
  ppg_green_crest_factor                   0.1449

PC8
  ppg_green_mad                            0.4970
  ppg_green_kurtosis                       0.4351
  ppg_green_ddx_kurtosis                   0.3617
  ppg_green_mean_cross_rate                0.2930
  ppg_green_skew                           0.2725
  ppg_green_iqr                            0.2625
  ppg_green_dx_kurtosis                    0.2152
  ppg_green_shape_factor                   0.1780

Saved to: data/feature_extraction/analysis/quality_ppg_green_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_10.0s.csv
Shape: (338, 28)
Selected feature columns: 21
After NaN/variance filter: (338, 2)
After correlation pruning: (338, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8007   (cum 0.8007)
   PC2: 0.1993   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8007   (cum 0.8007)
   PC2: 0.1993   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_10.0s.csv | rows=338 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_10.0s.csv
Shape: (338, 51)
Selected feature columns: 44
After NaN/variance filter: (338, 44)
After correlation pruning: (338, 23)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3667   (cum 0.3667)
   PC2: 0.2187   (cum 0.5854)
   PC3: 0.0894   (cum 0.6748)
   PC4: 0.0599   (cum 0.7347)
   PC5: 0.0485   (cum 0.7832)
   PC6: 0.0430   (cum 0.8263)
   PC7: 0.0422   (cum 0.8685)
   PC8: 0.0318   (cum 0.9003)
   PC9: 0.0277   (cum 0.9280)
  PC10: 0.0209   (cum 0.9489)
  PC11: 0.0137   (cum 0.9627)
  PC12: 0.0113   (cum 0.9739)
  PC13: 0.0074   (cum 0.9813)
  PC14: 0.0051   (cum 0.9863)
  PC15: 0.0039   (cum 0.9902)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_max                            0.3277
  ppg_infra_ddx_std                        0.3243
  ppg_infra_min                            0.3198
  ppg_infra_p99                            0.3186
  ppg_infra_signal_energy                  0.3048
  ppg_infra_diff_mean_abs                  0.2943
  ppg_infra_p90                            0.2860
  ppg_infra_tke_std                        0.2853

PC2
  ppg_infra_impulse_factor                 0.3922
  ppg_infra_kurtosis                       0.3730
  ppg_infra_shape_factor                   0.3665
  ppg_infra_clearance_factor               0.3649
  ppg_infra_crest_factor                   0.3575
  ppg_infra_ddx_kurtosis                   0.2518
  ppg_infra_dx_kurtosis                    0.2320
  ppg_infra_mad                            0.2219

PC3
  ppg_infra_trim_mean_10                   0.5683
  ppg_infra_mean                           0.5343
  ppg_infra_median                         0.3876
  ppg_infra_ddx_mean                       0.3669
  ppg_infra_dx_mean                        0.2626
  ppg_infra_skew                           0.1416
  ppg_infra_min                            0.0654
  ppg_infra_tke_std                        0.0600

PC4
  ppg_infra_skew                           0.6128
  ppg_infra_ddx_mean                       0.4459
  ppg_infra_median                         0.3782
  ppg_infra_zcr                            0.3193
  ppg_infra_mean                           0.2700
  ppg_infra_trim_mean_10                   0.1672
  ppg_infra_dx_kurtosis                    0.1426
  ppg_infra_kurtosis                       0.1299

PC5
  ppg_infra_dx_mean                        0.5097
  ppg_infra_skew                           0.4108
  ppg_infra_ddx_mean                       0.3802
  ppg_infra_ddx_kurtosis                   0.3269
  ppg_infra_mean                           0.2419
  ppg_infra_median                         0.2399
  ppg_infra_trim_mean_10                   0.2259
  ppg_infra_clearance_factor               0.2077

PC6
  ppg_infra_dx_mean                        0.6576
  ppg_infra_ddx_kurtosis                   0.3169
  ppg_infra_dx_kurtosis                    0.2563
  ppg_infra_skew                           0.2468
  ppg_infra_shape_factor                   0.2355
  ppg_infra_clearance_factor               0.2288
  ppg_infra_tke_std                        0.2144
  ppg_infra_median                         0.1935

PC7
  ppg_infra_zcr                            0.8617
  ppg_infra_median                         0.2165
  ppg_infra_ddx_mean                       0.2156
  ppg_infra_skew                           0.1833
  ppg_infra_mean                           0.1763
  ppg_infra_ddx_kurtosis                   0.1483
  ppg_infra_crest_factor                   0.1401
  ppg_infra_dx_mean                        0.1290

PC8
  ppg_infra_median                         0.4134
  ppg_infra_tke_std                        0.3869
  ppg_infra_skew                           0.3665
  ppg_infra_mad                            0.3298
  ppg_infra_ddx_kurtosis                   0.3231
  ppg_infra_dx_mean                        0.2447
  ppg_infra_signal_energy                  0.2367
  ppg_infra_ddx_mean                       0.2164

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3667   (cum 0.3667)
   PC2: 0.2187   (cum 0.5854)
   PC3: 0.0894   (cum 0.6748)
   PC4: 0.0599   (cum 0.7347)
   PC5: 0.0485   (cum 0.7832)
   PC6: 0.0430   (cum 0.8263)
   PC7: 0.0422   (cum 0.8685)
   PC8: 0.0318   (cum 0.9003)
   PC9: 0.0277   (cum 0.9280)
  PC10: 0.0209   (cum 0.9489)
  PC11: 0.0137   (cum 0.9627)
  PC12: 0.0113   (cum 0.9739)
  PC13: 0.0074   (cum 0.9813)
  PC14: 0.0051   (cum 0.9863)
  PC15: 0.0039   (cum 0.9902)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_max                            0.3277
  ppg_infra_ddx_std                        0.3243
  ppg_infra_min                            0.3198
  ppg_infra_p99                            0.3186
  ppg_infra_signal_energy                  0.3048
  ppg_infra_diff_mean_abs                  0.2943
  ppg_infra_p90                            0.2860
  ppg_infra_tke_std                        0.2853

PC2
  ppg_infra_impulse_factor                 0.3922
  ppg_infra_kurtosis                       0.3730
  ppg_infra_shape_factor                   0.3665
  ppg_infra_clearance_factor               0.3649
  ppg_infra_crest_factor                   0.3575
  ppg_infra_ddx_kurtosis                   0.2518
  ppg_infra_dx_kurtosis                    0.2320
  ppg_infra_mad                            0.2219

PC3
  ppg_infra_trim_mean_10                   0.5683
  ppg_infra_mean                           0.5343
  ppg_infra_median                         0.3876
  ppg_infra_ddx_mean                       0.3669
  ppg_infra_dx_mean                        0.2626
  ppg_infra_skew                           0.1416
  ppg_infra_min                            0.0654
  ppg_infra_tke_std                        0.0600

PC4
  ppg_infra_skew                           0.6128
  ppg_infra_ddx_mean                       0.4459
  ppg_infra_median                         0.3782
  ppg_infra_zcr                            0.3193
  ppg_infra_mean                           0.2700
  ppg_infra_trim_mean_10                   0.1672
  ppg_infra_dx_kurtosis                    0.1426
  ppg_infra_kurtosis                       0.1299

PC5
  ppg_infra_dx_mean                        0.5097
  ppg_infra_skew                           0.4108
  ppg_infra_ddx_mean                       0.3802
  ppg_infra_ddx_kurtosis                   0.3269
  ppg_infra_mean                           0.2419
  ppg_infra_median                         0.2399
  ppg_infra_trim_mean_10                   0.2259
  ppg_infra_clearance_factor               0.2077

PC6
  ppg_infra_dx_mean                        0.6576
  ppg_infra_ddx_kurtosis                   0.3169
  ppg_infra_dx_kurtosis                    0.2563
  ppg_infra_skew                           0.2468
  ppg_infra_shape_factor                   0.2355
  ppg_infra_clearance_factor               0.2288
  ppg_infra_tke_std                        0.2144
  ppg_infra_median                         0.1935

PC7
  ppg_infra_zcr                            0.8617
  ppg_infra_median                         0.2165
  ppg_infra_ddx_mean                       0.2156
  ppg_infra_skew                           0.1833
  ppg_infra_mean                           0.1763
  ppg_infra_ddx_kurtosis                   0.1483
  ppg_infra_crest_factor                   0.1401
  ppg_infra_dx_mean                        0.1290

PC8
  ppg_infra_median                         0.4134
  ppg_infra_tke_std                        0.3869
  ppg_infra_skew                           0.3665
  ppg_infra_mad                            0.3298
  ppg_infra_ddx_kurtosis                   0.3231
  ppg_infra_dx_mean                        0.2447
  ppg_infra_signal_energy                  0.2367
  ppg_infra_ddx_mean                       0.2164

Saved to: data/feature_extraction/analysis/quality_ppg_infra_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_10.0s.csv
Shape: (338, 28)
Selected feature columns: 21
After NaN/variance filter: (338, 14)
After correlation pruning: (338, 12)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.3836   (cum 0.3836)
   PC2: 0.3150   (cum 0.6986)
   PC3: 0.1085   (cum 0.8072)
   PC4: 0.0742   (cum 0.8814)
   PC5: 0.0513   (cum 0.9327)
   PC6: 0.0327   (cum 0.9655)
   PC7: 0.0173   (cum 0.9828)
   PC8: 0.0063   (cum 0.9891)
   PC9: 0.0053   (cum 0.9945)
  PC10: 0.0033   (cum 0.9978)
  PC11: 0.0021   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_min                         0.4298
  ppg_infra_hr_median                      0.4279
  ppg_infra_mean_ibi                       0.4226
  ppg_infra_n_peaks                        0.3156
  ppg_infra_sdnn                           0.3015
  ppg_infra_rmssd                          0.2988
  ppg_infra_hr_range                       0.2440
  ppg_infra_pnn50                          0.2250

PC2
  ppg_infra_cv_ibi                         0.4896
  ppg_infra_hr_std                         0.4716
  ppg_infra_hr_range                       0.3899
  ppg_infra_sdnn                           0.3517
  ppg_infra_rmssd                          0.3505
  ppg_infra_pnn50                          0.2357
  ppg_infra_pnn20                          0.1766
  ppg_infra_mean_ibi                       0.1460

PC3
  ppg_infra_peak_quality                   0.6682
  ppg_infra_pnn20                          0.4700
  ppg_infra_pnn50                          0.3658
  ppg_infra_n_peaks                        0.2150
  ppg_infra_hr_min                         0.1945
  ppg_infra_hr_range                       0.1749
  ppg_infra_sdnn                           0.1724
  ppg_infra_mean_ibi                       0.1650

PC4
  ppg_infra_peak_quality                   0.6029
  ppg_infra_pnn20                          0.5550
  ppg_infra_pnn50                          0.4031
  ppg_infra_sdnn                           0.2110
  ppg_infra_cv_ibi                         0.1958
  ppg_infra_n_peaks                        0.1680
  ppg_infra_hr_range                       0.1590
  ppg_infra_rmssd                          0.1392

PC5
  ppg_infra_n_peaks                        0.7458
  ppg_infra_peak_quality                   0.3720
  ppg_infra_hr_min                         0.2875
  ppg_infra_pnn20                          0.2581
  ppg_infra_pnn50                          0.2338
  ppg_infra_hr_median                      0.2128
  ppg_infra_mean_ibi                       0.1698
  ppg_infra_hr_range                       0.1369

PC6
  ppg_infra_pnn50                          0.7138
  ppg_infra_pnn20                          0.5591
  ppg_infra_n_peaks                        0.3572
  ppg_infra_hr_std                         0.1068
  ppg_infra_rmssd                          0.1039
  ppg_infra_peak_quality                   0.1020
  ppg_infra_cv_ibi                         0.0989
  ppg_infra_sdnn                           0.0677

PC7
  ppg_infra_rmssd                          0.5243
  ppg_infra_hr_range                       0.4797
  ppg_infra_hr_min                         0.3738
  ppg_infra_n_peaks                        0.3100
  ppg_infra_hr_median                      0.2800
  ppg_infra_hr_std                         0.2661
  ppg_infra_sdnn                           0.2245
  ppg_infra_pnn20                          0.1644

PC8
  ppg_infra_rmssd                          0.6223
  ppg_infra_hr_range                       0.5212
  ppg_infra_sdnn                           0.3434
  ppg_infra_cv_ibi                         0.3325
  ppg_infra_hr_std                         0.2058
  ppg_infra_n_peaks                        0.1671
  ppg_infra_peak_quality                   0.1215
  ppg_infra_pnn50                          0.1160

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 12
Stage 2: selected features: 12 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.3836   (cum 0.3836)
   PC2: 0.3150   (cum 0.6986)
   PC3: 0.1085   (cum 0.8072)
   PC4: 0.0742   (cum 0.8814)
   PC5: 0.0513   (cum 0.9327)
   PC6: 0.0327   (cum 0.9655)
   PC7: 0.0173   (cum 0.9828)
   PC8: 0.0063   (cum 0.9891)
   PC9: 0.0053   (cum 0.9945)
  PC10: 0.0033   (cum 0.9978)
  PC11: 0.0021   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_min                         0.4298
  ppg_infra_hr_median                      0.4279
  ppg_infra_mean_ibi                       0.4226
  ppg_infra_n_peaks                        0.3156
  ppg_infra_sdnn                           0.3015
  ppg_infra_rmssd                          0.2988
  ppg_infra_hr_range                       0.2440
  ppg_infra_pnn50                          0.2250

PC2
  ppg_infra_cv_ibi                         0.4896
  ppg_infra_hr_std                         0.4716
  ppg_infra_hr_range                       0.3899
  ppg_infra_sdnn                           0.3517
  ppg_infra_rmssd                          0.3505
  ppg_infra_pnn50                          0.2357
  ppg_infra_pnn20                          0.1766
  ppg_infra_mean_ibi                       0.1460

PC3
  ppg_infra_peak_quality                   0.6682
  ppg_infra_pnn20                          0.4700
  ppg_infra_pnn50                          0.3658
  ppg_infra_n_peaks                        0.2150
  ppg_infra_hr_min                         0.1945
  ppg_infra_hr_range                       0.1749
  ppg_infra_sdnn                           0.1724
  ppg_infra_mean_ibi                       0.1650

PC4
  ppg_infra_peak_quality                   0.6029
  ppg_infra_pnn20                          0.5550
  ppg_infra_pnn50                          0.4031
  ppg_infra_sdnn                           0.2110
  ppg_infra_cv_ibi                         0.1958
  ppg_infra_n_peaks                        0.1680
  ppg_infra_hr_range                       0.1590
  ppg_infra_rmssd                          0.1392

PC5
  ppg_infra_n_peaks                        0.7458
  ppg_infra_peak_quality                   0.3720
  ppg_infra_hr_min                         0.2875
  ppg_infra_pnn20                          0.2581
  ppg_infra_pnn50                          0.2338
  ppg_infra_hr_median                      0.2128
  ppg_infra_mean_ibi                       0.1698
  ppg_infra_hr_range                       0.1369

PC6
  ppg_infra_pnn50                          0.7138
  ppg_infra_pnn20                          0.5591
  ppg_infra_n_peaks                        0.3572
  ppg_infra_hr_std                         0.1068
  ppg_infra_rmssd                          0.1039
  ppg_infra_peak_quality                   0.1020
  ppg_infra_cv_ibi                         0.0989
  ppg_infra_sdnn                           0.0677

PC7
  ppg_infra_rmssd                          0.5243
  ppg_infra_hr_range                       0.4797
  ppg_infra_hr_min                         0.3738
  ppg_infra_n_peaks                        0.3100
  ppg_infra_hr_median                      0.2800
  ppg_infra_hr_std                         0.2661
  ppg_infra_sdnn                           0.2245
  ppg_infra_pnn20                          0.1644

PC8
  ppg_infra_rmssd                          0.6223
  ppg_infra_hr_range                       0.5212
  ppg_infra_sdnn                           0.3434
  ppg_infra_cv_ibi                         0.3325
  ppg_infra_hr_std                         0.2058
  ppg_infra_n_peaks                        0.1671
  ppg_infra_peak_quality                   0.1215
  ppg_infra_pnn50                          0.1160

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_10.0s.csv | rows=338 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_10.0s.csv
Shape: (338, 51)
Selected feature columns: 44
After NaN/variance filter: (338, 44)
After correlation pruning: (338, 22)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.2802   (cum 0.2802)
   PC2: 0.2313   (cum 0.5115)
   PC3: 0.1038   (cum 0.6153)
   PC4: 0.0837   (cum 0.6990)
   PC5: 0.0536   (cum 0.7525)
   PC6: 0.0518   (cum 0.8043)
   PC7: 0.0487   (cum 0.8530)
   PC8: 0.0418   (cum 0.8948)
   PC9: 0.0338   (cum 0.9287)
  PC10: 0.0209   (cum 0.9496)
  PC11: 0.0152   (cum 0.9648)
  PC12: 0.0102   (cum 0.9750)
  PC13: 0.0065   (cum 0.9815)
  PC14: 0.0054   (cum 0.9870)
  PC15: 0.0039   (cum 0.9909)

Top PCA loadings per component (round 1):

PC1
  ppg_red_max                              0.3400
  ppg_red_ddx_std                          0.3163
  ppg_red_p99                              0.3110
  ppg_red_impulse_factor                   0.2829
  ppg_red_crest_factor                     0.2808
  ppg_red_kurtosis                         0.2732
  ppg_red_diff_mean_abs                    0.2613
  ppg_red_tke_std                          0.2456

PC2
  ppg_red_mad                              0.3273
  ppg_red_diff_mean_abs                    0.3144
  ppg_red_p10                              0.3052
  ppg_red_clearance_factor                 0.2977
  ppg_red_shape_factor                     0.2974
  ppg_red_impulse_factor                   0.2970
  ppg_red_kurtosis                         0.2801
  ppg_red_crest_factor                     0.2505

PC3
  ppg_red_trim_mean_10                     0.5229
  ppg_red_mean                             0.5134
  ppg_red_median                           0.4390
  ppg_red_ddx_mean                         0.2804
  ppg_red_dx_mean                          0.2288
  ppg_red_skew                             0.1881
  ppg_red_p10                              0.1357
  ppg_red_mean_cross_rate                  0.1285

PC4
  ppg_red_zcr                              0.6379
  ppg_red_mean_cross_rate                  0.6271
  ppg_red_mean                             0.2215
  ppg_red_skew                             0.2023
  ppg_red_crest_factor                     0.1547
  ppg_red_kurtosis                         0.1178
  ppg_red_impulse_factor                   0.1084
  ppg_red_trim_mean_10                     0.1045

PC5
  ppg_red_dx_mean                          0.4563
  ppg_red_skew                             0.4496
  ppg_red_ddx_kurtosis                     0.3792
  ppg_red_mean                             0.3197
  ppg_red_ddx_mean                         0.3056
  ppg_red_dx_kurtosis                      0.2946
  ppg_red_trim_mean_10                     0.2177
  ppg_red_zcr                              0.1565

PC6
  ppg_red_skew                             0.5563
  ppg_red_ddx_mean                         0.4707
  ppg_red_tke_std                          0.4471
  ppg_red_trim_mean_10                     0.2115
  ppg_red_mean                             0.1666
  ppg_red_mad                              0.1620
  ppg_red_p10                              0.1503
  ppg_red_max                              0.1490

PC7
  ppg_red_dx_mean                          0.6088
  ppg_red_tke_std                          0.3664
  ppg_red_ddx_kurtosis                     0.3007
  ppg_red_dx_kurtosis                      0.2722
  ppg_red_ddx_mean                         0.2122
  ppg_red_skew                             0.2114
  ppg_red_shape_factor                     0.2052
  ppg_red_trim_mean_10                     0.2001

PC8
  ppg_red_median                           0.4871
  ppg_red_dx_kurtosis                      0.3717
  ppg_red_tke_std                          0.3147
  ppg_red_ddx_kurtosis                     0.3005
  ppg_red_skew                             0.2814
  ppg_red_dx_mean                          0.2080
  ppg_red_clearance_factor                 0.2074
  ppg_red_p10                              0.1961

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.2802   (cum 0.2802)
   PC2: 0.2313   (cum 0.5115)
   PC3: 0.1038   (cum 0.6153)
   PC4: 0.0837   (cum 0.6990)
   PC5: 0.0536   (cum 0.7525)
   PC6: 0.0518   (cum 0.8043)
   PC7: 0.0487   (cum 0.8530)
   PC8: 0.0418   (cum 0.8948)
   PC9: 0.0338   (cum 0.9287)
  PC10: 0.0209   (cum 0.9496)
  PC11: 0.0152   (cum 0.9648)
  PC12: 0.0102   (cum 0.9750)
  PC13: 0.0065   (cum 0.9815)
  PC14: 0.0054   (cum 0.9870)
  PC15: 0.0039   (cum 0.9909)

Top PCA loadings per component (round 2):

PC1
  ppg_red_max                              0.3400
  ppg_red_ddx_std                          0.3163
  ppg_red_p99                              0.3110
  ppg_red_impulse_factor                   0.2829
  ppg_red_crest_factor                     0.2808
  ppg_red_kurtosis                         0.2732
  ppg_red_diff_mean_abs                    0.2613
  ppg_red_tke_std                          0.2456

PC2
  ppg_red_mad                              0.3273
  ppg_red_diff_mean_abs                    0.3144
  ppg_red_p10                              0.3052
  ppg_red_clearance_factor                 0.2977
  ppg_red_shape_factor                     0.2974
  ppg_red_impulse_factor                   0.2970
  ppg_red_kurtosis                         0.2801
  ppg_red_crest_factor                     0.2505

PC3
  ppg_red_trim_mean_10                     0.5229
  ppg_red_mean                             0.5134
  ppg_red_median                           0.4390
  ppg_red_ddx_mean                         0.2804
  ppg_red_dx_mean                          0.2288
  ppg_red_skew                             0.1881
  ppg_red_p10                              0.1357
  ppg_red_mean_cross_rate                  0.1285

PC4
  ppg_red_zcr                              0.6379
  ppg_red_mean_cross_rate                  0.6271
  ppg_red_mean                             0.2215
  ppg_red_skew                             0.2023
  ppg_red_crest_factor                     0.1547
  ppg_red_kurtosis                         0.1178
  ppg_red_impulse_factor                   0.1084
  ppg_red_trim_mean_10                     0.1045

PC5
  ppg_red_dx_mean                          0.4563
  ppg_red_skew                             0.4496
  ppg_red_ddx_kurtosis                     0.3792
  ppg_red_mean                             0.3197
  ppg_red_ddx_mean                         0.3056
  ppg_red_dx_kurtosis                      0.2946
  ppg_red_trim_mean_10                     0.2177
  ppg_red_zcr                              0.1565

PC6
  ppg_red_skew                             0.5563
  ppg_red_ddx_mean                         0.4707
  ppg_red_tke_std                          0.4471
  ppg_red_trim_mean_10                     0.2115
  ppg_red_mean                             0.1666
  ppg_red_mad                              0.1620
  ppg_red_p10                              0.1503
  ppg_red_max                              0.1490

PC7
  ppg_red_dx_mean                          0.6088
  ppg_red_tke_std                          0.3664
  ppg_red_ddx_kurtosis                     0.3007
  ppg_red_dx_kurtosis                      0.2722
  ppg_red_ddx_mean                         0.2122
  ppg_red_skew                             0.2114
  ppg_red_shape_factor                     0.2052
  ppg_red_trim_mean_10                     0.2001

PC8
  ppg_red_median                           0.4871
  ppg_red_dx_kurtosis                      0.3717
  ppg_red_tke_std                          0.3147
  ppg_red_ddx_kurtosis                     0.3005
  ppg_red_skew                             0.2814
  ppg_red_dx_mean                          0.2080
  ppg_red_clearance_factor                 0.2074
  ppg_red_p10                              0.1961

Saved to: data/feature_extraction/analysis/quality_ppg_red_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_10.0s.csv
Shape: (338, 28)
Selected feature columns: 21
After NaN/variance filter: (338, 14)
After correlation pruning: (338, 12)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.4371   (cum 0.4371)
   PC2: 0.2811   (cum 0.7182)
   PC3: 0.1003   (cum 0.8185)
   PC4: 0.0728   (cum 0.8913)
   PC5: 0.0433   (cum 0.9346)
   PC6: 0.0274   (cum 0.9620)
   PC7: 0.0191   (cum 0.9811)
   PC8: 0.0074   (cum 0.9885)
   PC9: 0.0059   (cum 0.9944)
  PC10: 0.0030   (cum 0.9973)
  PC11: 0.0026   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_hr_min                           0.4073
  ppg_red_hr_median                        0.4051
  ppg_red_mean_ibi                         0.4026
  ppg_red_sdnn                             0.3303
  ppg_red_rmssd                            0.3210
  ppg_red_n_peaks                          0.2997
  ppg_red_pnn50                            0.2550
  ppg_red_hr_range                         0.2417

PC2
  ppg_red_cv_ibi                           0.5097
  ppg_red_hr_std                           0.4748
  ppg_red_hr_range                         0.4153
  ppg_red_sdnn                             0.3023
  ppg_red_rmssd                            0.2974
  ppg_red_pnn50                            0.2405
  ppg_red_pnn20                            0.2185
  ppg_red_hr_median                        0.1299

PC3
  ppg_red_peak_quality                     0.7311
  ppg_red_pnn20                            0.3982
  ppg_red_pnn50                            0.3706
  ppg_red_n_peaks                          0.1862
  ppg_red_mean_ibi                         0.1786
  ppg_red_hr_min                           0.1744
  ppg_red_sdnn                             0.1615
  ppg_red_hr_range                         0.1350

PC4
  ppg_red_pnn20                            0.6210
  ppg_red_peak_quality                     0.5315
  ppg_red_pnn50                            0.3483
  ppg_red_cv_ibi                           0.2620
  ppg_red_sdnn                             0.2503
  ppg_red_rmssd                            0.1790
  ppg_red_n_peaks                          0.1531
  ppg_red_hr_std                           0.1251

PC5
  ppg_red_n_peaks                          0.8937
  ppg_red_peak_quality                     0.3180
  ppg_red_hr_median                        0.1766
  ppg_red_hr_min                           0.1619
  ppg_red_mean_ibi                         0.1327
  ppg_red_hr_std                           0.0992
  ppg_red_pnn50                            0.0791
  ppg_red_rmssd                            0.0631

PC6
  ppg_red_pnn50                            0.7183
  ppg_red_pnn20                            0.5326
  ppg_red_rmssd                            0.2122
  ppg_red_hr_min                           0.2106
  ppg_red_hr_range                         0.2099
  ppg_red_peak_quality                     0.1743
  ppg_red_hr_median                        0.1327
  ppg_red_cv_ibi                           0.0873

PC7
  ppg_red_rmssd                            0.5782
  ppg_red_hr_min                           0.4487
  ppg_red_hr_range                         0.3486
  ppg_red_pnn50                            0.2874
  ppg_red_pnn20                            0.2827
  ppg_red_hr_median                        0.2750
  ppg_red_sdnn                             0.1933
  ppg_red_hr_std                           0.1805

PC8
  ppg_red_hr_range                         0.6379
  ppg_red_rmssd                            0.4881
  ppg_red_cv_ibi                           0.3971
  ppg_red_sdnn                             0.2999
  ppg_red_mean_ibi                         0.1773
  ppg_red_peak_quality                     0.1659
  ppg_red_n_peaks                          0.1472
  ppg_red_hr_std                           0.1004

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 12
Stage 2: selected features: 12 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.4371   (cum 0.4371)
   PC2: 0.2811   (cum 0.7182)
   PC3: 0.1003   (cum 0.8185)
   PC4: 0.0728   (cum 0.8913)
   PC5: 0.0433   (cum 0.9346)
   PC6: 0.0274   (cum 0.9620)
   PC7: 0.0191   (cum 0.9811)
   PC8: 0.0074   (cum 0.9885)
   PC9: 0.0059   (cum 0.9944)
  PC10: 0.0030   (cum 0.9973)
  PC11: 0.0026   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_hr_min                           0.4073
  ppg_red_hr_median                        0.4051
  ppg_red_mean_ibi                         0.4026
  ppg_red_sdnn                             0.3303
  ppg_red_rmssd                            0.3210
  ppg_red_n_peaks                          0.2997
  ppg_red_pnn50                            0.2550
  ppg_red_hr_range                         0.2417

PC2
  ppg_red_cv_ibi                           0.5097
  ppg_red_hr_std                           0.4748
  ppg_red_hr_range                         0.4153
  ppg_red_sdnn                             0.3023
  ppg_red_rmssd                            0.2974
  ppg_red_pnn50                            0.2405
  ppg_red_pnn20                            0.2185
  ppg_red_hr_median                        0.1299

PC3
  ppg_red_peak_quality                     0.7311
  ppg_red_pnn20                            0.3982
  ppg_red_pnn50                            0.3706
  ppg_red_n_peaks                          0.1862
  ppg_red_mean_ibi                         0.1786
  ppg_red_hr_min                           0.1744
  ppg_red_sdnn                             0.1615
  ppg_red_hr_range                         0.1350

PC4
  ppg_red_pnn20                            0.6210
  ppg_red_peak_quality                     0.5315
  ppg_red_pnn50                            0.3483
  ppg_red_cv_ibi                           0.2620
  ppg_red_sdnn                             0.2503
  ppg_red_rmssd                            0.1790
  ppg_red_n_peaks                          0.1531
  ppg_red_hr_std                           0.1251

PC5
  ppg_red_n_peaks                          0.8937
  ppg_red_peak_quality                     0.3180
  ppg_red_hr_median                        0.1766
  ppg_red_hr_min                           0.1619
  ppg_red_mean_ibi                         0.1327
  ppg_red_hr_std                           0.0992
  ppg_red_pnn50                            0.0791
  ppg_red_rmssd                            0.0631

PC6
  ppg_red_pnn50                            0.7183
  ppg_red_pnn20                            0.5326
  ppg_red_rmssd                            0.2122
  ppg_red_hr_min                           0.2106
  ppg_red_hr_range                         0.2099
  ppg_red_peak_quality                     0.1743
  ppg_red_hr_median                        0.1327
  ppg_red_cv_ibi                           0.0873

PC7
  ppg_red_rmssd                            0.5782
  ppg_red_hr_min                           0.4487
  ppg_red_hr_range                         0.3486
  ppg_red_pnn50                            0.2874
  ppg_red_pnn20                            0.2827
  ppg_red_hr_median                        0.2750
  ppg_red_sdnn                             0.1933
  ppg_red_hr_std                           0.1805

PC8
  ppg_red_hr_range                         0.6379
  ppg_red_rmssd                            0.4881
  ppg_red_cv_ibi                           0.3971
  ppg_red_sdnn                             0.2999
  ppg_red_mean_ibi                         0.1773
  ppg_red_peak_quality                     0.1659
  ppg_red_n_peaks                          0.1472
  ppg_red_hr_std                           0.1004

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_10.0s.csv | rows=299 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_10.0s.csv
Shape: (299, 33)
Selected feature columns: 26
After NaN/variance filter: (299, 26)
After correlation pruning: (299, 10)

PCA summary (round 1):
  pcs_for_90pct: 6
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.2959   (cum 0.2959)
   PC2: 0.2075   (cum 0.5034)
   PC3: 0.1537   (cum 0.6572)
   PC4: 0.1365   (cum 0.7936)
   PC5: 0.1000   (cum 0.8936)
   PC6: 0.0361   (cum 0.9298)
   PC7: 0.0349   (cum 0.9647)
   PC8: 0.0190   (cum 0.9837)
   PC9: 0.0103   (cum 0.9940)
  PC10: 0.0060   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_mean_abs_diff                     0.5507
  eda_cc_slope                             0.5228
  eda_cc_max                               0.5207
  eda_cc_skew                              0.2178
  eda_stress_skin_mad                      0.1923
  eda_cc_kurtosis                          0.1722
  eda_stress_skin_min                      0.1696
  eda_stress_skin_kurtosis                 0.0866

PC2
  eda_stress_skin_kurtosis                 0.5951
  eda_stress_skin_skew                     0.5682
  eda_stress_skin_mad                      0.3779
  eda_stress_skin_min                      0.3739
  eda_cc_max                               0.1426
  eda_cc_slope                             0.1096
  eda_cc_mean_abs_diff                     0.0840
  eda_cc_kurtosis                          0.0245

PC3
  eda_cc_kurtosis                          0.6877
  eda_cc_skew                              0.6559
  eda_cc_max                               0.1815
  eda_cc_slope                             0.1741
  eda_cc_mean_abs_diff                     0.1379
  eda_stress_skin_skew                     0.0929
  eda_stress_skin_kurtosis                 0.0665
  eda_stress_skin_slope                    0.0348

PC4
  eda_stress_skin_min                      0.5740
  eda_stress_skin_mad                      0.5557
  eda_stress_skin_skew                     0.4287
  eda_stress_skin_kurtosis                 0.3564
  eda_cc_max                               0.1548
  eda_cc_skew                              0.1053
  eda_cc_mean_abs_diff                     0.0810
  eda_cc_kurtosis                          0.0782

PC5
  eda_stress_skin_slope                    0.9965
  eda_stress_skin_min                      0.0547
  eda_cc_max                               0.0454
  eda_cc_kurtosis                          0.0245
  eda_stress_skin_kurtosis                 0.0228
  eda_stress_skin_skew                     0.0220
  eda_cc_skew                              0.0133
  eda_cc_slope                             0.0112

PC6
  eda_cc_skew                              0.6033
  eda_cc_kurtosis                          0.5726
  eda_stress_skin_min                      0.3914
  eda_stress_skin_mad                      0.3777
  eda_stress_skin_kurtosis                 0.0701
  eda_stress_skin_skew                     0.0654
  eda_cc_max                               0.0376
  eda_stress_skin_slope                    0.0249

PC7
  eda_stress_skin_mad                      0.5744
  eda_stress_skin_min                      0.5688
  eda_cc_kurtosis                          0.4019
  eda_cc_skew                              0.3803
  eda_stress_skin_skew                     0.1238
  eda_cc_slope                             0.1129
  eda_stress_skin_kurtosis                 0.1042
  eda_cc_max                               0.0289

PC8
  eda_cc_slope                             0.7182
  eda_cc_max                               0.3839
  eda_stress_skin_skew                     0.3476
  eda_stress_skin_kurtosis                 0.3255
  eda_cc_mean_abs_diff                     0.2648
  eda_stress_skin_min                      0.1404
  eda_stress_skin_mad                      0.1327
  eda_cc_skew                              0.0390

Stage 2: PCs used to reach 90%: 6
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 6
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.2959   (cum 0.2959)
   PC2: 0.2075   (cum 0.5034)
   PC3: 0.1537   (cum 0.6572)
   PC4: 0.1365   (cum 0.7936)
   PC5: 0.1000   (cum 0.8936)
   PC6: 0.0361   (cum 0.9298)
   PC7: 0.0349   (cum 0.9647)
   PC8: 0.0190   (cum 0.9837)
   PC9: 0.0103   (cum 0.9940)
  PC10: 0.0060   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_mean_abs_diff                     0.5507
  eda_cc_slope                             0.5228
  eda_cc_max                               0.5207
  eda_cc_skew                              0.2178
  eda_stress_skin_mad                      0.1923
  eda_cc_kurtosis                          0.1722
  eda_stress_skin_min                      0.1696
  eda_stress_skin_kurtosis                 0.0866

PC2
  eda_stress_skin_kurtosis                 0.5951
  eda_stress_skin_skew                     0.5682
  eda_stress_skin_mad                      0.3779
  eda_stress_skin_min                      0.3739
  eda_cc_max                               0.1426
  eda_cc_slope                             0.1096
  eda_cc_mean_abs_diff                     0.0840
  eda_cc_kurtosis                          0.0245

PC3
  eda_cc_kurtosis                          0.6877
  eda_cc_skew                              0.6559
  eda_cc_max                               0.1815
  eda_cc_slope                             0.1741
  eda_cc_mean_abs_diff                     0.1379
  eda_stress_skin_skew                     0.0929
  eda_stress_skin_kurtosis                 0.0665
  eda_stress_skin_slope                    0.0348

PC4
  eda_stress_skin_min                      0.5740
  eda_stress_skin_mad                      0.5557
  eda_stress_skin_skew                     0.4287
  eda_stress_skin_kurtosis                 0.3564
  eda_cc_max                               0.1548
  eda_cc_skew                              0.1053
  eda_cc_mean_abs_diff                     0.0810
  eda_cc_kurtosis                          0.0782

PC5
  eda_stress_skin_slope                    0.9965
  eda_stress_skin_min                      0.0547
  eda_cc_max                               0.0454
  eda_cc_kurtosis                          0.0245
  eda_stress_skin_kurtosis                 0.0228
  eda_stress_skin_skew                     0.0220
  eda_cc_skew                              0.0133
  eda_cc_slope                             0.0112

PC6
  eda_cc_skew                              0.6033
  eda_cc_kurtosis                          0.5726
  eda_stress_skin_min                      0.3914
  eda_stress_skin_mad                      0.3777
  eda_stress_skin_kurtosis                 0.0701
  eda_stress_skin_skew                     0.0654
  eda_cc_max                               0.0376
  eda_stress_skin_slope                    0.0249

PC7
  eda_stress_skin_mad                      0.5744
  eda_stress_skin_min                      0.5688
  eda_cc_kurtosis                          0.4019
  eda_cc_skew                              0.3803
  eda_stress_skin_skew                     0.1238
  eda_cc_slope                             0.1129
  eda_stress_skin_kurtosis                 0.1042
  eda_cc_max                               0.0289

PC8
  eda_cc_slope                             0.7182
  eda_cc_max                               0.3839
  eda_stress_skin_skew                     0.3476
  eda_stress_skin_kurtosis                 0.3255
  eda_cc_mean_abs_diff                     0.2648
  eda_stress_skin_min                      0.1404
  eda_stress_skin_mad                      0.1327
  eda_cc_skew                              0.0390

Saved to: data/feature_extraction/analysis/quality_eda_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_10.0s.csv
Shape: (299, 28)
Selected feature columns: 21
After NaN/variance filter: (299, 15)
After correlation pruning: (299, 4)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.8195   (cum 0.8195)
   PC2: 0.1442   (cum 0.9637)
   PC3: 0.0232   (cum 0.9869)
   PC4: 0.0131   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5316
  eda_phasic_energy                        0.5233
  eda_scl_max                              0.5082
  eda_scr_count                            0.4305

PC2
  eda_scr_count                            0.8096
  eda_scl_max                              0.4627
  eda_phasic_energy                        0.3402
  eda_scl_slope                            0.1215

PC3
  eda_scl_slope                            0.8378
  eda_scr_count                            0.3874
  eda_phasic_energy                        0.3070
  eda_scl_max                              0.2320

PC4
  eda_phasic_energy                        0.7185
  eda_scl_max                              0.6883
  eda_scr_count                            0.0957
  eda_scl_slope                            0.0284

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.8195   (cum 0.8195)
   PC2: 0.1442   (cum 0.9637)
   PC3: 0.0232   (cum 0.9869)
   PC4: 0.0131   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5316
  eda_phasic_energy                        0.5233
  eda_scl_max                              0.5082
  eda_scr_count                            0.4305

PC2
  eda_scr_count                            0.8096
  eda_scl_max                              0.4627
  eda_phasic_energy                        0.3402
  eda_scl_slope                            0.1215

PC3
  eda_scl_slope                            0.8378
  eda_scr_count                            0.3874
  eda_phasic_energy                        0.3070
  eda_scl_max                              0.2320

PC4
  eda_phasic_energy                        0.7185
  eda_scl_max                              0.6883
  eda_scr_count                            0.0957
  eda_scl_slope                            0.0284

Saved to: data/feature_extraction/analysis/quality_eda_advanced_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_features_5.0s.csv
Shape: (609, 39)
Selected feature columns: 30
After NaN/variance filter: (609, 29)
After correlation pruning: (609, 29)

PCA summary (round 1):
  pcs_for_90pct: 12
  pcs_for_95pct: 16
  pcs_for_99pct: 24

Explained variance per PC (round 1):
   PC1: 0.4125   (cum 0.4125)
   PC2: 0.1917   (cum 0.6042)
   PC3: 0.0721   (cum 0.6763)
   PC4: 0.0463   (cum 0.7226)
   PC5: 0.0374   (cum 0.7600)
   PC6: 0.0327   (cum 0.7927)
   PC7: 0.0282   (cum 0.8209)
   PC8: 0.0228   (cum 0.8436)
   PC9: 0.0205   (cum 0.8641)
  PC10: 0.0176   (cum 0.8817)
  PC11: 0.0155   (cum 0.8972)
  PC12: 0.0150   (cum 0.9122)
  PC13: 0.0123   (cum 0.9245)
  PC14: 0.0115   (cum 0.9360)
  PC15: 0.0098   (cum 0.9458)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2645
  acc_x_dyn__quantile_0.9                  0.2625
  acc_y_dyn__quantile_0.3                  0.2603
  acc_y_dyn__avg_amplitude_change          0.2537
  acc_x_dyn__quantile_0.3                  0.2514
  acc_z_dyn__harmonic_mean_of_abs          0.2304
  acc_x_dyn__variance_of_absolute_differences 0.2285
  acc_y_dyn__harmonic_mean_of_abs          0.2273

PC2
  acc_z_dyn__sample_entropy                0.3711
  acc_x_dyn__sample_entropy                0.3699
  acc_y_dyn__sample_entropy                0.3667
  acc_x_dyn__approximate_entropy_0.9       0.3231
  acc_y_dyn__katz_fractal_dimension        0.3125
  acc_z_dyn__katz_fractal_dimension        0.3039
  acc_x_dyn__katz_fractal_dimension        0.3015
  acc_y_dyn__tsallis_entropy               0.2841

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4221
  acc_z_dyn__approximate_entropy_0.1       0.3713
  acc_x_dyn__harmonic_mean_of_abs          0.2757
  acc_x_dyn__katz_fractal_dimension        0.2568
  acc_x_dyn__quantile_0.6                  0.2226
  acc_y_dyn__avg_amplitude_change          0.2166
  acc_x_dyn__quantile_0.3                  0.2085
  acc_x_dyn__quantile_0.4                  0.2064

PC4
  acc_x_dyn__approximate_entropy_0.1       0.3505
  acc_x_dyn__quantile_0.4                  0.3426
  acc_x_dyn__harmonic_mean_of_abs          0.3180
  acc_z_dyn__approximate_entropy_0.1       0.3016
  acc_z_dyn__quantile_0.6                  0.2672
  acc_z_dyn__variance_of_absolute_differences 0.2643
  acc_x_dyn__quantile_0.3                  0.2459
  acc_z_dyn__lower_complete_moment         0.2456

PC5
  acc_z_dyn__quantile_0.6                  0.4640
  acc_z_dyn__lower_complete_moment         0.4439
  acc_z_dyn__harmonic_mean_of_abs          0.2801
  acc_x_dyn__approximate_entropy_0.1       0.2726
  acc_z_dyn__approximate_entropy_0.1       0.2693
  acc_y_dyn__variance_of_absolute_differences 0.2587
  acc_x_dyn__quantile_0.6                  0.2270
  acc_x_dyn__quantile_0.4                  0.2186

PC6
  acc_x_dyn__cardinality                   0.6901
  acc_y_dyn__tsallis_entropy               0.3111
  acc_y_dyn__quantile_0.4                  0.2620
  acc_z_dyn__variance_of_absolute_differences 0.2542
  acc_x_dyn__variance_of_absolute_differences 0.2411
  acc_y_dyn__harmonic_mean_of_abs          0.2339
  acc_y_dyn__quantile_0.3                  0.2056
  acc_y_dyn__variance_of_absolute_differences 0.1728

PC7
  acc_x_dyn__cardinality                   0.6099
  acc_y_dyn__quantile_0.4                  0.3310
  acc_y_dyn__harmonic_mean_of_abs          0.3201
  acc_y_dyn__quantile_0.3                  0.2851
  acc_z_dyn__katz_fractal_dimension        0.2471
  acc_z_dyn__variance_of_absolute_differences 0.2176
  acc_x_dyn__max                           0.1937
  acc_z_dyn__quantile_0.4                  0.1915

PC8
  acc_z_dyn__quantile_0.4                  0.4340
  acc_x_dyn__approximate_entropy_0.9       0.4339
  acc_y_dyn__katz_fractal_dimension        0.3872
  acc_x_dyn__sample_entropy                0.3126
  acc_y_dyn__sample_entropy                0.2544
  acc_x_dyn__variance_of_absolute_differences 0.2429
  acc_z_dyn__harmonic_mean_of_abs          0.2351
  acc_x_dyn__katz_fractal_dimension        0.1908

Stage 2: PCs used to reach 90%: 12
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 12
  pcs_for_95pct: 16
  pcs_for_99pct: 24

Explained variance per PC (round 2):
   PC1: 0.4125   (cum 0.4125)
   PC2: 0.1917   (cum 0.6042)
   PC3: 0.0721   (cum 0.6763)
   PC4: 0.0463   (cum 0.7226)
   PC5: 0.0374   (cum 0.7600)
   PC6: 0.0327   (cum 0.7927)
   PC7: 0.0282   (cum 0.8209)
   PC8: 0.0228   (cum 0.8436)
   PC9: 0.0205   (cum 0.8641)
  PC10: 0.0176   (cum 0.8817)
  PC11: 0.0155   (cum 0.8972)
  PC12: 0.0150   (cum 0.9122)
  PC13: 0.0123   (cum 0.9245)
  PC14: 0.0115   (cum 0.9360)
  PC15: 0.0098   (cum 0.9458)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2645
  acc_x_dyn__quantile_0.9                  0.2625
  acc_y_dyn__quantile_0.3                  0.2603
  acc_y_dyn__avg_amplitude_change          0.2537
  acc_x_dyn__quantile_0.3                  0.2514
  acc_z_dyn__harmonic_mean_of_abs          0.2304
  acc_x_dyn__variance_of_absolute_differences 0.2285
  acc_y_dyn__harmonic_mean_of_abs          0.2273

PC2
  acc_z_dyn__sample_entropy                0.3711
  acc_x_dyn__sample_entropy                0.3699
  acc_y_dyn__sample_entropy                0.3667
  acc_x_dyn__approximate_entropy_0.9       0.3231
  acc_y_dyn__katz_fractal_dimension        0.3125
  acc_z_dyn__katz_fractal_dimension        0.3039
  acc_x_dyn__katz_fractal_dimension        0.3015
  acc_y_dyn__tsallis_entropy               0.2841

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4221
  acc_z_dyn__approximate_entropy_0.1       0.3713
  acc_x_dyn__harmonic_mean_of_abs          0.2757
  acc_x_dyn__katz_fractal_dimension        0.2568
  acc_x_dyn__quantile_0.6                  0.2226
  acc_y_dyn__avg_amplitude_change          0.2166
  acc_x_dyn__quantile_0.3                  0.2085
  acc_x_dyn__quantile_0.4                  0.2064

PC4
  acc_x_dyn__approximate_entropy_0.1       0.3505
  acc_x_dyn__quantile_0.4                  0.3426
  acc_x_dyn__harmonic_mean_of_abs          0.3180
  acc_z_dyn__approximate_entropy_0.1       0.3016
  acc_z_dyn__quantile_0.6                  0.2672
  acc_z_dyn__variance_of_absolute_differences 0.2643
  acc_x_dyn__quantile_0.3                  0.2459
  acc_z_dyn__lower_complete_moment         0.2456

PC5
  acc_z_dyn__quantile_0.6                  0.4640
  acc_z_dyn__lower_complete_moment         0.4439
  acc_z_dyn__harmonic_mean_of_abs          0.2801
  acc_x_dyn__approximate_entropy_0.1       0.2726
  acc_z_dyn__approximate_entropy_0.1       0.2693
  acc_y_dyn__variance_of_absolute_differences 0.2587
  acc_x_dyn__quantile_0.6                  0.2270
  acc_x_dyn__quantile_0.4                  0.2186

PC6
  acc_x_dyn__cardinality                   0.6901
  acc_y_dyn__tsallis_entropy               0.3111
  acc_y_dyn__quantile_0.4                  0.2620
  acc_z_dyn__variance_of_absolute_differences 0.2542
  acc_x_dyn__variance_of_absolute_differences 0.2411
  acc_y_dyn__harmonic_mean_of_abs          0.2339
  acc_y_dyn__quantile_0.3                  0.2056
  acc_y_dyn__variance_of_absolute_differences 0.1728

PC7
  acc_x_dyn__cardinality                   0.6099
  acc_y_dyn__quantile_0.4                  0.3310
  acc_y_dyn__harmonic_mean_of_abs          0.3201
  acc_y_dyn__quantile_0.3                  0.2851
  acc_z_dyn__katz_fractal_dimension        0.2471
  acc_z_dyn__variance_of_absolute_differences 0.2176
  acc_x_dyn__max                           0.1937
  acc_z_dyn__quantile_0.4                  0.1915

PC8
  acc_z_dyn__quantile_0.4                  0.4340
  acc_x_dyn__approximate_entropy_0.9       0.4339
  acc_y_dyn__katz_fractal_dimension        0.3872
  acc_x_dyn__sample_entropy                0.3126
  acc_y_dyn__sample_entropy                0.2544
  acc_x_dyn__variance_of_absolute_differences 0.2429
  acc_z_dyn__harmonic_mean_of_abs          0.2351
  acc_x_dyn__katz_fractal_dimension        0.1908

Saved to: data/feature_extraction/analysis/quality_imu_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_features_5.0s.csv | rows=676 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_features_5.0s.csv
Shape: (676, 51)
Selected feature columns: 44
After NaN/variance filter: (676, 43)
After correlation pruning: (676, 19)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.4540   (cum 0.4540)
   PC2: 0.1447   (cum 0.5988)
   PC3: 0.0978   (cum 0.6966)
   PC4: 0.0619   (cum 0.7585)
   PC5: 0.0564   (cum 0.8148)
   PC6: 0.0489   (cum 0.8638)
   PC7: 0.0395   (cum 0.9033)
   PC8: 0.0285   (cum 0.9318)
   PC9: 0.0161   (cum 0.9480)
  PC10: 0.0121   (cum 0.9600)
  PC11: 0.0113   (cum 0.9713)
  PC12: 0.0095   (cum 0.9808)
  PC13: 0.0071   (cum 0.9878)
  PC14: 0.0056   (cum 0.9934)
  PC15: 0.0040   (cum 0.9975)

Top PCA loadings per component (round 1):

PC1
  ppg_green_range                          0.3318
  ppg_green_max                            0.3228
  ppg_green_p90_p10                        0.3074
  ppg_green_shape_factor                   0.3005
  ppg_green_tke_p95_abs                    0.2918
  ppg_green_p90                            0.2900
  ppg_green_tke_mean                       0.2741
  ppg_green_crest_factor                   0.2706

PC2
  ppg_green_skew                           0.4494
  ppg_green_median                         0.3906
  ppg_green_kurtosis                       0.3751
  ppg_green_p1                             0.3377
  ppg_green_crest_factor                   0.2926
  ppg_green_p90                            0.2764
  ppg_green_iqr                            0.2040
  ppg_green_ddx_kurtosis                   0.2021

PC3
  ppg_green_p1                             0.5309
  ppg_green_kurtosis                       0.4103
  ppg_green_median                         0.3758
  ppg_green_ddx_kurtosis                   0.2596
  ppg_green_mad                            0.2189
  ppg_green_iqr                            0.2149
  ppg_green_dx_kurtosis                    0.2059
  ppg_green_shape_factor                   0.1864

PC4
  ppg_green_mean_cross_rate                0.6204
  ppg_green_ddx_kurtosis                   0.4506
  ppg_green_dx_kurtosis                    0.3844
  ppg_green_tke_p95_abs                    0.2467
  ppg_green_ddx_mean                       0.2248
  ppg_green_tke_mean                       0.2120
  ppg_green_diff_mean                      0.1660
  ppg_green_iqr                            0.1333

PC5
  ppg_green_diff_mean                      0.8247
  ppg_green_ddx_mean                       0.3708
  ppg_green_mean_cross_rate                0.3052
  ppg_green_mad                            0.1742
  ppg_green_shape_factor                   0.1355
  ppg_green_iqr                            0.1094
  ppg_green_tke_p95_abs                    0.1034
  ppg_green_dx_kurtosis                    0.0706

PC6
  ppg_green_ddx_mean                       0.8442
  ppg_green_diff_mean                      0.3049
  ppg_green_p1                             0.2408
  ppg_green_ddx_kurtosis                   0.2073
  ppg_green_mean_cross_rate                0.1436
  ppg_green_dx_kurtosis                    0.1270
  ppg_green_max                            0.1088
  ppg_green_iqr                            0.1038

PC7
  ppg_green_mean_cross_rate                0.5058
  ppg_green_diff_mean                      0.4232
  ppg_green_mad                            0.3780
  ppg_green_ddx_kurtosis                   0.3056
  ppg_green_tke_mean                       0.3041
  ppg_green_iqr                            0.2391
  ppg_green_shape_factor                   0.1923
  ppg_green_ddx_mean                       0.1872

PC8
  ppg_green_skew                           0.5498
  ppg_green_mad                            0.4497
  ppg_green_mean_cross_rate                0.3196
  ppg_green_iqr                            0.3054
  ppg_green_kurtosis                       0.2823
  ppg_green_ddx_kurtosis                   0.2702
  ppg_green_dx_kurtosis                    0.1976
  ppg_green_tke_mean                       0.1954

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 19
Stage 2: selected features: 19 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.4540   (cum 0.4540)
   PC2: 0.1447   (cum 0.5988)
   PC3: 0.0978   (cum 0.6966)
   PC4: 0.0619   (cum 0.7585)
   PC5: 0.0564   (cum 0.8148)
   PC6: 0.0489   (cum 0.8638)
   PC7: 0.0395   (cum 0.9033)
   PC8: 0.0285   (cum 0.9318)
   PC9: 0.0161   (cum 0.9480)
  PC10: 0.0121   (cum 0.9600)
  PC11: 0.0113   (cum 0.9713)
  PC12: 0.0095   (cum 0.9808)
  PC13: 0.0071   (cum 0.9878)
  PC14: 0.0056   (cum 0.9934)
  PC15: 0.0040   (cum 0.9975)

Top PCA loadings per component (round 2):

PC1
  ppg_green_range                          0.3318
  ppg_green_max                            0.3228
  ppg_green_p90_p10                        0.3074
  ppg_green_shape_factor                   0.3005
  ppg_green_tke_p95_abs                    0.2918
  ppg_green_p90                            0.2900
  ppg_green_tke_mean                       0.2741
  ppg_green_crest_factor                   0.2706

PC2
  ppg_green_skew                           0.4494
  ppg_green_median                         0.3906
  ppg_green_kurtosis                       0.3751
  ppg_green_p1                             0.3377
  ppg_green_crest_factor                   0.2926
  ppg_green_p90                            0.2764
  ppg_green_iqr                            0.2040
  ppg_green_ddx_kurtosis                   0.2021

PC3
  ppg_green_p1                             0.5309
  ppg_green_kurtosis                       0.4103
  ppg_green_median                         0.3758
  ppg_green_ddx_kurtosis                   0.2596
  ppg_green_mad                            0.2189
  ppg_green_iqr                            0.2149
  ppg_green_dx_kurtosis                    0.2059
  ppg_green_shape_factor                   0.1864

PC4
  ppg_green_mean_cross_rate                0.6204
  ppg_green_ddx_kurtosis                   0.4506
  ppg_green_dx_kurtosis                    0.3844
  ppg_green_tke_p95_abs                    0.2467
  ppg_green_ddx_mean                       0.2248
  ppg_green_tke_mean                       0.2120
  ppg_green_diff_mean                      0.1660
  ppg_green_iqr                            0.1333

PC5
  ppg_green_diff_mean                      0.8247
  ppg_green_ddx_mean                       0.3708
  ppg_green_mean_cross_rate                0.3052
  ppg_green_mad                            0.1742
  ppg_green_shape_factor                   0.1355
  ppg_green_iqr                            0.1094
  ppg_green_tke_p95_abs                    0.1034
  ppg_green_dx_kurtosis                    0.0706

PC6
  ppg_green_ddx_mean                       0.8442
  ppg_green_diff_mean                      0.3049
  ppg_green_p1                             0.2408
  ppg_green_ddx_kurtosis                   0.2073
  ppg_green_mean_cross_rate                0.1436
  ppg_green_dx_kurtosis                    0.1270
  ppg_green_max                            0.1088
  ppg_green_iqr                            0.1038

PC7
  ppg_green_mean_cross_rate                0.5058
  ppg_green_diff_mean                      0.4232
  ppg_green_mad                            0.3780
  ppg_green_ddx_kurtosis                   0.3056
  ppg_green_tke_mean                       0.3041
  ppg_green_iqr                            0.2391
  ppg_green_shape_factor                   0.1923
  ppg_green_ddx_mean                       0.1872

PC8
  ppg_green_skew                           0.5498
  ppg_green_mad                            0.4497
  ppg_green_mean_cross_rate                0.3196
  ppg_green_iqr                            0.3054
  ppg_green_kurtosis                       0.2823
  ppg_green_ddx_kurtosis                   0.2702
  ppg_green_dx_kurtosis                    0.1976
  ppg_green_tke_mean                       0.1954

Saved to: data/feature_extraction/analysis/quality_ppg_green_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_5.0s.csv
Shape: (676, 28)
Selected feature columns: 18
After NaN/variance filter: (676, 2)
After correlation pruning: (676, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7595   (cum 0.7595)
   PC2: 0.2405   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7595   (cum 0.7595)
   PC2: 0.2405   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_5.0s.csv | rows=676 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_5.0s.csv
Shape: (676, 51)
Selected feature columns: 44
After NaN/variance filter: (676, 44)
After correlation pruning: (676, 23)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3719   (cum 0.3719)
   PC2: 0.1889   (cum 0.5608)
   PC3: 0.0973   (cum 0.6581)
   PC4: 0.0835   (cum 0.7416)
   PC5: 0.0581   (cum 0.7997)
   PC6: 0.0492   (cum 0.8489)
   PC7: 0.0368   (cum 0.8858)
   PC8: 0.0296   (cum 0.9154)
   PC9: 0.0221   (cum 0.9374)
  PC10: 0.0171   (cum 0.9546)
  PC11: 0.0112   (cum 0.9658)
  PC12: 0.0065   (cum 0.9723)
  PC13: 0.0062   (cum 0.9785)
  PC14: 0.0046   (cum 0.9832)
  PC15: 0.0043   (cum 0.9874)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_ddx_std                        0.3262
  ppg_infra_p99                            0.3242
  ppg_infra_p1                             0.3215
  ppg_infra_p5                             0.3172
  ppg_infra_diff_mean_abs                  0.3150
  ppg_infra_p90                            0.3107
  ppg_infra_signal_energy                  0.3016
  ppg_infra_mad                            0.2876

PC2
  ppg_infra_clearance_factor               0.4307
  ppg_infra_kurtosis                       0.4181
  ppg_infra_shape_factor                   0.4154
  ppg_infra_crest_factor                   0.3905
  ppg_infra_ddx_kurtosis                   0.2874
  ppg_infra_dx_kurtosis                    0.2742
  ppg_infra_mad                            0.1715
  ppg_infra_skew                           0.1586

PC3
  ppg_infra_trim_mean_10                   0.5781
  ppg_infra_mean                           0.5168
  ppg_infra_median                         0.4360
  ppg_infra_ddx_mean                       0.3368
  ppg_infra_mean_cross_rate                0.1670
  ppg_infra_zcr                            0.1522
  ppg_infra_p1                             0.0918
  ppg_infra_p90                            0.0838

PC4
  ppg_infra_zcr                            0.6685
  ppg_infra_mean_cross_rate                0.6535
  ppg_infra_crest_factor                   0.1572
  ppg_infra_trim_mean_10                   0.1445
  ppg_infra_mean                           0.1248
  ppg_infra_kurtosis                       0.1223
  ppg_infra_clearance_factor               0.1055
  ppg_infra_ddx_kurtosis                   0.0931

PC5
  ppg_infra_dx_mean                        0.6350
  ppg_infra_ddx_mean                       0.5370
  ppg_infra_skew                           0.3145
  ppg_infra_median                         0.2788
  ppg_infra_tke_std                        0.2301
  ppg_infra_trim_mean_10                   0.1642
  ppg_infra_signal_energy                  0.1180
  ppg_infra_p1                             0.1040

PC6
  ppg_infra_skew                           0.7415
  ppg_infra_dx_mean                        0.4617
  ppg_infra_mean                           0.3054
  ppg_infra_median                         0.2008
  ppg_infra_p99                            0.1369
  ppg_infra_mad                            0.1307
  ppg_infra_tke_std                        0.1194
  ppg_infra_p90                            0.1177

PC7
  ppg_infra_ddx_kurtosis                   0.5648
  ppg_infra_dx_kurtosis                    0.4761
  ppg_infra_tke_std                        0.2939
  ppg_infra_ddx_mean                       0.2592
  ppg_infra_signal_energy                  0.2522
  ppg_infra_shape_factor                   0.2379
  ppg_infra_clearance_factor               0.1804
  ppg_infra_trim_mean_10                   0.1738

PC8
  ppg_infra_median                         0.5231
  ppg_infra_tke_std                        0.4049
  ppg_infra_dx_kurtosis                    0.2877
  ppg_infra_trim_mean_10                   0.2825
  ppg_infra_p5                             0.2558
  ppg_infra_dx_mean                        0.2451
  ppg_infra_mad                            0.2320
  ppg_infra_mean                           0.1951

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3719   (cum 0.3719)
   PC2: 0.1889   (cum 0.5608)
   PC3: 0.0973   (cum 0.6581)
   PC4: 0.0835   (cum 0.7416)
   PC5: 0.0581   (cum 0.7997)
   PC6: 0.0492   (cum 0.8489)
   PC7: 0.0368   (cum 0.8858)
   PC8: 0.0296   (cum 0.9154)
   PC9: 0.0221   (cum 0.9374)
  PC10: 0.0171   (cum 0.9546)
  PC11: 0.0112   (cum 0.9658)
  PC12: 0.0065   (cum 0.9723)
  PC13: 0.0062   (cum 0.9785)
  PC14: 0.0046   (cum 0.9832)
  PC15: 0.0043   (cum 0.9874)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_ddx_std                        0.3262
  ppg_infra_p99                            0.3242
  ppg_infra_p1                             0.3215
  ppg_infra_p5                             0.3172
  ppg_infra_diff_mean_abs                  0.3150
  ppg_infra_p90                            0.3107
  ppg_infra_signal_energy                  0.3016
  ppg_infra_mad                            0.2876

PC2
  ppg_infra_clearance_factor               0.4307
  ppg_infra_kurtosis                       0.4181
  ppg_infra_shape_factor                   0.4154
  ppg_infra_crest_factor                   0.3905
  ppg_infra_ddx_kurtosis                   0.2874
  ppg_infra_dx_kurtosis                    0.2742
  ppg_infra_mad                            0.1715
  ppg_infra_skew                           0.1586

PC3
  ppg_infra_trim_mean_10                   0.5781
  ppg_infra_mean                           0.5168
  ppg_infra_median                         0.4360
  ppg_infra_ddx_mean                       0.3368
  ppg_infra_mean_cross_rate                0.1670
  ppg_infra_zcr                            0.1522
  ppg_infra_p1                             0.0918
  ppg_infra_p90                            0.0838

PC4
  ppg_infra_zcr                            0.6685
  ppg_infra_mean_cross_rate                0.6535
  ppg_infra_crest_factor                   0.1572
  ppg_infra_trim_mean_10                   0.1445
  ppg_infra_mean                           0.1248
  ppg_infra_kurtosis                       0.1223
  ppg_infra_clearance_factor               0.1055
  ppg_infra_ddx_kurtosis                   0.0931

PC5
  ppg_infra_dx_mean                        0.6350
  ppg_infra_ddx_mean                       0.5370
  ppg_infra_skew                           0.3145
  ppg_infra_median                         0.2788
  ppg_infra_tke_std                        0.2301
  ppg_infra_trim_mean_10                   0.1642
  ppg_infra_signal_energy                  0.1180
  ppg_infra_p1                             0.1040

PC6
  ppg_infra_skew                           0.7415
  ppg_infra_dx_mean                        0.4617
  ppg_infra_mean                           0.3054
  ppg_infra_median                         0.2008
  ppg_infra_p99                            0.1369
  ppg_infra_mad                            0.1307
  ppg_infra_tke_std                        0.1194
  ppg_infra_p90                            0.1177

PC7
  ppg_infra_ddx_kurtosis                   0.5648
  ppg_infra_dx_kurtosis                    0.4761
  ppg_infra_tke_std                        0.2939
  ppg_infra_ddx_mean                       0.2592
  ppg_infra_signal_energy                  0.2522
  ppg_infra_shape_factor                   0.2379
  ppg_infra_clearance_factor               0.1804
  ppg_infra_trim_mean_10                   0.1738

PC8
  ppg_infra_median                         0.5231
  ppg_infra_tke_std                        0.4049
  ppg_infra_dx_kurtosis                    0.2877
  ppg_infra_trim_mean_10                   0.2825
  ppg_infra_p5                             0.2558
  ppg_infra_dx_mean                        0.2451
  ppg_infra_mad                            0.2320
  ppg_infra_mean                           0.1951

Saved to: data/feature_extraction/analysis/quality_ppg_infra_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_5.0s.csv
Shape: (676, 28)
Selected feature columns: 18
After NaN/variance filter: (676, 2)
After correlation pruning: (676, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5265   (cum 0.5265)
   PC2: 0.4735   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5265   (cum 0.5265)
   PC2: 0.4735   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_5.0s.csv | rows=676 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_5.0s.csv
Shape: (676, 51)
Selected feature columns: 44
After NaN/variance filter: (676, 44)
After correlation pruning: (676, 22)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3145   (cum 0.3145)
   PC2: 0.1968   (cum 0.5113)
   PC3: 0.1076   (cum 0.6188)
   PC4: 0.0890   (cum 0.7078)
   PC5: 0.0587   (cum 0.7665)
   PC6: 0.0535   (cum 0.8200)
   PC7: 0.0459   (cum 0.8659)
   PC8: 0.0338   (cum 0.8997)
   PC9: 0.0282   (cum 0.9279)
  PC10: 0.0201   (cum 0.9481)
  PC11: 0.0127   (cum 0.9608)
  PC12: 0.0098   (cum 0.9705)
  PC13: 0.0075   (cum 0.9780)
  PC14: 0.0064   (cum 0.9844)
  PC15: 0.0046   (cum 0.9890)

Top PCA loadings per component (round 1):

PC1
  ppg_red_p99                              0.3590
  ppg_red_p1                               0.3583
  ppg_red_p95                              0.3547
  ppg_red_ddx_std                          0.3529
  ppg_red_diff_mean_abs                    0.3528
  ppg_red_p10                              0.3278
  ppg_red_iqr                              0.3219
  ppg_red_tke_std                          0.2422

PC2
  ppg_red_clearance_factor                 0.4365
  ppg_red_shape_factor                     0.4032
  ppg_red_kurtosis                         0.4013
  ppg_red_crest_factor                     0.3945
  ppg_red_dx_kurtosis                      0.3593
  ppg_red_ddx_kurtosis                     0.3130
  ppg_red_iqr                              0.1641
  ppg_red_p10                              0.1311

PC3
  ppg_red_mean                             0.5637
  ppg_red_trim_mean_10                     0.5258
  ppg_red_median                           0.4305
  ppg_red_ddx_mean                         0.4121
  ppg_red_dx_mean                          0.1061
  ppg_red_tke_std                          0.0933
  ppg_red_p10                              0.0788
  ppg_red_clearance_factor                 0.0709

PC4
  ppg_red_zcr                              0.6789
  ppg_red_mean_cross_rate                  0.6697
  ppg_red_ddx_kurtosis                     0.1260
  ppg_red_skew                             0.1251
  ppg_red_crest_factor                     0.1090
  ppg_red_kurtosis                         0.0938
  ppg_red_dx_kurtosis                      0.0751
  ppg_red_clearance_factor                 0.0655

PC5
  ppg_red_tke_std                          0.4858
  ppg_red_skew                             0.4266
  ppg_red_trim_mean_10                     0.3475
  ppg_red_ddx_mean                         0.3240
  ppg_red_dx_mean                          0.2664
  ppg_red_p10                              0.2440
  ppg_red_ddx_kurtosis                     0.2113
  ppg_red_iqr                              0.1858

PC6
  ppg_red_skew                             0.7236
  ppg_red_dx_mean                          0.4004
  ppg_red_median                           0.2913
  ppg_red_mean                             0.2554
  ppg_red_shape_factor                     0.1611
  ppg_red_p10                              0.1552
  ppg_red_tke_std                          0.1545
  ppg_red_iqr                              0.1388

PC7
  ppg_red_dx_mean                          0.6930
  ppg_red_median                           0.3819
  ppg_red_tke_std                          0.3752
  ppg_red_ddx_mean                         0.1963
  ppg_red_ddx_std                          0.1709
  ppg_red_p10                              0.1598
  ppg_red_iqr                              0.1560
  ppg_red_skew                             0.1510

PC8
  ppg_red_ddx_kurtosis                     0.5530
  ppg_red_dx_kurtosis                      0.5039
  ppg_red_shape_factor                     0.3991
  ppg_red_dx_mean                          0.2915
  ppg_red_clearance_factor                 0.2770
  ppg_red_median                           0.1776
  ppg_red_mean_cross_rate                  0.1284
  ppg_red_crest_factor                     0.1129

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3145   (cum 0.3145)
   PC2: 0.1968   (cum 0.5113)
   PC3: 0.1076   (cum 0.6188)
   PC4: 0.0890   (cum 0.7078)
   PC5: 0.0587   (cum 0.7665)
   PC6: 0.0535   (cum 0.8200)
   PC7: 0.0459   (cum 0.8659)
   PC8: 0.0338   (cum 0.8997)
   PC9: 0.0282   (cum 0.9279)
  PC10: 0.0201   (cum 0.9481)
  PC11: 0.0127   (cum 0.9608)
  PC12: 0.0098   (cum 0.9705)
  PC13: 0.0075   (cum 0.9780)
  PC14: 0.0064   (cum 0.9844)
  PC15: 0.0046   (cum 0.9890)

Top PCA loadings per component (round 2):

PC1
  ppg_red_p99                              0.3590
  ppg_red_p1                               0.3583
  ppg_red_p95                              0.3547
  ppg_red_ddx_std                          0.3529
  ppg_red_diff_mean_abs                    0.3528
  ppg_red_p10                              0.3278
  ppg_red_iqr                              0.3219
  ppg_red_tke_std                          0.2422

PC2
  ppg_red_clearance_factor                 0.4365
  ppg_red_shape_factor                     0.4032
  ppg_red_kurtosis                         0.4013
  ppg_red_crest_factor                     0.3945
  ppg_red_dx_kurtosis                      0.3593
  ppg_red_ddx_kurtosis                     0.3130
  ppg_red_iqr                              0.1641
  ppg_red_p10                              0.1311

PC3
  ppg_red_mean                             0.5637
  ppg_red_trim_mean_10                     0.5258
  ppg_red_median                           0.4305
  ppg_red_ddx_mean                         0.4121
  ppg_red_dx_mean                          0.1061
  ppg_red_tke_std                          0.0933
  ppg_red_p10                              0.0788
  ppg_red_clearance_factor                 0.0709

PC4
  ppg_red_zcr                              0.6789
  ppg_red_mean_cross_rate                  0.6697
  ppg_red_ddx_kurtosis                     0.1260
  ppg_red_skew                             0.1251
  ppg_red_crest_factor                     0.1090
  ppg_red_kurtosis                         0.0938
  ppg_red_dx_kurtosis                      0.0751
  ppg_red_clearance_factor                 0.0655

PC5
  ppg_red_tke_std                          0.4858
  ppg_red_skew                             0.4266
  ppg_red_trim_mean_10                     0.3475
  ppg_red_ddx_mean                         0.3240
  ppg_red_dx_mean                          0.2664
  ppg_red_p10                              0.2440
  ppg_red_ddx_kurtosis                     0.2113
  ppg_red_iqr                              0.1858

PC6
  ppg_red_skew                             0.7236
  ppg_red_dx_mean                          0.4004
  ppg_red_median                           0.2913
  ppg_red_mean                             0.2554
  ppg_red_shape_factor                     0.1611
  ppg_red_p10                              0.1552
  ppg_red_tke_std                          0.1545
  ppg_red_iqr                              0.1388

PC7
  ppg_red_dx_mean                          0.6930
  ppg_red_median                           0.3819
  ppg_red_tke_std                          0.3752
  ppg_red_ddx_mean                         0.1963
  ppg_red_ddx_std                          0.1709
  ppg_red_p10                              0.1598
  ppg_red_iqr                              0.1560
  ppg_red_skew                             0.1510

PC8
  ppg_red_ddx_kurtosis                     0.5530
  ppg_red_dx_kurtosis                      0.5039
  ppg_red_shape_factor                     0.3991
  ppg_red_dx_mean                          0.2915
  ppg_red_clearance_factor                 0.2770
  ppg_red_median                           0.1776
  ppg_red_mean_cross_rate                  0.1284
  ppg_red_crest_factor                     0.1129

Saved to: data/feature_extraction/analysis/quality_ppg_red_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_5.0s.csv
Shape: (676, 28)
Selected feature columns: 18
After NaN/variance filter: (676, 2)
After correlation pruning: (676, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5663   (cum 0.5663)
   PC2: 0.4337   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5663   (cum 0.5663)
   PC2: 0.4337   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE

=== Processing dataset: elderly_sim_elderly1 ===
▶ imu_bioz: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_bioz/imu_preprocessed.csv
  Windowing imu_bioz...
    ✓ Created 313 windows (10.0s)
  Extracting features for imu_bioz...
▶ imu_wrist: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_preprocessed.csv
  Windowing imu_wrist...
    ✓ Created 304 windows (10.0s)
  Extracting features for imu_wrist...
▶ ppg_green: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_preprocessed.csv
▶ ppg_infra: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_preprocessed.csv
▶ ppg_red: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_preprocessed.csv
▶ RR: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/rr/rr_preprocessed.csv
▶ EDA: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_preprocessed.csv

▶ Window length: 10.0s | overlap=0.1
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_10.0s.csv | windows=338 | features=21
    ✓ HRV features: 338 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_aligned_10.0s.csv (338 windows | borg labeled: 144)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_aligned_10.0s.csv (338 windows | borg labeled: 144)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_10.0s.csv | windows=338 | features=21
    ✓ HRV features: 338 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_aligned_10.0s.csv (338 windows | borg labeled: 144)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_aligned_10.0s.csv (338 windows | borg labeled: 144)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_10.0s.csv | windows=338 | features=21
    ✓ HRV features: 338 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_aligned_10.0s.csv (338 windows | borg labeled: 144)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 338
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_aligned_10.0s.csv (338 windows | borg labeled: 144)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_10.0s.csv | windows=299 | features=21
    ✓ Advanced EDA features: 299 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 299
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_aligned_10.0s.csv (299 windows | borg labeled: 145)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 299
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_aligned_10.0s.csv (299 windows | borg labeled: 145)

▶ Window length: 5.0s | overlap=0.1
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 609
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_aligned_5.0s.csv (609 windows | borg labeled: 293)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_5.0s.csv | windows=676 | features=21
    ✓ HRV features: 676 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_aligned_5.0s.csv (676 windows | borg labeled: 294)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_aligned_5.0s.csv (676 windows | borg labeled: 294)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_5.0s.csv | windows=676 | features=21
    ✓ HRV features: 676 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_aligned_5.0s.csv (676 windows | borg labeled: 294)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_aligned_5.0s.csv (676 windows | borg labeled: 294)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_5.0s.csv | windows=676 | features=21
    ✓ HRV features: 676 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_aligned_5.0s.csv (676 windows | borg labeled: 294)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 676
  Windows in ADL time range: 439
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_5.0s.csv | rows=599 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_5.0s.csv
Shape: (599, 33)
Selected feature columns: 26
After NaN/variance filter: (599, 26)
After correlation pruning: (599, 10)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.2946   (cum 0.2946)
   PC2: 0.1964   (cum 0.4910)
   PC3: 0.1809   (cum 0.6719)
   PC4: 0.1399   (cum 0.8118)
   PC5: 0.1000   (cum 0.9118)
   PC6: 0.0340   (cum 0.9458)
   PC7: 0.0223   (cum 0.9682)
   PC8: 0.0132   (cum 0.9814)
   PC9: 0.0125   (cum 0.9938)
  PC10: 0.0062   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_mean_abs_diff                     0.5456
  eda_cc_slope                             0.5152
  eda_cc_max                               0.5145
  eda_stress_skin_std                      0.2124
  eda_stress_skin_min                      0.1918
  eda_cc_skew                              0.1794
  eda_stress_skin_kurtosis                 0.1751
  eda_cc_kurtosis                          0.1565

PC2
  eda_stress_skin_kurtosis                 0.5593
  eda_stress_skin_skew                     0.5225
  eda_stress_skin_min                      0.3833
  eda_stress_skin_std                      0.3821
  eda_cc_max                               0.2211
  eda_cc_slope                             0.1934
  eda_cc_mean_abs_diff                     0.1565
  eda_cc_kurtosis                          0.0741

PC3
  eda_cc_kurtosis                          0.6873
  eda_cc_skew                              0.6783
  eda_cc_slope                             0.1175
  eda_cc_max                               0.1098
  eda_cc_mean_abs_diff                     0.0985
  eda_stress_skin_std                      0.0980
  eda_stress_skin_min                      0.0935
  eda_stress_skin_kurtosis                 0.0924

PC4
  eda_stress_skin_min                      0.5462
  eda_stress_skin_std                      0.5347
  eda_stress_skin_skew                     0.5056
  eda_stress_skin_kurtosis                 0.3613
  eda_cc_max                               0.1474
  eda_cc_mean_abs_diff                     0.0737
  eda_cc_slope                             0.0394
  eda_stress_skin_slope                    0.0244

PC5
  eda_stress_skin_slope                    0.9971
  eda_stress_skin_min                      0.0476
  eda_cc_max                               0.0444
  eda_stress_skin_skew                     0.0301
  eda_stress_skin_kurtosis                 0.0210
  eda_cc_skew                              0.0091
  eda_cc_slope                             0.0090
  eda_cc_kurtosis                          0.0076

PC6
  eda_stress_skin_min                      0.6857
  eda_stress_skin_std                      0.6516
  eda_stress_skin_skew                     0.1990
  eda_stress_skin_kurtosis                 0.1909
  eda_cc_slope                             0.1549
  eda_cc_max                               0.0546
  eda_cc_mean_abs_diff                     0.0400
  eda_stress_skin_slope                    0.0248

PC7
  eda_cc_slope                             0.5320
  eda_stress_skin_skew                     0.5067
  eda_stress_skin_kurtosis                 0.5039
  eda_stress_skin_std                      0.2720
  eda_cc_mean_abs_diff                     0.2254
  eda_cc_max                               0.2152
  eda_stress_skin_min                      0.1779
  eda_cc_skew                              0.0412

PC8
  eda_cc_slope                             0.5610
  eda_cc_max                               0.5412
  eda_stress_skin_kurtosis                 0.4216
  eda_stress_skin_skew                     0.3600
  eda_cc_skew                              0.1830
  eda_cc_kurtosis                          0.1787
  eda_stress_skin_std                      0.1154
  eda_stress_skin_min                      0.0607

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.2946   (cum 0.2946)
   PC2: 0.1964   (cum 0.4910)
   PC3: 0.1809   (cum 0.6719)
   PC4: 0.1399   (cum 0.8118)
   PC5: 0.1000   (cum 0.9118)
   PC6: 0.0340   (cum 0.9458)
   PC7: 0.0223   (cum 0.9682)
   PC8: 0.0132   (cum 0.9814)
   PC9: 0.0125   (cum 0.9938)
  PC10: 0.0062   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_mean_abs_diff                     0.5456
  eda_cc_slope                             0.5152
  eda_cc_max                               0.5145
  eda_stress_skin_std                      0.2124
  eda_stress_skin_min                      0.1918
  eda_cc_skew                              0.1794
  eda_stress_skin_kurtosis                 0.1751
  eda_cc_kurtosis                          0.1565

PC2
  eda_stress_skin_kurtosis                 0.5593
  eda_stress_skin_skew                     0.5225
  eda_stress_skin_min                      0.3833
  eda_stress_skin_std                      0.3821
  eda_cc_max                               0.2211
  eda_cc_slope                             0.1934
  eda_cc_mean_abs_diff                     0.1565
  eda_cc_kurtosis                          0.0741

PC3
  eda_cc_kurtosis                          0.6873
  eda_cc_skew                              0.6783
  eda_cc_slope                             0.1175
  eda_cc_max                               0.1098
  eda_cc_mean_abs_diff                     0.0985
  eda_stress_skin_std                      0.0980
  eda_stress_skin_min                      0.0935
  eda_stress_skin_kurtosis                 0.0924

PC4
  eda_stress_skin_min                      0.5462
  eda_stress_skin_std                      0.5347
  eda_stress_skin_skew                     0.5056
  eda_stress_skin_kurtosis                 0.3613
  eda_cc_max                               0.1474
  eda_cc_mean_abs_diff                     0.0737
  eda_cc_slope                             0.0394
  eda_stress_skin_slope                    0.0244

PC5
  eda_stress_skin_slope                    0.9971
  eda_stress_skin_min                      0.0476
  eda_cc_max                               0.0444
  eda_stress_skin_skew                     0.0301
  eda_stress_skin_kurtosis                 0.0210
  eda_cc_skew                              0.0091
  eda_cc_slope                             0.0090
  eda_cc_kurtosis                          0.0076

PC6
  eda_stress_skin_min                      0.6857
  eda_stress_skin_std                      0.6516
  eda_stress_skin_skew                     0.1990
  eda_stress_skin_kurtosis                 0.1909
  eda_cc_slope                             0.1549
  eda_cc_max                               0.0546
  eda_cc_mean_abs_diff                     0.0400
  eda_stress_skin_slope                    0.0248

PC7
  eda_cc_slope                             0.5320
  eda_stress_skin_skew                     0.5067
  eda_stress_skin_kurtosis                 0.5039
  eda_stress_skin_std                      0.2720
  eda_cc_mean_abs_diff                     0.2254
  eda_cc_max                               0.2152
  eda_stress_skin_min                      0.1779
  eda_cc_skew                              0.0412

PC8
  eda_cc_slope                             0.5610
  eda_cc_max                               0.5412
  eda_stress_skin_kurtosis                 0.4216
  eda_stress_skin_skew                     0.3600
  eda_cc_skew                              0.1830
  eda_cc_kurtosis                          0.1787
  eda_stress_skin_std                      0.1154
  eda_stress_skin_min                      0.0607

Saved to: data/feature_extraction/analysis/quality_eda_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_5.0s.csv
Shape: (599, 28)
Selected feature columns: 21
After NaN/variance filter: (599, 15)
After correlation pruning: (599, 4)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 3

Explained variance per PC (round 1):
   PC1: 0.8076   (cum 0.8076)
   PC2: 0.1669   (cum 0.9745)
   PC3: 0.0168   (cum 0.9912)
   PC4: 0.0088   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5430
  eda_phasic_energy                        0.5180
  eda_scl_max                              0.5113
  eda_scr_rate                             0.4188

PC2
  eda_scr_rate                             0.7978
  eda_scl_max                              0.4216
  eda_phasic_energy                        0.3992
  eda_scl_slope                            0.1626

PC3
  eda_scl_max                              0.7305
  eda_phasic_energy                        0.4570
  eda_scl_slope                            0.4429
  eda_scr_rate                             0.2477

PC4
  eda_scl_slope                            0.6947
  eda_phasic_energy                        0.6029
  eda_scr_rate                             0.3561
  eda_scl_max                              0.1648

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 3

Explained variance per PC (round 2):
   PC1: 0.8076   (cum 0.8076)
   PC2: 0.1669   (cum 0.9745)
   PC3: 0.0168   (cum 0.9912)
   PC4: 0.0088   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5430
  eda_phasic_energy                        0.5180
  eda_scl_max                              0.5113
  eda_scr_rate                             0.4188

PC2
  eda_scr_rate                             0.7978
  eda_scl_max                              0.4216
  eda_phasic_energy                        0.3992
  eda_scl_slope                            0.1626

PC3
  eda_scl_max                              0.7305
  eda_phasic_energy                        0.4570
  eda_scl_slope                            0.4429
  eda_scr_rate                             0.2477

PC4
  eda_scl_slope                            0.6947
  eda_phasic_energy                        0.6029
  eda_scr_rate                             0.3561
  eda_scl_max                              0.1648

Saved to: data/feature_extraction/analysis/quality_eda_advanced_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_features_2.0s.csv
Shape: (1512, 39)
Selected feature columns: 30
After NaN/variance filter: (1512, 29)
After correlation pruning: (1512, 29)

PCA summary (round 1):
  pcs_for_90pct: 15
  pcs_for_95pct: 19
  pcs_for_99pct: 25

Explained variance per PC (round 1):
   PC1: 0.3385   (cum 0.3385)
   PC2: 0.1610   (cum 0.4996)
   PC3: 0.0568   (cum 0.5564)
   PC4: 0.0501   (cum 0.6065)
   PC5: 0.0434   (cum 0.6499)
   PC6: 0.0375   (cum 0.6874)
   PC7: 0.0359   (cum 0.7233)
   PC8: 0.0327   (cum 0.7560)
   PC9: 0.0305   (cum 0.7865)
  PC10: 0.0271   (cum 0.8137)
  PC11: 0.0232   (cum 0.8369)
  PC12: 0.0216   (cum 0.8584)
  PC13: 0.0183   (cum 0.8767)
  PC14: 0.0165   (cum 0.8932)
  PC15: 0.0151   (cum 0.9083)

Top PCA loadings per component (round 1):

PC1
  acc_x_dyn__quantile_0.9                  0.2825
  acc_z_dyn__sum_of_absolute_changes       0.2780
  acc_y_dyn__avg_amplitude_change          0.2689
  acc_x_dyn__max                           0.2652
  acc_y_dyn__quantile_0.3                  0.2624
  acc_x_dyn__quantile_0.3                  0.2600
  acc_z_dyn__harmonic_mean_of_abs          0.2419
  acc_x_dyn__harmonic_mean_of_abs          0.2418

PC2
  acc_x_dyn__katz_fractal_dimension        0.3687
  acc_x_dyn__approximate_entropy_0.9       0.3680
  acc_y_dyn__katz_fractal_dimension        0.3489
  acc_z_dyn__katz_fractal_dimension        0.3387
  acc_z_dyn__sample_entropy                0.3290
  acc_x_dyn__sample_entropy                0.3284
  acc_y_dyn__sample_entropy                0.2997
  acc_x_dyn__approximate_entropy_0.1       0.2386

PC3
  acc_x_dyn__quantile_0.4                  0.4194
  acc_z_dyn__quantile_0.6                  0.3868
  acc_z_dyn__lower_complete_moment         0.3427
  acc_x_dyn__quantile_0.3                  0.3246
  acc_x_dyn__harmonic_mean_of_abs          0.2832
  acc_z_dyn__variance_of_absolute_differences 0.2818
  acc_z_dyn__quantile_0.4                  0.2429
  acc_y_dyn__tsallis_entropy               0.1976

PC4
  acc_y_dyn__tsallis_entropy               0.4525
  acc_y_dyn__sample_entropy                0.3677
  acc_z_dyn__quantile_0.6                  0.3047
  acc_x_dyn__approximate_entropy_0.1       0.2949
  acc_x_dyn__quantile_0.6                  0.2615
  acc_z_dyn__lower_complete_moment         0.2473
  acc_y_dyn__variance_of_absolute_differences 0.2211
  acc_z_dyn__harmonic_mean_of_abs          0.2057

PC5
  acc_z_dyn__approximate_entropy_0.1       0.4441
  acc_y_dyn__quantile_0.4                  0.4316
  acc_z_dyn__katz_fractal_dimension        0.3286
  acc_y_dyn__quantile_0.3                  0.3156
  acc_y_dyn__tsallis_entropy               0.2696
  acc_z_dyn__sample_entropy                0.2010
  acc_x_dyn__harmonic_mean_of_abs          0.1947
  acc_x_dyn__sample_entropy                0.1921

PC6
  acc_x_dyn__cardinality                   0.3920
  acc_x_dyn__approximate_entropy_0.1       0.3624
  acc_x_dyn__approximate_entropy_0.9       0.3145
  acc_x_dyn__sample_entropy                0.2746
  acc_y_dyn__quantile_0.4                  0.2378
  acc_y_dyn__tsallis_entropy               0.2318
  acc_x_dyn__quantile_0.4                  0.2147
  acc_y_dyn__katz_fractal_dimension        0.2129

PC7
  acc_x_dyn__approximate_entropy_0.1       0.3659
  acc_z_dyn__variance_of_absolute_differences 0.3531
  acc_x_dyn__cardinality                   0.3521
  acc_z_dyn__quantile_0.4                  0.3269
  acc_z_dyn__quantile_0.6                  0.3220
  acc_y_dyn__variance_of_absolute_differences 0.3208
  acc_z_dyn__approximate_entropy_0.1       0.2809
  acc_x_dyn__variance_of_absolute_differences 0.2025

PC8
  acc_x_dyn__cardinality                   0.5806
  acc_z_dyn__quantile_0.4                  0.5359
  acc_z_dyn__harmonic_mean_of_abs          0.2606
  acc_z_dyn__quantile_0.6                  0.2088
  acc_y_dyn__variance_of_absolute_differences 0.1898
  acc_z_dyn__sum_of_absolute_changes       0.1672
  acc_y_dyn__quantile_0.4                  0.1644
  acc_y_dyn__avg_amplitude_change          0.1540

Stage 2: PCs used to reach 90%: 15
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 15
  pcs_for_95pct: 19
  pcs_for_99pct: 25

Explained variance per PC (round 2):
   PC1: 0.3385   (cum 0.3385)
   PC2: 0.1610   (cum 0.4996)
   PC3: 0.0568   (cum 0.5564)
   PC4: 0.0501   (cum 0.6065)
   PC5: 0.0434   (cum 0.6499)
   PC6: 0.0375   (cum 0.6874)
   PC7: 0.0359   (cum 0.7233)
   PC8: 0.0327   (cum 0.7560)
   PC9: 0.0305   (cum 0.7865)
  PC10: 0.0271   (cum 0.8137)
  PC11: 0.0232   (cum 0.8369)
  PC12: 0.0216   (cum 0.8584)
  PC13: 0.0183   (cum 0.8767)
  PC14: 0.0165   (cum 0.8932)
  PC15: 0.0151   (cum 0.9083)

Top PCA loadings per component (round 2):

PC1
  acc_x_dyn__quantile_0.9                  0.2825
  acc_z_dyn__sum_of_absolute_changes       0.2780
  acc_y_dyn__avg_amplitude_change          0.2689
  acc_x_dyn__max                           0.2652
  acc_y_dyn__quantile_0.3                  0.2624
  acc_x_dyn__quantile_0.3                  0.2600
  acc_z_dyn__harmonic_mean_of_abs          0.2419
  acc_x_dyn__harmonic_mean_of_abs          0.2418

PC2
  acc_x_dyn__katz_fractal_dimension        0.3687
  acc_x_dyn__approximate_entropy_0.9       0.3680
  acc_y_dyn__katz_fractal_dimension        0.3489
  acc_z_dyn__katz_fractal_dimension        0.3387
  acc_z_dyn__sample_entropy                0.3290
  acc_x_dyn__sample_entropy                0.3284
  acc_y_dyn__sample_entropy                0.2997
  acc_x_dyn__approximate_entropy_0.1       0.2386

PC3
  acc_x_dyn__quantile_0.4                  0.4194
  acc_z_dyn__quantile_0.6                  0.3868
  acc_z_dyn__lower_complete_moment         0.3427
  acc_x_dyn__quantile_0.3                  0.3246
  acc_x_dyn__harmonic_mean_of_abs          0.2832
  acc_z_dyn__variance_of_absolute_differences 0.2818
  acc_z_dyn__quantile_0.4                  0.2429
  acc_y_dyn__tsallis_entropy               0.1976

PC4
  acc_y_dyn__tsallis_entropy               0.4525
  acc_y_dyn__sample_entropy                0.3677
  acc_z_dyn__quantile_0.6                  0.3047
  acc_x_dyn__approximate_entropy_0.1       0.2949
  acc_x_dyn__quantile_0.6                  0.2615
  acc_z_dyn__lower_complete_moment         0.2473
  acc_y_dyn__variance_of_absolute_differences 0.2211
  acc_z_dyn__harmonic_mean_of_abs          0.2057

PC5
  acc_z_dyn__approximate_entropy_0.1       0.4441
  acc_y_dyn__quantile_0.4                  0.4316
  acc_z_dyn__katz_fractal_dimension        0.3286
  acc_y_dyn__quantile_0.3                  0.3156
  acc_y_dyn__tsallis_entropy               0.2696
  acc_z_dyn__sample_entropy                0.2010
  acc_x_dyn__harmonic_mean_of_abs          0.1947
  acc_x_dyn__sample_entropy                0.1921

PC6
  acc_x_dyn__cardinality                   0.3920
  acc_x_dyn__approximate_entropy_0.1       0.3624
  acc_x_dyn__approximate_entropy_0.9       0.3145
  acc_x_dyn__sample_entropy                0.2746
  acc_y_dyn__quantile_0.4                  0.2378
  acc_y_dyn__tsallis_entropy               0.2318
  acc_x_dyn__quantile_0.4                  0.2147
  acc_y_dyn__katz_fractal_dimension        0.2129

PC7
  acc_x_dyn__approximate_entropy_0.1       0.3659
  acc_z_dyn__variance_of_absolute_differences 0.3531
  acc_x_dyn__cardinality                   0.3521
  acc_z_dyn__quantile_0.4                  0.3269
  acc_z_dyn__quantile_0.6                  0.3220
  acc_y_dyn__variance_of_absolute_differences 0.3208
  acc_z_dyn__approximate_entropy_0.1       0.2809
  acc_x_dyn__variance_of_absolute_differences 0.2025

PC8
  acc_x_dyn__cardinality                   0.5806
  acc_z_dyn__quantile_0.4                  0.5359
  acc_z_dyn__harmonic_mean_of_abs          0.2606
  acc_z_dyn__quantile_0.6                  0.2088
  acc_y_dyn__variance_of_absolute_differences 0.1898
  acc_z_dyn__sum_of_absolute_changes       0.1672
  acc_y_dyn__quantile_0.4                  0.1644
  acc_y_dyn__avg_amplitude_change          0.1540

Saved to: data/feature_extraction/analysis/quality_imu_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_features_2.0s.csv | rows=1680 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_features_2.0s.csv
Shape: (1680, 51)
Selected feature columns: 44
After NaN/variance filter: (1680, 43)
After correlation pruning: (1680, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.4307   (cum 0.4307)
   PC2: 0.1394   (cum 0.5701)
   PC3: 0.1042   (cum 0.6743)
   PC4: 0.0643   (cum 0.7386)
   PC5: 0.0570   (cum 0.7956)
   PC6: 0.0488   (cum 0.8444)
   PC7: 0.0404   (cum 0.8848)
   PC8: 0.0324   (cum 0.9172)
   PC9: 0.0270   (cum 0.9442)
  PC10: 0.0184   (cum 0.9626)
  PC11: 0.0119   (cum 0.9745)
  PC12: 0.0074   (cum 0.9819)
  PC13: 0.0066   (cum 0.9884)
  PC14: 0.0047   (cum 0.9931)
  PC15: 0.0040   (cum 0.9971)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p90_p10                        0.3399
  ppg_green_diff_mean_abs                  0.3393
  ppg_green_shape_factor                   0.3161
  ppg_green_tke_mean                       0.3056
  ppg_green_p90                            0.3036
  ppg_green_iqr                            0.2908
  ppg_green_tke_p95_abs                    0.2889
  ppg_green_crest_factor                   0.2789

PC2
  ppg_green_min                            0.5713
  ppg_green_median                         0.5215
  ppg_green_skew                           0.4022
  ppg_green_p90                            0.2939
  ppg_green_crest_factor                   0.2145
  ppg_green_kurtosis                       0.1928
  ppg_green_shape_factor                   0.1585
  ppg_green_mean_cross_rate                0.1148

PC3
  ppg_green_kurtosis                       0.5452
  ppg_green_ddx_kurtosis                   0.4182
  ppg_green_dx_kurtosis                    0.3369
  ppg_green_iqr                            0.2852
  ppg_green_mad                            0.2828
  ppg_green_skew                           0.2767
  ppg_green_crest_factor                   0.2589
  ppg_green_tke_p95_abs                    0.1886

PC4
  ppg_green_diff_mean                      0.6422
  ppg_green_ddx_mean                       0.6215
  ppg_green_mean_cross_rate                0.3218
  ppg_green_ddx_kurtosis                   0.1555
  ppg_green_dx_kurtosis                    0.1402
  ppg_green_mad                            0.1221
  ppg_green_min                            0.1025
  ppg_green_diff_mean_abs                  0.0998

PC5
  ppg_green_mean_cross_rate                0.8364
  ppg_green_diff_mean                      0.3278
  ppg_green_tke_p95_abs                    0.2216
  ppg_green_ddx_mean                       0.1984
  ppg_green_dx_kurtosis                    0.1618
  ppg_green_ddx_kurtosis                   0.1499
  ppg_green_diff_mean_abs                  0.1211
  ppg_green_skew                           0.1058

PC6
  ppg_green_ddx_mean                       0.7259
  ppg_green_diff_mean                      0.6498
  ppg_green_mad                            0.1313
  ppg_green_tke_mean                       0.1065
  ppg_green_kurtosis                       0.0732
  ppg_green_mean_cross_rate                0.0713
  ppg_green_median                         0.0473
  ppg_green_tke_p95_abs                    0.0461

PC7
  ppg_green_ddx_kurtosis                   0.4863
  ppg_green_mad                            0.4009
  ppg_green_iqr                            0.3342
  ppg_green_tke_mean                       0.3129
  ppg_green_crest_factor                   0.2568
  ppg_green_mean_cross_rate                0.2561
  ppg_green_dx_kurtosis                    0.2443
  ppg_green_min                            0.2278

PC8
  ppg_green_skew                           0.7746
  ppg_green_kurtosis                       0.3423
  ppg_green_min                            0.3115
  ppg_green_tke_mean                       0.2379
  ppg_green_median                         0.2073
  ppg_green_shape_factor                   0.1424
  ppg_green_mad                            0.1340
  ppg_green_p90                            0.1312

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.4307   (cum 0.4307)
   PC2: 0.1394   (cum 0.5701)
   PC3: 0.1042   (cum 0.6743)
   PC4: 0.0643   (cum 0.7386)
   PC5: 0.0570   (cum 0.7956)
   PC6: 0.0488   (cum 0.8444)
   PC7: 0.0404   (cum 0.8848)
   PC8: 0.0324   (cum 0.9172)
   PC9: 0.0270   (cum 0.9442)
  PC10: 0.0184   (cum 0.9626)
  PC11: 0.0119   (cum 0.9745)
  PC12: 0.0074   (cum 0.9819)
  PC13: 0.0066   (cum 0.9884)
  PC14: 0.0047   (cum 0.9931)
  PC15: 0.0040   (cum 0.9971)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p90_p10                        0.3399
  ppg_green_diff_mean_abs                  0.3393
  ppg_green_shape_factor                   0.3161
  ppg_green_tke_mean                       0.3056
  ppg_green_p90                            0.3036
  ppg_green_iqr                            0.2908
  ppg_green_tke_p95_abs                    0.2889
  ppg_green_crest_factor                   0.2789

PC2
  ppg_green_min                            0.5713
  ppg_green_median                         0.5215
  ppg_green_skew                           0.4022
  ppg_green_p90                            0.2939
  ppg_green_crest_factor                   0.2145
  ppg_green_kurtosis                       0.1928
  ppg_green_shape_factor                   0.1585
  ppg_green_mean_cross_rate                0.1148

PC3
  ppg_green_kurtosis                       0.5452
  ppg_green_ddx_kurtosis                   0.4182
  ppg_green_dx_kurtosis                    0.3369
  ppg_green_iqr                            0.2852
  ppg_green_mad                            0.2828
  ppg_green_skew                           0.2767
  ppg_green_crest_factor                   0.2589
  ppg_green_tke_p95_abs                    0.1886

PC4
  ppg_green_diff_mean                      0.6422
  ppg_green_ddx_mean                       0.6215
  ppg_green_mean_cross_rate                0.3218
  ppg_green_ddx_kurtosis                   0.1555
  ppg_green_dx_kurtosis                    0.1402
  ppg_green_mad                            0.1221
  ppg_green_min                            0.1025
  ppg_green_diff_mean_abs                  0.0998

PC5
  ppg_green_mean_cross_rate                0.8364
  ppg_green_diff_mean                      0.3278
  ppg_green_tke_p95_abs                    0.2216
  ppg_green_ddx_mean                       0.1984
  ppg_green_dx_kurtosis                    0.1618
  ppg_green_ddx_kurtosis                   0.1499
  ppg_green_diff_mean_abs                  0.1211
  ppg_green_skew                           0.1058

PC6
  ppg_green_ddx_mean                       0.7259
  ppg_green_diff_mean                      0.6498
  ppg_green_mad                            0.1313
  ppg_green_tke_mean                       0.1065
  ppg_green_kurtosis                       0.0732
  ppg_green_mean_cross_rate                0.0713
  ppg_green_median                         0.0473
  ppg_green_tke_p95_abs                    0.0461

PC7
  ppg_green_ddx_kurtosis                   0.4863
  ppg_green_mad                            0.4009
  ppg_green_iqr                            0.3342
  ppg_green_tke_mean                       0.3129
  ppg_green_crest_factor                   0.2568
  ppg_green_mean_cross_rate                0.2561
  ppg_green_dx_kurtosis                    0.2443
  ppg_green_min                            0.2278

PC8
  ppg_green_skew                           0.7746
  ppg_green_kurtosis                       0.3423
  ppg_green_min                            0.3115
  ppg_green_tke_mean                       0.2379
  ppg_green_median                         0.2073
  ppg_green_shape_factor                   0.1424
  ppg_green_mad                            0.1340
  ppg_green_p90                            0.1312

Saved to: data/feature_extraction/analysis/quality_ppg_green_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_2.0s.csv
Shape: (1680, 28)
Selected feature columns: 15
After NaN/variance filter: (1680, 2)
After correlation pruning: (1680, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8203   (cum 0.8203)
   PC2: 0.1797   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8203   (cum 0.8203)
   PC2: 0.1797   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_2.0s.csv | rows=1680 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_features_2.0s.csv
Shape: (1680, 51)
Selected feature columns: 44
After NaN/variance filter: (1680, 44)
After correlation pruning: (1680, 23)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 1):
   PC1: 0.3263   (cum 0.3263)
   PC2: 0.1950   (cum 0.5213)
   PC3: 0.1223   (cum 0.6436)
   PC4: 0.0837   (cum 0.7274)
   PC5: 0.0545   (cum 0.7818)
   PC6: 0.0435   (cum 0.8253)
   PC7: 0.0406   (cum 0.8659)
   PC8: 0.0278   (cum 0.8937)
   PC9: 0.0231   (cum 0.9168)
  PC10: 0.0196   (cum 0.9363)
  PC11: 0.0172   (cum 0.9535)
  PC12: 0.0099   (cum 0.9634)
  PC13: 0.0080   (cum 0.9715)
  PC14: 0.0068   (cum 0.9783)
  PC15: 0.0061   (cum 0.9844)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_ddx_std                        0.3384
  ppg_infra_max                            0.3371
  ppg_infra_min                            0.3295
  ppg_infra_diff_mean_abs                  0.3274
  ppg_infra_p10                            0.3045
  ppg_infra_signal_energy                  0.2968
  ppg_infra_iqr                            0.2850
  ppg_infra_tke_std                        0.2849

PC2
  ppg_infra_impulse_factor                 0.4058
  ppg_infra_shape_factor                   0.3820
  ppg_infra_kurtosis                       0.3788
  ppg_infra_crest_factor                   0.3624
  ppg_infra_clearance_factor               0.3467
  ppg_infra_iqr                            0.2157
  ppg_infra_p10                            0.1920
  ppg_infra_dx_kurtosis                    0.1834

PC3
  ppg_infra_mean                           0.5676
  ppg_infra_trim_mean_10                   0.5525
  ppg_infra_median                         0.4262
  ppg_infra_ddx_mean                       0.4092
  ppg_infra_tke_std                        0.1004
  ppg_infra_iqr                            0.0693
  ppg_infra_diff_mean                      0.0440
  ppg_infra_ddx_std                        0.0366

PC4
  ppg_infra_mean_cross_rate                0.6756
  ppg_infra_zcr                            0.6693
  ppg_infra_ddx_kurtosis                   0.2141
  ppg_infra_dx_kurtosis                    0.1760
  ppg_infra_diff_mean_abs                  0.0960
  ppg_infra_crest_factor                   0.0562
  ppg_infra_ddx_std                        0.0546
  ppg_infra_median                         0.0343

PC5
  ppg_infra_diff_mean                      0.5932
  ppg_infra_skew                           0.5310
  ppg_infra_ddx_mean                       0.3813
  ppg_infra_median                         0.3567
  ppg_infra_clearance_factor               0.1570
  ppg_infra_shape_factor                   0.1177
  ppg_infra_crest_factor                   0.0976
  ppg_infra_tke_std                        0.0865

PC6
  ppg_infra_skew                           0.6775
  ppg_infra_diff_mean                      0.6086
  ppg_infra_ddx_kurtosis                   0.2155
  ppg_infra_dx_kurtosis                    0.1736
  ppg_infra_mean                           0.1612
  ppg_infra_max                            0.1362
  ppg_infra_median                         0.1236
  ppg_infra_ddx_mean                       0.0983

PC7
  ppg_infra_ddx_kurtosis                   0.5971
  ppg_infra_dx_kurtosis                    0.4712
  ppg_infra_clearance_factor               0.2698
  ppg_infra_diff_mean                      0.2545
  ppg_infra_signal_energy                  0.2542
  ppg_infra_tke_std                        0.2413
  ppg_infra_shape_factor                   0.2396
  ppg_infra_mean_cross_rate                0.1833

PC8
  ppg_infra_tke_std                        0.5907
  ppg_infra_p10                            0.3963
  ppg_infra_iqr                            0.3716
  ppg_infra_dx_kurtosis                    0.2625
  ppg_infra_signal_energy                  0.2415
  ppg_infra_clearance_factor               0.2118
  ppg_infra_trim_mean_10                   0.1738
  ppg_infra_diff_mean_abs                  0.1701

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 2):
   PC1: 0.3263   (cum 0.3263)
   PC2: 0.1950   (cum 0.5213)
   PC3: 0.1223   (cum 0.6436)
   PC4: 0.0837   (cum 0.7274)
   PC5: 0.0545   (cum 0.7818)
   PC6: 0.0435   (cum 0.8253)
   PC7: 0.0406   (cum 0.8659)
   PC8: 0.0278   (cum 0.8937)
   PC9: 0.0231   (cum 0.9168)
  PC10: 0.0196   (cum 0.9363)
  PC11: 0.0172   (cum 0.9535)
  PC12: 0.0099   (cum 0.9634)
  PC13: 0.0080   (cum 0.9715)
  PC14: 0.0068   (cum 0.9783)
  PC15: 0.0061   (cum 0.9844)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_ddx_std                        0.3384
  ppg_infra_max                            0.3371
  ppg_infra_min                            0.3295
  ppg_infra_diff_mean_abs                  0.3274
  ppg_infra_p10                            0.3045
  ppg_infra_signal_energy                  0.2968
  ppg_infra_iqr                            0.2850
  ppg_infra_tke_std                        0.2849

PC2
  ppg_infra_impulse_factor                 0.4058
  ppg_infra_shape_factor                   0.3820
  ppg_infra_kurtosis                       0.3788
  ppg_infra_crest_factor                   0.3624
  ppg_infra_clearance_factor               0.3467
  ppg_infra_iqr                            0.2157
  ppg_infra_p10                            0.1920
  ppg_infra_dx_kurtosis                    0.1834

PC3
  ppg_infra_mean                           0.5676
  ppg_infra_trim_mean_10                   0.5525
  ppg_infra_median                         0.4262
  ppg_infra_ddx_mean                       0.4092
  ppg_infra_tke_std                        0.1004
  ppg_infra_iqr                            0.0693
  ppg_infra_diff_mean                      0.0440
  ppg_infra_ddx_std                        0.0366

PC4
  ppg_infra_mean_cross_rate                0.6756
  ppg_infra_zcr                            0.6693
  ppg_infra_ddx_kurtosis                   0.2141
  ppg_infra_dx_kurtosis                    0.1760
  ppg_infra_diff_mean_abs                  0.0960
  ppg_infra_crest_factor                   0.0562
  ppg_infra_ddx_std                        0.0546
  ppg_infra_median                         0.0343

PC5
  ppg_infra_diff_mean                      0.5932
  ppg_infra_skew                           0.5310
  ppg_infra_ddx_mean                       0.3813
  ppg_infra_median                         0.3567
  ppg_infra_clearance_factor               0.1570
  ppg_infra_shape_factor                   0.1177
  ppg_infra_crest_factor                   0.0976
  ppg_infra_tke_std                        0.0865

PC6
  ppg_infra_skew                           0.6775
  ppg_infra_diff_mean                      0.6086
  ppg_infra_ddx_kurtosis                   0.2155
  ppg_infra_dx_kurtosis                    0.1736
  ppg_infra_mean                           0.1612
  ppg_infra_max                            0.1362
  ppg_infra_median                         0.1236
  ppg_infra_ddx_mean                       0.0983

PC7
  ppg_infra_ddx_kurtosis                   0.5971
  ppg_infra_dx_kurtosis                    0.4712
  ppg_infra_clearance_factor               0.2698
  ppg_infra_diff_mean                      0.2545
  ppg_infra_signal_energy                  0.2542
  ppg_infra_tke_std                        0.2413
  ppg_infra_shape_factor                   0.2396
  ppg_infra_mean_cross_rate                0.1833

PC8
  ppg_infra_tke_std                        0.5907
  ppg_infra_p10                            0.3963
  ppg_infra_iqr                            0.3716
  ppg_infra_dx_kurtosis                    0.2625
  ppg_infra_signal_energy                  0.2415
  ppg_infra_clearance_factor               0.2118
  ppg_infra_trim_mean_10                   0.1738
  ppg_infra_diff_mean_abs                  0.1701

Saved to: data/feature_extraction/analysis/quality_ppg_infra_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_2.0s.csv
Shape: (1680, 28)
Selected feature columns: 15
After NaN/variance filter: (1680, 2)
After correlation pruning: (1680, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7887   (cum 0.7887)
   PC2: 0.2113   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7887   (cum 0.7887)
   PC2: 0.2113   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_2.0s.csv | rows=1680 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_features_2.0s.csv
Shape: (1680, 51)
Selected feature columns: 44
After NaN/variance filter: (1680, 44)
After correlation pruning: (1680, 23)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3160   (cum 0.3160)
   PC2: 0.1999   (cum 0.5159)
   PC3: 0.1129   (cum 0.6288)
   PC4: 0.0832   (cum 0.7119)
   PC5: 0.0540   (cum 0.7659)
   PC6: 0.0464   (cum 0.8123)
   PC7: 0.0423   (cum 0.8546)
   PC8: 0.0345   (cum 0.8891)
   PC9: 0.0270   (cum 0.9161)
  PC10: 0.0195   (cum 0.9355)
  PC11: 0.0168   (cum 0.9523)
  PC12: 0.0108   (cum 0.9631)
  PC13: 0.0088   (cum 0.9719)
  PC14: 0.0079   (cum 0.9798)
  PC15: 0.0064   (cum 0.9863)

Top PCA loadings per component (round 1):

PC1
  ppg_red_p99                              0.3488
  ppg_red_p5                               0.3370
  ppg_red_tke_p95_abs                      0.3353
  ppg_red_ddx_std                          0.3311
  ppg_red_p90                              0.3199
  ppg_red_p10                              0.3150
  ppg_red_iqr                              0.2999
  ppg_red_tke_std                          0.2235

PC2
  ppg_red_impulse_factor                   0.4133
  ppg_red_kurtosis                         0.3957
  ppg_red_shape_factor                     0.3871
  ppg_red_crest_factor                     0.3707
  ppg_red_clearance_factor                 0.3379
  ppg_red_dx_kurtosis                      0.2278
  ppg_red_ddx_kurtosis                     0.1927
  ppg_red_iqr                              0.1859

PC3
  ppg_red_mean                             0.5495
  ppg_red_trim_mean_10                     0.5359
  ppg_red_median                           0.4129
  ppg_red_ddx_mean                         0.3428
  ppg_red_p10                              0.1890
  ppg_red_tke_std                          0.1484
  ppg_red_iqr                              0.1466
  ppg_red_tke_p95_abs                      0.1327

PC4
  ppg_red_mean_cross_rate                  0.6601
  ppg_red_zcr                              0.6544
  ppg_red_ddx_kurtosis                     0.2584
  ppg_red_dx_kurtosis                      0.2183
  ppg_red_ddx_std                          0.0775
  ppg_red_tke_p95_abs                      0.0758
  ppg_red_iqr                              0.0499
  ppg_red_crest_factor                     0.0400

PC5
  ppg_red_skew                             0.7022
  ppg_red_ddx_mean                         0.4111
  ppg_red_median                           0.3597
  ppg_red_dx_mean                          0.2576
  ppg_red_tke_std                          0.1883
  ppg_red_p90                              0.1709
  ppg_red_mean                             0.1399
  ppg_red_p99                              0.1382

PC6
  ppg_red_dx_mean                          0.4932
  ppg_red_ddx_kurtosis                     0.4752
  ppg_red_dx_kurtosis                      0.4295
  ppg_red_skew                             0.3221
  ppg_red_clearance_factor                 0.2308
  ppg_red_ddx_mean                         0.2280
  ppg_red_tke_std                          0.1845
  ppg_red_mean_cross_rate                  0.1675

PC7
  ppg_red_dx_mean                          0.7614
  ppg_red_tke_std                          0.3413
  ppg_red_ddx_kurtosis                     0.2853
  ppg_red_dx_kurtosis                      0.2428
  ppg_red_mean                             0.1923
  ppg_red_ddx_std                          0.1629
  ppg_red_mean_cross_rate                  0.1432
  ppg_red_clearance_factor                 0.1420

PC8
  ppg_red_tke_std                          0.5412
  ppg_red_skew                             0.3916
  ppg_red_dx_kurtosis                      0.3420
  ppg_red_ddx_mean                         0.3049
  ppg_red_ddx_std                          0.2683
  ppg_red_clearance_factor                 0.2258
  ppg_red_p10                              0.2171
  ppg_red_iqr                              0.2035

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3160   (cum 0.3160)
   PC2: 0.1999   (cum 0.5159)
   PC3: 0.1129   (cum 0.6288)
   PC4: 0.0832   (cum 0.7119)
   PC5: 0.0540   (cum 0.7659)
   PC6: 0.0464   (cum 0.8123)
   PC7: 0.0423   (cum 0.8546)
   PC8: 0.0345   (cum 0.8891)
   PC9: 0.0270   (cum 0.9161)
  PC10: 0.0195   (cum 0.9355)
  PC11: 0.0168   (cum 0.9523)
  PC12: 0.0108   (cum 0.9631)
  PC13: 0.0088   (cum 0.9719)
  PC14: 0.0079   (cum 0.9798)
  PC15: 0.0064   (cum 0.9863)

Top PCA loadings per component (round 2):

PC1
  ppg_red_p99                              0.3488
  ppg_red_p5                               0.3370
  ppg_red_tke_p95_abs                      0.3353
  ppg_red_ddx_std                          0.3311
  ppg_red_p90                              0.3199
  ppg_red_p10                              0.3150
  ppg_red_iqr                              0.2999
  ppg_red_tke_std                          0.2235

PC2
  ppg_red_impulse_factor                   0.4133
  ppg_red_kurtosis                         0.3957
  ppg_red_shape_factor                     0.3871
  ppg_red_crest_factor                     0.3707
  ppg_red_clearance_factor                 0.3379
  ppg_red_dx_kurtosis                      0.2278
  ppg_red_ddx_kurtosis                     0.1927
  ppg_red_iqr                              0.1859

PC3
  ppg_red_mean                             0.5495
  ppg_red_trim_mean_10                     0.5359
  ppg_red_median                           0.4129
  ppg_red_ddx_mean                         0.3428
  ppg_red_p10                              0.1890
  ppg_red_tke_std                          0.1484
  ppg_red_iqr                              0.1466
  ppg_red_tke_p95_abs                      0.1327

PC4
  ppg_red_mean_cross_rate                  0.6601
  ppg_red_zcr                              0.6544
  ppg_red_ddx_kurtosis                     0.2584
  ppg_red_dx_kurtosis                      0.2183
  ppg_red_ddx_std                          0.0775
  ppg_red_tke_p95_abs                      0.0758
  ppg_red_iqr                              0.0499
  ppg_red_crest_factor                     0.0400

PC5
  ppg_red_skew                             0.7022
  ppg_red_ddx_mean                         0.4111
  ppg_red_median                           0.3597
  ppg_red_dx_mean                          0.2576
  ppg_red_tke_std                          0.1883
  ppg_red_p90                              0.1709
  ppg_red_mean                             0.1399
  ppg_red_p99                              0.1382

PC6
  ppg_red_dx_mean                          0.4932
  ppg_red_ddx_kurtosis                     0.4752
  ppg_red_dx_kurtosis                      0.4295
  ppg_red_skew                             0.3221
  ppg_red_clearance_factor                 0.2308
  ppg_red_ddx_mean                         0.2280
  ppg_red_tke_std                          0.1845
  ppg_red_mean_cross_rate                  0.1675

PC7
  ppg_red_dx_mean                          0.7614
  ppg_red_tke_std                          0.3413
  ppg_red_ddx_kurtosis                     0.2853
  ppg_red_dx_kurtosis                      0.2428
  ppg_red_mean                             0.1923
  ppg_red_ddx_std                          0.1629
  ppg_red_mean_cross_rate                  0.1432
  ppg_red_clearance_factor                 0.1420

PC8
  ppg_red_tke_std                          0.5412
  ppg_red_skew                             0.3916
  ppg_red_dx_kurtosis                      0.3420
  ppg_red_ddx_mean                         0.3049
  ppg_red_ddx_std                          0.2683
  ppg_red_clearance_factor                 0.2258
  ppg_red_p10                              0.2171
  ppg_red_iqr                              0.2035

Saved to: data/feature_extraction/analysis/quality_ppg_red_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_2.0s.csv
Shape: (1680, 28)
Selected feature columns: 15
After NaN/variance filter: (1680, 2)
After correlation pruning: (1680, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7957   (cum 0.7957)
   PC2: 0.2043   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7957   (cum 0.7957)
   PC2: 0.2043   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_2.0s.csv | rows=1489 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_features_2.0s.csv
Shape: (1489, 33)
Selected feature columns: 26
After NaN/variance filter: (1489, 26)
After correlation pruning: (1489, 10)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.3075   (cum 0.3075)
   PC2: 0.1915   (cum 0.4990)
   PC3: 0.1806   (cum 0.6797)
   PC4: 0.1277   (cum 0.8073)
   PC5: 0.0999   (cum 0.9073)
   PC6: 0.0386   (cum 0.9459)
   PC7: 0.0286   (cum 0.9745)
   PC8: 0.0131   (cum 0.9876)
   PC9: 0.0068   (cum 0.9944)
  PC10: 0.0056   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_mean_abs_diff                     0.5257
  eda_cc_max                               0.4880
  eda_cc_slope                             0.4855
  eda_stress_skin_kurtosis                 0.3223
  eda_stress_skin_mad                      0.2384
  eda_stress_skin_min                      0.2143
  eda_cc_skew                              0.1235
  eda_cc_kurtosis                          0.1196

PC2
  eda_cc_kurtosis                          0.6472
  eda_cc_skew                              0.6422
  eda_cc_max                               0.1990
  eda_cc_slope                             0.1875
  eda_cc_mean_abs_diff                     0.1598
  eda_stress_skin_kurtosis                 0.1390
  eda_stress_skin_skew                     0.1339
  eda_stress_skin_mad                      0.1249

PC3
  eda_stress_skin_min                      0.4843
  eda_stress_skin_mad                      0.4821
  eda_stress_skin_kurtosis                 0.3930
  eda_stress_skin_skew                     0.3217
  eda_cc_skew                              0.2652
  eda_cc_max                               0.2554
  eda_cc_kurtosis                          0.2554
  eda_cc_slope                             0.2078

PC4
  eda_stress_skin_skew                     0.6950
  eda_stress_skin_min                      0.4190
  eda_stress_skin_mad                      0.4116
  eda_stress_skin_kurtosis                 0.3982
  eda_stress_skin_slope                    0.0749
  eda_cc_slope                             0.0566
  eda_cc_max                               0.0400
  eda_cc_kurtosis                          0.0384

PC5
  eda_stress_skin_slope                    0.9946
  eda_stress_skin_skew                     0.0688
  eda_stress_skin_min                      0.0621
  eda_cc_max                               0.0442
  eda_cc_slope                             0.0117
  eda_cc_skew                              0.0111
  eda_cc_kurtosis                          0.0042
  eda_stress_skin_mad                      0.0039

PC6
  eda_stress_skin_min                      0.5380
  eda_stress_skin_kurtosis                 0.5154
  eda_stress_skin_skew                     0.4539
  eda_stress_skin_mad                      0.3357
  eda_cc_slope                             0.3332
  eda_cc_mean_abs_diff                     0.1018
  eda_cc_max                               0.0663
  eda_cc_kurtosis                          0.0164

PC7
  eda_stress_skin_mad                      0.6297
  eda_stress_skin_min                      0.4780
  eda_stress_skin_kurtosis                 0.3915
  eda_stress_skin_skew                     0.3325
  eda_cc_slope                             0.2934
  eda_cc_mean_abs_diff                     0.1359
  eda_cc_max                               0.0624
  eda_stress_skin_slope                    0.0488

PC8
  eda_cc_max                               0.6452
  eda_cc_slope                             0.6423
  eda_stress_skin_kurtosis                 0.3169
  eda_stress_skin_skew                     0.2151
  eda_stress_skin_mad                      0.1243
  eda_stress_skin_min                      0.0790
  eda_cc_mean_abs_diff                     0.0509
  eda_stress_skin_slope                    0.0120

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.3075   (cum 0.3075)
   PC2: 0.1915   (cum 0.4990)
   PC3: 0.1806   (cum 0.6797)
   PC4: 0.1277   (cum 0.8073)
   PC5: 0.0999   (cum 0.9073)
   PC6: 0.0386   (cum 0.9459)
   PC7: 0.0286   (cum 0.9745)
   PC8: 0.0131   (cum 0.9876)
   PC9: 0.0068   (cum 0.9944)
  PC10: 0.0056   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_mean_abs_diff                     0.5257
  eda_cc_max                               0.4880
  eda_cc_slope                             0.4855
  eda_stress_skin_kurtosis                 0.3223
  eda_stress_skin_mad                      0.2384
  eda_stress_skin_min                      0.2143
  eda_cc_skew                              0.1235
  eda_cc_kurtosis                          0.1196

PC2
  eda_cc_kurtosis                          0.6472
  eda_cc_skew                              0.6422
  eda_cc_max                               0.1990
  eda_cc_slope                             0.1875
  eda_cc_mean_abs_diff                     0.1598
  eda_stress_skin_kurtosis                 0.1390
  eda_stress_skin_skew                     0.1339
  eda_stress_skin_mad                      0.1249

PC3
  eda_stress_skin_min                      0.4843
  eda_stress_skin_mad                      0.4821
  eda_stress_skin_kurtosis                 0.3930
  eda_stress_skin_skew                     0.3217
  eda_cc_skew                              0.2652
  eda_cc_max                               0.2554
  eda_cc_kurtosis                          0.2554
  eda_cc_slope                             0.2078

PC4
  eda_stress_skin_skew                     0.6950
  eda_stress_skin_min                      0.4190
  eda_stress_skin_mad                      0.4116
  eda_stress_skin_kurtosis                 0.3982
  eda_stress_skin_slope                    0.0749
  eda_cc_slope                             0.0566
  eda_cc_max                               0.0400
  eda_cc_kurtosis                          0.0384

PC5
  eda_stress_skin_slope                    0.9946
  eda_stress_skin_skew                     0.0688
  eda_stress_skin_min                      0.0621
  eda_cc_max                               0.0442
  eda_cc_slope                             0.0117
  eda_cc_skew                              0.0111
  eda_cc_kurtosis                          0.0042
  eda_stress_skin_mad                      0.0039

PC6
  eda_stress_skin_min                      0.5380
  eda_stress_skin_kurtosis                 0.5154
  eda_stress_skin_skew                     0.4539
  eda_stress_skin_mad                      0.3357
  eda_cc_slope                             0.3332
  eda_cc_mean_abs_diff                     0.1018
  eda_cc_max                               0.0663
  eda_cc_kurtosis                          0.0164

PC7
  eda_stress_skin_mad                      0.6297
  eda_stress_skin_min                      0.4780
  eda_stress_skin_kurtosis                 0.3915
  eda_stress_skin_skew                     0.3325
  eda_cc_slope                             0.2934
  eda_cc_mean_abs_diff                     0.1359
  eda_cc_max                               0.0624
  eda_stress_skin_slope                    0.0488

PC8
  eda_cc_max                               0.6452
  eda_cc_slope                             0.6423
  eda_stress_skin_kurtosis                 0.3169
  eda_stress_skin_skew                     0.2151
  eda_stress_skin_mad                      0.1243
  eda_stress_skin_min                      0.0790
  eda_cc_mean_abs_diff                     0.0509
  eda_stress_skin_slope                    0.0120

Saved to: data/feature_extraction/analysis/quality_eda_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_2.0s.csv
Shape: (1489, 28)
Selected feature columns: 21
After NaN/variance filter: (1489, 15)
After correlation pruning: (1489, 4)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 3

Explained variance per PC (round 1):
   PC1: 0.8087   (cum 0.8087)
   PC2: 0.1655   (cum 0.9742)
   PC3: 0.0168   (cum 0.9910)
   PC4: 0.0090   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5423
  eda_phasic_energy                        0.5177
  eda_scl_max                              0.5110
  eda_scr_count                            0.4204

PC2
  eda_scr_count                            0.7959
  eda_scl_max                              0.4234
  eda_phasic_energy                        0.4003
  eda_scl_slope                            0.1641

PC3
  eda_scl_max                              0.7274
  eda_phasic_energy                        0.4511
  eda_scl_slope                            0.4510
  eda_scr_count                            0.2531

PC4
  eda_scl_slope                            0.6896
  eda_phasic_energy                        0.6068
  eda_scr_count                            0.3545
  eda_scl_max                              0.1746

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 3

Explained variance per PC (round 2):
   PC1: 0.8087   (cum 0.8087)
   PC2: 0.1655   (cum 0.9742)
   PC3: 0.0168   (cum 0.9910)
   PC4: 0.0090   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5423
  eda_phasic_energy                        0.5177
  eda_scl_max                              0.5110
  eda_scr_count                            0.4204

PC2
  eda_scr_count                            0.7959
  eda_scl_max                              0.4234
  eda_phasic_energy                        0.4003
  eda_scl_slope                            0.1641

PC3
  eda_scl_max                              0.7274
  eda_phasic_energy                        0.4511
  eda_scl_slope                            0.4510
  eda_scr_count                            0.2531

PC4
  eda_scl_slope                            0.6896
  eda_phasic_energy                        0.6068
  eda_scr_count                            0.3545
  eda_scl_max                              0.1746

Saved to: data/feature_extraction/analysis/quality_eda_advanced_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_aligned_5.0s.csv (676 windows | borg labeled: 294)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_5.0s.csv | windows=599 | features=21
    ✓ Advanced EDA features: 599 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 599
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_aligned_5.0s.csv (599 windows | borg labeled: 293)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 599
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_aligned_5.0s.csv (599 windows | borg labeled: 293)

▶ Window length: 2.0s | overlap=0.1
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1512
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/imu_wrist/imu_aligned_2.0s.csv (1512 windows | borg labeled: 726)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_features_2.0s.csv | windows=1680 | features=21
    ✓ HRV features: 1680 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_green/ppg_green_hrv_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_features_2.0s.csv | windows=1680 | features=21
    ✓ HRV features: 1680 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_infra/ppg_infra_hrv_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_features_2.0s.csv | windows=1680 | features=21
    ✓ HRV features: 1680 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1680
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/ppg_red/ppg_red_hrv_aligned_2.0s.csv (1680 windows | borg labeled: 729)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_features_2.0s.csv | windows=1489 | features=21
    ✓ Advanced EDA features: 1489 windows
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1489
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_aligned_2.0s.csv (1489 windows | borg labeled: 731)
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1489
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/eda/eda_advanced_aligned_2.0s.csv (1489 windows | borg labeled: 731)

▶ Fusion step
  Running fusion...

▶ Fusing features for window length: 10.0s
  Loaded eda: 299 windows | t_center min=1762407723.000 max=1762410405.000 n=299
  Loaded eda_advanced: 299 windows | t_center min=1762407723.000 max=1762410405.000 n=299
  Loaded imu_bioz: 313 windows | t_center min=1762407395.000 max=1762410203.000 n=313
  Loaded imu_wrist: 304 windows | t_center min=1762407671.000 max=1762410398.000 n=304
  Loaded ppg_green: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Loaded ppg_green_hrv: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Loaded ppg_infra: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Loaded ppg_infra_hrv: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Loaded ppg_red: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Loaded ppg_red_hrv: 338 windows | t_center min=1762407364.000 max=1762410397.000 n=338
  Dropped 12 invalid feature columns
  ✓ Wrote 0 fused windows → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_features_10.0s.csv

▶ Fusing features for window length: 5.0s
  Loaded eda: 599 windows | t_center min=1762407720.500 max=1762410411.500 n=599
  Loaded eda_advanced: 599 windows | t_center min=1762407720.500 max=1762410411.500 n=599
  Loaded imu_bioz: 627 windows | t_center min=1762407392.500 max=1762410209.500 n=627
  Loaded imu_wrist: 609 windows | t_center min=1762407668.500 max=1762410404.500 n=609
  Loaded ppg_green: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Loaded ppg_green_hrv: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Loaded ppg_infra: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Loaded ppg_infra_hrv: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Loaded ppg_red: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Loaded ppg_red_hrv: 676 windows | t_center min=1762407361.500 max=1762410399.000 n=676
  Dropped 30 invalid feature columns
  ✓ Wrote 554 fused windows → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_features_5.0s.csv

▶ Fusing features for window length: 2.0s
  Loaded eda: 1489 windows | t_center min=1762407719.000 max=1762410416.000 n=1489
  Loaded eda_advanced: 1489 windows | t_center min=1762407719.000 max=1762410416.000 n=1489
  Loaded imu_bioz: 1559 windows | t_center min=1762407391.000 max=1762410214.875 n=1559
  Loaded imu_wrist: 1512 windows | t_center min=1762407667.000 max=1762410405.688 n=1512
  Loaded ppg_green: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
  Loaded ppg_green_hrv: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
  Loaded ppg_infra: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
  Loaded ppg_infra_hrv: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
  Loaded ppg_red: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
  Loaded ppg_red_hrv: 1680 windows | t_center min=1762407360.000 max=1762410403.188 n=1680
  Dropped 69 invalid feature columns
  ✓ Wrote 1379 fused windows → /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_features_2.0s.csv
  ✓ Fusion complete

▶ Aligning fused features with Borg effort labels
  Aligning fused features (10.0s windows)...
  ⚠ No data in features file (0 rows), skipping alignment
  Aligning fused features (5.0s windows)...
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 627
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_aligned_5.0s.csv (439 windows | borg labeled: 293)
  Aligning fused features (2.0s windows)...
  ADL recording time: 1762408033.0 to 1762410010.2
  Windows before filtering: 1559
  Windows in ADL time range: 1091
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_aligned_2.0s.csv (1091 windows | borg labeled: 729)

▶ Feature selection with correlation pruning + quality checks
  Running feature selection (5.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (5.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_aligned_5.0s.csv
  ✓ Loaded 293 labeled samples
  ✓ 254 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 234, Test: 59

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 10, IMU: 17, PPG: 73

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 2, IMU: 16, PPG: 18
  ✓ Total: 36 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 15, 'pcs_for_95pct': 20, 'pcs_for_99pct': 29}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/feature_selection_qc/qc_5.0s/features_filtered_5.0s.csv
    → 36 features + 2 metadata columns
    → 293 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_5.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (5.0s)
  Running feature selection (2.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (2.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_aligned_2.0s.csv
  ✓ Loaded 729 labeled samples
  ✓ 215 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 583, Test: 146

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 10, IMU: 15, PPG: 75

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 2, IMU: 15, PPG: 16
  ✓ Total: 33 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 16, 'pcs_for_95pct': 21, 'pcs_for_99pct': 28}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/feature_selection_qc/qc_2.0s/features_filtered_2.0s.csv
    → 33 features + 2 metadata columns
    → 729 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_2.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (2.0s)
[manual_features_imu] processed 200/891 windows
[manual_features_imu] processed 400/891 windows
[manual_features_imu] processed 600/891 windows
[manual_features_imu] processed 800/891 windows
[manual_features_imu] processed 200/1783 windows
[manual_features_imu] processed 400/1783 windows
[manual_features_imu] processed 600/1783 windows
[manual_features_imu] processed 800/1783 windows
[manual_features_imu] processed 1000/1783 windows
[manual_features_imu] processed 1200/1783 windows
[manual_features_imu] processed 1400/1783 windows
[manual_features_imu] processed 1600/1783 windows
[manual_features_imu] processed 200/4428 windows
[manual_features_imu] processed 400/4428 windows
[manual_features_imu] processed 600/4428 windows
[manual_features_imu] processed 800/4428 windows
[manual_features_imu] processed 1000/4428 windows
[manual_features_imu] processed 1200/4428 windows
[manual_features_imu] processed 1400/4428 windows
[manual_features_imu] processed 1600/4428 windows
[manual_features_imu] processed 1800/4428 windows
[manual_features_imu] processed 2000/4428 windows
[manual_features_imu] processed 2200/4428 windows
[manual_features_imu] processed 2400/4428 windows
[manual_features_imu] processed 2600/4428 windows
[manual_features_imu] processed 2800/4428 windows
[manual_features_imu] processed 3000/4428 windows
[manual_features_imu] processed 3200/4428 windows
[manual_features_imu] processed 3400/4428 windows
[manual_features_imu] processed 3600/4428 windows
[manual_features_imu] processed 3800/4428 windows
[manual_features_imu] processed 4000/4428 windows
[manual_features_imu] processed 4200/4428 windows
[manual_features_imu] processed 4400/4428 windows
[manual_features_imu] processed 200/383 windows
[manual_features_imu] processed 200/766 windows
[manual_features_imu] processed 400/766 windows
[manual_features_imu] processed 600/766 windows
[manual_features_imu] processed 200/1902 windows
[manual_features_imu] processed 400/1902 windows
[manual_features_imu] processed 600/1902 windows
[manual_features_imu] processed 800/1902 windows
[manual_features_imu] processed 1000/1902 windows
[manual_features_imu] processed 1200/1902 windows
[manual_features_imu] processed 1400/1902 windows
[manual_features_imu] processed 1600/1902 windows
[manual_features_imu] processed 1800/1902 windows
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_features_10.0s.csv
Shape: (383, 39)
Selected feature columns: 30
After NaN/variance filter: (383, 29)
After correlation pruning: (383, 29)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 1):
   PC1: 0.5166   (cum 0.5166)
   PC2: 0.1869   (cum 0.7035)
   PC3: 0.0590   (cum 0.7625)
   PC4: 0.0437   (cum 0.8063)
   PC5: 0.0329   (cum 0.8392)
   PC6: 0.0261   (cum 0.8653)
   PC7: 0.0210   (cum 0.8862)
   PC8: 0.0166   (cum 0.9028)
   PC9: 0.0135   (cum 0.9163)
  PC10: 0.0111   (cum 0.9274)
  PC11: 0.0096   (cum 0.9370)
  PC12: 0.0090   (cum 0.9460)
  PC13: 0.0081   (cum 0.9541)
  PC14: 0.0071   (cum 0.9612)
  PC15: 0.0067   (cum 0.9679)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2323
  acc_y_dyn__avg_amplitude_change          0.2273
  acc_x_dyn__quantile_0.3                  0.2220
  acc_x_dyn__quantile_0.9                  0.2207
  acc_y_dyn__quantile_0.3                  0.2192
  acc_z_dyn__quantile_0.4                  0.2126
  acc_z_dyn__quantile_0.6                  0.2121
  acc_x_dyn__quantile_0.4                  0.2092

PC2
  acc_y_dyn__sample_entropy                0.3156
  acc_x_dyn__sample_entropy                0.3008
  acc_z_dyn__sample_entropy                0.2936
  acc_z_dyn__approximate_entropy_0.1       0.2769
  acc_y_dyn__katz_fractal_dimension        0.2721
  acc_x_dyn__approximate_entropy_0.1       0.2695
  acc_x_dyn__approximate_entropy_0.9       0.2526
  acc_x_dyn__katz_fractal_dimension        0.2458

PC3
  acc_y_dyn__tsallis_entropy               0.5092
  acc_x_dyn__cardinality                   0.3781
  acc_x_dyn__max                           0.2899
  acc_x_dyn__variance_of_absolute_differences 0.2697
  acc_y_dyn__harmonic_mean_of_abs          0.2477
  acc_z_dyn__variance_of_absolute_differences 0.2426
  acc_x_dyn__harmonic_mean_of_abs          0.2409
  acc_x_dyn__quantile_0.6                  0.2146

PC4
  acc_y_dyn__quantile_0.4                  0.3951
  acc_y_dyn__tsallis_entropy               0.3315
  acc_x_dyn__harmonic_mean_of_abs          0.3184
  acc_x_dyn__cardinality                   0.3118
  acc_x_dyn__quantile_0.6                  0.2688
  acc_x_dyn__quantile_0.3                  0.2478
  acc_x_dyn__max                           0.2191
  acc_z_dyn__quantile_0.6                  0.2181

PC5
  acc_y_dyn__harmonic_mean_of_abs          0.3826
  acc_z_dyn__lower_complete_moment         0.3686
  acc_y_dyn__avg_amplitude_change          0.3041
  acc_z_dyn__variance_of_absolute_differences 0.2726
  acc_y_dyn__variance_of_absolute_differences 0.2680
  acc_z_dyn__katz_fractal_dimension        0.2562
  acc_y_dyn__quantile_0.3                  0.2533
  acc_x_dyn__approximate_entropy_0.1       0.2366

PC6
  acc_x_dyn__variance_of_absolute_differences 0.5072
  acc_y_dyn__tsallis_entropy               0.4362
  acc_x_dyn__cardinality                   0.2632
  acc_z_dyn__harmonic_mean_of_abs          0.2579
  acc_z_dyn__quantile_0.6                  0.2468
  acc_z_dyn__quantile_0.4                  0.2468
  acc_x_dyn__max                           0.2257
  acc_x_dyn__quantile_0.9                  0.2038

PC7
  acc_y_dyn__variance_of_absolute_differences 0.4490
  acc_z_dyn__harmonic_mean_of_abs          0.4433
  acc_z_dyn__lower_complete_moment         0.3329
  acc_z_dyn__variance_of_absolute_differences 0.3108
  acc_z_dyn__quantile_0.4                  0.2842
  acc_x_dyn__sample_entropy                0.2043
  acc_y_dyn__harmonic_mean_of_abs          0.1908
  acc_x_dyn__quantile_0.4                  0.1841

PC8
  acc_y_dyn__quantile_0.4                  0.3881
  acc_y_dyn__variance_of_absolute_differences 0.3373
  acc_x_dyn__katz_fractal_dimension        0.3286
  acc_z_dyn__lower_complete_moment         0.3185
  acc_x_dyn__approximate_entropy_0.1       0.3183
  acc_z_dyn__approximate_entropy_0.1       0.3151
  acc_y_dyn__katz_fractal_dimension        0.2871
  acc_x_dyn__max                           0.2396

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 2):
   PC1: 0.5166   (cum 0.5166)
   PC2: 0.1869   (cum 0.7035)
   PC3: 0.0590   (cum 0.7625)
   PC4: 0.0437   (cum 0.8063)
   PC5: 0.0329   (cum 0.8392)
   PC6: 0.0261   (cum 0.8653)
   PC7: 0.0210   (cum 0.8862)
   PC8: 0.0166   (cum 0.9028)
   PC9: 0.0135   (cum 0.9163)
  PC10: 0.0111   (cum 0.9274)
  PC11: 0.0096   (cum 0.9370)
  PC12: 0.0090   (cum 0.9460)
  PC13: 0.0081   (cum 0.9541)
  PC14: 0.0071   (cum 0.9612)
  PC15: 0.0067   (cum 0.9679)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2323
  acc_y_dyn__avg_amplitude_change          0.2273
  acc_x_dyn__quantile_0.3                  0.2220
  acc_x_dyn__quantile_0.9                  0.2207
  acc_y_dyn__quantile_0.3                  0.2192
  acc_z_dyn__quantile_0.4                  0.2126
  acc_z_dyn__quantile_0.6                  0.2121
  acc_x_dyn__quantile_0.4                  0.2092

PC2
  acc_y_dyn__sample_entropy                0.3156
  acc_x_dyn__sample_entropy                0.3008
  acc_z_dyn__sample_entropy                0.2936
  acc_z_dyn__approximate_entropy_0.1       0.2769
  acc_y_dyn__katz_fractal_dimension        0.2721
  acc_x_dyn__approximate_entropy_0.1       0.2695
  acc_x_dyn__approximate_entropy_0.9       0.2526
  acc_x_dyn__katz_fractal_dimension        0.2458

PC3
  acc_y_dyn__tsallis_entropy               0.5092
  acc_x_dyn__cardinality                   0.3781
  acc_x_dyn__max                           0.2899
  acc_x_dyn__variance_of_absolute_differences 0.2697
  acc_y_dyn__harmonic_mean_of_abs          0.2477
  acc_z_dyn__variance_of_absolute_differences 0.2426
  acc_x_dyn__harmonic_mean_of_abs          0.2409
  acc_x_dyn__quantile_0.6                  0.2146

PC4
  acc_y_dyn__quantile_0.4                  0.3951
  acc_y_dyn__tsallis_entropy               0.3315
  acc_x_dyn__harmonic_mean_of_abs          0.3184
  acc_x_dyn__cardinality                   0.3118
  acc_x_dyn__quantile_0.6                  0.2688
  acc_x_dyn__quantile_0.3                  0.2478
  acc_x_dyn__max                           0.2191
  acc_z_dyn__quantile_0.6                  0.2181

PC5
  acc_y_dyn__harmonic_mean_of_abs          0.3826
  acc_z_dyn__lower_complete_moment         0.3686
  acc_y_dyn__avg_amplitude_change          0.3041
  acc_z_dyn__variance_of_absolute_differences 0.2726
  acc_y_dyn__variance_of_absolute_differences 0.2680
  acc_z_dyn__katz_fractal_dimension        0.2562
  acc_y_dyn__quantile_0.3                  0.2533
  acc_x_dyn__approximate_entropy_0.1       0.2366

PC6
  acc_x_dyn__variance_of_absolute_differences 0.5072
  acc_y_dyn__tsallis_entropy               0.4362
  acc_x_dyn__cardinality                   0.2632
  acc_z_dyn__harmonic_mean_of_abs          0.2579
  acc_z_dyn__quantile_0.6                  0.2468
  acc_z_dyn__quantile_0.4                  0.2468
  acc_x_dyn__max                           0.2257
  acc_x_dyn__quantile_0.9                  0.2038

PC7
  acc_y_dyn__variance_of_absolute_differences 0.4490
  acc_z_dyn__harmonic_mean_of_abs          0.4433
  acc_z_dyn__lower_complete_moment         0.3329
  acc_z_dyn__variance_of_absolute_differences 0.3108
  acc_z_dyn__quantile_0.4                  0.2842
  acc_x_dyn__sample_entropy                0.2043
  acc_y_dyn__harmonic_mean_of_abs          0.1908
  acc_x_dyn__quantile_0.4                  0.1841

PC8
  acc_y_dyn__quantile_0.4                  0.3881
  acc_y_dyn__variance_of_absolute_differences 0.3373
  acc_x_dyn__katz_fractal_dimension        0.3286
  acc_z_dyn__lower_complete_moment         0.3185
  acc_x_dyn__approximate_entropy_0.1       0.3183
  acc_z_dyn__approximate_entropy_0.1       0.3151
  acc_y_dyn__katz_fractal_dimension        0.2871
  acc_x_dyn__max                           0.2396

Saved to: data/feature_extraction/analysis/quality_imu_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_10.0s.csv | rows=377 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_10.0s.csv
Shape: (377, 51)
Selected feature columns: 44
After NaN/variance filter: (377, 43)
After correlation pruning: (377, 18)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 11

Explained variance per PC (round 1):
   PC1: 0.3724   (cum 0.3724)
   PC2: 0.2356   (cum 0.6080)
   PC3: 0.1040   (cum 0.7119)
   PC4: 0.0826   (cum 0.7945)
   PC5: 0.0541   (cum 0.8486)
   PC6: 0.0471   (cum 0.8957)
   PC7: 0.0404   (cum 0.9361)
   PC8: 0.0201   (cum 0.9562)
   PC9: 0.0160   (cum 0.9723)
  PC10: 0.0110   (cum 0.9833)
  PC11: 0.0074   (cum 0.9906)
  PC12: 0.0052   (cum 0.9959)
  PC13: 0.0024   (cum 0.9983)
  PC14: 0.0012   (cum 0.9995)
  PC15: 0.0003   (cum 0.9997)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3734
  ppg_green_tke_std                        0.3533
  ppg_green_tke_p95_abs                    0.3436
  ppg_green_shape_factor                   0.3175
  ppg_green_crest_factor                   0.3041
  ppg_green_iqr                            0.3003
  ppg_green_p99                            0.2814
  ppg_green_dx_kurtosis                    0.2412

PC2
  ppg_green_p10                            0.4618
  ppg_green_trim_mean_10                   0.4498
  ppg_green_p1                             0.4389
  ppg_green_p90                            0.3827
  ppg_green_p99                            0.3146
  ppg_green_mean_cross_rate                0.2242
  ppg_green_crest_factor                   0.1568
  ppg_green_kurtosis                       0.1495

PC3
  ppg_green_kurtosis                       0.4794
  ppg_green_ddx_kurtosis                   0.4225
  ppg_green_dx_kurtosis                    0.3975
  ppg_green_iqr                            0.3321
  ppg_green_skew                           0.3190
  ppg_green_shape_factor                   0.2666
  ppg_green_tke_p95_abs                    0.2257
  ppg_green_p10                            0.1935

PC4
  ppg_green_ddx_mean                       0.6325
  ppg_green_dx_mean                        0.6097
  ppg_green_skew                           0.2283
  ppg_green_iqr                            0.2280
  ppg_green_shape_factor                   0.1806
  ppg_green_crest_factor                   0.1476
  ppg_green_mean_cross_rate                0.1457
  ppg_green_ddx_kurtosis                   0.1333

PC5
  ppg_green_skew                           0.6148
  ppg_green_ddx_kurtosis                   0.4789
  ppg_green_dx_kurtosis                    0.4045
  ppg_green_mean_cross_rate                0.3270
  ppg_green_kurtosis                       0.2071
  ppg_green_crest_factor                   0.2009
  ppg_green_p99                            0.1169
  ppg_green_p1                             0.0909

PC6
  ppg_green_mean_cross_rate                0.8457
  ppg_green_skew                           0.3425
  ppg_green_ddx_mean                       0.2189
  ppg_green_crest_factor                   0.1908
  ppg_green_dx_mean                        0.1380
  ppg_green_tke_p95_abs                    0.1116
  ppg_green_kurtosis                       0.1063
  ppg_green_trim_mean_10                   0.1037

PC7
  ppg_green_kurtosis                       0.4886
  ppg_green_skew                           0.4810
  ppg_green_ddx_kurtosis                   0.3779
  ppg_green_iqr                            0.2771
  ppg_green_tke_std                        0.2484
  ppg_green_dx_mean                        0.2193
  ppg_green_mean_cross_rate                0.2109
  ppg_green_tke_p95_abs                    0.1930

PC8
  ppg_green_ddx_mean                       0.6499
  ppg_green_dx_mean                        0.6324
  ppg_green_tke_std                        0.2341
  ppg_green_dx_kurtosis                    0.1855
  ppg_green_ddx_kurtosis                   0.1490
  ppg_green_crest_factor                   0.1332
  ppg_green_iqr                            0.1080
  ppg_green_skew                           0.0894

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 11

Explained variance per PC (round 2):
   PC1: 0.3724   (cum 0.3724)
   PC2: 0.2356   (cum 0.6080)
   PC3: 0.1040   (cum 0.7119)
   PC4: 0.0826   (cum 0.7945)
   PC5: 0.0541   (cum 0.8486)
   PC6: 0.0471   (cum 0.8957)
   PC7: 0.0404   (cum 0.9361)
   PC8: 0.0201   (cum 0.9562)
   PC9: 0.0160   (cum 0.9723)
  PC10: 0.0110   (cum 0.9833)
  PC11: 0.0074   (cum 0.9906)
  PC12: 0.0052   (cum 0.9959)
  PC13: 0.0024   (cum 0.9983)
  PC14: 0.0012   (cum 0.9995)
  PC15: 0.0003   (cum 0.9997)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3734
  ppg_green_tke_std                        0.3533
  ppg_green_tke_p95_abs                    0.3436
  ppg_green_shape_factor                   0.3175
  ppg_green_crest_factor                   0.3041
  ppg_green_iqr                            0.3003
  ppg_green_p99                            0.2814
  ppg_green_dx_kurtosis                    0.2412

PC2
  ppg_green_p10                            0.4618
  ppg_green_trim_mean_10                   0.4498
  ppg_green_p1                             0.4389
  ppg_green_p90                            0.3827
  ppg_green_p99                            0.3146
  ppg_green_mean_cross_rate                0.2242
  ppg_green_crest_factor                   0.1568
  ppg_green_kurtosis                       0.1495

PC3
  ppg_green_kurtosis                       0.4794
  ppg_green_ddx_kurtosis                   0.4225
  ppg_green_dx_kurtosis                    0.3975
  ppg_green_iqr                            0.3321
  ppg_green_skew                           0.3190
  ppg_green_shape_factor                   0.2666
  ppg_green_tke_p95_abs                    0.2257
  ppg_green_p10                            0.1935

PC4
  ppg_green_ddx_mean                       0.6325
  ppg_green_dx_mean                        0.6097
  ppg_green_skew                           0.2283
  ppg_green_iqr                            0.2280
  ppg_green_shape_factor                   0.1806
  ppg_green_crest_factor                   0.1476
  ppg_green_mean_cross_rate                0.1457
  ppg_green_ddx_kurtosis                   0.1333

PC5
  ppg_green_skew                           0.6148
  ppg_green_ddx_kurtosis                   0.4789
  ppg_green_dx_kurtosis                    0.4045
  ppg_green_mean_cross_rate                0.3270
  ppg_green_kurtosis                       0.2071
  ppg_green_crest_factor                   0.2009
  ppg_green_p99                            0.1169
  ppg_green_p1                             0.0909

PC6
  ppg_green_mean_cross_rate                0.8457
  ppg_green_skew                           0.3425
  ppg_green_ddx_mean                       0.2189
  ppg_green_crest_factor                   0.1908
  ppg_green_dx_mean                        0.1380
  ppg_green_tke_p95_abs                    0.1116
  ppg_green_kurtosis                       0.1063
  ppg_green_trim_mean_10                   0.1037

PC7
  ppg_green_kurtosis                       0.4886
  ppg_green_skew                           0.4810
  ppg_green_ddx_kurtosis                   0.3779
  ppg_green_iqr                            0.2771
  ppg_green_tke_std                        0.2484
  ppg_green_dx_mean                        0.2193
  ppg_green_mean_cross_rate                0.2109
  ppg_green_tke_p95_abs                    0.1930

PC8
  ppg_green_ddx_mean                       0.6499
  ppg_green_dx_mean                        0.6324
  ppg_green_tke_std                        0.2341
  ppg_green_dx_kurtosis                    0.1855
  ppg_green_ddx_kurtosis                   0.1490
  ppg_green_crest_factor                   0.1332
  ppg_green_iqr                            0.1080
  ppg_green_skew                           0.0894

Saved to: data/feature_extraction/analysis/quality_ppg_green_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_10.0s.csv
Shape: (377, 28)
Selected feature columns: 21
After NaN/variance filter: (377, 2)
After correlation pruning: (377, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8453   (cum 0.8453)
   PC2: 0.1547   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8453   (cum 0.8453)
   PC2: 0.1547   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_10.0s.csv | rows=377 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_10.0s.csv
Shape: (377, 51)
Selected feature columns: 44
After NaN/variance filter: (377, 44)
After correlation pruning: (377, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.3260   (cum 0.3260)
   PC2: 0.2361   (cum 0.5621)
   PC3: 0.1028   (cum 0.6650)
   PC4: 0.0670   (cum 0.7320)
   PC5: 0.0583   (cum 0.7903)
   PC6: 0.0559   (cum 0.8462)
   PC7: 0.0410   (cum 0.8871)
   PC8: 0.0299   (cum 0.9170)
   PC9: 0.0222   (cum 0.9392)
  PC10: 0.0149   (cum 0.9541)
  PC11: 0.0144   (cum 0.9686)
  PC12: 0.0091   (cum 0.9776)
  PC13: 0.0083   (cum 0.9860)
  PC14: 0.0061   (cum 0.9921)
  PC15: 0.0032   (cum 0.9953)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_p99                            0.3626
  ppg_infra_signal_energy                  0.3481
  ppg_infra_tke_std                        0.3446
  ppg_infra_p10                            0.3210
  ppg_infra_iqr                            0.2840
  ppg_infra_median                         0.2580
  ppg_infra_dx_kurtosis                    0.2390
  ppg_infra_trim_mean_10                   0.2385

PC2
  ppg_infra_clearance_factor               0.3792
  ppg_infra_shape_factor                   0.3691
  ppg_infra_kurtosis                       0.3685
  ppg_infra_crest_factor                   0.3510
  ppg_infra_ddx_kurtosis                   0.2943
  ppg_infra_dx_kurtosis                    0.2812
  ppg_infra_iqr                            0.2621
  ppg_infra_p10                            0.2286

PC3
  ppg_infra_ddx_mean                       0.5607
  ppg_infra_trim_mean_10                   0.4532
  ppg_infra_diff_mean                      0.4100
  ppg_infra_mean                           0.3405
  ppg_infra_p10                            0.2506
  ppg_infra_iqr                            0.1769
  ppg_infra_median                         0.1683
  ppg_infra_p99                            0.1168

PC4
  ppg_infra_mean                           0.7015
  ppg_infra_diff_mean                      0.4141
  ppg_infra_skew                           0.3155
  ppg_infra_tke_std                        0.2111
  ppg_infra_trim_mean_10                   0.2013
  ppg_infra_dx_kurtosis                    0.1661
  ppg_infra_ddx_mean                       0.1600
  ppg_infra_zcr                            0.1465

PC5
  ppg_infra_skew                           0.8587
  ppg_infra_trim_mean_10                   0.2421
  ppg_infra_diff_mean                      0.1895
  ppg_infra_median                         0.1855
  ppg_infra_mean                           0.1683
  ppg_infra_ddx_mean                       0.1507
  ppg_infra_tke_std                        0.1377
  ppg_infra_shape_factor                   0.1183

PC6
  ppg_infra_zcr                            0.8746
  ppg_infra_median                         0.2543
  ppg_infra_ddx_mean                       0.1957
  ppg_infra_ddx_kurtosis                   0.1829
  ppg_infra_signal_energy                  0.1267
  ppg_infra_kurtosis                       0.1184
  ppg_infra_clearance_factor               0.1159
  ppg_infra_shape_factor                   0.1105

PC7
  ppg_infra_ddx_kurtosis                   0.5541
  ppg_infra_dx_kurtosis                    0.4842
  ppg_infra_zcr                            0.3554
  ppg_infra_shape_factor                   0.3275
  ppg_infra_mean                           0.2515
  ppg_infra_skew                           0.2145
  ppg_infra_clearance_factor               0.2034
  ppg_infra_kurtosis                       0.1613

PC8
  ppg_infra_diff_mean                      0.6734
  ppg_infra_ddx_mean                       0.6541
  ppg_infra_mean                           0.2769
  ppg_infra_iqr                            0.1497
  ppg_infra_zcr                            0.0989
  ppg_infra_dx_kurtosis                    0.0485
  ppg_infra_median                         0.0483
  ppg_infra_ddx_kurtosis                   0.0460

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.3260   (cum 0.3260)
   PC2: 0.2361   (cum 0.5621)
   PC3: 0.1028   (cum 0.6650)
   PC4: 0.0670   (cum 0.7320)
   PC5: 0.0583   (cum 0.7903)
   PC6: 0.0559   (cum 0.8462)
   PC7: 0.0410   (cum 0.8871)
   PC8: 0.0299   (cum 0.9170)
   PC9: 0.0222   (cum 0.9392)
  PC10: 0.0149   (cum 0.9541)
  PC11: 0.0144   (cum 0.9686)
  PC12: 0.0091   (cum 0.9776)
  PC13: 0.0083   (cum 0.9860)
  PC14: 0.0061   (cum 0.9921)
  PC15: 0.0032   (cum 0.9953)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_p99                            0.3626
  ppg_infra_signal_energy                  0.3481
  ppg_infra_tke_std                        0.3446
  ppg_infra_p10                            0.3210
  ppg_infra_iqr                            0.2840
  ppg_infra_median                         0.2580
  ppg_infra_dx_kurtosis                    0.2390
  ppg_infra_trim_mean_10                   0.2385

PC2
  ppg_infra_clearance_factor               0.3792
  ppg_infra_shape_factor                   0.3691
  ppg_infra_kurtosis                       0.3685
  ppg_infra_crest_factor                   0.3510
  ppg_infra_ddx_kurtosis                   0.2943
  ppg_infra_dx_kurtosis                    0.2812
  ppg_infra_iqr                            0.2621
  ppg_infra_p10                            0.2286

PC3
  ppg_infra_ddx_mean                       0.5607
  ppg_infra_trim_mean_10                   0.4532
  ppg_infra_diff_mean                      0.4100
  ppg_infra_mean                           0.3405
  ppg_infra_p10                            0.2506
  ppg_infra_iqr                            0.1769
  ppg_infra_median                         0.1683
  ppg_infra_p99                            0.1168

PC4
  ppg_infra_mean                           0.7015
  ppg_infra_diff_mean                      0.4141
  ppg_infra_skew                           0.3155
  ppg_infra_tke_std                        0.2111
  ppg_infra_trim_mean_10                   0.2013
  ppg_infra_dx_kurtosis                    0.1661
  ppg_infra_ddx_mean                       0.1600
  ppg_infra_zcr                            0.1465

PC5
  ppg_infra_skew                           0.8587
  ppg_infra_trim_mean_10                   0.2421
  ppg_infra_diff_mean                      0.1895
  ppg_infra_median                         0.1855
  ppg_infra_mean                           0.1683
  ppg_infra_ddx_mean                       0.1507
  ppg_infra_tke_std                        0.1377
  ppg_infra_shape_factor                   0.1183

PC6
  ppg_infra_zcr                            0.8746
  ppg_infra_median                         0.2543
  ppg_infra_ddx_mean                       0.1957
  ppg_infra_ddx_kurtosis                   0.1829
  ppg_infra_signal_energy                  0.1267
  ppg_infra_kurtosis                       0.1184
  ppg_infra_clearance_factor               0.1159
  ppg_infra_shape_factor                   0.1105

PC7
  ppg_infra_ddx_kurtosis                   0.5541
  ppg_infra_dx_kurtosis                    0.4842
  ppg_infra_zcr                            0.3554
  ppg_infra_shape_factor                   0.3275
  ppg_infra_mean                           0.2515
  ppg_infra_skew                           0.2145
  ppg_infra_clearance_factor               0.2034
  ppg_infra_kurtosis                       0.1613

PC8
  ppg_infra_diff_mean                      0.6734
  ppg_infra_ddx_mean                       0.6541
  ppg_infra_mean                           0.2769
  ppg_infra_iqr                            0.1497
  ppg_infra_zcr                            0.0989
  ppg_infra_dx_kurtosis                    0.0485
  ppg_infra_median                         0.0483
  ppg_infra_ddx_kurtosis                   0.0460

Saved to: data/feature_extraction/analysis/quality_ppg_infra_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_10.0s.csv
Shape: (377, 28)
Selected feature columns: 21
After NaN/variance filter: (377, 14)
After correlation pruning: (377, 11)

PCA summary (round 1):
  pcs_for_90pct: 4
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.4013   (cum 0.4013)
   PC2: 0.3347   (cum 0.7360)
   PC3: 0.0991   (cum 0.8351)
   PC4: 0.0691   (cum 0.9042)
   PC5: 0.0362   (cum 0.9404)
   PC6: 0.0278   (cum 0.9682)
   PC7: 0.0150   (cum 0.9832)
   PC8: 0.0068   (cum 0.9900)
   PC9: 0.0054   (cum 0.9955)
  PC10: 0.0038   (cum 0.9993)
  PC11: 0.0007   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_sdnn                           0.4058
  ppg_infra_rmssd                          0.3918
  ppg_infra_hr_median                      0.3917
  ppg_infra_mean_ibi                       0.3827
  ppg_infra_pnn50                          0.3445
  ppg_infra_n_peaks                        0.3419
  ppg_infra_pnn20                          0.2538
  ppg_infra_cv_ibi                         0.2093

PC2
  ppg_infra_hr_std                         0.4959
  ppg_infra_hr_range                       0.4594
  ppg_infra_cv_ibi                         0.4454
  ppg_infra_hr_median                      0.2535
  ppg_infra_mean_ibi                       0.2504
  ppg_infra_rmssd                          0.2265
  ppg_infra_sdnn                           0.2101
  ppg_infra_n_peaks                        0.1947

PC3
  ppg_infra_peak_quality                   0.8831
  ppg_infra_pnn20                          0.2195
  ppg_infra_mean_ibi                       0.2166
  ppg_infra_n_peaks                        0.1657
  ppg_infra_sdnn                           0.1597
  ppg_infra_pnn50                          0.1561
  ppg_infra_hr_std                         0.1235
  ppg_infra_rmssd                          0.1166

PC4
  ppg_infra_pnn20                          0.7514
  ppg_infra_pnn50                          0.3682
  ppg_infra_cv_ibi                         0.2716
  ppg_infra_peak_quality                   0.2499
  ppg_infra_sdnn                           0.2389
  ppg_infra_n_peaks                        0.1990
  ppg_infra_rmssd                          0.1822
  ppg_infra_hr_std                         0.1777

PC5
  ppg_infra_n_peaks                        0.7742
  ppg_infra_pnn50                          0.3928
  ppg_infra_pnn20                          0.3054
  ppg_infra_peak_quality                   0.2504
  ppg_infra_mean_ibi                       0.1751
  ppg_infra_rmssd                          0.1597
  ppg_infra_hr_median                      0.1084
  ppg_infra_hr_std                         0.1078

PC6
  ppg_infra_pnn50                          0.7182
  ppg_infra_pnn20                          0.4339
  ppg_infra_n_peaks                        0.3752
  ppg_infra_sdnn                           0.2244
  ppg_infra_peak_quality                   0.1952
  ppg_infra_rmssd                          0.1851
  ppg_infra_mean_ibi                       0.1174
  ppg_infra_hr_std                         0.1023

PC7
  ppg_infra_hr_range                       0.5340
  ppg_infra_rmssd                          0.5202
  ppg_infra_hr_median                      0.4783
  ppg_infra_mean_ibi                       0.3936
  ppg_infra_hr_std                         0.1936
  ppg_infra_peak_quality                   0.1135
  ppg_infra_pnn50                          0.0709
  ppg_infra_cv_ibi                         0.0547

PC8
  ppg_infra_hr_range                       0.5982
  ppg_infra_rmssd                          0.5516
  ppg_infra_cv_ibi                         0.3770
  ppg_infra_sdnn                           0.2527
  ppg_infra_hr_std                         0.2107
  ppg_infra_n_peaks                        0.1782
  ppg_infra_mean_ibi                       0.1467
  ppg_infra_peak_quality                   0.1353

Stage 2: PCs used to reach 90%: 4
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 4
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.4013   (cum 0.4013)
   PC2: 0.3347   (cum 0.7360)
   PC3: 0.0991   (cum 0.8351)
   PC4: 0.0691   (cum 0.9042)
   PC5: 0.0362   (cum 0.9404)
   PC6: 0.0278   (cum 0.9682)
   PC7: 0.0150   (cum 0.9832)
   PC8: 0.0068   (cum 0.9900)
   PC9: 0.0054   (cum 0.9955)
  PC10: 0.0038   (cum 0.9993)
  PC11: 0.0007   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_sdnn                           0.4058
  ppg_infra_rmssd                          0.3918
  ppg_infra_hr_median                      0.3917
  ppg_infra_mean_ibi                       0.3827
  ppg_infra_pnn50                          0.3445
  ppg_infra_n_peaks                        0.3419
  ppg_infra_pnn20                          0.2538
  ppg_infra_cv_ibi                         0.2093

PC2
  ppg_infra_hr_std                         0.4959
  ppg_infra_hr_range                       0.4594
  ppg_infra_cv_ibi                         0.4454
  ppg_infra_hr_median                      0.2535
  ppg_infra_mean_ibi                       0.2504
  ppg_infra_rmssd                          0.2265
  ppg_infra_sdnn                           0.2101
  ppg_infra_n_peaks                        0.1947

PC3
  ppg_infra_peak_quality                   0.8831
  ppg_infra_pnn20                          0.2195
  ppg_infra_mean_ibi                       0.2166
  ppg_infra_n_peaks                        0.1657
  ppg_infra_sdnn                           0.1597
  ppg_infra_pnn50                          0.1561
  ppg_infra_hr_std                         0.1235
  ppg_infra_rmssd                          0.1166

PC4
  ppg_infra_pnn20                          0.7514
  ppg_infra_pnn50                          0.3682
  ppg_infra_cv_ibi                         0.2716
  ppg_infra_peak_quality                   0.2499
  ppg_infra_sdnn                           0.2389
  ppg_infra_n_peaks                        0.1990
  ppg_infra_rmssd                          0.1822
  ppg_infra_hr_std                         0.1777

PC5
  ppg_infra_n_peaks                        0.7742
  ppg_infra_pnn50                          0.3928
  ppg_infra_pnn20                          0.3054
  ppg_infra_peak_quality                   0.2504
  ppg_infra_mean_ibi                       0.1751
  ppg_infra_rmssd                          0.1597
  ppg_infra_hr_median                      0.1084
  ppg_infra_hr_std                         0.1078

PC6
  ppg_infra_pnn50                          0.7182
  ppg_infra_pnn20                          0.4339
  ppg_infra_n_peaks                        0.3752
  ppg_infra_sdnn                           0.2244
  ppg_infra_peak_quality                   0.1952
  ppg_infra_rmssd                          0.1851
  ppg_infra_mean_ibi                       0.1174
  ppg_infra_hr_std                         0.1023

PC7
  ppg_infra_hr_range                       0.5340
  ppg_infra_rmssd                          0.5202
  ppg_infra_hr_median                      0.4783
  ppg_infra_mean_ibi                       0.3936
  ppg_infra_hr_std                         0.1936
  ppg_infra_peak_quality                   0.1135
  ppg_infra_pnn50                          0.0709
  ppg_infra_cv_ibi                         0.0547

PC8
  ppg_infra_hr_range                       0.5982
  ppg_infra_rmssd                          0.5516
  ppg_infra_cv_ibi                         0.3770
  ppg_infra_sdnn                           0.2527
  ppg_infra_hr_std                         0.2107
  ppg_infra_n_peaks                        0.1782
  ppg_infra_mean_ibi                       0.1467
  ppg_infra_peak_quality                   0.1353

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_10.0s.csv | rows=377 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_10.0s.csv
Shape: (377, 51)
Selected feature columns: 44
After NaN/variance filter: (377, 44)
After correlation pruning: (377, 20)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.3972   (cum 0.3972)
   PC2: 0.2472   (cum 0.6444)
   PC3: 0.0943   (cum 0.7387)
   PC4: 0.0561   (cum 0.7948)
   PC5: 0.0454   (cum 0.8402)
   PC6: 0.0431   (cum 0.8834)
   PC7: 0.0395   (cum 0.9228)
   PC8: 0.0187   (cum 0.9415)
   PC9: 0.0160   (cum 0.9576)
  PC10: 0.0125   (cum 0.9701)
  PC11: 0.0104   (cum 0.9805)
  PC12: 0.0065   (cum 0.9870)
  PC13: 0.0036   (cum 0.9906)
  PC14: 0.0034   (cum 0.9939)
  PC15: 0.0030   (cum 0.9970)

Top PCA loadings per component (round 1):

PC1
  ppg_red_min                              0.3278
  ppg_red_signal_energy                    0.3262
  ppg_red_p99                              0.3250
  ppg_red_tke_std                          0.3244
  ppg_red_p10                              0.3067
  ppg_red_iqr                              0.2978
  ppg_red_trim_mean_10                     0.2598
  ppg_red_ddx_mean                         0.2485

PC2
  ppg_red_impulse_factor                   0.3869
  ppg_red_kurtosis                         0.3680
  ppg_red_clearance_factor                 0.3659
  ppg_red_shape_factor                     0.3653
  ppg_red_crest_factor                     0.3476
  ppg_red_ddx_kurtosis                     0.2630
  ppg_red_dx_kurtosis                      0.2566
  ppg_red_iqr                              0.1687

PC3
  ppg_red_diff_mean                        0.6320
  ppg_red_ddx_mean                         0.3969
  ppg_red_median                           0.3659
  ppg_red_trim_mean_10                     0.2737
  ppg_red_p10                              0.2246
  ppg_red_mean                             0.2239
  ppg_red_iqr                              0.1993
  ppg_red_tke_std                          0.1567

PC4
  ppg_red_skew                             0.7415
  ppg_red_mean                             0.4180
  ppg_red_zcr                              0.3452
  ppg_red_ddx_kurtosis                     0.2308
  ppg_red_dx_kurtosis                      0.1777
  ppg_red_kurtosis                         0.1093
  ppg_red_trim_mean_10                     0.0981
  ppg_red_shape_factor                     0.0907

PC5
  ppg_red_zcr                              0.8730
  ppg_red_mean                             0.2610
  ppg_red_median                           0.2038
  ppg_red_skew                             0.1940
  ppg_red_dx_kurtosis                      0.1354
  ppg_red_clearance_factor                 0.1187
  ppg_red_diff_mean                        0.1160
  ppg_red_signal_energy                    0.1043

PC6
  ppg_red_skew                             0.5457
  ppg_red_dx_kurtosis                      0.4362
  ppg_red_ddx_kurtosis                     0.4008
  ppg_red_mean                             0.3548
  ppg_red_shape_factor                     0.2961
  ppg_red_trim_mean_10                     0.1853
  ppg_red_clearance_factor                 0.1714
  ppg_red_impulse_factor                   0.1698

PC7
  ppg_red_mean                             0.6009
  ppg_red_ddx_kurtosis                     0.4173
  ppg_red_dx_kurtosis                      0.3742
  ppg_red_trim_mean_10                     0.2687
  ppg_red_skew                             0.2436
  ppg_red_zcr                              0.1995
  ppg_red_median                           0.1753
  ppg_red_p10                              0.1729

PC8
  ppg_red_median                           0.5644
  ppg_red_diff_mean                        0.4073
  ppg_red_ddx_mean                         0.4029
  ppg_red_trim_mean_10                     0.2949
  ppg_red_p99                              0.2630
  ppg_red_crest_factor                     0.2223
  ppg_red_clearance_factor                 0.1971
  ppg_red_shape_factor                     0.1536

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.3972   (cum 0.3972)
   PC2: 0.2472   (cum 0.6444)
   PC3: 0.0943   (cum 0.7387)
   PC4: 0.0561   (cum 0.7948)
   PC5: 0.0454   (cum 0.8402)
   PC6: 0.0431   (cum 0.8834)
   PC7: 0.0395   (cum 0.9228)
   PC8: 0.0187   (cum 0.9415)
   PC9: 0.0160   (cum 0.9576)
  PC10: 0.0125   (cum 0.9701)
  PC11: 0.0104   (cum 0.9805)
  PC12: 0.0065   (cum 0.9870)
  PC13: 0.0036   (cum 0.9906)
  PC14: 0.0034   (cum 0.9939)
  PC15: 0.0030   (cum 0.9970)

Top PCA loadings per component (round 2):

PC1
  ppg_red_min                              0.3278
  ppg_red_signal_energy                    0.3262
  ppg_red_p99                              0.3250
  ppg_red_tke_std                          0.3244
  ppg_red_p10                              0.3067
  ppg_red_iqr                              0.2978
  ppg_red_trim_mean_10                     0.2598
  ppg_red_ddx_mean                         0.2485

PC2
  ppg_red_impulse_factor                   0.3869
  ppg_red_kurtosis                         0.3680
  ppg_red_clearance_factor                 0.3659
  ppg_red_shape_factor                     0.3653
  ppg_red_crest_factor                     0.3476
  ppg_red_ddx_kurtosis                     0.2630
  ppg_red_dx_kurtosis                      0.2566
  ppg_red_iqr                              0.1687

PC3
  ppg_red_diff_mean                        0.6320
  ppg_red_ddx_mean                         0.3969
  ppg_red_median                           0.3659
  ppg_red_trim_mean_10                     0.2737
  ppg_red_p10                              0.2246
  ppg_red_mean                             0.2239
  ppg_red_iqr                              0.1993
  ppg_red_tke_std                          0.1567

PC4
  ppg_red_skew                             0.7415
  ppg_red_mean                             0.4180
  ppg_red_zcr                              0.3452
  ppg_red_ddx_kurtosis                     0.2308
  ppg_red_dx_kurtosis                      0.1777
  ppg_red_kurtosis                         0.1093
  ppg_red_trim_mean_10                     0.0981
  ppg_red_shape_factor                     0.0907

PC5
  ppg_red_zcr                              0.8730
  ppg_red_mean                             0.2610
  ppg_red_median                           0.2038
  ppg_red_skew                             0.1940
  ppg_red_dx_kurtosis                      0.1354
  ppg_red_clearance_factor                 0.1187
  ppg_red_diff_mean                        0.1160
  ppg_red_signal_energy                    0.1043

PC6
  ppg_red_skew                             0.5457
  ppg_red_dx_kurtosis                      0.4362
  ppg_red_ddx_kurtosis                     0.4008
  ppg_red_mean                             0.3548
  ppg_red_shape_factor                     0.2961
  ppg_red_trim_mean_10                     0.1853
  ppg_red_clearance_factor                 0.1714
  ppg_red_impulse_factor                   0.1698

PC7
  ppg_red_mean                             0.6009
  ppg_red_ddx_kurtosis                     0.4173
  ppg_red_dx_kurtosis                      0.3742
  ppg_red_trim_mean_10                     0.2687
  ppg_red_skew                             0.2436
  ppg_red_zcr                              0.1995
  ppg_red_median                           0.1753
  ppg_red_p10                              0.1729

PC8
  ppg_red_median                           0.5644
  ppg_red_diff_mean                        0.4073
  ppg_red_ddx_mean                         0.4029
  ppg_red_trim_mean_10                     0.2949
  ppg_red_p99                              0.2630
  ppg_red_crest_factor                     0.2223
  ppg_red_clearance_factor                 0.1971
  ppg_red_shape_factor                     0.1536

Saved to: data/feature_extraction/analysis/quality_ppg_red_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_10.0s.csv
Shape: (377, 28)
Selected feature columns: 21
After NaN/variance filter: (377, 14)
After correlation pruning: (377, 11)

PCA summary (round 1):
  pcs_for_90pct: 4
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.4366   (cum 0.4366)
   PC2: 0.2834   (cum 0.7200)
   PC3: 0.0985   (cum 0.8185)
   PC4: 0.0816   (cum 0.9001)
   PC5: 0.0365   (cum 0.9366)
   PC6: 0.0299   (cum 0.9665)
   PC7: 0.0202   (cum 0.9866)
   PC8: 0.0070   (cum 0.9936)
   PC9: 0.0051   (cum 0.9987)
  PC10: 0.0013   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_hr_max                           0.4482
  ppg_red_mean_ibi                         0.4274
  ppg_red_hr_min                           0.4185
  ppg_red_hr_range                         0.3657
  ppg_red_n_peaks                          0.3523
  ppg_red_hr_std                           0.2968
  ppg_red_rmssd                            0.2100
  ppg_red_pnn50                            0.1625

PC2
  ppg_red_cv_ibi                           0.5267
  ppg_red_rmssd                            0.4399
  ppg_red_pnn50                            0.4161
  ppg_red_hr_std                           0.3994
  ppg_red_pnn20                            0.3086
  ppg_red_hr_range                         0.2833
  ppg_red_hr_min                           0.1028
  ppg_red_n_peaks                          0.0887

PC3
  ppg_red_peak_quality                     0.8652
  ppg_red_mean_ibi                         0.2463
  ppg_red_pnn20                            0.2401
  ppg_red_n_peaks                          0.2265
  ppg_red_rmssd                            0.1774
  ppg_red_hr_min                           0.1558
  ppg_red_hr_range                         0.1032
  ppg_red_hr_std                           0.0762

PC4
  ppg_red_pnn20                            0.7534
  ppg_red_pnn50                            0.3448
  ppg_red_cv_ibi                           0.3283
  ppg_red_peak_quality                     0.2794
  ppg_red_rmssd                            0.2313
  ppg_red_hr_std                           0.2114
  ppg_red_n_peaks                          0.1323
  ppg_red_hr_min                           0.0795

PC5
  ppg_red_n_peaks                          0.8572
  ppg_red_peak_quality                     0.3351
  ppg_red_hr_min                           0.2154
  ppg_red_rmssd                            0.1955
  ppg_red_hr_max                           0.1421
  ppg_red_hr_std                           0.1110
  ppg_red_mean_ibi                         0.1094
  ppg_red_pnn20                            0.1089

PC6
  ppg_red_pnn50                            0.8109
  ppg_red_pnn20                            0.5035
  ppg_red_n_peaks                          0.1736
  ppg_red_cv_ibi                           0.1639
  ppg_red_rmssd                            0.1581
  ppg_red_peak_quality                     0.0711
  ppg_red_mean_ibi                         0.0376
  ppg_red_hr_std                           0.0224

PC7
  ppg_red_hr_range                         0.5745
  ppg_red_hr_min                           0.5561
  ppg_red_rmssd                            0.5377
  ppg_red_hr_max                           0.1578
  ppg_red_hr_std                           0.1464
  ppg_red_mean_ibi                         0.0889
  ppg_red_pnn50                            0.0798
  ppg_red_n_peaks                          0.0785

PC8
  ppg_red_mean_ibi                         0.6514
  ppg_red_hr_range                         0.4022
  ppg_red_cv_ibi                           0.3866
  ppg_red_hr_max                           0.3291
  ppg_red_hr_min                           0.2451
  ppg_red_rmssd                            0.2350
  ppg_red_peak_quality                     0.1848
  ppg_red_n_peaks                          0.0786

Stage 2: PCs used to reach 90%: 4
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 4
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.4366   (cum 0.4366)
   PC2: 0.2834   (cum 0.7200)
   PC3: 0.0985   (cum 0.8185)
   PC4: 0.0816   (cum 0.9001)
   PC5: 0.0365   (cum 0.9366)
   PC6: 0.0299   (cum 0.9665)
   PC7: 0.0202   (cum 0.9866)
   PC8: 0.0070   (cum 0.9936)
   PC9: 0.0051   (cum 0.9987)
  PC10: 0.0013   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_hr_max                           0.4482
  ppg_red_mean_ibi                         0.4274
  ppg_red_hr_min                           0.4185
  ppg_red_hr_range                         0.3657
  ppg_red_n_peaks                          0.3523
  ppg_red_hr_std                           0.2968
  ppg_red_rmssd                            0.2100
  ppg_red_pnn50                            0.1625

PC2
  ppg_red_cv_ibi                           0.5267
  ppg_red_rmssd                            0.4399
  ppg_red_pnn50                            0.4161
  ppg_red_hr_std                           0.3994
  ppg_red_pnn20                            0.3086
  ppg_red_hr_range                         0.2833
  ppg_red_hr_min                           0.1028
  ppg_red_n_peaks                          0.0887

PC3
  ppg_red_peak_quality                     0.8652
  ppg_red_mean_ibi                         0.2463
  ppg_red_pnn20                            0.2401
  ppg_red_n_peaks                          0.2265
  ppg_red_rmssd                            0.1774
  ppg_red_hr_min                           0.1558
  ppg_red_hr_range                         0.1032
  ppg_red_hr_std                           0.0762

PC4
  ppg_red_pnn20                            0.7534
  ppg_red_pnn50                            0.3448
  ppg_red_cv_ibi                           0.3283
  ppg_red_peak_quality                     0.2794
  ppg_red_rmssd                            0.2313
  ppg_red_hr_std                           0.2114
  ppg_red_n_peaks                          0.1323
  ppg_red_hr_min                           0.0795

PC5
  ppg_red_n_peaks                          0.8572
  ppg_red_peak_quality                     0.3351
  ppg_red_hr_min                           0.2154
  ppg_red_rmssd                            0.1955
  ppg_red_hr_max                           0.1421
  ppg_red_hr_std                           0.1110
  ppg_red_mean_ibi                         0.1094
  ppg_red_pnn20                            0.1089

PC6
  ppg_red_pnn50                            0.8109
  ppg_red_pnn20                            0.5035
  ppg_red_n_peaks                          0.1736
  ppg_red_cv_ibi                           0.1639
  ppg_red_rmssd                            0.1581
  ppg_red_peak_quality                     0.0711
  ppg_red_mean_ibi                         0.0376
  ppg_red_hr_std                           0.0224

PC7
  ppg_red_hr_range                         0.5745
  ppg_red_hr_min                           0.5561
  ppg_red_rmssd                            0.5377
  ppg_red_hr_max                           0.1578
  ppg_red_hr_std                           0.1464
  ppg_red_mean_ibi                         0.0889
  ppg_red_pnn50                            0.0798
  ppg_red_n_peaks                          0.0785

PC8
  ppg_red_mean_ibi                         0.6514
  ppg_red_hr_range                         0.4022
  ppg_red_cv_ibi                           0.3866
  ppg_red_hr_max                           0.3291
  ppg_red_hr_min                           0.2451
  ppg_red_rmssd                            0.2350
  ppg_red_peak_quality                     0.1848
  ppg_red_n_peaks                          0.0786

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_10.0s.csv | rows=899 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_10.0s.csv
Shape: (899, 33)
Selected feature columns: 26
After NaN/variance filter: (899, 26)
After correlation pruning: (899, 10)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.2993   (cum 0.2993)
   PC2: 0.1669   (cum 0.4662)
   PC3: 0.1300   (cum 0.5962)
   PC4: 0.1245   (cum 0.7207)
   PC5: 0.0780   (cum 0.7987)
   PC6: 0.0743   (cum 0.8730)
   PC7: 0.0632   (cum 0.9361)
   PC8: 0.0329   (cum 0.9690)
   PC9: 0.0188   (cum 0.9879)
  PC10: 0.0121   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_slope                             0.5032
  eda_cc_range                             0.4815
  eda_stress_skin_min                      0.4711
  eda_stress_skin_iqr                      0.3862
  eda_cc_min                               0.3361
  eda_stress_skin_slope                    0.1289
  eda_stress_skin_kurtosis                 0.0857
  eda_stress_skin_skew                     0.0681

PC2
  eda_stress_skin_skew                     0.6937
  eda_stress_skin_kurtosis                 0.6906
  eda_cc_range                             0.1087
  eda_cc_kurtosis                          0.1064
  eda_cc_slope                             0.0835
  eda_cc_skew                              0.0748
  eda_cc_min                               0.0712
  eda_stress_skin_iqr                      0.0310

PC3
  eda_stress_skin_slope                    0.5205
  eda_cc_skew                              0.5090
  eda_cc_kurtosis                          0.4769
  eda_stress_skin_iqr                      0.3859
  eda_cc_min                               0.1772
  eda_cc_range                             0.1564
  eda_cc_slope                             0.1197
  eda_stress_skin_skew                     0.1108

PC4
  eda_cc_kurtosis                          0.5106
  eda_stress_skin_slope                    0.4941
  eda_cc_skew                              0.4773
  eda_stress_skin_iqr                      0.3718
  eda_cc_min                               0.2790
  eda_cc_slope                             0.1777
  eda_cc_range                             0.1201
  eda_stress_skin_kurtosis                 0.0681

PC5
  eda_cc_min                               0.6126
  eda_stress_skin_slope                    0.5051
  eda_cc_skew                              0.3320
  eda_stress_skin_min                      0.3261
  eda_cc_kurtosis                          0.2765
  eda_stress_skin_iqr                      0.2572
  eda_stress_skin_skew                     0.0769
  eda_cc_range                             0.0594

PC6
  eda_cc_skew                              0.5524
  eda_cc_kurtosis                          0.5234
  eda_stress_skin_min                      0.3798
  eda_stress_skin_slope                    0.3074
  eda_cc_range                             0.2752
  eda_stress_skin_iqr                      0.2618
  eda_cc_slope                             0.1787
  eda_stress_skin_skew                     0.0645

PC7
  eda_cc_min                               0.5736
  eda_cc_range                             0.4325
  eda_cc_kurtosis                          0.3790
  eda_cc_slope                             0.3471
  eda_stress_skin_min                      0.3120
  eda_cc_skew                              0.2981
  eda_stress_skin_iqr                      0.1129
  eda_stress_skin_kurtosis                 0.1024

PC8
  eda_stress_skin_kurtosis                 0.6801
  eda_stress_skin_skew                     0.6761
  eda_cc_min                               0.1600
  eda_stress_skin_min                      0.1467
  eda_stress_skin_iqr                      0.1034
  eda_cc_range                             0.0986
  eda_stress_skin_slope                    0.0875
  eda_cc_skew                              0.0554

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.2993   (cum 0.2993)
   PC2: 0.1669   (cum 0.4662)
   PC3: 0.1300   (cum 0.5962)
   PC4: 0.1245   (cum 0.7207)
   PC5: 0.0780   (cum 0.7987)
   PC6: 0.0743   (cum 0.8730)
   PC7: 0.0632   (cum 0.9361)
   PC8: 0.0329   (cum 0.9690)
   PC9: 0.0188   (cum 0.9879)
  PC10: 0.0121   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_slope                             0.5032
  eda_cc_range                             0.4815
  eda_stress_skin_min                      0.4711
  eda_stress_skin_iqr                      0.3862
  eda_cc_min                               0.3361
  eda_stress_skin_slope                    0.1289
  eda_stress_skin_kurtosis                 0.0857
  eda_stress_skin_skew                     0.0681

PC2
  eda_stress_skin_skew                     0.6937
  eda_stress_skin_kurtosis                 0.6906
  eda_cc_range                             0.1087
  eda_cc_kurtosis                          0.1064
  eda_cc_slope                             0.0835
  eda_cc_skew                              0.0748
  eda_cc_min                               0.0712
  eda_stress_skin_iqr                      0.0310

PC3
  eda_stress_skin_slope                    0.5205
  eda_cc_skew                              0.5090
  eda_cc_kurtosis                          0.4769
  eda_stress_skin_iqr                      0.3859
  eda_cc_min                               0.1772
  eda_cc_range                             0.1564
  eda_cc_slope                             0.1197
  eda_stress_skin_skew                     0.1108

PC4
  eda_cc_kurtosis                          0.5106
  eda_stress_skin_slope                    0.4941
  eda_cc_skew                              0.4773
  eda_stress_skin_iqr                      0.3718
  eda_cc_min                               0.2790
  eda_cc_slope                             0.1777
  eda_cc_range                             0.1201
  eda_stress_skin_kurtosis                 0.0681

PC5
  eda_cc_min                               0.6126
  eda_stress_skin_slope                    0.5051
  eda_cc_skew                              0.3320
  eda_stress_skin_min                      0.3261
  eda_cc_kurtosis                          0.2765
  eda_stress_skin_iqr                      0.2572
  eda_stress_skin_skew                     0.0769
  eda_cc_range                             0.0594

PC6
  eda_cc_skew                              0.5524
  eda_cc_kurtosis                          0.5234
  eda_stress_skin_min                      0.3798
  eda_stress_skin_slope                    0.3074
  eda_cc_range                             0.2752
  eda_stress_skin_iqr                      0.2618
  eda_cc_slope                             0.1787
  eda_stress_skin_skew                     0.0645

PC7
  eda_cc_min                               0.5736
  eda_cc_range                             0.4325
  eda_cc_kurtosis                          0.3790
  eda_cc_slope                             0.3471
  eda_stress_skin_min                      0.3120
  eda_cc_skew                              0.2981
  eda_stress_skin_iqr                      0.1129
  eda_stress_skin_kurtosis                 0.1024

PC8
  eda_stress_skin_kurtosis                 0.6801
  eda_stress_skin_skew                     0.6761
  eda_cc_min                               0.1600
  eda_stress_skin_min                      0.1467
  eda_stress_skin_iqr                      0.1034
  eda_cc_range                             0.0986
  eda_stress_skin_slope                    0.0875
  eda_cc_skew                              0.0554

Saved to: data/feature_extraction/analysis/quality_eda_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_10.0s.csv
Shape: (899, 28)
Selected feature columns: 21
After NaN/variance filter: (899, 15)
After correlation pruning: (899, 4)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6875   (cum 0.6875)
   PC2: 0.2062   (cum 0.8937)
   PC3: 0.0825   (cum 0.9762)
   PC4: 0.0238   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5826
  eda_phasic_max                           0.5440
  eda_scr_rate                             0.4979
  eda_scl_min                              0.3416

PC2
  eda_scl_min                              0.8922
  eda_scr_rate                             0.4364
  eda_phasic_max                           0.1029
  eda_scl_slope                            0.0541

PC3
  eda_phasic_max                           0.6885
  eda_scr_rate                             0.6771
  eda_scl_min                              0.2470
  eda_scl_slope                            0.0806

PC4
  eda_scl_slope                            0.8069
  eda_phasic_max                           0.4685
  eda_scr_rate                             0.3211
  eda_scl_min                              0.1621

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6875   (cum 0.6875)
   PC2: 0.2062   (cum 0.8937)
   PC3: 0.0825   (cum 0.9762)
   PC4: 0.0238   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5826
  eda_phasic_max                           0.5440
  eda_scr_rate                             0.4979
  eda_scl_min                              0.3416

PC2
  eda_scl_min                              0.8922
  eda_scr_rate                             0.4364
  eda_phasic_max                           0.1029
  eda_scl_slope                            0.0541

PC3
  eda_phasic_max                           0.6885
  eda_scr_rate                             0.6771
  eda_scl_min                              0.2470
  eda_scl_slope                            0.0806

PC4
  eda_scl_slope                            0.8069
  eda_phasic_max                           0.4685
  eda_scr_rate                             0.3211
  eda_scl_min                              0.1621

Saved to: data/feature_extraction/analysis/quality_eda_advanced_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_features_5.0s.csv
Shape: (766, 39)
Selected feature columns: 30
After NaN/variance filter: (766, 29)
After correlation pruning: (766, 29)

PCA summary (round 1):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 24

Explained variance per PC (round 1):
   PC1: 0.4542   (cum 0.4542)
   PC2: 0.1975   (cum 0.6516)
   PC3: 0.0529   (cum 0.7046)
   PC4: 0.0474   (cum 0.7520)
   PC5: 0.0377   (cum 0.7897)
   PC6: 0.0304   (cum 0.8201)
   PC7: 0.0259   (cum 0.8460)
   PC8: 0.0243   (cum 0.8704)
   PC9: 0.0159   (cum 0.8862)
  PC10: 0.0155   (cum 0.9017)
  PC11: 0.0124   (cum 0.9141)
  PC12: 0.0110   (cum 0.9251)
  PC13: 0.0100   (cum 0.9351)
  PC14: 0.0095   (cum 0.9446)
  PC15: 0.0084   (cum 0.9530)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2471
  acc_y_dyn__avg_amplitude_change          0.2422
  acc_x_dyn__quantile_0.9                  0.2343
  acc_x_dyn__quantile_0.3                  0.2323
  acc_y_dyn__quantile_0.3                  0.2308
  acc_x_dyn__quantile_0.4                  0.2128
  acc_x_dyn__harmonic_mean_of_abs          0.2055
  acc_z_dyn__harmonic_mean_of_abs          0.2048

PC2
  acc_y_dyn__sample_entropy                0.3315
  acc_x_dyn__sample_entropy                0.3217
  acc_z_dyn__sample_entropy                0.3152
  acc_y_dyn__katz_fractal_dimension        0.2850
  acc_x_dyn__approximate_entropy_0.9       0.2763
  acc_x_dyn__katz_fractal_dimension        0.2601
  acc_z_dyn__approximate_entropy_0.1       0.2598
  acc_x_dyn__approximate_entropy_0.1       0.2541

PC3
  acc_y_dyn__tsallis_entropy               0.4857
  acc_x_dyn__harmonic_mean_of_abs          0.3239
  acc_z_dyn__variance_of_absolute_differences 0.3207
  acc_x_dyn__quantile_0.6                  0.3125
  acc_y_dyn__harmonic_mean_of_abs          0.2469
  acc_x_dyn__variance_of_absolute_differences 0.2369
  acc_x_dyn__quantile_0.3                  0.2263
  acc_x_dyn__cardinality                   0.2204

PC4
  acc_y_dyn__tsallis_entropy               0.4730
  acc_x_dyn__cardinality                   0.3292
  acc_y_dyn__quantile_0.4                  0.2793
  acc_z_dyn__approximate_entropy_0.1       0.2687
  acc_x_dyn__max                           0.2589
  acc_z_dyn__harmonic_mean_of_abs          0.2426
  acc_z_dyn__quantile_0.6                  0.2320
  acc_x_dyn__harmonic_mean_of_abs          0.2199

PC5
  acc_x_dyn__approximate_entropy_0.1       0.3959
  acc_z_dyn__lower_complete_moment         0.3471
  acc_z_dyn__katz_fractal_dimension        0.3175
  acc_z_dyn__approximate_entropy_0.1       0.3077
  acc_z_dyn__quantile_0.6                  0.2916
  acc_z_dyn__harmonic_mean_of_abs          0.2657
  acc_x_dyn__katz_fractal_dimension        0.2532
  acc_y_dyn__variance_of_absolute_differences 0.2366

PC6
  acc_x_dyn__variance_of_absolute_differences 0.4383
  acc_y_dyn__tsallis_entropy               0.3511
  acc_y_dyn__harmonic_mean_of_abs          0.3015
  acc_x_dyn__quantile_0.4                  0.2991
  acc_y_dyn__quantile_0.3                  0.2796
  acc_x_dyn__max                           0.2361
  acc_y_dyn__avg_amplitude_change          0.2134
  acc_z_dyn__quantile_0.4                  0.2099

PC7
  acc_z_dyn__quantile_0.4                  0.5207
  acc_y_dyn__variance_of_absolute_differences 0.4548
  acc_z_dyn__harmonic_mean_of_abs          0.4224
  acc_y_dyn__harmonic_mean_of_abs          0.2227
  acc_z_dyn__variance_of_absolute_differences 0.2119
  acc_z_dyn__lower_complete_moment         0.2094
  acc_x_dyn__cardinality                   0.1686
  acc_y_dyn__tsallis_entropy               0.1428

PC8
  acc_y_dyn__quantile_0.4                  0.4345
  acc_y_dyn__tsallis_entropy               0.3123
  acc_z_dyn__lower_complete_moment         0.3001
  acc_z_dyn__approximate_entropy_0.1       0.2925
  acc_z_dyn__quantile_0.6                  0.2883
  acc_x_dyn__approximate_entropy_0.1       0.2671
  acc_x_dyn__variance_of_absolute_differences 0.2640
  acc_x_dyn__max                           0.2151

Stage 2: PCs used to reach 90%: 10
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 24

Explained variance per PC (round 2):
   PC1: 0.4542   (cum 0.4542)
   PC2: 0.1975   (cum 0.6516)
   PC3: 0.0529   (cum 0.7046)
   PC4: 0.0474   (cum 0.7520)
   PC5: 0.0377   (cum 0.7897)
   PC6: 0.0304   (cum 0.8201)
   PC7: 0.0259   (cum 0.8460)
   PC8: 0.0243   (cum 0.8704)
   PC9: 0.0159   (cum 0.8862)
  PC10: 0.0155   (cum 0.9017)
  PC11: 0.0124   (cum 0.9141)
  PC12: 0.0110   (cum 0.9251)
  PC13: 0.0100   (cum 0.9351)
  PC14: 0.0095   (cum 0.9446)
  PC15: 0.0084   (cum 0.9530)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2471
  acc_y_dyn__avg_amplitude_change          0.2422
  acc_x_dyn__quantile_0.9                  0.2343
  acc_x_dyn__quantile_0.3                  0.2323
  acc_y_dyn__quantile_0.3                  0.2308
  acc_x_dyn__quantile_0.4                  0.2128
  acc_x_dyn__harmonic_mean_of_abs          0.2055
  acc_z_dyn__harmonic_mean_of_abs          0.2048

PC2
  acc_y_dyn__sample_entropy                0.3315
  acc_x_dyn__sample_entropy                0.3217
  acc_z_dyn__sample_entropy                0.3152
  acc_y_dyn__katz_fractal_dimension        0.2850
  acc_x_dyn__approximate_entropy_0.9       0.2763
  acc_x_dyn__katz_fractal_dimension        0.2601
  acc_z_dyn__approximate_entropy_0.1       0.2598
  acc_x_dyn__approximate_entropy_0.1       0.2541

PC3
  acc_y_dyn__tsallis_entropy               0.4857
  acc_x_dyn__harmonic_mean_of_abs          0.3239
  acc_z_dyn__variance_of_absolute_differences 0.3207
  acc_x_dyn__quantile_0.6                  0.3125
  acc_y_dyn__harmonic_mean_of_abs          0.2469
  acc_x_dyn__variance_of_absolute_differences 0.2369
  acc_x_dyn__quantile_0.3                  0.2263
  acc_x_dyn__cardinality                   0.2204

PC4
  acc_y_dyn__tsallis_entropy               0.4730
  acc_x_dyn__cardinality                   0.3292
  acc_y_dyn__quantile_0.4                  0.2793
  acc_z_dyn__approximate_entropy_0.1       0.2687
  acc_x_dyn__max                           0.2589
  acc_z_dyn__harmonic_mean_of_abs          0.2426
  acc_z_dyn__quantile_0.6                  0.2320
  acc_x_dyn__harmonic_mean_of_abs          0.2199

PC5
  acc_x_dyn__approximate_entropy_0.1       0.3959
  acc_z_dyn__lower_complete_moment         0.3471
  acc_z_dyn__katz_fractal_dimension        0.3175
  acc_z_dyn__approximate_entropy_0.1       0.3077
  acc_z_dyn__quantile_0.6                  0.2916
  acc_z_dyn__harmonic_mean_of_abs          0.2657
  acc_x_dyn__katz_fractal_dimension        0.2532
  acc_y_dyn__variance_of_absolute_differences 0.2366

PC6
  acc_x_dyn__variance_of_absolute_differences 0.4383
  acc_y_dyn__tsallis_entropy               0.3511
  acc_y_dyn__harmonic_mean_of_abs          0.3015
  acc_x_dyn__quantile_0.4                  0.2991
  acc_y_dyn__quantile_0.3                  0.2796
  acc_x_dyn__max                           0.2361
  acc_y_dyn__avg_amplitude_change          0.2134
  acc_z_dyn__quantile_0.4                  0.2099

PC7
  acc_z_dyn__quantile_0.4                  0.5207
  acc_y_dyn__variance_of_absolute_differences 0.4548
  acc_z_dyn__harmonic_mean_of_abs          0.4224
  acc_y_dyn__harmonic_mean_of_abs          0.2227
  acc_z_dyn__variance_of_absolute_differences 0.2119
  acc_z_dyn__lower_complete_moment         0.2094
  acc_x_dyn__cardinality                   0.1686
  acc_y_dyn__tsallis_entropy               0.1428

PC8
  acc_y_dyn__quantile_0.4                  0.4345
  acc_y_dyn__tsallis_entropy               0.3123
  acc_z_dyn__lower_complete_moment         0.3001
  acc_z_dyn__approximate_entropy_0.1       0.2925
  acc_z_dyn__quantile_0.6                  0.2883
  acc_x_dyn__approximate_entropy_0.1       0.2671
  acc_x_dyn__variance_of_absolute_differences 0.2640
  acc_x_dyn__max                           0.2151

Saved to: data/feature_extraction/analysis/quality_imu_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_5.0s.csv | rows=755 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_5.0s.csv
Shape: (755, 51)
Selected feature columns: 44
After NaN/variance filter: (755, 43)
After correlation pruning: (755, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.4363   (cum 0.4363)
   PC2: 0.1266   (cum 0.5629)
   PC3: 0.1090   (cum 0.6720)
   PC4: 0.0744   (cum 0.7463)
   PC5: 0.0529   (cum 0.7992)
   PC6: 0.0484   (cum 0.8476)
   PC7: 0.0410   (cum 0.8886)
   PC8: 0.0344   (cum 0.9230)
   PC9: 0.0244   (cum 0.9474)
  PC10: 0.0173   (cum 0.9646)
  PC11: 0.0150   (cum 0.9796)
  PC12: 0.0074   (cum 0.9870)
  PC13: 0.0056   (cum 0.9926)
  PC14: 0.0038   (cum 0.9964)
  PC15: 0.0020   (cum 0.9984)

Top PCA loadings per component (round 1):

PC1
  ppg_green_range                          0.3439
  ppg_green_diff_mean_abs                  0.3394
  ppg_green_p90_p10                        0.3332
  ppg_green_tke_p95_abs                    0.3206
  ppg_green_iqr                            0.3070
  ppg_green_tke_mean_abs                   0.3037
  ppg_green_shape_factor                   0.2884
  ppg_green_crest_factor                   0.2869

PC2
  ppg_green_trim_mean_10                   0.6060
  ppg_green_p10                            0.5831
  ppg_green_mean_cross_rate                0.3175
  ppg_green_kurtosis                       0.2627
  ppg_green_skew                           0.2516
  ppg_green_ddx_mean                       0.1512
  ppg_green_crest_factor                   0.1236
  ppg_green_ddx_kurtosis                   0.0984

PC3
  ppg_green_kurtosis                       0.4372
  ppg_green_ddx_mean                       0.4331
  ppg_green_dx_kurtosis                    0.3201
  ppg_green_mad                            0.3103
  ppg_green_iqr                            0.2956
  ppg_green_ddx_kurtosis                   0.2843
  ppg_green_shape_factor                   0.2308
  ppg_green_skew                           0.2074

PC4
  ppg_green_skew                           0.5066
  ppg_green_diff_mean                      0.4890
  ppg_green_ddx_mean                       0.3916
  ppg_green_mean_cross_rate                0.3473
  ppg_green_crest_factor                   0.2457
  ppg_green_ddx_kurtosis                   0.2161
  ppg_green_tke_p95_abs                    0.1917
  ppg_green_p10                            0.1610

PC5
  ppg_green_mean_cross_rate                0.5145
  ppg_green_ddx_kurtosis                   0.4720
  ppg_green_kurtosis                       0.3377
  ppg_green_ddx_mean                       0.2903
  ppg_green_trim_mean_10                   0.2450
  ppg_green_p10                            0.2328
  ppg_green_skew                           0.2328
  ppg_green_dx_kurtosis                    0.2235

PC6
  ppg_green_diff_mean                      0.7859
  ppg_green_ddx_mean                       0.2866
  ppg_green_mean_cross_rate                0.2789
  ppg_green_shape_factor                   0.2755
  ppg_green_skew                           0.2488
  ppg_green_diff_mean_abs                  0.1479
  ppg_green_tke_p95_abs                    0.1446
  ppg_green_kurtosis                       0.1284

PC7
  ppg_green_skew                           0.4724
  ppg_green_ddx_mean                       0.4479
  ppg_green_ddx_kurtosis                   0.4443
  ppg_green_mean_cross_rate                0.3644
  ppg_green_dx_kurtosis                    0.3317
  ppg_green_shape_factor                   0.1888
  ppg_green_crest_factor                   0.1501
  ppg_green_p10                            0.1169

PC8
  ppg_green_mean_cross_rate                0.4635
  ppg_green_skew                           0.4507
  ppg_green_kurtosis                       0.3831
  ppg_green_tke_mean_abs                   0.3157
  ppg_green_ddx_kurtosis                   0.2911
  ppg_green_mad                            0.2637
  ppg_green_iqr                            0.1992
  ppg_green_ddx_mean                       0.1900

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.4363   (cum 0.4363)
   PC2: 0.1266   (cum 0.5629)
   PC3: 0.1090   (cum 0.6720)
   PC4: 0.0744   (cum 0.7463)
   PC5: 0.0529   (cum 0.7992)
   PC6: 0.0484   (cum 0.8476)
   PC7: 0.0410   (cum 0.8886)
   PC8: 0.0344   (cum 0.9230)
   PC9: 0.0244   (cum 0.9474)
  PC10: 0.0173   (cum 0.9646)
  PC11: 0.0150   (cum 0.9796)
  PC12: 0.0074   (cum 0.9870)
  PC13: 0.0056   (cum 0.9926)
  PC14: 0.0038   (cum 0.9964)
  PC15: 0.0020   (cum 0.9984)

Top PCA loadings per component (round 2):

PC1
  ppg_green_range                          0.3439
  ppg_green_diff_mean_abs                  0.3394
  ppg_green_p90_p10                        0.3332
  ppg_green_tke_p95_abs                    0.3206
  ppg_green_iqr                            0.3070
  ppg_green_tke_mean_abs                   0.3037
  ppg_green_shape_factor                   0.2884
  ppg_green_crest_factor                   0.2869

PC2
  ppg_green_trim_mean_10                   0.6060
  ppg_green_p10                            0.5831
  ppg_green_mean_cross_rate                0.3175
  ppg_green_kurtosis                       0.2627
  ppg_green_skew                           0.2516
  ppg_green_ddx_mean                       0.1512
  ppg_green_crest_factor                   0.1236
  ppg_green_ddx_kurtosis                   0.0984

PC3
  ppg_green_kurtosis                       0.4372
  ppg_green_ddx_mean                       0.4331
  ppg_green_dx_kurtosis                    0.3201
  ppg_green_mad                            0.3103
  ppg_green_iqr                            0.2956
  ppg_green_ddx_kurtosis                   0.2843
  ppg_green_shape_factor                   0.2308
  ppg_green_skew                           0.2074

PC4
  ppg_green_skew                           0.5066
  ppg_green_diff_mean                      0.4890
  ppg_green_ddx_mean                       0.3916
  ppg_green_mean_cross_rate                0.3473
  ppg_green_crest_factor                   0.2457
  ppg_green_ddx_kurtosis                   0.2161
  ppg_green_tke_p95_abs                    0.1917
  ppg_green_p10                            0.1610

PC5
  ppg_green_mean_cross_rate                0.5145
  ppg_green_ddx_kurtosis                   0.4720
  ppg_green_kurtosis                       0.3377
  ppg_green_ddx_mean                       0.2903
  ppg_green_trim_mean_10                   0.2450
  ppg_green_p10                            0.2328
  ppg_green_skew                           0.2328
  ppg_green_dx_kurtosis                    0.2235

PC6
  ppg_green_diff_mean                      0.7859
  ppg_green_ddx_mean                       0.2866
  ppg_green_mean_cross_rate                0.2789
  ppg_green_shape_factor                   0.2755
  ppg_green_skew                           0.2488
  ppg_green_diff_mean_abs                  0.1479
  ppg_green_tke_p95_abs                    0.1446
  ppg_green_kurtosis                       0.1284

PC7
  ppg_green_skew                           0.4724
  ppg_green_ddx_mean                       0.4479
  ppg_green_ddx_kurtosis                   0.4443
  ppg_green_mean_cross_rate                0.3644
  ppg_green_dx_kurtosis                    0.3317
  ppg_green_shape_factor                   0.1888
  ppg_green_crest_factor                   0.1501
  ppg_green_p10                            0.1169

PC8
  ppg_green_mean_cross_rate                0.4635
  ppg_green_skew                           0.4507
  ppg_green_kurtosis                       0.3831
  ppg_green_tke_mean_abs                   0.3157
  ppg_green_ddx_kurtosis                   0.2911
  ppg_green_mad                            0.2637
  ppg_green_iqr                            0.1992
  ppg_green_ddx_mean                       0.1900

Saved to: data/feature_extraction/analysis/quality_ppg_green_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_5.0s.csv
Shape: (755, 28)
Selected feature columns: 18
After NaN/variance filter: (755, 2)
After correlation pruning: (755, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7969   (cum 0.7969)
   PC2: 0.2031   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7969   (cum 0.7969)
   PC2: 0.2031   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_5.0s.csv | rows=755 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_5.0s.csv
Shape: (755, 51)
Selected feature columns: 44
After NaN/variance filter: (755, 44)
After correlation pruning: (755, 23)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3994   (cum 0.3994)
   PC2: 0.2156   (cum 0.6150)
   PC3: 0.0862   (cum 0.7012)
   PC4: 0.0741   (cum 0.7753)
   PC5: 0.0518   (cum 0.8271)
   PC6: 0.0391   (cum 0.8661)
   PC7: 0.0288   (cum 0.8949)
   PC8: 0.0249   (cum 0.9199)
   PC9: 0.0184   (cum 0.9382)
  PC10: 0.0167   (cum 0.9549)
  PC11: 0.0131   (cum 0.9680)
  PC12: 0.0094   (cum 0.9775)
  PC13: 0.0056   (cum 0.9831)
  PC14: 0.0052   (cum 0.9883)
  PC15: 0.0027   (cum 0.9910)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_max                            0.3093
  ppg_infra_ddx_std                        0.3063
  ppg_infra_p1                             0.2999
  ppg_infra_diff_mean_abs                  0.2948
  ppg_infra_signal_energy                  0.2889
  ppg_infra_tke_std                        0.2777
  ppg_infra_p90                            0.2759
  ppg_infra_mad                            0.2545

PC2
  ppg_infra_impulse_factor                 0.3756
  ppg_infra_clearance_factor               0.3624
  ppg_infra_kurtosis                       0.3571
  ppg_infra_shape_factor                   0.3485
  ppg_infra_crest_factor                   0.3368
  ppg_infra_dx_kurtosis                    0.2559
  ppg_infra_ddx_kurtosis                   0.2386
  ppg_infra_mad                            0.2118

PC3
  ppg_infra_zcr                            0.6692
  ppg_infra_mean_cross_rate                0.6643
  ppg_infra_ddx_kurtosis                   0.1519
  ppg_infra_mean                           0.1363
  ppg_infra_ddx_mean                       0.1088
  ppg_infra_trim_mean_10                   0.0950
  ppg_infra_median                         0.0897
  ppg_infra_tke_std                        0.0764

PC4
  ppg_infra_mean                           0.6617
  ppg_infra_trim_mean_10                   0.5202
  ppg_infra_ddx_mean                       0.2671
  ppg_infra_skew                           0.2657
  ppg_infra_diff_mean                      0.1949
  ppg_infra_mean_cross_rate                0.1462
  ppg_infra_zcr                            0.1451
  ppg_infra_crest_factor                   0.1245

PC5
  ppg_infra_skew                           0.7823
  ppg_infra_trim_mean_10                   0.4500
  ppg_infra_median                         0.2134
  ppg_infra_max                            0.1718
  ppg_infra_ddx_kurtosis                   0.1417
  ppg_infra_crest_factor                   0.1203
  ppg_infra_tke_std                        0.1198
  ppg_infra_clearance_factor               0.1083

PC6
  ppg_infra_diff_mean                      0.5622
  ppg_infra_ddx_mean                       0.5098
  ppg_infra_median                         0.3414
  ppg_infra_p1                             0.2204
  ppg_infra_ddx_std                        0.2155
  ppg_infra_diff_mean_abs                  0.1781
  ppg_infra_trim_mean_10                   0.1774
  ppg_infra_tke_std                        0.1766

PC7
  ppg_infra_ddx_kurtosis                   0.5913
  ppg_infra_tke_std                        0.4088
  ppg_infra_mad                            0.3085
  ppg_infra_dx_kurtosis                    0.2915
  ppg_infra_skew                           0.2422
  ppg_infra_p90                            0.2234
  ppg_infra_ddx_std                        0.1831
  ppg_infra_shape_factor                   0.1801

PC8
  ppg_infra_ddx_mean                       0.5610
  ppg_infra_median                         0.3294
  ppg_infra_dx_kurtosis                    0.3227
  ppg_infra_shape_factor                   0.2928
  ppg_infra_tke_std                        0.2689
  ppg_infra_skew                           0.2389
  ppg_infra_p90                            0.1917
  ppg_infra_mad                            0.1807

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3994   (cum 0.3994)
   PC2: 0.2156   (cum 0.6150)
   PC3: 0.0862   (cum 0.7012)
   PC4: 0.0741   (cum 0.7753)
   PC5: 0.0518   (cum 0.8271)
   PC6: 0.0391   (cum 0.8661)
   PC7: 0.0288   (cum 0.8949)
   PC8: 0.0249   (cum 0.9199)
   PC9: 0.0184   (cum 0.9382)
  PC10: 0.0167   (cum 0.9549)
  PC11: 0.0131   (cum 0.9680)
  PC12: 0.0094   (cum 0.9775)
  PC13: 0.0056   (cum 0.9831)
  PC14: 0.0052   (cum 0.9883)
  PC15: 0.0027   (cum 0.9910)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_max                            0.3093
  ppg_infra_ddx_std                        0.3063
  ppg_infra_p1                             0.2999
  ppg_infra_diff_mean_abs                  0.2948
  ppg_infra_signal_energy                  0.2889
  ppg_infra_tke_std                        0.2777
  ppg_infra_p90                            0.2759
  ppg_infra_mad                            0.2545

PC2
  ppg_infra_impulse_factor                 0.3756
  ppg_infra_clearance_factor               0.3624
  ppg_infra_kurtosis                       0.3571
  ppg_infra_shape_factor                   0.3485
  ppg_infra_crest_factor                   0.3368
  ppg_infra_dx_kurtosis                    0.2559
  ppg_infra_ddx_kurtosis                   0.2386
  ppg_infra_mad                            0.2118

PC3
  ppg_infra_zcr                            0.6692
  ppg_infra_mean_cross_rate                0.6643
  ppg_infra_ddx_kurtosis                   0.1519
  ppg_infra_mean                           0.1363
  ppg_infra_ddx_mean                       0.1088
  ppg_infra_trim_mean_10                   0.0950
  ppg_infra_median                         0.0897
  ppg_infra_tke_std                        0.0764

PC4
  ppg_infra_mean                           0.6617
  ppg_infra_trim_mean_10                   0.5202
  ppg_infra_ddx_mean                       0.2671
  ppg_infra_skew                           0.2657
  ppg_infra_diff_mean                      0.1949
  ppg_infra_mean_cross_rate                0.1462
  ppg_infra_zcr                            0.1451
  ppg_infra_crest_factor                   0.1245

PC5
  ppg_infra_skew                           0.7823
  ppg_infra_trim_mean_10                   0.4500
  ppg_infra_median                         0.2134
  ppg_infra_max                            0.1718
  ppg_infra_ddx_kurtosis                   0.1417
  ppg_infra_crest_factor                   0.1203
  ppg_infra_tke_std                        0.1198
  ppg_infra_clearance_factor               0.1083

PC6
  ppg_infra_diff_mean                      0.5622
  ppg_infra_ddx_mean                       0.5098
  ppg_infra_median                         0.3414
  ppg_infra_p1                             0.2204
  ppg_infra_ddx_std                        0.2155
  ppg_infra_diff_mean_abs                  0.1781
  ppg_infra_trim_mean_10                   0.1774
  ppg_infra_tke_std                        0.1766

PC7
  ppg_infra_ddx_kurtosis                   0.5913
  ppg_infra_tke_std                        0.4088
  ppg_infra_mad                            0.3085
  ppg_infra_dx_kurtosis                    0.2915
  ppg_infra_skew                           0.2422
  ppg_infra_p90                            0.2234
  ppg_infra_ddx_std                        0.1831
  ppg_infra_shape_factor                   0.1801

PC8
  ppg_infra_ddx_mean                       0.5610
  ppg_infra_median                         0.3294
  ppg_infra_dx_kurtosis                    0.3227
  ppg_infra_shape_factor                   0.2928
  ppg_infra_tke_std                        0.2689
  ppg_infra_skew                           0.2389
  ppg_infra_p90                            0.1917
  ppg_infra_mad                            0.1807

Saved to: data/feature_extraction/analysis/quality_ppg_infra_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE

=== Processing dataset: elderly_sim_elderly2 ===
▶ imu_bioz: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_bioz/imu_preprocessed.csv
  Windowing imu_bioz...
    ✓ Created 891 windows (10.0s)
  Extracting features for imu_bioz...
    ✓ Features 10.0s: 891 windows, 38 features
    ✓ Features 5.0s: 1783 windows, 38 features
    ✓ Features 2.0s: 4428 windows, 38 features
▶ imu_wrist: preprocessing
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_preprocessed.csv
  Windowing imu_wrist...
    ✓ Created 383 windows (10.0s)
  Extracting features for imu_wrist...
    ✓ Features 10.0s: 383 windows, 38 features
    ✓ Features 5.0s: 766 windows, 38 features
    ✓ Features 2.0s: 1902 windows, 38 features
▶ ppg_green: preprocessing
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_preprocessed.csv | rows=108768 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_preprocessed.csv
▶ ppg_infra: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_preprocessed.csv | rows=108768 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_preprocessed.csv
▶ ppg_red: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_preprocessed.csv | rows=108768 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_preprocessed.csv
▶ RR: preprocessing
✓ RR preprocessed → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/rr/rr_preprocessed.csv | rows=22134 | irregular sampling (no resample)
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/rr/rr_preprocessed.csv
▶ EDA: preprocessing
✓ EDA preprocessed → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_preprocessed.csv | rows=259201 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_preprocessed.csv

▶ Window length: 10.0s | overlap=0.1
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 383
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_aligned_10.0s.csv (383 windows | borg labeled: 137)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_10.0s.csv | windows=377 | features=21
    ✓ HRV features: 377 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_aligned_10.0s.csv (377 windows | borg labeled: 135)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_aligned_10.0s.csv (377 windows | borg labeled: 135)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_10.0s.csv | windows=377 | features=21
    ✓ HRV features: 377 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_aligned_10.0s.csv (377 windows | borg labeled: 135)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_aligned_10.0s.csv (377 windows | borg labeled: 135)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_10.0s.csv | windows=377 | features=21
    ✓ HRV features: 377 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_aligned_10.0s.csv (377 windows | borg labeled: 135)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 377
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_aligned_10.0s.csv (377 windows | borg labeled: 135)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_10.0s.csv | windows=899 | features=21
    ✓ Advanced EDA features: 899 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 899
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_aligned_10.0s.csv (899 windows | borg labeled: 131)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 899
  Windows in ADL time range: 183
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_aligned_10.0s.csv (899 windows | borg labeled: 131)

▶ Window length: 5.0s | overlap=0.1
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 766
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_aligned_5.0s.csv (766 windows | borg labeled: 267)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_5.0s.csv | windows=755 | features=21
    ✓ HRV features: 755 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_aligned_5.0s.csv (755 windows | borg labeled: 267)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_aligned_5.0s.csv (755 windows | borg labeled: 267)
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_5.0s.csv
Shape: (755, 28)
Selected feature columns: 18
After NaN/variance filter: (755, 2)
After correlation pruning: (755, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5953   (cum 0.5953)
   PC2: 0.4047   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5953   (cum 0.5953)
   PC2: 0.4047   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_5.0s.csv | rows=755 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_5.0s.csv
Shape: (755, 51)
Selected feature columns: 44
After NaN/variance filter: (755, 44)
After correlation pruning: (755, 20)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.3938   (cum 0.3938)
   PC2: 0.2036   (cum 0.5974)
   PC3: 0.0954   (cum 0.6928)
   PC4: 0.0596   (cum 0.7524)
   PC5: 0.0536   (cum 0.8059)
   PC6: 0.0424   (cum 0.8484)
   PC7: 0.0332   (cum 0.8816)
   PC8: 0.0289   (cum 0.9105)
   PC9: 0.0211   (cum 0.9316)
  PC10: 0.0198   (cum 0.9515)
  PC11: 0.0138   (cum 0.9653)
  PC12: 0.0122   (cum 0.9775)
  PC13: 0.0096   (cum 0.9870)
  PC14: 0.0045   (cum 0.9916)
  PC15: 0.0039   (cum 0.9954)

Top PCA loadings per component (round 1):

PC1
  ppg_red_min                              0.3290
  ppg_red_diff_mean_abs                    0.3266
  ppg_red_max                              0.3259
  ppg_red_signal_energy                    0.3187
  ppg_red_p90                              0.3093
  ppg_red_tke_std                          0.3012
  ppg_red_p10                              0.2932
  ppg_red_dx_kurtosis                      0.2138

PC2
  ppg_red_clearance_factor                 0.4067
  ppg_red_kurtosis                         0.4008
  ppg_red_shape_factor                     0.3842
  ppg_red_crest_factor                     0.3635
  ppg_red_ddx_kurtosis                     0.2781
  ppg_red_dx_kurtosis                      0.2698
  ppg_red_p10                              0.2085
  ppg_red_dx_mean                          0.1888

PC3
  ppg_red_trim_mean_10                     0.5838
  ppg_red_mean                             0.5561
  ppg_red_ddx_mean                         0.3690
  ppg_red_dx_mean                          0.3194
  ppg_red_median                           0.1893
  ppg_red_crest_factor                     0.1346
  ppg_red_p10                              0.1025
  ppg_red_shape_factor                     0.0963

PC4
  ppg_red_skew                             0.6668
  ppg_red_zcr                              0.4707
  ppg_red_ddx_kurtosis                     0.2573
  ppg_red_mean                             0.2356
  ppg_red_trim_mean_10                     0.2343
  ppg_red_ddx_mean                         0.2193
  ppg_red_tke_std                          0.1692
  ppg_red_max                              0.1576

PC5
  ppg_red_zcr                              0.6438
  ppg_red_skew                             0.3859
  ppg_red_ddx_mean                         0.2776
  ppg_red_ddx_kurtosis                     0.2638
  ppg_red_dx_mean                          0.2471
  ppg_red_mean                             0.2131
  ppg_red_dx_kurtosis                      0.2128
  ppg_red_shape_factor                     0.1882

PC6
  ppg_red_ddx_mean                         0.5329
  ppg_red_median                           0.5310
  ppg_red_skew                             0.4589
  ppg_red_mean                             0.2588
  ppg_red_dx_mean                          0.1792
  ppg_red_min                              0.1560
  ppg_red_p10                              0.1507
  ppg_red_zcr                              0.1434

PC7
  ppg_red_zcr                              0.5450
  ppg_red_ddx_kurtosis                     0.4926
  ppg_red_dx_kurtosis                      0.4724
  ppg_red_shape_factor                     0.2797
  ppg_red_median                           0.2340
  ppg_red_clearance_factor                 0.1601
  ppg_red_dx_mean                          0.1289
  ppg_red_crest_factor                     0.1176

PC8
  ppg_red_median                           0.5295
  ppg_red_tke_std                          0.3947
  ppg_red_ddx_mean                         0.3560
  ppg_red_skew                             0.3282
  ppg_red_max                              0.3093
  ppg_red_p10                              0.2089
  ppg_red_dx_mean                          0.2015
  ppg_red_ddx_kurtosis                     0.2015

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.3938   (cum 0.3938)
   PC2: 0.2036   (cum 0.5974)
   PC3: 0.0954   (cum 0.6928)
   PC4: 0.0596   (cum 0.7524)
   PC5: 0.0536   (cum 0.8059)
   PC6: 0.0424   (cum 0.8484)
   PC7: 0.0332   (cum 0.8816)
   PC8: 0.0289   (cum 0.9105)
   PC9: 0.0211   (cum 0.9316)
  PC10: 0.0198   (cum 0.9515)
  PC11: 0.0138   (cum 0.9653)
  PC12: 0.0122   (cum 0.9775)
  PC13: 0.0096   (cum 0.9870)
  PC14: 0.0045   (cum 0.9916)
  PC15: 0.0039   (cum 0.9954)

Top PCA loadings per component (round 2):

PC1
  ppg_red_min                              0.3290
  ppg_red_diff_mean_abs                    0.3266
  ppg_red_max                              0.3259
  ppg_red_signal_energy                    0.3187
  ppg_red_p90                              0.3093
  ppg_red_tke_std                          0.3012
  ppg_red_p10                              0.2932
  ppg_red_dx_kurtosis                      0.2138

PC2
  ppg_red_clearance_factor                 0.4067
  ppg_red_kurtosis                         0.4008
  ppg_red_shape_factor                     0.3842
  ppg_red_crest_factor                     0.3635
  ppg_red_ddx_kurtosis                     0.2781
  ppg_red_dx_kurtosis                      0.2698
  ppg_red_p10                              0.2085
  ppg_red_dx_mean                          0.1888

PC3
  ppg_red_trim_mean_10                     0.5838
  ppg_red_mean                             0.5561
  ppg_red_ddx_mean                         0.3690
  ppg_red_dx_mean                          0.3194
  ppg_red_median                           0.1893
  ppg_red_crest_factor                     0.1346
  ppg_red_p10                              0.1025
  ppg_red_shape_factor                     0.0963

PC4
  ppg_red_skew                             0.6668
  ppg_red_zcr                              0.4707
  ppg_red_ddx_kurtosis                     0.2573
  ppg_red_mean                             0.2356
  ppg_red_trim_mean_10                     0.2343
  ppg_red_ddx_mean                         0.2193
  ppg_red_tke_std                          0.1692
  ppg_red_max                              0.1576

PC5
  ppg_red_zcr                              0.6438
  ppg_red_skew                             0.3859
  ppg_red_ddx_mean                         0.2776
  ppg_red_ddx_kurtosis                     0.2638
  ppg_red_dx_mean                          0.2471
  ppg_red_mean                             0.2131
  ppg_red_dx_kurtosis                      0.2128
  ppg_red_shape_factor                     0.1882

PC6
  ppg_red_ddx_mean                         0.5329
  ppg_red_median                           0.5310
  ppg_red_skew                             0.4589
  ppg_red_mean                             0.2588
  ppg_red_dx_mean                          0.1792
  ppg_red_min                              0.1560
  ppg_red_p10                              0.1507
  ppg_red_zcr                              0.1434

PC7
  ppg_red_zcr                              0.5450
  ppg_red_ddx_kurtosis                     0.4926
  ppg_red_dx_kurtosis                      0.4724
  ppg_red_shape_factor                     0.2797
  ppg_red_median                           0.2340
  ppg_red_clearance_factor                 0.1601
  ppg_red_dx_mean                          0.1289
  ppg_red_crest_factor                     0.1176

PC8
  ppg_red_median                           0.5295
  ppg_red_tke_std                          0.3947
  ppg_red_ddx_mean                         0.3560
  ppg_red_skew                             0.3282
  ppg_red_max                              0.3093
  ppg_red_p10                              0.2089
  ppg_red_dx_mean                          0.2015
  ppg_red_ddx_kurtosis                     0.2015

Saved to: data/feature_extraction/analysis/quality_ppg_red_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_5.0s.csv
Shape: (755, 28)
Selected feature columns: 18
After NaN/variance filter: (755, 2)
After correlation pruning: (755, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.6165   (cum 0.6165)
   PC2: 0.3835   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.6165   (cum 0.6165)
   PC2: 0.3835   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_5.0s.csv | rows=1799 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_5.0s.csv
Shape: (1799, 33)
Selected feature columns: 26
After NaN/variance filter: (1799, 26)
After correlation pruning: (1799, 10)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.3006   (cum 0.3006)
   PC2: 0.1593   (cum 0.4599)
   PC3: 0.1306   (cum 0.5905)
   PC4: 0.1239   (cum 0.7145)
   PC5: 0.0781   (cum 0.7925)
   PC6: 0.0742   (cum 0.8667)
   PC7: 0.0628   (cum 0.9296)
   PC8: 0.0397   (cum 0.9693)
   PC9: 0.0187   (cum 0.9880)
  PC10: 0.0120   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_slope                             0.5025
  eda_cc_iqr                               0.4813
  eda_stress_skin_min                      0.4731
  eda_stress_skin_mad                      0.3888
  eda_cc_min                               0.3366
  eda_stress_skin_slope                    0.1214
  eda_stress_skin_kurtosis                 0.0866
  eda_cc_kurtosis                          0.0536

PC2
  eda_stress_skin_skew                     0.6897
  eda_stress_skin_kurtosis                 0.6865
  eda_cc_skew                              0.1241
  eda_cc_iqr                               0.1046
  eda_cc_min                               0.0977
  eda_cc_kurtosis                          0.0781
  eda_cc_slope                             0.0777
  eda_stress_skin_mad                      0.0662

PC3
  eda_cc_kurtosis                          0.5612
  eda_cc_skew                              0.5507
  eda_stress_skin_slope                    0.4445
  eda_stress_skin_mad                      0.3218
  eda_cc_iqr                               0.1380
  eda_stress_skin_skew                     0.1321
  eda_cc_min                               0.1279
  eda_stress_skin_kurtosis                 0.1245

PC4
  eda_stress_skin_slope                    0.5612
  eda_cc_kurtosis                          0.4236
  eda_stress_skin_mad                      0.4214
  eda_cc_skew                              0.4149
  eda_cc_min                               0.3027
  eda_cc_slope                             0.1990
  eda_cc_iqr                               0.1452
  eda_stress_skin_skew                     0.0476

PC5
  eda_stress_skin_slope                    0.5793
  eda_cc_min                               0.5718
  eda_stress_skin_min                      0.4100
  eda_stress_skin_mad                      0.3198
  eda_cc_skew                              0.1621
  eda_stress_skin_skew                     0.1439
  eda_cc_kurtosis                          0.1127
  eda_cc_slope                             0.0829

PC6
  eda_cc_skew                              0.6196
  eda_cc_kurtosis                          0.5753
  eda_cc_iqr                               0.2912
  eda_stress_skin_min                      0.2644
  eda_cc_min                               0.2149
  eda_stress_skin_slope                    0.1765
  eda_stress_skin_mad                      0.1625
  eda_cc_slope                             0.1554

PC7
  eda_cc_min                               0.5663
  eda_cc_iqr                               0.4218
  eda_cc_kurtosis                          0.3780
  eda_cc_slope                             0.3503
  eda_stress_skin_min                      0.3022
  eda_cc_skew                              0.3004
  eda_stress_skin_kurtosis                 0.1520
  eda_stress_skin_mad                      0.1218

PC8
  eda_stress_skin_kurtosis                 0.6909
  eda_stress_skin_skew                     0.6847
  eda_cc_min                               0.1671
  eda_cc_iqr                               0.0962
  eda_cc_skew                              0.0912
  eda_cc_kurtosis                          0.0691
  eda_stress_skin_min                      0.0508
  eda_stress_skin_mad                      0.0280

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.3006   (cum 0.3006)
   PC2: 0.1593   (cum 0.4599)
   PC3: 0.1306   (cum 0.5905)
   PC4: 0.1239   (cum 0.7145)
   PC5: 0.0781   (cum 0.7925)
   PC6: 0.0742   (cum 0.8667)
   PC7: 0.0628   (cum 0.9296)
   PC8: 0.0397   (cum 0.9693)
   PC9: 0.0187   (cum 0.9880)
  PC10: 0.0120   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_slope                             0.5025
  eda_cc_iqr                               0.4813
  eda_stress_skin_min                      0.4731
  eda_stress_skin_mad                      0.3888
  eda_cc_min                               0.3366
  eda_stress_skin_slope                    0.1214
  eda_stress_skin_kurtosis                 0.0866
  eda_cc_kurtosis                          0.0536

PC2
  eda_stress_skin_skew                     0.6897
  eda_stress_skin_kurtosis                 0.6865
  eda_cc_skew                              0.1241
  eda_cc_iqr                               0.1046
  eda_cc_min                               0.0977
  eda_cc_kurtosis                          0.0781
  eda_cc_slope                             0.0777
  eda_stress_skin_mad                      0.0662

PC3
  eda_cc_kurtosis                          0.5612
  eda_cc_skew                              0.5507
  eda_stress_skin_slope                    0.4445
  eda_stress_skin_mad                      0.3218
  eda_cc_iqr                               0.1380
  eda_stress_skin_skew                     0.1321
  eda_cc_min                               0.1279
  eda_stress_skin_kurtosis                 0.1245

PC4
  eda_stress_skin_slope                    0.5612
  eda_cc_kurtosis                          0.4236
  eda_stress_skin_mad                      0.4214
  eda_cc_skew                              0.4149
  eda_cc_min                               0.3027
  eda_cc_slope                             0.1990
  eda_cc_iqr                               0.1452
  eda_stress_skin_skew                     0.0476

PC5
  eda_stress_skin_slope                    0.5793
  eda_cc_min                               0.5718
  eda_stress_skin_min                      0.4100
  eda_stress_skin_mad                      0.3198
  eda_cc_skew                              0.1621
  eda_stress_skin_skew                     0.1439
  eda_cc_kurtosis                          0.1127
  eda_cc_slope                             0.0829

PC6
  eda_cc_skew                              0.6196
  eda_cc_kurtosis                          0.5753
  eda_cc_iqr                               0.2912
  eda_stress_skin_min                      0.2644
  eda_cc_min                               0.2149
  eda_stress_skin_slope                    0.1765
  eda_stress_skin_mad                      0.1625
  eda_cc_slope                             0.1554

PC7
  eda_cc_min                               0.5663
  eda_cc_iqr                               0.4218
  eda_cc_kurtosis                          0.3780
  eda_cc_slope                             0.3503
  eda_stress_skin_min                      0.3022
  eda_cc_skew                              0.3004
  eda_stress_skin_kurtosis                 0.1520
  eda_stress_skin_mad                      0.1218

PC8
  eda_stress_skin_kurtosis                 0.6909
  eda_stress_skin_skew                     0.6847
  eda_cc_min                               0.1671
  eda_cc_iqr                               0.0962
  eda_cc_skew                              0.0912
  eda_cc_kurtosis                          0.0691
  eda_stress_skin_min                      0.0508
  eda_stress_skin_mad                      0.0280

Saved to: data/feature_extraction/analysis/quality_eda_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_5.0s.csv
Shape: (1799, 28)
Selected feature columns: 21
After NaN/variance filter: (1799, 15)
After correlation pruning: (1799, 4)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6790   (cum 0.6790)
   PC2: 0.2114   (cum 0.8904)
   PC3: 0.0876   (cum 0.9780)
   PC4: 0.0220   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5881
  eda_scl_std                              0.5452
  eda_scr_rate                             0.4880
  eda_scl_min                              0.3446

PC2
  eda_scl_min                              0.8719
  eda_scr_rate                             0.4829
  eda_scl_std                              0.0641
  eda_scl_slope                            0.0509

PC3
  eda_scl_std                              0.6973
  eda_scr_rate                             0.6463
  eda_scl_min                              0.3028
  eda_scl_slope                            0.0672

PC4
  eda_scl_slope                            0.8044
  eda_scl_std                              0.4609
  eda_scr_rate                             0.3333
  eda_scl_min                              0.1715

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6790   (cum 0.6790)
   PC2: 0.2114   (cum 0.8904)
   PC3: 0.0876   (cum 0.9780)
   PC4: 0.0220   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5881
  eda_scl_std                              0.5452
  eda_scr_rate                             0.4880
  eda_scl_min                              0.3446

PC2
  eda_scl_min                              0.8719
  eda_scr_rate                             0.4829
  eda_scl_std                              0.0641
  eda_scl_slope                            0.0509

PC3
  eda_scl_std                              0.6973
  eda_scr_rate                             0.6463
  eda_scl_min                              0.3028
  eda_scl_slope                            0.0672

PC4
  eda_scl_slope                            0.8044
  eda_scl_std                              0.4609
  eda_scr_rate                             0.3333
  eda_scl_min                              0.1715

Saved to: data/feature_extraction/analysis/quality_eda_advanced_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_features_2.0s.csv
Shape: (1902, 39)
Selected feature columns: 30
After NaN/variance filter: (1902, 30)
After correlation pruning: (1902, 30)

PCA summary (round 1):
  pcs_for_90pct: 14
  pcs_for_95pct: 18
  pcs_for_99pct: 26

Explained variance per PC (round 1):
   PC1: 0.3577   (cum 0.3577)
   PC2: 0.1798   (cum 0.5376)
   PC3: 0.0547   (cum 0.5923)
   PC4: 0.0497   (cum 0.6420)
   PC5: 0.0393   (cum 0.6813)
   PC6: 0.0385   (cum 0.7199)
   PC7: 0.0351   (cum 0.7550)
   PC8: 0.0335   (cum 0.7884)
   PC9: 0.0302   (cum 0.8187)
  PC10: 0.0261   (cum 0.8448)
  PC11: 0.0205   (cum 0.8653)
  PC12: 0.0182   (cum 0.8834)
  PC13: 0.0152   (cum 0.8986)
  PC14: 0.0145   (cum 0.9132)
  PC15: 0.0116   (cum 0.9247)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2698
  acc_y_dyn__avg_amplitude_change          0.2617
  acc_x_dyn__quantile_0.9                  0.2586
  acc_x_dyn__max                           0.2502
  acc_x_dyn__quantile_0.3                  0.2385
  acc_y_dyn__quantile_0.3                  0.2362
  acc_x_dyn__harmonic_mean_of_abs          0.2277
  acc_y_dyn__harmonic_mean_of_abs          0.2196

PC2
  acc_y_dyn__sample_entropy                0.3399
  acc_x_dyn__sample_entropy                0.3376
  acc_z_dyn__sample_entropy                0.3287
  acc_x_dyn__approximate_entropy_0.9       0.3261
  acc_y_dyn__katz_fractal_dimension        0.3228
  acc_x_dyn__katz_fractal_dimension        0.3107
  acc_z_dyn__katz_fractal_dimension        0.2915
  acc_x_dyn__cardinality                   0.2670

PC3
  acc_x_dyn__approximate_entropy_0.1       0.5334
  acc_z_dyn__approximate_entropy_0.1       0.4731
  acc_x_dyn__cardinality                   0.2834
  acc_z_dyn__variance_of_absolute_differences 0.1920
  acc_z_dyn__quantile_0.6                  0.1725
  acc_x_dyn__harmonic_mean_of_abs          0.1714
  acc_z_dyn__lower_complete_moment         0.1714
  acc_y_dyn__tsallis_entropy               0.1689

PC4
  acc_z_dyn__quantile_0.6                  0.3846
  acc_z_dyn__lower_complete_moment         0.3714
  acc_y_dyn__quantile_0.4                  0.3440
  acc_y_dyn__quantile_0.3                  0.3047
  acc_y_dyn__tsallis_entropy               0.2827
  acc_z_dyn__variance_of_absolute_differences 0.2782
  acc_x_dyn__quantile_0.4                  0.2521
  acc_z_dyn__harmonic_mean_of_abs          0.2371

PC5
  acc_y_dyn__tsallis_entropy               0.4300
  acc_x_dyn__variance_of_absolute_differences 0.3984
  acc_z_dyn__harmonic_mean_of_abs          0.3418
  acc_z_dyn__quantile_0.4                  0.2772
  acc_x_dyn__max                           0.2513
  acc_y_dyn__quantile_0.4                  0.2404
  acc_y_dyn__quantile_0.3                  0.2153
  acc_z_dyn__katz_fractal_dimension        0.1832

PC6
  acc_y_dyn__tsallis_entropy               0.4420
  acc_y_dyn__quantile_0.4                  0.3743
  acc_x_dyn__harmonic_mean_of_abs          0.3401
  acc_x_dyn__quantile_0.6                  0.3329
  acc_y_dyn__variance_of_absolute_differences 0.3039
  acc_x_dyn__quantile_0.3                  0.2244
  acc_z_dyn__quantile_0.4                  0.2104
  acc_y_dyn__quantile_0.3                  0.1993

PC7
  acc_x_dyn__quantile_0.6                  0.5746
  acc_x_dyn__quantile_0.4                  0.4695
  acc_y_dyn__harmonic_mean_of_abs          0.3385
  acc_y_dyn__variance_of_absolute_differences 0.2402
  acc_x_dyn__quantile_0.3                  0.2047
  acc_z_dyn__lower_complete_moment         0.2011
  acc_y_dyn__avg_amplitude_change          0.1937
  acc_z_dyn__variance_of_absolute_differences 0.1620

PC8
  acc_x_dyn__harmonic_mean                 0.9679
  acc_z_dyn__quantile_0.4                  0.1339
  acc_z_dyn__harmonic_mean_of_abs          0.0962
  acc_x_dyn__variance_of_absolute_differences 0.0948
  acc_x_dyn__quantile_0.4                  0.0660
  acc_x_dyn__quantile_0.6                  0.0561
  acc_x_dyn__approximate_entropy_0.9       0.0493
  acc_x_dyn__max                           0.0459

Stage 2: PCs used to reach 90%: 14
Stage 2: ranking pool size: 30
Stage 2: selected features: 30 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 14
  pcs_for_95pct: 18
  pcs_for_99pct: 26

Explained variance per PC (round 2):
   PC1: 0.3577   (cum 0.3577)
   PC2: 0.1798   (cum 0.5376)
   PC3: 0.0547   (cum 0.5923)
   PC4: 0.0497   (cum 0.6420)
   PC5: 0.0393   (cum 0.6813)
   PC6: 0.0385   (cum 0.7199)
   PC7: 0.0351   (cum 0.7550)
   PC8: 0.0335   (cum 0.7884)
   PC9: 0.0302   (cum 0.8187)
  PC10: 0.0261   (cum 0.8448)
  PC11: 0.0205   (cum 0.8653)
  PC12: 0.0182   (cum 0.8834)
  PC13: 0.0152   (cum 0.8986)
  PC14: 0.0145   (cum 0.9132)
  PC15: 0.0116   (cum 0.9247)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2698
  acc_y_dyn__avg_amplitude_change          0.2617
  acc_x_dyn__quantile_0.9                  0.2586
  acc_x_dyn__max                           0.2502
  acc_x_dyn__quantile_0.3                  0.2385
  acc_y_dyn__quantile_0.3                  0.2362
  acc_x_dyn__harmonic_mean_of_abs          0.2277
  acc_y_dyn__harmonic_mean_of_abs          0.2196

PC2
  acc_y_dyn__sample_entropy                0.3399
  acc_x_dyn__sample_entropy                0.3376
  acc_z_dyn__sample_entropy                0.3287
  acc_x_dyn__approximate_entropy_0.9       0.3261
  acc_y_dyn__katz_fractal_dimension        0.3228
  acc_x_dyn__katz_fractal_dimension        0.3107
  acc_z_dyn__katz_fractal_dimension        0.2915
  acc_x_dyn__cardinality                   0.2670

PC3
  acc_x_dyn__approximate_entropy_0.1       0.5334
  acc_z_dyn__approximate_entropy_0.1       0.4731
  acc_x_dyn__cardinality                   0.2834
  acc_z_dyn__variance_of_absolute_differences 0.1920
  acc_z_dyn__quantile_0.6                  0.1725
  acc_x_dyn__harmonic_mean_of_abs          0.1714
  acc_z_dyn__lower_complete_moment         0.1714
  acc_y_dyn__tsallis_entropy               0.1689

PC4
  acc_z_dyn__quantile_0.6                  0.3846
  acc_z_dyn__lower_complete_moment         0.3714
  acc_y_dyn__quantile_0.4                  0.3440
  acc_y_dyn__quantile_0.3                  0.3047
  acc_y_dyn__tsallis_entropy               0.2827
  acc_z_dyn__variance_of_absolute_differences 0.2782
  acc_x_dyn__quantile_0.4                  0.2521
  acc_z_dyn__harmonic_mean_of_abs          0.2371

PC5
  acc_y_dyn__tsallis_entropy               0.4300
  acc_x_dyn__variance_of_absolute_differences 0.3984
  acc_z_dyn__harmonic_mean_of_abs          0.3418
  acc_z_dyn__quantile_0.4                  0.2772
  acc_x_dyn__max                           0.2513
  acc_y_dyn__quantile_0.4                  0.2404
  acc_y_dyn__quantile_0.3                  0.2153
  acc_z_dyn__katz_fractal_dimension        0.1832

PC6
  acc_y_dyn__tsallis_entropy               0.4420
  acc_y_dyn__quantile_0.4                  0.3743
  acc_x_dyn__harmonic_mean_of_abs          0.3401
  acc_x_dyn__quantile_0.6                  0.3329
  acc_y_dyn__variance_of_absolute_differences 0.3039
  acc_x_dyn__quantile_0.3                  0.2244
  acc_z_dyn__quantile_0.4                  0.2104
  acc_y_dyn__quantile_0.3                  0.1993

PC7
  acc_x_dyn__quantile_0.6                  0.5746
  acc_x_dyn__quantile_0.4                  0.4695
  acc_y_dyn__harmonic_mean_of_abs          0.3385
  acc_y_dyn__variance_of_absolute_differences 0.2402
  acc_x_dyn__quantile_0.3                  0.2047
  acc_z_dyn__lower_complete_moment         0.2011
  acc_y_dyn__avg_amplitude_change          0.1937
  acc_z_dyn__variance_of_absolute_differences 0.1620

PC8
  acc_x_dyn__harmonic_mean                 0.9679
  acc_z_dyn__quantile_0.4                  0.1339
  acc_z_dyn__harmonic_mean_of_abs          0.0962
  acc_x_dyn__variance_of_absolute_differences 0.0948
  acc_x_dyn__quantile_0.4                  0.0660
  acc_x_dyn__quantile_0.6                  0.0561
  acc_x_dyn__approximate_entropy_0.9       0.0493
  acc_x_dyn__max                           0.0459

Saved to: data/feature_extraction/analysis/quality_imu_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_2.0s.csv | rows=1875 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_features_2.0s.csv
Shape: (1875, 51)
Selected feature columns: 44
After NaN/variance filter: (1875, 43)
After correlation pruning: (1875, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.3959   (cum 0.3959)
   PC2: 0.1668   (cum 0.5626)
   PC3: 0.0945   (cum 0.6571)
   PC4: 0.0665   (cum 0.7236)
   PC5: 0.0553   (cum 0.7789)
   PC6: 0.0523   (cum 0.8311)
   PC7: 0.0506   (cum 0.8817)
   PC8: 0.0336   (cum 0.9154)
   PC9: 0.0247   (cum 0.9401)
  PC10: 0.0210   (cum 0.9611)
  PC11: 0.0139   (cum 0.9750)
  PC12: 0.0110   (cum 0.9859)
  PC13: 0.0068   (cum 0.9927)
  PC14: 0.0051   (cum 0.9978)
  PC15: 0.0016   (cum 0.9994)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p90_p10                        0.3580
  ppg_green_clearance_factor               0.3491
  ppg_green_crest_factor                   0.3342
  ppg_green_iqr                            0.3336
  ppg_green_tke_p95_abs                    0.3317
  ppg_green_tke_std                        0.3287
  ppg_green_mad                            0.3115
  ppg_green_shape_factor                   0.3010

PC2
  ppg_green_median                         0.5610
  ppg_green_p10                            0.5540
  ppg_green_p90                            0.5181
  ppg_green_mean_cross_rate                0.2359
  ppg_green_skew                           0.1524
  ppg_green_crest_factor                   0.0819
  ppg_green_clearance_factor               0.0810
  ppg_green_kurtosis                       0.0779

PC3
  ppg_green_kurtosis                       0.6017
  ppg_green_ddx_kurtosis                   0.4752
  ppg_green_dx_kurtosis                    0.4413
  ppg_green_iqr                            0.2119
  ppg_green_shape_factor                   0.1877
  ppg_green_mean_cross_rate                0.1717
  ppg_green_mad                            0.1668
  ppg_green_diff_mean                      0.1546

PC4
  ppg_green_diff_mean                      0.7407
  ppg_green_ddx_mean                       0.5189
  ppg_green_skew                           0.2025
  ppg_green_tke_p95_abs                    0.1949
  ppg_green_ddx_kurtosis                   0.1882
  ppg_green_kurtosis                       0.1216
  ppg_green_tke_std                        0.1144
  ppg_green_dx_kurtosis                    0.1096

PC5
  ppg_green_skew                           0.9034
  ppg_green_diff_mean                      0.2657
  ppg_green_crest_factor                   0.1608
  ppg_green_mean_cross_rate                0.1317
  ppg_green_mad                            0.1199
  ppg_green_kurtosis                       0.0991
  ppg_green_clearance_factor               0.0987
  ppg_green_p10                            0.0960

PC6
  ppg_green_mean_cross_rate                0.7110
  ppg_green_ddx_mean                       0.4528
  ppg_green_diff_mean                      0.3262
  ppg_green_tke_p95_abs                    0.2158
  ppg_green_ddx_kurtosis                   0.1923
  ppg_green_kurtosis                       0.1530
  ppg_green_median                         0.1348
  ppg_green_p90                            0.1146

PC7
  ppg_green_ddx_mean                       0.6917
  ppg_green_mean_cross_rate                0.4709
  ppg_green_ddx_kurtosis                   0.3344
  ppg_green_diff_mean                      0.2783
  ppg_green_skew                           0.1876
  ppg_green_dx_kurtosis                    0.1733
  ppg_green_shape_factor                   0.1296
  ppg_green_p10                            0.0892

PC8
  ppg_green_kurtosis                       0.5854
  ppg_green_ddx_kurtosis                   0.5168
  ppg_green_mean_cross_rate                0.3373
  ppg_green_mad                            0.2968
  ppg_green_shape_factor                   0.2494
  ppg_green_diff_mean                      0.2162
  ppg_green_clearance_factor               0.1837
  ppg_green_tke_std                        0.1087

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.3959   (cum 0.3959)
   PC2: 0.1668   (cum 0.5626)
   PC3: 0.0945   (cum 0.6571)
   PC4: 0.0665   (cum 0.7236)
   PC5: 0.0553   (cum 0.7789)
   PC6: 0.0523   (cum 0.8311)
   PC7: 0.0506   (cum 0.8817)
   PC8: 0.0336   (cum 0.9154)
   PC9: 0.0247   (cum 0.9401)
  PC10: 0.0210   (cum 0.9611)
  PC11: 0.0139   (cum 0.9750)
  PC12: 0.0110   (cum 0.9859)
  PC13: 0.0068   (cum 0.9927)
  PC14: 0.0051   (cum 0.9978)
  PC15: 0.0016   (cum 0.9994)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p90_p10                        0.3580
  ppg_green_clearance_factor               0.3491
  ppg_green_crest_factor                   0.3342
  ppg_green_iqr                            0.3336
  ppg_green_tke_p95_abs                    0.3317
  ppg_green_tke_std                        0.3287
  ppg_green_mad                            0.3115
  ppg_green_shape_factor                   0.3010

PC2
  ppg_green_median                         0.5610
  ppg_green_p10                            0.5540
  ppg_green_p90                            0.5181
  ppg_green_mean_cross_rate                0.2359
  ppg_green_skew                           0.1524
  ppg_green_crest_factor                   0.0819
  ppg_green_clearance_factor               0.0810
  ppg_green_kurtosis                       0.0779

PC3
  ppg_green_kurtosis                       0.6017
  ppg_green_ddx_kurtosis                   0.4752
  ppg_green_dx_kurtosis                    0.4413
  ppg_green_iqr                            0.2119
  ppg_green_shape_factor                   0.1877
  ppg_green_mean_cross_rate                0.1717
  ppg_green_mad                            0.1668
  ppg_green_diff_mean                      0.1546

PC4
  ppg_green_diff_mean                      0.7407
  ppg_green_ddx_mean                       0.5189
  ppg_green_skew                           0.2025
  ppg_green_tke_p95_abs                    0.1949
  ppg_green_ddx_kurtosis                   0.1882
  ppg_green_kurtosis                       0.1216
  ppg_green_tke_std                        0.1144
  ppg_green_dx_kurtosis                    0.1096

PC5
  ppg_green_skew                           0.9034
  ppg_green_diff_mean                      0.2657
  ppg_green_crest_factor                   0.1608
  ppg_green_mean_cross_rate                0.1317
  ppg_green_mad                            0.1199
  ppg_green_kurtosis                       0.0991
  ppg_green_clearance_factor               0.0987
  ppg_green_p10                            0.0960

PC6
  ppg_green_mean_cross_rate                0.7110
  ppg_green_ddx_mean                       0.4528
  ppg_green_diff_mean                      0.3262
  ppg_green_tke_p95_abs                    0.2158
  ppg_green_ddx_kurtosis                   0.1923
  ppg_green_kurtosis                       0.1530
  ppg_green_median                         0.1348
  ppg_green_p90                            0.1146

PC7
  ppg_green_ddx_mean                       0.6917
  ppg_green_mean_cross_rate                0.4709
  ppg_green_ddx_kurtosis                   0.3344
  ppg_green_diff_mean                      0.2783
  ppg_green_skew                           0.1876
  ppg_green_dx_kurtosis                    0.1733
  ppg_green_shape_factor                   0.1296
  ppg_green_p10                            0.0892

PC8
  ppg_green_kurtosis                       0.5854
  ppg_green_ddx_kurtosis                   0.5168
  ppg_green_mean_cross_rate                0.3373
  ppg_green_mad                            0.2968
  ppg_green_shape_factor                   0.2494
  ppg_green_diff_mean                      0.2162
  ppg_green_clearance_factor               0.1837
  ppg_green_tke_std                        0.1087

Saved to: data/feature_extraction/analysis/quality_ppg_green_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_2.0s.csv
Shape: (1875, 28)
Selected feature columns: 15
After NaN/variance filter: (1875, 2)
After correlation pruning: (1875, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8119   (cum 0.8119)
   PC2: 0.1881   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8119   (cum 0.8119)
   PC2: 0.1881   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_2.0s.csv | rows=1875 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_features_2.0s.csv
Shape: (1875, 51)
Selected feature columns: 44
After NaN/variance filter: (1875, 44)
After correlation pruning: (1875, 22)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3163   (cum 0.3163)
   PC2: 0.2060   (cum 0.5223)
   PC3: 0.1076   (cum 0.6299)
   PC4: 0.0862   (cum 0.7161)
   PC5: 0.0558   (cum 0.7719)
   PC6: 0.0495   (cum 0.8214)
   PC7: 0.0377   (cum 0.8592)
   PC8: 0.0316   (cum 0.8907)
   PC9: 0.0230   (cum 0.9138)
  PC10: 0.0194   (cum 0.9331)
  PC11: 0.0187   (cum 0.9518)
  PC12: 0.0111   (cum 0.9629)
  PC13: 0.0081   (cum 0.9710)
  PC14: 0.0077   (cum 0.9787)
  PC15: 0.0072   (cum 0.9859)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_ddx_std                        0.3550
  ppg_infra_max                            0.3489
  ppg_infra_signal_energy                  0.3429
  ppg_infra_tke_p95_abs                    0.3360
  ppg_infra_p10                            0.3306
  ppg_infra_tke_std                        0.3191
  ppg_infra_mad                            0.3126
  ppg_infra_dx_kurtosis                    0.2244

PC2
  ppg_infra_impulse_factor                 0.4259
  ppg_infra_kurtosis                       0.4007
  ppg_infra_shape_factor                   0.3959
  ppg_infra_crest_factor                   0.3794
  ppg_infra_clearance_factor               0.3435
  ppg_infra_dx_kurtosis                    0.2320
  ppg_infra_ddx_kurtosis                   0.1930
  ppg_infra_mad                            0.1647

PC3
  ppg_infra_mean                           0.5865
  ppg_infra_trim_mean_10                   0.5796
  ppg_infra_median                         0.3149
  ppg_infra_ddx_mean                       0.2539
  ppg_infra_mean_cross_rate                0.1972
  ppg_infra_zcr                            0.1869
  ppg_infra_diff_mean                      0.1416
  ppg_infra_ddx_kurtosis                   0.1330

PC4
  ppg_infra_zcr                            0.6339
  ppg_infra_mean_cross_rate                0.6319
  ppg_infra_mean                           0.2182
  ppg_infra_trim_mean_10                   0.2124
  ppg_infra_ddx_kurtosis                   0.2062
  ppg_infra_dx_kurtosis                    0.1389
  ppg_infra_ddx_mean                       0.1250
  ppg_infra_signal_energy                  0.0808

PC5
  ppg_infra_diff_mean                      0.6455
  ppg_infra_ddx_mean                       0.5739
  ppg_infra_skew                           0.3564
  ppg_infra_median                         0.2484
  ppg_infra_tke_p95_abs                    0.1140
  ppg_infra_max                            0.1098
  ppg_infra_zcr                            0.0849
  ppg_infra_tke_std                        0.0799

PC6
  ppg_infra_skew                           0.8277
  ppg_infra_diff_mean                      0.4460
  ppg_infra_median                         0.1474
  ppg_infra_crest_factor                   0.1284
  ppg_infra_ddx_mean                       0.1282
  ppg_infra_clearance_factor               0.1105
  ppg_infra_ddx_kurtosis                   0.1038
  ppg_infra_mean                           0.0872

PC7
  ppg_infra_ddx_kurtosis                   0.6555
  ppg_infra_dx_kurtosis                    0.4719
  ppg_infra_clearance_factor               0.3026
  ppg_infra_shape_factor                   0.2250
  ppg_infra_mean_cross_rate                0.2161
  ppg_infra_skew                           0.1623
  ppg_infra_tke_std                        0.1576
  ppg_infra_zcr                            0.1575

PC8
  ppg_infra_ddx_mean                       0.7445
  ppg_infra_diff_mean                      0.4966
  ppg_infra_trim_mean_10                   0.2738
  ppg_infra_mean                           0.2267
  ppg_infra_skew                           0.1424
  ppg_infra_tke_p95_abs                    0.1268
  ppg_infra_mad                            0.0898
  ppg_infra_tke_std                        0.0844

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3163   (cum 0.3163)
   PC2: 0.2060   (cum 0.5223)
   PC3: 0.1076   (cum 0.6299)
   PC4: 0.0862   (cum 0.7161)
   PC5: 0.0558   (cum 0.7719)
   PC6: 0.0495   (cum 0.8214)
   PC7: 0.0377   (cum 0.8592)
   PC8: 0.0316   (cum 0.8907)
   PC9: 0.0230   (cum 0.9138)
  PC10: 0.0194   (cum 0.9331)
  PC11: 0.0187   (cum 0.9518)
  PC12: 0.0111   (cum 0.9629)
  PC13: 0.0081   (cum 0.9710)
  PC14: 0.0077   (cum 0.9787)
  PC15: 0.0072   (cum 0.9859)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_ddx_std                        0.3550
  ppg_infra_max                            0.3489
  ppg_infra_signal_energy                  0.3429
  ppg_infra_tke_p95_abs                    0.3360
  ppg_infra_p10                            0.3306
  ppg_infra_tke_std                        0.3191
  ppg_infra_mad                            0.3126
  ppg_infra_dx_kurtosis                    0.2244

PC2
  ppg_infra_impulse_factor                 0.4259
  ppg_infra_kurtosis                       0.4007
  ppg_infra_shape_factor                   0.3959
  ppg_infra_crest_factor                   0.3794
  ppg_infra_clearance_factor               0.3435
  ppg_infra_dx_kurtosis                    0.2320
  ppg_infra_ddx_kurtosis                   0.1930
  ppg_infra_mad                            0.1647

PC3
  ppg_infra_mean                           0.5865
  ppg_infra_trim_mean_10                   0.5796
  ppg_infra_median                         0.3149
  ppg_infra_ddx_mean                       0.2539
  ppg_infra_mean_cross_rate                0.1972
  ppg_infra_zcr                            0.1869
  ppg_infra_diff_mean                      0.1416
  ppg_infra_ddx_kurtosis                   0.1330

PC4
  ppg_infra_zcr                            0.6339
  ppg_infra_mean_cross_rate                0.6319
  ppg_infra_mean                           0.2182
  ppg_infra_trim_mean_10                   0.2124
  ppg_infra_ddx_kurtosis                   0.2062
  ppg_infra_dx_kurtosis                    0.1389
  ppg_infra_ddx_mean                       0.1250
  ppg_infra_signal_energy                  0.0808

PC5
  ppg_infra_diff_mean                      0.6455
  ppg_infra_ddx_mean                       0.5739
  ppg_infra_skew                           0.3564
  ppg_infra_median                         0.2484
  ppg_infra_tke_p95_abs                    0.1140
  ppg_infra_max                            0.1098
  ppg_infra_zcr                            0.0849
  ppg_infra_tke_std                        0.0799

PC6
  ppg_infra_skew                           0.8277
  ppg_infra_diff_mean                      0.4460
  ppg_infra_median                         0.1474
  ppg_infra_crest_factor                   0.1284
  ppg_infra_ddx_mean                       0.1282
  ppg_infra_clearance_factor               0.1105
  ppg_infra_ddx_kurtosis                   0.1038
  ppg_infra_mean                           0.0872

PC7
  ppg_infra_ddx_kurtosis                   0.6555
  ppg_infra_dx_kurtosis                    0.4719
  ppg_infra_clearance_factor               0.3026
  ppg_infra_shape_factor                   0.2250
  ppg_infra_mean_cross_rate                0.2161
  ppg_infra_skew                           0.1623
  ppg_infra_tke_std                        0.1576
  ppg_infra_zcr                            0.1575

PC8
  ppg_infra_ddx_mean                       0.7445
  ppg_infra_diff_mean                      0.4966
  ppg_infra_trim_mean_10                   0.2738
  ppg_infra_mean                           0.2267
  ppg_infra_skew                           0.1424
  ppg_infra_tke_p95_abs                    0.1268
  ppg_infra_mad                            0.0898
  ppg_infra_tke_std                        0.0844

Saved to: data/feature_extraction/analysis/quality_ppg_infra_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_2.0s.csv
Shape: (1875, 28)
Selected feature columns: 15
After NaN/variance filter: (1875, 2)
After correlation pruning: (1875, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7702   (cum 0.7702)
   PC2: 0.2298   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7702   (cum 0.7702)
   PC2: 0.2298   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_2.0s.csv | rows=1875 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_features_2.0s.csv
Shape: (1875, 51)
Selected feature columns: 44
After NaN/variance filter: (1875, 44)
After correlation pruning: (1875, 22)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3052   (cum 0.3052)
   PC2: 0.2039   (cum 0.5090)
   PC3: 0.1051   (cum 0.6141)
   PC4: 0.0916   (cum 0.7057)
   PC5: 0.0553   (cum 0.7610)
   PC6: 0.0484   (cum 0.8094)
   PC7: 0.0424   (cum 0.8517)
   PC8: 0.0382   (cum 0.8899)
   PC9: 0.0272   (cum 0.9172)
  PC10: 0.0199   (cum 0.9371)
  PC11: 0.0165   (cum 0.9536)
  PC12: 0.0117   (cum 0.9653)
  PC13: 0.0089   (cum 0.9741)
  PC14: 0.0077   (cum 0.9818)
  PC15: 0.0066   (cum 0.9885)

Top PCA loadings per component (round 1):

PC1
  ppg_red_ddx_std                          0.3568
  ppg_red_signal_energy                    0.3526
  ppg_red_max                              0.3517
  ppg_red_p10                              0.3401
  ppg_red_mad                              0.3271
  ppg_red_p90                              0.3216
  ppg_red_tke_std                          0.3134
  ppg_red_dx_kurtosis                      0.2064

PC2
  ppg_red_impulse_factor                   0.4244
  ppg_red_kurtosis                         0.3933
  ppg_red_shape_factor                     0.3916
  ppg_red_crest_factor                     0.3824
  ppg_red_clearance_factor                 0.3625
  ppg_red_dx_kurtosis                      0.2355
  ppg_red_ddx_kurtosis                     0.1798
  ppg_red_mad                              0.1669

PC3
  ppg_red_mean                             0.5488
  ppg_red_trim_mean_10                     0.5419
  ppg_red_median                           0.4177
  ppg_red_diff_mean                        0.2657
  ppg_red_tke_std                          0.2199
  ppg_red_zcr                              0.1711
  ppg_red_mean_cross_rate                  0.1710
  ppg_red_p10                              0.1335

PC4
  ppg_red_zcr                              0.6215
  ppg_red_mean_cross_rate                  0.6183
  ppg_red_ddx_kurtosis                     0.2665
  ppg_red_mean                             0.2039
  ppg_red_dx_kurtosis                      0.1957
  ppg_red_trim_mean_10                     0.1917
  ppg_red_crest_factor                     0.1041
  ppg_red_signal_energy                    0.0938

PC5
  ppg_red_ddx_mean                         0.6337
  ppg_red_median                           0.3843
  ppg_red_skew                             0.3523
  ppg_red_trim_mean_10                     0.3394
  ppg_red_diff_mean                        0.2604
  ppg_red_p90                              0.2589
  ppg_red_mean                             0.2049
  ppg_red_mad                              0.1157

PC6
  ppg_red_skew                             0.8475
  ppg_red_ddx_mean                         0.3110
  ppg_red_diff_mean                        0.2152
  ppg_red_ddx_kurtosis                     0.1717
  ppg_red_trim_mean_10                     0.1485
  ppg_red_crest_factor                     0.1404
  ppg_red_clearance_factor                 0.1302
  ppg_red_dx_kurtosis                      0.1155

PC7
  ppg_red_diff_mean                        0.8071
  ppg_red_ddx_mean                         0.5151
  ppg_red_mean                             0.1898
  ppg_red_max                              0.1508
  ppg_red_trim_mean_10                     0.1241
  ppg_red_dx_kurtosis                      0.0520
  ppg_red_skew                             0.0407
  ppg_red_crest_factor                     0.0384

PC8
  ppg_red_ddx_kurtosis                     0.6349
  ppg_red_dx_kurtosis                      0.5016
  ppg_red_mean_cross_rate                  0.2956
  ppg_red_shape_factor                     0.2330
  ppg_red_zcr                              0.2120
  ppg_red_skew                             0.1779
  ppg_red_clearance_factor                 0.1682
  ppg_red_impulse_factor                   0.1591

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3052   (cum 0.3052)
   PC2: 0.2039   (cum 0.5090)
   PC3: 0.1051   (cum 0.6141)
   PC4: 0.0916   (cum 0.7057)
   PC5: 0.0553   (cum 0.7610)
   PC6: 0.0484   (cum 0.8094)
   PC7: 0.0424   (cum 0.8517)
   PC8: 0.0382   (cum 0.8899)
   PC9: 0.0272   (cum 0.9172)
  PC10: 0.0199   (cum 0.9371)
  PC11: 0.0165   (cum 0.9536)
  PC12: 0.0117   (cum 0.9653)
  PC13: 0.0089   (cum 0.9741)
  PC14: 0.0077   (cum 0.9818)
  PC15: 0.0066   (cum 0.9885)

Top PCA loadings per component (round 2):

PC1
  ppg_red_ddx_std                          0.3568
  ppg_red_signal_energy                    0.3526
  ppg_red_max                              0.3517
  ppg_red_p10                              0.3401
  ppg_red_mad                              0.3271
  ppg_red_p90                              0.3216
  ppg_red_tke_std                          0.3134
  ppg_red_dx_kurtosis                      0.2064

PC2
  ppg_red_impulse_factor                   0.4244
  ppg_red_kurtosis                         0.3933
  ppg_red_shape_factor                     0.3916
  ppg_red_crest_factor                     0.3824
  ppg_red_clearance_factor                 0.3625
  ppg_red_dx_kurtosis                      0.2355
  ppg_red_ddx_kurtosis                     0.1798
  ppg_red_mad                              0.1669

PC3
  ppg_red_mean                             0.5488
  ppg_red_trim_mean_10                     0.5419
  ppg_red_median                           0.4177
  ppg_red_diff_mean                        0.2657
  ppg_red_tke_std                          0.2199
  ppg_red_zcr                              0.1711
  ppg_red_mean_cross_rate                  0.1710
  ppg_red_p10                              0.1335

PC4
  ppg_red_zcr                              0.6215
  ppg_red_mean_cross_rate                  0.6183
  ppg_red_ddx_kurtosis                     0.2665
  ppg_red_mean                             0.2039
  ppg_red_dx_kurtosis                      0.1957
  ppg_red_trim_mean_10                     0.1917
  ppg_red_crest_factor                     0.1041
  ppg_red_signal_energy                    0.0938

PC5
  ppg_red_ddx_mean                         0.6337
  ppg_red_median                           0.3843
  ppg_red_skew                             0.3523
  ppg_red_trim_mean_10                     0.3394
  ppg_red_diff_mean                        0.2604
  ppg_red_p90                              0.2589
  ppg_red_mean                             0.2049
  ppg_red_mad                              0.1157

PC6
  ppg_red_skew                             0.8475
  ppg_red_ddx_mean                         0.3110
  ppg_red_diff_mean                        0.2152
  ppg_red_ddx_kurtosis                     0.1717
  ppg_red_trim_mean_10                     0.1485
  ppg_red_crest_factor                     0.1404
  ppg_red_clearance_factor                 0.1302
  ppg_red_dx_kurtosis                      0.1155

PC7
  ppg_red_diff_mean                        0.8071
  ppg_red_ddx_mean                         0.5151
  ppg_red_mean                             0.1898
  ppg_red_max                              0.1508
  ppg_red_trim_mean_10                     0.1241
  ppg_red_dx_kurtosis                      0.0520
  ppg_red_skew                             0.0407
  ppg_red_crest_factor                     0.0384

PC8
  ppg_red_ddx_kurtosis                     0.6349
  ppg_red_dx_kurtosis                      0.5016
  ppg_red_mean_cross_rate                  0.2956
  ppg_red_shape_factor                     0.2330
  ppg_red_zcr                              0.2120
  ppg_red_skew                             0.1779
  ppg_red_clearance_factor                 0.1682
  ppg_red_impulse_factor                   0.1591

Saved to: data/feature_extraction/analysis/quality_ppg_red_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_2.0s.csv
Shape: (1875, 28)
Selected feature columns: 15
After NaN/variance filter: (1875, 2)
After correlation pruning: (1875, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7953   (cum 0.7953)
   PC2: 0.2047   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7953   (cum 0.7953)
   PC2: 0.2047   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_2.0s.csv | rows=4468 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_features_2.0s.csv
Shape: (4468, 33)
Selected feature columns: 26
After NaN/variance filter: (4468, 26)
After correlation pruning: (4468, 10)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.3019   (cum 0.3019)
   PC2: 0.1701   (cum 0.4720)
   PC3: 0.1275   (cum 0.5994)
   PC4: 0.1031   (cum 0.7025)
   PC5: 0.0989   (cum 0.8014)
   PC6: 0.0776   (cum 0.8791)
   PC7: 0.0625   (cum 0.9416)
   PC8: 0.0287   (cum 0.9703)
   PC9: 0.0184   (cum 0.9887)
  PC10: 0.0113   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_cc_slope                             0.5016
  eda_cc_mad                               0.4837
  eda_stress_skin_min                      0.4707
  eda_stress_skin_mad                      0.3864
  eda_cc_min                               0.3359
  eda_stress_skin_slope                    0.1207
  eda_cc_kurtosis                          0.0837
  eda_stress_skin_kurtosis                 0.0799

PC2
  eda_stress_skin_skew                     0.7030
  eda_stress_skin_kurtosis                 0.6967
  eda_cc_min                               0.0840
  eda_cc_skew                              0.0745
  eda_cc_mad                               0.0629
  eda_cc_slope                             0.0502
  eda_cc_kurtosis                          0.0318
  eda_stress_skin_min                      0.0168

PC3
  eda_stress_skin_slope                    0.7043
  eda_stress_skin_mad                      0.5341
  eda_cc_min                               0.2926
  eda_cc_mad                               0.2244
  eda_cc_slope                             0.2084
  eda_cc_kurtosis                          0.1657
  eda_stress_skin_min                      0.0819
  eda_stress_skin_skew                     0.0557

PC4
  eda_cc_kurtosis                          0.7783
  eda_cc_skew                              0.5582
  eda_cc_min                               0.2475
  eda_cc_mad                               0.1031
  eda_cc_slope                             0.0533
  eda_stress_skin_kurtosis                 0.0483
  eda_stress_skin_min                      0.0482
  eda_stress_skin_mad                      0.0419

PC5
  eda_cc_skew                              0.8191
  eda_cc_kurtosis                          0.5229
  eda_cc_min                               0.1530
  eda_stress_skin_kurtosis                 0.1083
  eda_stress_skin_slope                    0.0876
  eda_stress_skin_min                      0.0653
  eda_cc_mad                               0.0634
  eda_cc_slope                             0.0518

PC6
  eda_stress_skin_slope                    0.6169
  eda_stress_skin_min                      0.4794
  eda_cc_min                               0.4663
  eda_stress_skin_mad                      0.3566
  eda_cc_slope                             0.1272
  eda_cc_mad                               0.1226
  eda_stress_skin_skew                     0.0844
  eda_cc_kurtosis                          0.0692

PC7
  eda_cc_min                               0.6611
  eda_cc_mad                               0.4737
  eda_cc_slope                             0.3945
  eda_stress_skin_min                      0.3013
  eda_cc_kurtosis                          0.2588
  eda_stress_skin_mad                      0.1245
  eda_stress_skin_skew                     0.0682
  eda_stress_skin_slope                    0.0575

PC8
  eda_stress_skin_kurtosis                 0.6898
  eda_stress_skin_skew                     0.6877
  eda_stress_skin_min                      0.1194
  eda_cc_min                               0.1117
  eda_cc_mad                               0.0929
  eda_cc_skew                              0.0923
  eda_stress_skin_mad                      0.0592
  eda_cc_slope                             0.0494

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.3019   (cum 0.3019)
   PC2: 0.1701   (cum 0.4720)
   PC3: 0.1275   (cum 0.5994)
   PC4: 0.1031   (cum 0.7025)
   PC5: 0.0989   (cum 0.8014)
   PC6: 0.0776   (cum 0.8791)
   PC7: 0.0625   (cum 0.9416)
   PC8: 0.0287   (cum 0.9703)
   PC9: 0.0184   (cum 0.9887)
  PC10: 0.0113   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_cc_slope                             0.5016
  eda_cc_mad                               0.4837
  eda_stress_skin_min                      0.4707
  eda_stress_skin_mad                      0.3864
  eda_cc_min                               0.3359
  eda_stress_skin_slope                    0.1207
  eda_cc_kurtosis                          0.0837
  eda_stress_skin_kurtosis                 0.0799

PC2
  eda_stress_skin_skew                     0.7030
  eda_stress_skin_kurtosis                 0.6967
  eda_cc_min                               0.0840
  eda_cc_skew                              0.0745
  eda_cc_mad                               0.0629
  eda_cc_slope                             0.0502
  eda_cc_kurtosis                          0.0318
  eda_stress_skin_min                      0.0168

PC3
  eda_stress_skin_slope                    0.7043
  eda_stress_skin_mad                      0.5341
  eda_cc_min                               0.2926
  eda_cc_mad                               0.2244
  eda_cc_slope                             0.2084
  eda_cc_kurtosis                          0.1657
  eda_stress_skin_min                      0.0819
  eda_stress_skin_skew                     0.0557

PC4
  eda_cc_kurtosis                          0.7783
  eda_cc_skew                              0.5582
  eda_cc_min                               0.2475
  eda_cc_mad                               0.1031
  eda_cc_slope                             0.0533
  eda_stress_skin_kurtosis                 0.0483
  eda_stress_skin_min                      0.0482
  eda_stress_skin_mad                      0.0419

PC5
  eda_cc_skew                              0.8191
  eda_cc_kurtosis                          0.5229
  eda_cc_min                               0.1530
  eda_stress_skin_kurtosis                 0.1083
  eda_stress_skin_slope                    0.0876
  eda_stress_skin_min                      0.0653
  eda_cc_mad                               0.0634
  eda_cc_slope                             0.0518

PC6
  eda_stress_skin_slope                    0.6169
  eda_stress_skin_min                      0.4794
  eda_cc_min                               0.4663
  eda_stress_skin_mad                      0.3566
  eda_cc_slope                             0.1272
  eda_cc_mad                               0.1226
  eda_stress_skin_skew                     0.0844
  eda_cc_kurtosis                          0.0692

PC7
  eda_cc_min                               0.6611
  eda_cc_mad                               0.4737
  eda_cc_slope                             0.3945
  eda_stress_skin_min                      0.3013
  eda_cc_kurtosis                          0.2588
  eda_stress_skin_mad                      0.1245
  eda_stress_skin_skew                     0.0682
  eda_stress_skin_slope                    0.0575

PC8
  eda_stress_skin_kurtosis                 0.6898
  eda_stress_skin_skew                     0.6877
  eda_stress_skin_min                      0.1194
  eda_cc_min                               0.1117
  eda_cc_mad                               0.0929
  eda_cc_skew                              0.0923
  eda_stress_skin_mad                      0.0592
  eda_cc_slope                             0.0494

Saved to: data/feature_extraction/analysis/quality_eda_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_2.0s.csv
Shape: (4468, 28)
Selected feature columns: 21
After NaN/variance filter: (4468, 15)
After correlation pruning: (4468, 4)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6802   (cum 0.6802)
   PC2: 0.2110   (cum 0.8912)
   PC3: 0.0869   (cum 0.9781)
   PC4: 0.0219   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scl_slope                            0.5876
  eda_scl_range                            0.5451
  eda_scr_rate                             0.4877
  eda_scl_min                              0.3460

PC2
  eda_scl_min                              0.8705
  eda_scr_rate                             0.4855
  eda_scl_range                            0.0630
  eda_scl_slope                            0.0511

PC3
  eda_scl_range                            0.6987
  eda_scr_rate                             0.6439
  eda_scl_min                              0.3047
  eda_scl_slope                            0.0657

PC4
  eda_scl_slope                            0.8048
  eda_scl_range                            0.4590
  eda_scr_rate                             0.3343
  eda_scl_min                              0.1725

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6802   (cum 0.6802)
   PC2: 0.2110   (cum 0.8912)
   PC3: 0.0869   (cum 0.9781)
   PC4: 0.0219   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scl_slope                            0.5876
  eda_scl_range                            0.5451
  eda_scr_rate                             0.4877
  eda_scl_min                              0.3460

PC2
  eda_scl_min                              0.8705
  eda_scr_rate                             0.4855
  eda_scl_range                            0.0630
  eda_scl_slope                            0.0511

PC3
  eda_scl_range                            0.6987
  eda_scr_rate                             0.6439
  eda_scl_min                              0.3047
  eda_scl_slope                            0.0657

PC4
  eda_scl_slope                            0.8048
  eda_scl_range                            0.4590
  eda_scr_rate                             0.3343
  eda_scl_min                              0.1725

Saved to: data/feature_extraction/analysis/quality_eda_advanced_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_5.0s.csv | windows=755 | features=21
    ✓ HRV features: 755 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_aligned_5.0s.csv (755 windows | borg labeled: 267)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_aligned_5.0s.csv (755 windows | borg labeled: 267)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_5.0s.csv | windows=755 | features=21
    ✓ HRV features: 755 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_aligned_5.0s.csv (755 windows | borg labeled: 267)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 755
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_aligned_5.0s.csv (755 windows | borg labeled: 267)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_5.0s.csv | windows=1799 | features=21
    ✓ Advanced EDA features: 1799 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1799
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_aligned_5.0s.csv (1799 windows | borg labeled: 273)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1799
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_aligned_5.0s.csv (1799 windows | borg labeled: 273)

▶ Window length: 2.0s | overlap=0.1
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1902
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/imu_wrist/imu_aligned_2.0s.csv (1902 windows | borg labeled: 671)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_features_2.0s.csv | windows=1875 | features=21
    ✓ HRV features: 1875 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_green/ppg_green_hrv_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_features_2.0s.csv | windows=1875 | features=21
    ✓ HRV features: 1875 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_infra/ppg_infra_hrv_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_features_2.0s.csv | windows=1875 | features=21
    ✓ HRV features: 1875 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1875
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/ppg_red/ppg_red_hrv_aligned_2.0s.csv (1875 windows | borg labeled: 668)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_features_2.0s.csv | windows=4468 | features=21
    ✓ Advanced EDA features: 4468 windows
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 4468
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_aligned_2.0s.csv (4468 windows | borg labeled: 671)
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 4468
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/eda/eda_advanced_aligned_2.0s.csv (4468 windows | borg labeled: 671)

▶ Fusion step
  Running fusion...

▶ Fusing features for window length: 10.0s
  Loaded eda: 899 windows | t_center min=1764821401.000 max=1764829483.000 n=899
  Loaded eda_advanced: 899 windows | t_center min=1764821401.000 max=1764829483.000 n=899
  Loaded imu_bioz: 891 windows | t_center min=1764821437.000 max=1764829447.000 n=891
  Loaded imu_wrist: 383 windows | t_center min=1764826033.000 max=1764829471.000 n=383
  Loaded ppg_green: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Loaded ppg_green_hrv: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Loaded ppg_infra: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Loaded ppg_infra_hrv: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Loaded ppg_red: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Loaded ppg_red_hrv: 377 windows | t_center min=1764825796.000 max=1764829180.000 n=377
  Dropped 12 invalid feature columns
  ✓ Wrote 0 fused windows → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_features_10.0s.csv

▶ Fusing features for window length: 5.0s
  Loaded eda: 1799 windows | t_center min=1764821398.500 max=1764829489.500 n=1799
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
  Loaded eda_advanced: 1799 windows | t_center min=1764821398.500 max=1764829489.500 n=1799
  Loaded imu_bioz: 1783 windows | t_center min=1764821434.500 max=1764829453.500 n=1783
  Loaded imu_wrist: 766 windows | t_center min=1764826030.500 max=1764829473.000 n=766
  Loaded ppg_green: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Loaded ppg_green_hrv: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Loaded ppg_infra: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Loaded ppg_infra_hrv: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Loaded ppg_red: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Loaded ppg_red_hrv: 755 windows | t_center min=1764825793.500 max=1764829186.500 n=755
  Dropped 36 invalid feature columns
  ✓ Wrote 755 fused windows → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_features_5.0s.csv

▶ Fusing features for window length: 2.0s
  Loaded eda: 4468 windows | t_center min=1764821397.000 max=1764829493.438 n=4468
  Loaded eda_advanced: 4468 windows | t_center min=1764821397.000 max=1764829493.438 n=4468
  Loaded imu_bioz: 4428 windows | t_center min=1764821433.000 max=1764829456.938 n=4428
  Loaded imu_wrist: 1902 windows | t_center min=1764826029.000 max=1764829474.562 n=1902
  Loaded ppg_green: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Loaded ppg_green_hrv: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Loaded ppg_infra: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Loaded ppg_infra_hrv: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Loaded ppg_red: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Loaded ppg_red_hrv: 1875 windows | t_center min=1764825792.000 max=1764829188.625 n=1875
  Dropped 75 invalid feature columns
  ✓ Wrote 1876 fused windows → /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_features_2.0s.csv
  ✓ Fusion complete

▶ Aligning fused features with Borg effort labels
  Aligning fused features (10.0s windows)...
  ⚠ No data in features file (0 rows), skipping alignment
  Aligning fused features (5.0s windows)...
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 1783
  Windows in ADL time range: 366
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_aligned_5.0s.csv (366 windows | borg labeled: 273)
  Aligning fused features (2.0s windows)...
  ADL recording time: 1764827496.0 to 1764829143.6
  Windows before filtering: 4428
  Windows in ADL time range: 909
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_aligned_2.0s.csv (909 windows | borg labeled: 670)

▶ Feature selection with correlation pruning + quality checks
  Running feature selection (5.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (5.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_aligned_5.0s.csv
  ✓ Loaded 273 labeled samples
  ✓ 248 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 218, Test: 55

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 28, IMU: 11, PPG: 61

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 5, IMU: 10, PPG: 16
  ✓ Total: 31 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 15, 'pcs_for_95pct': 19, 'pcs_for_99pct': 26}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/feature_selection_qc/qc_5.0s/features_filtered_5.0s.csv
    → 31 features + 2 metadata columns
    → 273 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_5.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (5.0s)
  Running feature selection (2.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (2.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_aligned_2.0s.csv
  ✓ Loaded 670 labeled samples
  ✓ 209 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 536, Test: 134

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 28, IMU: 9, PPG: 63

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 5, IMU: 9, PPG: 14
  ✓ Total: 28 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 14, 'pcs_for_95pct': 17, 'pcs_for_99pct': 23}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/feature_selection_qc/qc_2.0s/features_filtered_2.0s.csv
    → 28 features + 2 metadata columns
    → 670 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_2.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (2.0s)
[manual_features_imu] processed 200/327 windows
[manual_features_imu] processed 200/654 windows
[manual_features_imu] processed 400/654 windows
[manual_features_imu] processed 600/654 windows
[manual_features_imu] processed 200/1624 windows
[manual_features_imu] processed 400/1624 windows
[manual_features_imu] processed 600/1624 windows
[manual_features_imu] processed 800/1624 windows
[manual_features_imu] processed 1000/1624 windows
[manual_features_imu] processed 1200/1624 windows
[manual_features_imu] processed 1400/1624 windows
[manual_features_imu] processed 1600/1624 windows
[manual_features_imu] processed 200/391 windows
[manual_features_imu] processed 200/782 windows
[manual_features_imu] processed 400/782 windows
[manual_features_imu] processed 600/782 windows
[manual_features_imu] processed 200/1943 windows
[manual_features_imu] processed 400/1943 windows
[manual_features_imu] processed 600/1943 windows
[manual_features_imu] processed 800/1943 windows
[manual_features_imu] processed 1000/1943 windows
[manual_features_imu] processed 1200/1943 windows
[manual_features_imu] processed 1400/1943 windows
[manual_features_imu] processed 1600/1943 windows
[manual_features_imu] processed 1800/1943 windows
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_features_10.0s.csv
Shape: (391, 39)
Selected feature columns: 30
After NaN/variance filter: (391, 29)
After correlation pruning: (391, 29)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 1):
   PC1: 0.5179   (cum 0.5179)
   PC2: 0.1644   (cum 0.6823)
   PC3: 0.0649   (cum 0.7472)
   PC4: 0.0435   (cum 0.7907)
   PC5: 0.0346   (cum 0.8253)
   PC6: 0.0262   (cum 0.8515)
   PC7: 0.0206   (cum 0.8721)
   PC8: 0.0190   (cum 0.8911)
   PC9: 0.0157   (cum 0.9069)
  PC10: 0.0143   (cum 0.9211)
  PC11: 0.0112   (cum 0.9323)
  PC12: 0.0098   (cum 0.9421)
  PC13: 0.0081   (cum 0.9502)
  PC14: 0.0069   (cum 0.9571)
  PC15: 0.0061   (cum 0.9632)

Top PCA loadings per component (round 1):

PC1
  acc_x_dyn__quantile_0.3                  0.2310
  acc_z_dyn__sum_of_absolute_changes       0.2295
  acc_y_dyn__avg_amplitude_change          0.2221
  acc_x_dyn__quantile_0.9                  0.2193
  acc_y_dyn__quantile_0.3                  0.2122
  acc_x_dyn__harmonic_mean_of_abs          0.2072
  acc_z_dyn__quantile_0.4                  0.2053
  acc_z_dyn__quantile_0.6                  0.2038

PC2
  acc_y_dyn__sample_entropy                0.3177
  acc_x_dyn__approximate_entropy_0.1       0.3063
  acc_x_dyn__sample_entropy                0.3063
  acc_z_dyn__approximate_entropy_0.1       0.2937
  acc_z_dyn__sample_entropy                0.2865
  acc_y_dyn__katz_fractal_dimension        0.2179
  acc_x_dyn__approximate_entropy_0.9       0.2118
  acc_z_dyn__katz_fractal_dimension        0.2065

PC3
  acc_z_dyn__variance_of_absolute_differences 0.3817
  acc_y_dyn__quantile_0.4                  0.3434
  acc_z_dyn__lower_complete_moment         0.3172
  acc_y_dyn__harmonic_mean_of_abs          0.3015
  acc_y_dyn__quantile_0.3                  0.2756
  acc_x_dyn__variance_of_absolute_differences 0.2624
  acc_x_dyn__harmonic_mean_of_abs          0.2481
  acc_y_dyn__tsallis_entropy               0.2386

PC4
  acc_y_dyn__tsallis_entropy               0.5505
  acc_x_dyn__cardinality                   0.5491
  acc_x_dyn__max                           0.2841
  acc_z_dyn__lower_complete_moment         0.2384
  acc_z_dyn__quantile_0.6                  0.2270
  acc_z_dyn__harmonic_mean_of_abs          0.1670
  acc_z_dyn__variance_of_absolute_differences 0.1595
  acc_z_dyn__katz_fractal_dimension        0.1541

PC5
  acc_y_dyn__variance_of_absolute_differences 0.3530
  acc_y_dyn__katz_fractal_dimension        0.3241
  acc_y_dyn__avg_amplitude_change          0.3057
  acc_x_dyn__max                           0.2932
  acc_x_dyn__katz_fractal_dimension        0.2771
  acc_x_dyn__approximate_entropy_0.1       0.2470
  acc_z_dyn__quantile_0.6                  0.2296
  acc_x_dyn__cardinality                   0.2152

PC6
  acc_x_dyn__quantile_0.4                  0.4240
  acc_x_dyn__variance_of_absolute_differences 0.3234
  acc_y_dyn__harmonic_mean_of_abs          0.2819
  acc_x_dyn__cardinality                   0.2665
  acc_x_dyn__quantile_0.6                  0.2652
  acc_z_dyn__lower_complete_moment         0.2549
  acc_z_dyn__harmonic_mean_of_abs          0.2359
  acc_y_dyn__tsallis_entropy               0.2120

PC7
  acc_z_dyn__harmonic_mean_of_abs          0.3696
  acc_z_dyn__quantile_0.6                  0.3394
  acc_x_dyn__variance_of_absolute_differences 0.3156
  acc_z_dyn__variance_of_absolute_differences 0.3103
  acc_x_dyn__approximate_entropy_0.1       0.2879
  acc_y_dyn__variance_of_absolute_differences 0.2583
  acc_z_dyn__approximate_entropy_0.1       0.2499
  acc_x_dyn__katz_fractal_dimension        0.2484

PC8
  acc_z_dyn__quantile_0.4                  0.5824
  acc_z_dyn__harmonic_mean_of_abs          0.3413
  acc_y_dyn__quantile_0.4                  0.2466
  acc_x_dyn__quantile_0.4                  0.2201
  acc_x_dyn__quantile_0.3                  0.2198
  acc_z_dyn__lower_complete_moment         0.2137
  acc_y_dyn__variance_of_absolute_differences 0.2015
  acc_x_dyn__quantile_0.6                  0.1959

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 13
  pcs_for_99pct: 22

Explained variance per PC (round 2):
   PC1: 0.5179   (cum 0.5179)
   PC2: 0.1644   (cum 0.6823)
   PC3: 0.0649   (cum 0.7472)
   PC4: 0.0435   (cum 0.7907)
   PC5: 0.0346   (cum 0.8253)
   PC6: 0.0262   (cum 0.8515)
   PC7: 0.0206   (cum 0.8721)
   PC8: 0.0190   (cum 0.8911)
   PC9: 0.0157   (cum 0.9069)
  PC10: 0.0143   (cum 0.9211)
  PC11: 0.0112   (cum 0.9323)
  PC12: 0.0098   (cum 0.9421)
  PC13: 0.0081   (cum 0.9502)
  PC14: 0.0069   (cum 0.9571)
  PC15: 0.0061   (cum 0.9632)

Top PCA loadings per component (round 2):

PC1
  acc_x_dyn__quantile_0.3                  0.2310
  acc_z_dyn__sum_of_absolute_changes       0.2295
  acc_y_dyn__avg_amplitude_change          0.2221
  acc_x_dyn__quantile_0.9                  0.2193
  acc_y_dyn__quantile_0.3                  0.2122
  acc_x_dyn__harmonic_mean_of_abs          0.2072
  acc_z_dyn__quantile_0.4                  0.2053
  acc_z_dyn__quantile_0.6                  0.2038

PC2
  acc_y_dyn__sample_entropy                0.3177
  acc_x_dyn__approximate_entropy_0.1       0.3063
  acc_x_dyn__sample_entropy                0.3063
  acc_z_dyn__approximate_entropy_0.1       0.2937
  acc_z_dyn__sample_entropy                0.2865
  acc_y_dyn__katz_fractal_dimension        0.2179
  acc_x_dyn__approximate_entropy_0.9       0.2118
  acc_z_dyn__katz_fractal_dimension        0.2065

PC3
  acc_z_dyn__variance_of_absolute_differences 0.3817
  acc_y_dyn__quantile_0.4                  0.3434
  acc_z_dyn__lower_complete_moment         0.3172
  acc_y_dyn__harmonic_mean_of_abs          0.3015
  acc_y_dyn__quantile_0.3                  0.2756
  acc_x_dyn__variance_of_absolute_differences 0.2624
  acc_x_dyn__harmonic_mean_of_abs          0.2481
  acc_y_dyn__tsallis_entropy               0.2386

PC4
  acc_y_dyn__tsallis_entropy               0.5505
  acc_x_dyn__cardinality                   0.5491
  acc_x_dyn__max                           0.2841
  acc_z_dyn__lower_complete_moment         0.2384
  acc_z_dyn__quantile_0.6                  0.2270
  acc_z_dyn__harmonic_mean_of_abs          0.1670
  acc_z_dyn__variance_of_absolute_differences 0.1595
  acc_z_dyn__katz_fractal_dimension        0.1541

PC5
  acc_y_dyn__variance_of_absolute_differences 0.3530
  acc_y_dyn__katz_fractal_dimension        0.3241
  acc_y_dyn__avg_amplitude_change          0.3057
  acc_x_dyn__max                           0.2932
  acc_x_dyn__katz_fractal_dimension        0.2771
  acc_x_dyn__approximate_entropy_0.1       0.2470
  acc_z_dyn__quantile_0.6                  0.2296
  acc_x_dyn__cardinality                   0.2152

PC6
  acc_x_dyn__quantile_0.4                  0.4240
  acc_x_dyn__variance_of_absolute_differences 0.3234
  acc_y_dyn__harmonic_mean_of_abs          0.2819
  acc_x_dyn__cardinality                   0.2665
  acc_x_dyn__quantile_0.6                  0.2652
  acc_z_dyn__lower_complete_moment         0.2549
  acc_z_dyn__harmonic_mean_of_abs          0.2359
  acc_y_dyn__tsallis_entropy               0.2120

PC7
  acc_z_dyn__harmonic_mean_of_abs          0.3696
  acc_z_dyn__quantile_0.6                  0.3394
  acc_x_dyn__variance_of_absolute_differences 0.3156
  acc_z_dyn__variance_of_absolute_differences 0.3103
  acc_x_dyn__approximate_entropy_0.1       0.2879
  acc_y_dyn__variance_of_absolute_differences 0.2583
  acc_z_dyn__approximate_entropy_0.1       0.2499
  acc_x_dyn__katz_fractal_dimension        0.2484

PC8
  acc_z_dyn__quantile_0.4                  0.5824
  acc_z_dyn__harmonic_mean_of_abs          0.3413
  acc_y_dyn__quantile_0.4                  0.2466
  acc_x_dyn__quantile_0.4                  0.2201
  acc_x_dyn__quantile_0.3                  0.2198
  acc_z_dyn__lower_complete_moment         0.2137
  acc_y_dyn__variance_of_absolute_differences 0.2015
  acc_x_dyn__quantile_0.6                  0.1959

Saved to: data/feature_extraction/analysis/quality_imu_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_10.0s.csv | rows=396 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_10.0s.csv
Shape: (396, 51)
Selected feature columns: 44
After NaN/variance filter: (396, 43)
After correlation pruning: (396, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.4641   (cum 0.4641)
   PC2: 0.1724   (cum 0.6365)
   PC3: 0.0869   (cum 0.7233)
   PC4: 0.0608   (cum 0.7841)
   PC5: 0.0453   (cum 0.8294)
   PC6: 0.0436   (cum 0.8730)
   PC7: 0.0356   (cum 0.9086)
   PC8: 0.0273   (cum 0.9360)
   PC9: 0.0181   (cum 0.9541)
  PC10: 0.0159   (cum 0.9700)
  PC11: 0.0097   (cum 0.9797)
  PC12: 0.0086   (cum 0.9882)
  PC13: 0.0038   (cum 0.9920)
  PC14: 0.0033   (cum 0.9954)
  PC15: 0.0018   (cum 0.9971)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3111
  ppg_green_std                            0.3110
  ppg_green_clearance_factor               0.2913
  ppg_green_diff_mean_abs                  0.2910
  ppg_green_p95_p5                         0.2683
  ppg_green_shape_factor                   0.2677
  ppg_green_p90_p10                        0.2555
  ppg_green_tke_p95_abs                    0.2527

PC2
  ppg_green_p99                            0.4043
  ppg_green_p10                            0.3718
  ppg_green_p95                            0.3225
  ppg_green_kurtosis                       0.3043
  ppg_green_tke_std                        0.2685
  ppg_green_iqr                            0.2656
  ppg_green_dx_kurtosis                    0.2627
  ppg_green_mad                            0.2561

PC3
  ppg_green_p95                            0.5316
  ppg_green_mean_cross_rate                0.4219
  ppg_green_p10                            0.3289
  ppg_green_iqr                            0.2687
  ppg_green_p99                            0.2532
  ppg_green_mad                            0.2273
  ppg_green_p90_p10                        0.2102
  ppg_green_kurtosis                       0.1958

PC4
  ppg_green_diff_mean                      0.6116
  ppg_green_ddx_mean                       0.5789
  ppg_green_mean_cross_rate                0.3262
  ppg_green_shape_factor                   0.2152
  ppg_green_tke_p95_abs                    0.1896
  ppg_green_tke_std                        0.1505
  ppg_green_clearance_factor               0.1357
  ppg_green_skew                           0.1135

PC5
  ppg_green_mean_cross_rate                0.6866
  ppg_green_diff_mean                      0.3514
  ppg_green_ddx_mean                       0.3061
  ppg_green_p95                            0.2852
  ppg_green_tke_p95_abs                    0.2683
  ppg_green_diff_mean_abs                  0.2218
  ppg_green_p10                            0.2011
  ppg_green_p99                            0.1195

PC6
  ppg_green_ddx_kurtosis                   0.6477
  ppg_green_diff_mean                      0.4065
  ppg_green_dx_kurtosis                    0.3628
  ppg_green_skew                           0.2725
  ppg_green_shape_factor                   0.2173
  ppg_green_ddx_mean                       0.2041
  ppg_green_clearance_factor               0.1875
  ppg_green_tke_std                        0.1817

PC7
  ppg_green_ddx_mean                       0.6929
  ppg_green_diff_mean                      0.5566
  ppg_green_ddx_kurtosis                   0.3718
  ppg_green_dx_kurtosis                    0.1868
  ppg_green_kurtosis                       0.0887
  ppg_green_shape_factor                   0.0884
  ppg_green_clearance_factor               0.0718
  ppg_green_p99                            0.0540

PC8
  ppg_green_skew                           0.7853
  ppg_green_kurtosis                       0.3775
  ppg_green_mad                            0.2550
  ppg_green_iqr                            0.1933
  ppg_green_shape_factor                   0.1916
  ppg_green_dx_kurtosis                    0.1430
  ppg_green_tke_p95_abs                    0.1394
  ppg_green_mean_cross_rate                0.1044

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.4641   (cum 0.4641)
   PC2: 0.1724   (cum 0.6365)
   PC3: 0.0869   (cum 0.7233)
   PC4: 0.0608   (cum 0.7841)
   PC5: 0.0453   (cum 0.8294)
   PC6: 0.0436   (cum 0.8730)
   PC7: 0.0356   (cum 0.9086)
   PC8: 0.0273   (cum 0.9360)
   PC9: 0.0181   (cum 0.9541)
  PC10: 0.0159   (cum 0.9700)
  PC11: 0.0097   (cum 0.9797)
  PC12: 0.0086   (cum 0.9882)
  PC13: 0.0038   (cum 0.9920)
  PC14: 0.0033   (cum 0.9954)
  PC15: 0.0018   (cum 0.9971)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3111
  ppg_green_std                            0.3110
  ppg_green_clearance_factor               0.2913
  ppg_green_diff_mean_abs                  0.2910
  ppg_green_p95_p5                         0.2683
  ppg_green_shape_factor                   0.2677
  ppg_green_p90_p10                        0.2555
  ppg_green_tke_p95_abs                    0.2527

PC2
  ppg_green_p99                            0.4043
  ppg_green_p10                            0.3718
  ppg_green_p95                            0.3225
  ppg_green_kurtosis                       0.3043
  ppg_green_tke_std                        0.2685
  ppg_green_iqr                            0.2656
  ppg_green_dx_kurtosis                    0.2627
  ppg_green_mad                            0.2561

PC3
  ppg_green_p95                            0.5316
  ppg_green_mean_cross_rate                0.4219
  ppg_green_p10                            0.3289
  ppg_green_iqr                            0.2687
  ppg_green_p99                            0.2532
  ppg_green_mad                            0.2273
  ppg_green_p90_p10                        0.2102
  ppg_green_kurtosis                       0.1958

PC4
  ppg_green_diff_mean                      0.6116
  ppg_green_ddx_mean                       0.5789
  ppg_green_mean_cross_rate                0.3262
  ppg_green_shape_factor                   0.2152
  ppg_green_tke_p95_abs                    0.1896
  ppg_green_tke_std                        0.1505
  ppg_green_clearance_factor               0.1357
  ppg_green_skew                           0.1135

PC5
  ppg_green_mean_cross_rate                0.6866
  ppg_green_diff_mean                      0.3514
  ppg_green_ddx_mean                       0.3061
  ppg_green_p95                            0.2852
  ppg_green_tke_p95_abs                    0.2683
  ppg_green_diff_mean_abs                  0.2218
  ppg_green_p10                            0.2011
  ppg_green_p99                            0.1195

PC6
  ppg_green_ddx_kurtosis                   0.6477
  ppg_green_diff_mean                      0.4065
  ppg_green_dx_kurtosis                    0.3628
  ppg_green_skew                           0.2725
  ppg_green_shape_factor                   0.2173
  ppg_green_ddx_mean                       0.2041
  ppg_green_clearance_factor               0.1875
  ppg_green_tke_std                        0.1817

PC7
  ppg_green_ddx_mean                       0.6929
  ppg_green_diff_mean                      0.5566
  ppg_green_ddx_kurtosis                   0.3718
  ppg_green_dx_kurtosis                    0.1868
  ppg_green_kurtosis                       0.0887
  ppg_green_shape_factor                   0.0884
  ppg_green_clearance_factor               0.0718
  ppg_green_p99                            0.0540

PC8
  ppg_green_skew                           0.7853
  ppg_green_kurtosis                       0.3775
  ppg_green_mad                            0.2550
  ppg_green_iqr                            0.1933
  ppg_green_shape_factor                   0.1916
  ppg_green_dx_kurtosis                    0.1430
  ppg_green_tke_p95_abs                    0.1394
  ppg_green_mean_cross_rate                0.1044

Saved to: data/feature_extraction/analysis/quality_ppg_green_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_10.0s.csv
Shape: (396, 28)
Selected feature columns: 21
After NaN/variance filter: (396, 2)
After correlation pruning: (396, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7616   (cum 0.7616)
   PC2: 0.2384   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7616   (cum 0.7616)
   PC2: 0.2384   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_10.0s.csv | rows=396 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_10.0s.csv
Shape: (396, 51)
Selected feature columns: 44
After NaN/variance filter: (396, 44)
After correlation pruning: (396, 23)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 1):
   PC1: 0.3422   (cum 0.3422)
   PC2: 0.1949   (cum 0.5371)
   PC3: 0.0954   (cum 0.6326)
   PC4: 0.0840   (cum 0.7165)
   PC5: 0.0527   (cum 0.7692)
   PC6: 0.0496   (cum 0.8189)
   PC7: 0.0420   (cum 0.8609)
   PC8: 0.0312   (cum 0.8921)
   PC9: 0.0262   (cum 0.9183)
  PC10: 0.0216   (cum 0.9400)
  PC11: 0.0131   (cum 0.9531)
  PC12: 0.0097   (cum 0.9627)
  PC13: 0.0085   (cum 0.9713)
  PC14: 0.0069   (cum 0.9782)
  PC15: 0.0056   (cum 0.9838)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_p5                             0.3424
  ppg_infra_diff_mean_abs                  0.3361
  ppg_infra_signal_energy                  0.3325
  ppg_infra_min                            0.3301
  ppg_infra_p90                            0.3289
  ppg_infra_tke_mean                       0.3275
  ppg_infra_max                            0.3247
  ppg_infra_iqr                            0.3132

PC2
  ppg_infra_kurtosis                       0.4310
  ppg_infra_shape_factor                   0.4264
  ppg_infra_crest_factor                   0.4173
  ppg_infra_clearance_factor               0.3955
  ppg_infra_dx_kurtosis                    0.3428
  ppg_infra_ddx_kurtosis                   0.2889
  ppg_infra_iqr                            0.1499
  ppg_infra_p90                            0.1119

PC3
  ppg_infra_trim_mean_10                   0.5582
  ppg_infra_mean                           0.4815
  ppg_infra_median                         0.4286
  ppg_infra_ddx_mean                       0.2962
  ppg_infra_skew                           0.2263
  ppg_infra_zcr                            0.1929
  ppg_infra_mean_cross_rate                0.1880
  ppg_infra_tke_std                        0.1168

PC4
  ppg_infra_mean_cross_rate                0.6479
  ppg_infra_zcr                            0.6425
  ppg_infra_mean                           0.1936
  ppg_infra_ddx_mean                       0.1927
  ppg_infra_crest_factor                   0.1445
  ppg_infra_trim_mean_10                   0.1340
  ppg_infra_dx_mean                        0.1096
  ppg_infra_kurtosis                       0.1018

PC5
  ppg_infra_dx_mean                        0.7351
  ppg_infra_ddx_mean                       0.5301
  ppg_infra_trim_mean_10                   0.2592
  ppg_infra_median                         0.1306
  ppg_infra_skew                           0.1302
  ppg_infra_ddx_kurtosis                   0.1123
  ppg_infra_max                            0.1068
  ppg_infra_mean                           0.1067

PC6
  ppg_infra_skew                           0.7994
  ppg_infra_mean                           0.4853
  ppg_infra_max                            0.1661
  ppg_infra_dx_mean                        0.1604
  ppg_infra_min                            0.1141
  ppg_infra_crest_factor                   0.1065
  ppg_infra_ddx_mean                       0.0985
  ppg_infra_median                         0.0949

PC7
  ppg_infra_dx_kurtosis                    0.5130
  ppg_infra_ddx_kurtosis                   0.5098
  ppg_infra_clearance_factor               0.3390
  ppg_infra_tke_std                        0.2942
  ppg_infra_shape_factor                   0.2918
  ppg_infra_kurtosis                       0.1961
  ppg_infra_signal_energy                  0.1528
  ppg_infra_median                         0.1517

PC8
  ppg_infra_median                         0.7343
  ppg_infra_ddx_mean                       0.3669
  ppg_infra_dx_mean                        0.3106
  ppg_infra_skew                           0.2659
  ppg_infra_trim_mean_10                   0.2244
  ppg_infra_p90                            0.1721
  ppg_infra_tke_std                        0.1628
  ppg_infra_mean                           0.0997

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 2):
   PC1: 0.3422   (cum 0.3422)
   PC2: 0.1949   (cum 0.5371)
   PC3: 0.0954   (cum 0.6326)
   PC4: 0.0840   (cum 0.7165)
   PC5: 0.0527   (cum 0.7692)
   PC6: 0.0496   (cum 0.8189)
   PC7: 0.0420   (cum 0.8609)
   PC8: 0.0312   (cum 0.8921)
   PC9: 0.0262   (cum 0.9183)
  PC10: 0.0216   (cum 0.9400)
  PC11: 0.0131   (cum 0.9531)
  PC12: 0.0097   (cum 0.9627)
  PC13: 0.0085   (cum 0.9713)
  PC14: 0.0069   (cum 0.9782)
  PC15: 0.0056   (cum 0.9838)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_p5                             0.3424
  ppg_infra_diff_mean_abs                  0.3361
  ppg_infra_signal_energy                  0.3325
  ppg_infra_min                            0.3301
  ppg_infra_p90                            0.3289
  ppg_infra_tke_mean                       0.3275
  ppg_infra_max                            0.3247
  ppg_infra_iqr                            0.3132

PC2
  ppg_infra_kurtosis                       0.4310
  ppg_infra_shape_factor                   0.4264
  ppg_infra_crest_factor                   0.4173
  ppg_infra_clearance_factor               0.3955
  ppg_infra_dx_kurtosis                    0.3428
  ppg_infra_ddx_kurtosis                   0.2889
  ppg_infra_iqr                            0.1499
  ppg_infra_p90                            0.1119

PC3
  ppg_infra_trim_mean_10                   0.5582
  ppg_infra_mean                           0.4815
  ppg_infra_median                         0.4286
  ppg_infra_ddx_mean                       0.2962
  ppg_infra_skew                           0.2263
  ppg_infra_zcr                            0.1929
  ppg_infra_mean_cross_rate                0.1880
  ppg_infra_tke_std                        0.1168

PC4
  ppg_infra_mean_cross_rate                0.6479
  ppg_infra_zcr                            0.6425
  ppg_infra_mean                           0.1936
  ppg_infra_ddx_mean                       0.1927
  ppg_infra_crest_factor                   0.1445
  ppg_infra_trim_mean_10                   0.1340
  ppg_infra_dx_mean                        0.1096
  ppg_infra_kurtosis                       0.1018

PC5
  ppg_infra_dx_mean                        0.7351
  ppg_infra_ddx_mean                       0.5301
  ppg_infra_trim_mean_10                   0.2592
  ppg_infra_median                         0.1306
  ppg_infra_skew                           0.1302
  ppg_infra_ddx_kurtosis                   0.1123
  ppg_infra_max                            0.1068
  ppg_infra_mean                           0.1067

PC6
  ppg_infra_skew                           0.7994
  ppg_infra_mean                           0.4853
  ppg_infra_max                            0.1661
  ppg_infra_dx_mean                        0.1604
  ppg_infra_min                            0.1141
  ppg_infra_crest_factor                   0.1065
  ppg_infra_ddx_mean                       0.0985
  ppg_infra_median                         0.0949

PC7
  ppg_infra_dx_kurtosis                    0.5130
  ppg_infra_ddx_kurtosis                   0.5098
  ppg_infra_clearance_factor               0.3390
  ppg_infra_tke_std                        0.2942
  ppg_infra_shape_factor                   0.2918
  ppg_infra_kurtosis                       0.1961
  ppg_infra_signal_energy                  0.1528
  ppg_infra_median                         0.1517

PC8
  ppg_infra_median                         0.7343
  ppg_infra_ddx_mean                       0.3669
  ppg_infra_dx_mean                        0.3106
  ppg_infra_skew                           0.2659
  ppg_infra_trim_mean_10                   0.2244
  ppg_infra_p90                            0.1721
  ppg_infra_tke_std                        0.1628
  ppg_infra_mean                           0.0997

Saved to: data/feature_extraction/analysis/quality_ppg_infra_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_10.0s.csv
Shape: (396, 28)
Selected feature columns: 21
After NaN/variance filter: (396, 14)
After correlation pruning: (396, 11)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.4149   (cum 0.4149)
   PC2: 0.3039   (cum 0.7188)
   PC3: 0.1040   (cum 0.8228)
   PC4: 0.0737   (cum 0.8965)
   PC5: 0.0367   (cum 0.9331)
   PC6: 0.0301   (cum 0.9632)
   PC7: 0.0202   (cum 0.9835)
   PC8: 0.0072   (cum 0.9907)
   PC9: 0.0053   (cum 0.9960)
  PC10: 0.0034   (cum 0.9994)
  PC11: 0.0006   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_median                      0.3970
  ppg_infra_sdnn                           0.3844
  ppg_infra_rmssd                          0.3842
  ppg_infra_mean_ibi                       0.3818
  ppg_infra_pnn50                          0.3590
  ppg_infra_n_peaks                        0.3423
  ppg_infra_pnn20                          0.2686
  ppg_infra_cv_ibi                         0.2124

PC2
  ppg_infra_hr_std                         0.5269
  ppg_infra_hr_range                       0.4783
  ppg_infra_cv_ibi                         0.4728
  ppg_infra_sdnn                           0.2457
  ppg_infra_rmssd                          0.2324
  ppg_infra_mean_ibi                       0.2314
  ppg_infra_hr_median                      0.2078
  ppg_infra_n_peaks                        0.1767

PC3
  ppg_infra_peak_quality                   0.8023
  ppg_infra_pnn20                          0.3614
  ppg_infra_mean_ibi                       0.2679
  ppg_infra_sdnn                           0.1855
  ppg_infra_n_peaks                        0.1824
  ppg_infra_rmssd                          0.1718
  ppg_infra_pnn50                          0.1670
  ppg_infra_hr_std                         0.1197

PC4
  ppg_infra_pnn20                          0.7213
  ppg_infra_peak_quality                   0.4821
  ppg_infra_pnn50                          0.2876
  ppg_infra_sdnn                           0.2420
  ppg_infra_rmssd                          0.2085
  ppg_infra_cv_ibi                         0.1762
  ppg_infra_hr_range                       0.1686
  ppg_infra_mean_ibi                       0.0435

PC5
  ppg_infra_n_peaks                        0.8765
  ppg_infra_pnn50                          0.2939
  ppg_infra_peak_quality                   0.2346
  ppg_infra_mean_ibi                       0.1813
  ppg_infra_hr_median                      0.1715
  ppg_infra_hr_std                         0.1069
  ppg_infra_cv_ibi                         0.0929
  ppg_infra_rmssd                          0.0502

PC6
  ppg_infra_pnn50                          0.7925
  ppg_infra_pnn20                          0.5070
  ppg_infra_sdnn                           0.2077
  ppg_infra_n_peaks                        0.1795
  ppg_infra_rmssd                          0.1186
  ppg_infra_peak_quality                   0.0855
  ppg_infra_cv_ibi                         0.0827
  ppg_infra_mean_ibi                       0.0785

PC7
  ppg_infra_hr_median                      0.6140
  ppg_infra_hr_range                       0.4913
  ppg_infra_rmssd                          0.4283
  ppg_infra_mean_ibi                       0.2814
  ppg_infra_hr_std                         0.2200
  ppg_infra_sdnn                           0.1409
  ppg_infra_pnn50                          0.1339
  ppg_infra_pnn20                          0.1155

PC8
  ppg_infra_mean_ibi                       0.5494
  ppg_infra_hr_range                       0.4703
  ppg_infra_hr_median                      0.4391
  ppg_infra_cv_ibi                         0.3581
  ppg_infra_rmssd                          0.3109
  ppg_infra_peak_quality                   0.1750
  ppg_infra_sdnn                           0.1223
  ppg_infra_n_peaks                        0.0998

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.4149   (cum 0.4149)
   PC2: 0.3039   (cum 0.7188)
   PC3: 0.1040   (cum 0.8228)
   PC4: 0.0737   (cum 0.8965)
   PC5: 0.0367   (cum 0.9331)
   PC6: 0.0301   (cum 0.9632)
   PC7: 0.0202   (cum 0.9835)
   PC8: 0.0072   (cum 0.9907)
   PC9: 0.0053   (cum 0.9960)
  PC10: 0.0034   (cum 0.9994)
  PC11: 0.0006   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_median                      0.3970
  ppg_infra_sdnn                           0.3844
  ppg_infra_rmssd                          0.3842
  ppg_infra_mean_ibi                       0.3818
  ppg_infra_pnn50                          0.3590
  ppg_infra_n_peaks                        0.3423
  ppg_infra_pnn20                          0.2686
  ppg_infra_cv_ibi                         0.2124

PC2
  ppg_infra_hr_std                         0.5269
  ppg_infra_hr_range                       0.4783
  ppg_infra_cv_ibi                         0.4728
  ppg_infra_sdnn                           0.2457
  ppg_infra_rmssd                          0.2324
  ppg_infra_mean_ibi                       0.2314
  ppg_infra_hr_median                      0.2078
  ppg_infra_n_peaks                        0.1767

PC3
  ppg_infra_peak_quality                   0.8023
  ppg_infra_pnn20                          0.3614
  ppg_infra_mean_ibi                       0.2679
  ppg_infra_sdnn                           0.1855
  ppg_infra_n_peaks                        0.1824
  ppg_infra_rmssd                          0.1718
  ppg_infra_pnn50                          0.1670
  ppg_infra_hr_std                         0.1197

PC4
  ppg_infra_pnn20                          0.7213
  ppg_infra_peak_quality                   0.4821
  ppg_infra_pnn50                          0.2876
  ppg_infra_sdnn                           0.2420
  ppg_infra_rmssd                          0.2085
  ppg_infra_cv_ibi                         0.1762
  ppg_infra_hr_range                       0.1686
  ppg_infra_mean_ibi                       0.0435

PC5
  ppg_infra_n_peaks                        0.8765
  ppg_infra_pnn50                          0.2939
  ppg_infra_peak_quality                   0.2346
  ppg_infra_mean_ibi                       0.1813
  ppg_infra_hr_median                      0.1715
  ppg_infra_hr_std                         0.1069
  ppg_infra_cv_ibi                         0.0929
  ppg_infra_rmssd                          0.0502

PC6
  ppg_infra_pnn50                          0.7925
  ppg_infra_pnn20                          0.5070
  ppg_infra_sdnn                           0.2077
  ppg_infra_n_peaks                        0.1795
  ppg_infra_rmssd                          0.1186
  ppg_infra_peak_quality                   0.0855
  ppg_infra_cv_ibi                         0.0827
  ppg_infra_mean_ibi                       0.0785

PC7
  ppg_infra_hr_median                      0.6140
  ppg_infra_hr_range                       0.4913
  ppg_infra_rmssd                          0.4283
  ppg_infra_mean_ibi                       0.2814
  ppg_infra_hr_std                         0.2200
  ppg_infra_sdnn                           0.1409
  ppg_infra_pnn50                          0.1339
  ppg_infra_pnn20                          0.1155

PC8
  ppg_infra_mean_ibi                       0.5494
  ppg_infra_hr_range                       0.4703
  ppg_infra_hr_median                      0.4391
  ppg_infra_cv_ibi                         0.3581
  ppg_infra_rmssd                          0.3109
  ppg_infra_peak_quality                   0.1750
  ppg_infra_sdnn                           0.1223
  ppg_infra_n_peaks                        0.0998

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_10.0s.csv | rows=396 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_10.0s.csv
Shape: (396, 51)
Selected feature columns: 44
After NaN/variance filter: (396, 44)
After correlation pruning: (396, 25)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3465   (cum 0.3465)
   PC2: 0.2156   (cum 0.5620)
   PC3: 0.0854   (cum 0.6474)
   PC4: 0.0774   (cum 0.7248)
   PC5: 0.0480   (cum 0.7728)
   PC6: 0.0454   (cum 0.8181)
   PC7: 0.0423   (cum 0.8604)
   PC8: 0.0306   (cum 0.8910)
   PC9: 0.0288   (cum 0.9198)
  PC10: 0.0242   (cum 0.9441)
  PC11: 0.0120   (cum 0.9560)
  PC12: 0.0101   (cum 0.9661)
  PC13: 0.0085   (cum 0.9746)
  PC14: 0.0062   (cum 0.9808)
  PC15: 0.0057   (cum 0.9866)

Top PCA loadings per component (round 1):

PC1
  ppg_red_min                              0.3248
  ppg_red_p99                              0.3201
  ppg_red_p95                              0.3188
  ppg_red_ddx_std                          0.3164
  ppg_red_max                              0.3158
  ppg_red_tke_mean                         0.3120
  ppg_red_diff_mean_abs                    0.3114
  ppg_red_signal_energy                    0.3053

PC2
  ppg_red_impulse_factor                   0.4127
  ppg_red_kurtosis                         0.3971
  ppg_red_shape_factor                     0.3912
  ppg_red_crest_factor                     0.3781
  ppg_red_clearance_factor                 0.3749
  ppg_red_dx_kurtosis                      0.2912
  ppg_red_ddx_kurtosis                     0.2614
  ppg_red_iqr                              0.1601

PC3
  ppg_red_trim_mean_10                     0.5977
  ppg_red_mean                             0.5740
  ppg_red_median                           0.3940
  ppg_red_ddx_mean                         0.3253
  ppg_red_skew                             0.1212
  ppg_red_dx_mean                          0.1103
  ppg_red_ddx_kurtosis                     0.0677
  ppg_red_mean_cross_rate                  0.0609

PC4
  ppg_red_zcr                              0.6610
  ppg_red_mean_cross_rate                  0.6401
  ppg_red_skew                             0.1945
  ppg_red_tke_mean                         0.1431
  ppg_red_tke_std                          0.1401
  ppg_red_ddx_std                          0.1297
  ppg_red_crest_factor                     0.0971
  ppg_red_kurtosis                         0.0967

PC5
  ppg_red_skew                             0.6771
  ppg_red_dx_mean                          0.4974
  ppg_red_mean                             0.3717
  ppg_red_max                              0.1729
  ppg_red_p99                              0.1388
  ppg_red_median                           0.1362
  ppg_red_mean_cross_rate                  0.1309
  ppg_red_zcr                              0.1136

PC6
  ppg_red_ddx_mean                         0.4952
  ppg_red_dx_kurtosis                      0.3920
  ppg_red_ddx_kurtosis                     0.3867
  ppg_red_dx_mean                          0.2997
  ppg_red_shape_factor                     0.2393
  ppg_red_skew                             0.2174
  ppg_red_clearance_factor                 0.2081
  ppg_red_tke_std                          0.1921

PC7
  ppg_red_dx_mean                          0.5603
  ppg_red_dx_kurtosis                      0.4214
  ppg_red_ddx_kurtosis                     0.4056
  ppg_red_skew                             0.3160
  ppg_red_ddx_mean                         0.3089
  ppg_red_clearance_factor                 0.1970
  ppg_red_trim_mean_10                     0.1676
  ppg_red_mean_cross_rate                  0.1390

PC8
  ppg_red_median                           0.7432
  ppg_red_skew                             0.3779
  ppg_red_ddx_mean                         0.3656
  ppg_red_dx_mean                          0.2750
  ppg_red_trim_mean_10                     0.1832
  ppg_red_ddx_kurtosis                     0.1511
  ppg_red_dx_kurtosis                      0.1220
  ppg_red_max                              0.0609

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 25
Stage 2: selected features: 25 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3465   (cum 0.3465)
   PC2: 0.2156   (cum 0.5620)
   PC3: 0.0854   (cum 0.6474)
   PC4: 0.0774   (cum 0.7248)
   PC5: 0.0480   (cum 0.7728)
   PC6: 0.0454   (cum 0.8181)
   PC7: 0.0423   (cum 0.8604)
   PC8: 0.0306   (cum 0.8910)
   PC9: 0.0288   (cum 0.9198)
  PC10: 0.0242   (cum 0.9441)
  PC11: 0.0120   (cum 0.9560)
  PC12: 0.0101   (cum 0.9661)
  PC13: 0.0085   (cum 0.9746)
  PC14: 0.0062   (cum 0.9808)
  PC15: 0.0057   (cum 0.9866)

Top PCA loadings per component (round 2):

PC1
  ppg_red_min                              0.3248
  ppg_red_p99                              0.3201
  ppg_red_p95                              0.3188
  ppg_red_ddx_std                          0.3164
  ppg_red_max                              0.3158
  ppg_red_tke_mean                         0.3120
  ppg_red_diff_mean_abs                    0.3114
  ppg_red_signal_energy                    0.3053

PC2
  ppg_red_impulse_factor                   0.4127
  ppg_red_kurtosis                         0.3971
  ppg_red_shape_factor                     0.3912
  ppg_red_crest_factor                     0.3781
  ppg_red_clearance_factor                 0.3749
  ppg_red_dx_kurtosis                      0.2912
  ppg_red_ddx_kurtosis                     0.2614
  ppg_red_iqr                              0.1601

PC3
  ppg_red_trim_mean_10                     0.5977
  ppg_red_mean                             0.5740
  ppg_red_median                           0.3940
  ppg_red_ddx_mean                         0.3253
  ppg_red_skew                             0.1212
  ppg_red_dx_mean                          0.1103
  ppg_red_ddx_kurtosis                     0.0677
  ppg_red_mean_cross_rate                  0.0609

PC4
  ppg_red_zcr                              0.6610
  ppg_red_mean_cross_rate                  0.6401
  ppg_red_skew                             0.1945
  ppg_red_tke_mean                         0.1431
  ppg_red_tke_std                          0.1401
  ppg_red_ddx_std                          0.1297
  ppg_red_crest_factor                     0.0971
  ppg_red_kurtosis                         0.0967

PC5
  ppg_red_skew                             0.6771
  ppg_red_dx_mean                          0.4974
  ppg_red_mean                             0.3717
  ppg_red_max                              0.1729
  ppg_red_p99                              0.1388
  ppg_red_median                           0.1362
  ppg_red_mean_cross_rate                  0.1309
  ppg_red_zcr                              0.1136

PC6
  ppg_red_ddx_mean                         0.4952
  ppg_red_dx_kurtosis                      0.3920
  ppg_red_ddx_kurtosis                     0.3867
  ppg_red_dx_mean                          0.2997
  ppg_red_shape_factor                     0.2393
  ppg_red_skew                             0.2174
  ppg_red_clearance_factor                 0.2081
  ppg_red_tke_std                          0.1921

PC7
  ppg_red_dx_mean                          0.5603
  ppg_red_dx_kurtosis                      0.4214
  ppg_red_ddx_kurtosis                     0.4056
  ppg_red_skew                             0.3160
  ppg_red_ddx_mean                         0.3089
  ppg_red_clearance_factor                 0.1970
  ppg_red_trim_mean_10                     0.1676
  ppg_red_mean_cross_rate                  0.1390

PC8
  ppg_red_median                           0.7432
  ppg_red_skew                             0.3779
  ppg_red_ddx_mean                         0.3656
  ppg_red_dx_mean                          0.2750
  ppg_red_trim_mean_10                     0.1832
  ppg_red_ddx_kurtosis                     0.1511
  ppg_red_dx_kurtosis                      0.1220
  ppg_red_max                              0.0609

Saved to: data/feature_extraction/analysis/quality_ppg_red_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_10.0s.csv
Shape: (396, 28)
Selected feature columns: 21
After NaN/variance filter: (396, 14)
After correlation pruning: (396, 11)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.3852   (cum 0.3852)
   PC2: 0.3189   (cum 0.7041)
   PC3: 0.1004   (cum 0.8045)
   PC4: 0.0917   (cum 0.8963)
   PC5: 0.0378   (cum 0.9341)
   PC6: 0.0328   (cum 0.9669)
   PC7: 0.0165   (cum 0.9834)
   PC8: 0.0067   (cum 0.9901)
   PC9: 0.0057   (cum 0.9958)
  PC10: 0.0034   (cum 0.9992)
  PC11: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_mean_ibi                         0.4333
  ppg_red_hr_median                        0.4303
  ppg_red_rmssd                            0.3718
  ppg_red_sdnn                             0.3624
  ppg_red_n_peaks                          0.3394
  ppg_red_pnn50                            0.2817
  ppg_red_hr_range                         0.2550
  ppg_red_pnn20                            0.1895

PC2
  ppg_red_cv_ibi                           0.4903
  ppg_red_hr_std                           0.4811
  ppg_red_hr_range                         0.4140
  ppg_red_sdnn                             0.3034
  ppg_red_rmssd                            0.2921
  ppg_red_pnn50                            0.2494
  ppg_red_pnn20                            0.1966
  ppg_red_hr_median                        0.1712

PC3
  ppg_red_peak_quality                     0.8935
  ppg_red_n_peaks                          0.3505
  ppg_red_hr_range                         0.1726
  ppg_red_mean_ibi                         0.1340
  ppg_red_cv_ibi                           0.1167
  ppg_red_pnn20                            0.0698
  ppg_red_pnn50                            0.0691
  ppg_red_hr_std                           0.0684

PC4
  ppg_red_pnn20                            0.7561
  ppg_red_pnn50                            0.4567
  ppg_red_sdnn                             0.2925
  ppg_red_cv_ibi                           0.2211
  ppg_red_rmssd                            0.1957
  ppg_red_mean_ibi                         0.1550
  ppg_red_hr_median                        0.1008
  ppg_red_n_peaks                          0.0770

PC5
  ppg_red_n_peaks                          0.7914
  ppg_red_peak_quality                     0.3107
  ppg_red_pnn20                            0.3100
  ppg_red_hr_median                        0.2337
  ppg_red_mean_ibi                         0.1970
  ppg_red_pnn50                            0.1779
  ppg_red_hr_std                           0.1726
  ppg_red_sdnn                             0.1161

PC6
  ppg_red_pnn50                            0.7734
  ppg_red_pnn20                            0.4989
  ppg_red_n_peaks                          0.2680
  ppg_red_peak_quality                     0.2108
  ppg_red_sdnn                             0.1363
  ppg_red_cv_ibi                           0.0839
  ppg_red_hr_median                        0.0724
  ppg_red_hr_range                         0.0627

PC7
  ppg_red_hr_range                         0.5827
  ppg_red_hr_median                        0.5281
  ppg_red_rmssd                            0.4710
  ppg_red_mean_ibi                         0.3121
  ppg_red_hr_std                           0.1716
  ppg_red_n_peaks                          0.1245
  ppg_red_sdnn                             0.1099
  ppg_red_peak_quality                     0.0668

PC8
  ppg_red_hr_range                         0.5469
  ppg_red_rmssd                            0.4740
  ppg_red_cv_ibi                           0.4179
  ppg_red_hr_median                        0.3131
  ppg_red_mean_ibi                         0.2686
  ppg_red_hr_std                           0.2585
  ppg_red_peak_quality                     0.1991
  ppg_red_n_peaks                          0.1363

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.3852   (cum 0.3852)
   PC2: 0.3189   (cum 0.7041)
   PC3: 0.1004   (cum 0.8045)
   PC4: 0.0917   (cum 0.8963)
   PC5: 0.0378   (cum 0.9341)
   PC6: 0.0328   (cum 0.9669)
   PC7: 0.0165   (cum 0.9834)
   PC8: 0.0067   (cum 0.9901)
   PC9: 0.0057   (cum 0.9958)
  PC10: 0.0034   (cum 0.9992)
  PC11: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_mean_ibi                         0.4333
  ppg_red_hr_median                        0.4303
  ppg_red_rmssd                            0.3718
  ppg_red_sdnn                             0.3624
  ppg_red_n_peaks                          0.3394
  ppg_red_pnn50                            0.2817
  ppg_red_hr_range                         0.2550
  ppg_red_pnn20                            0.1895

PC2
  ppg_red_cv_ibi                           0.4903
  ppg_red_hr_std                           0.4811
  ppg_red_hr_range                         0.4140
  ppg_red_sdnn                             0.3034
  ppg_red_rmssd                            0.2921
  ppg_red_pnn50                            0.2494
  ppg_red_pnn20                            0.1966
  ppg_red_hr_median                        0.1712

PC3
  ppg_red_peak_quality                     0.8935
  ppg_red_n_peaks                          0.3505
  ppg_red_hr_range                         0.1726
  ppg_red_mean_ibi                         0.1340
  ppg_red_cv_ibi                           0.1167
  ppg_red_pnn20                            0.0698
  ppg_red_pnn50                            0.0691
  ppg_red_hr_std                           0.0684

PC4
  ppg_red_pnn20                            0.7561
  ppg_red_pnn50                            0.4567
  ppg_red_sdnn                             0.2925
  ppg_red_cv_ibi                           0.2211
  ppg_red_rmssd                            0.1957
  ppg_red_mean_ibi                         0.1550
  ppg_red_hr_median                        0.1008
  ppg_red_n_peaks                          0.0770

PC5
  ppg_red_n_peaks                          0.7914
  ppg_red_peak_quality                     0.3107
  ppg_red_pnn20                            0.3100
  ppg_red_hr_median                        0.2337
  ppg_red_mean_ibi                         0.1970
  ppg_red_pnn50                            0.1779
  ppg_red_hr_std                           0.1726
  ppg_red_sdnn                             0.1161

PC6
  ppg_red_pnn50                            0.7734
  ppg_red_pnn20                            0.4989
  ppg_red_n_peaks                          0.2680
  ppg_red_peak_quality                     0.2108
  ppg_red_sdnn                             0.1363
  ppg_red_cv_ibi                           0.0839
  ppg_red_hr_median                        0.0724
  ppg_red_hr_range                         0.0627

PC7
  ppg_red_hr_range                         0.5827
  ppg_red_hr_median                        0.5281
  ppg_red_rmssd                            0.4710
  ppg_red_mean_ibi                         0.3121
  ppg_red_hr_std                           0.1716
  ppg_red_n_peaks                          0.1245
  ppg_red_sdnn                             0.1099
  ppg_red_peak_quality                     0.0668

PC8
  ppg_red_hr_range                         0.5469
  ppg_red_rmssd                            0.4740
  ppg_red_cv_ibi                           0.4179
  ppg_red_hr_median                        0.3131
  ppg_red_mean_ibi                         0.2686
  ppg_red_hr_std                           0.2585
  ppg_red_peak_quality                     0.1991
  ppg_red_n_peaks                          0.1363

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_10.0s.csv | rows=377 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_10.0s.csv
Shape: (377, 33)
Selected feature columns: 26
After NaN/variance filter: (377, 26)
After correlation pruning: (377, 10)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.2412   (cum 0.2412)
   PC2: 0.1557   (cum 0.3969)
   PC3: 0.1294   (cum 0.5263)
   PC4: 0.1124   (cum 0.6387)
   PC5: 0.0989   (cum 0.7376)
   PC6: 0.0872   (cum 0.8249)
   PC7: 0.0694   (cum 0.8942)
   PC8: 0.0524   (cum 0.9466)
   PC9: 0.0312   (cum 0.9779)
  PC10: 0.0221   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mad                      0.5410
  eda_stress_skin_min                      0.5022
  eda_stress_skin_slope                    0.4010
  eda_stress_skin_kurtosis                 0.3603
  eda_stress_skin_skew                     0.2479
  eda_cc_slope                             0.2397
  eda_cc_max                               0.2026
  eda_cc_kurtosis                          0.0502

PC2
  eda_stress_skin_skew                     0.5838
  eda_stress_skin_kurtosis                 0.5671
  eda_cc_max                               0.3993
  eda_cc_slope                             0.2727
  eda_stress_skin_slope                    0.2725
  eda_cc_mean_abs_diff                     0.1148
  eda_stress_skin_mad                      0.1033
  eda_stress_skin_min                      0.0623

PC3
  eda_cc_max                               0.5304
  eda_cc_slope                             0.5241
  eda_stress_skin_skew                     0.3071
  eda_cc_skew                              0.3011
  eda_stress_skin_mad                      0.2875
  eda_stress_skin_slope                    0.2416
  eda_stress_skin_min                      0.2183
  eda_cc_kurtosis                          0.2089

PC4
  eda_cc_mean_abs_diff                     0.6743
  eda_cc_kurtosis                          0.6084
  eda_cc_skew                              0.3041
  eda_stress_skin_slope                    0.2105
  eda_cc_slope                             0.1369
  eda_stress_skin_kurtosis                 0.1195
  eda_stress_skin_mad                      0.0519
  eda_stress_skin_skew                     0.0462

PC5
  eda_cc_skew                              0.7603
  eda_cc_kurtosis                          0.4842
  eda_cc_slope                             0.3277
  eda_cc_mean_abs_diff                     0.2020
  eda_stress_skin_slope                    0.1302
  eda_cc_max                               0.1255
  eda_stress_skin_skew                     0.0567
  eda_stress_skin_mad                      0.0465

PC6
  eda_cc_mean_abs_diff                     0.6741
  eda_cc_kurtosis                          0.5200
  eda_cc_skew                              0.4830
  eda_stress_skin_skew                     0.1213
  eda_cc_max                               0.0978
  eda_stress_skin_slope                    0.0890
  eda_stress_skin_mad                      0.0758
  eda_cc_slope                             0.0456

PC7
  eda_stress_skin_slope                    0.5664
  eda_cc_slope                             0.4376
  eda_cc_max                               0.4231
  eda_stress_skin_min                      0.3223
  eda_stress_skin_skew                     0.3103
  eda_cc_kurtosis                          0.2592
  eda_stress_skin_mad                      0.1841
  eda_cc_mean_abs_diff                     0.0713

PC8
  eda_stress_skin_min                      0.6012
  eda_cc_slope                             0.4618
  eda_cc_max                               0.4579
  eda_stress_skin_slope                    0.4217
  eda_stress_skin_mad                      0.1500
  eda_cc_mean_abs_diff                     0.0736
  eda_cc_kurtosis                          0.0720
  eda_stress_skin_kurtosis                 0.0642

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.2412   (cum 0.2412)
   PC2: 0.1557   (cum 0.3969)
   PC3: 0.1294   (cum 0.5263)
   PC4: 0.1124   (cum 0.6387)
   PC5: 0.0989   (cum 0.7376)
   PC6: 0.0872   (cum 0.8249)
   PC7: 0.0694   (cum 0.8942)
   PC8: 0.0524   (cum 0.9466)
   PC9: 0.0312   (cum 0.9779)
  PC10: 0.0221   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mad                      0.5410
  eda_stress_skin_min                      0.5022
  eda_stress_skin_slope                    0.4010
  eda_stress_skin_kurtosis                 0.3603
  eda_stress_skin_skew                     0.2479
  eda_cc_slope                             0.2397
  eda_cc_max                               0.2026
  eda_cc_kurtosis                          0.0502

PC2
  eda_stress_skin_skew                     0.5838
  eda_stress_skin_kurtosis                 0.5671
  eda_cc_max                               0.3993
  eda_cc_slope                             0.2727
  eda_stress_skin_slope                    0.2725
  eda_cc_mean_abs_diff                     0.1148
  eda_stress_skin_mad                      0.1033
  eda_stress_skin_min                      0.0623

PC3
  eda_cc_max                               0.5304
  eda_cc_slope                             0.5241
  eda_stress_skin_skew                     0.3071
  eda_cc_skew                              0.3011
  eda_stress_skin_mad                      0.2875
  eda_stress_skin_slope                    0.2416
  eda_stress_skin_min                      0.2183
  eda_cc_kurtosis                          0.2089

PC4
  eda_cc_mean_abs_diff                     0.6743
  eda_cc_kurtosis                          0.6084
  eda_cc_skew                              0.3041
  eda_stress_skin_slope                    0.2105
  eda_cc_slope                             0.1369
  eda_stress_skin_kurtosis                 0.1195
  eda_stress_skin_mad                      0.0519
  eda_stress_skin_skew                     0.0462

PC5
  eda_cc_skew                              0.7603
  eda_cc_kurtosis                          0.4842
  eda_cc_slope                             0.3277
  eda_cc_mean_abs_diff                     0.2020
  eda_stress_skin_slope                    0.1302
  eda_cc_max                               0.1255
  eda_stress_skin_skew                     0.0567
  eda_stress_skin_mad                      0.0465

PC6
  eda_cc_mean_abs_diff                     0.6741
  eda_cc_kurtosis                          0.5200
  eda_cc_skew                              0.4830
  eda_stress_skin_skew                     0.1213
  eda_cc_max                               0.0978
  eda_stress_skin_slope                    0.0890
  eda_stress_skin_mad                      0.0758
  eda_cc_slope                             0.0456

PC7
  eda_stress_skin_slope                    0.5664
  eda_cc_slope                             0.4376
  eda_cc_max                               0.4231
  eda_stress_skin_min                      0.3223
  eda_stress_skin_skew                     0.3103
  eda_cc_kurtosis                          0.2592
  eda_stress_skin_mad                      0.1841
  eda_cc_mean_abs_diff                     0.0713

PC8
  eda_stress_skin_min                      0.6012
  eda_cc_slope                             0.4618
  eda_cc_max                               0.4579
  eda_stress_skin_slope                    0.4217
  eda_stress_skin_mad                      0.1500
  eda_cc_mean_abs_diff                     0.0736
  eda_cc_kurtosis                          0.0720
  eda_stress_skin_kurtosis                 0.0642

Saved to: data/feature_extraction/analysis/quality_eda_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_10.0s.csv
Shape: (377, 28)
Selected feature columns: 21
After NaN/variance filter: (377, 15)
After correlation pruning: (377, 5)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.5970   (cum 0.5970)
   PC2: 0.2423   (cum 0.8392)
   PC3: 0.1288   (cum 0.9680)
   PC4: 0.0236   (cum 0.9917)
   PC5: 0.0083   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5617
  eda_scr_count                            0.5530
  eda_scl_slope                            0.4584
  eda_phasic_auc                           0.3174
  eda_scl_max                              0.2606

PC2
  eda_phasic_auc                           0.6783
  eda_scl_max                              0.5901
  eda_scl_slope                            0.4071
  eda_scr_amp_sum                          0.1328
  eda_scr_count                            0.0914

PC3
  eda_scl_max                              0.7635
  eda_scl_slope                            0.4540
  eda_phasic_auc                           0.4298
  eda_scr_amp_sum                          0.1208
  eda_scr_count                            0.1075

PC4
  eda_scr_count                            0.7386
  eda_scl_slope                            0.5352
  eda_phasic_auc                           0.4051
  eda_scr_amp_sum                          0.0632
  eda_scl_max                              0.0038

PC5
  eda_scr_amp_sum                          0.8051
  eda_scl_slope                            0.3627
  eda_scr_count                            0.3590
  eda_phasic_auc                           0.3007
  eda_scl_max                              0.0304

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.5970   (cum 0.5970)
   PC2: 0.2423   (cum 0.8392)
   PC3: 0.1288   (cum 0.9680)
   PC4: 0.0236   (cum 0.9917)
   PC5: 0.0083   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5617
  eda_scr_count                            0.5530
  eda_scl_slope                            0.4584
  eda_phasic_auc                           0.3174
  eda_scl_max                              0.2606

PC2
  eda_phasic_auc                           0.6783
  eda_scl_max                              0.5901
  eda_scl_slope                            0.4071
  eda_scr_amp_sum                          0.1328
  eda_scr_count                            0.0914

PC3
  eda_scl_max                              0.7635
  eda_scl_slope                            0.4540
  eda_phasic_auc                           0.4298
  eda_scr_amp_sum                          0.1208
  eda_scr_count                            0.1075

PC4
  eda_scr_count                            0.7386
  eda_scl_slope                            0.5352
  eda_phasic_auc                           0.4051
  eda_scr_amp_sum                          0.0632
  eda_scl_max                              0.0038

PC5
  eda_scr_amp_sum                          0.8051
  eda_scl_slope                            0.3627
  eda_scr_count                            0.3590
  eda_phasic_auc                           0.3007
  eda_scl_max                              0.0304

Saved to: data/feature_extraction/analysis/quality_eda_advanced_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_features_5.0s.csv
Shape: (782, 39)
Selected feature columns: 30
After NaN/variance filter: (782, 29)
After correlation pruning: (782, 29)

PCA summary (round 1):
  pcs_for_90pct: 11
  pcs_for_95pct: 16
  pcs_for_99pct: 24

Explained variance per PC (round 1):
   PC1: 0.4454   (cum 0.4454)
   PC2: 0.1748   (cum 0.6201)
   PC3: 0.0612   (cum 0.6813)
   PC4: 0.0445   (cum 0.7259)
   PC5: 0.0417   (cum 0.7675)
   PC6: 0.0351   (cum 0.8026)
   PC7: 0.0261   (cum 0.8287)
   PC8: 0.0253   (cum 0.8540)
   PC9: 0.0196   (cum 0.8736)
  PC10: 0.0157   (cum 0.8894)
  PC11: 0.0131   (cum 0.9024)
  PC12: 0.0127   (cum 0.9151)
  PC13: 0.0117   (cum 0.9268)
  PC14: 0.0096   (cum 0.9364)
  PC15: 0.0091   (cum 0.9455)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2478
  acc_y_dyn__avg_amplitude_change          0.2407
  acc_x_dyn__quantile_0.3                  0.2398
  acc_x_dyn__quantile_0.9                  0.2355
  acc_y_dyn__quantile_0.3                  0.2195
  acc_x_dyn__harmonic_mean_of_abs          0.2184
  acc_z_dyn__harmonic_mean_of_abs          0.2046
  acc_x_dyn__max                           0.2018

PC2
  acc_y_dyn__sample_entropy                0.3340
  acc_x_dyn__sample_entropy                0.3213
  acc_z_dyn__sample_entropy                0.3107
  acc_z_dyn__approximate_entropy_0.1       0.2758
  acc_x_dyn__approximate_entropy_0.1       0.2694
  acc_y_dyn__katz_fractal_dimension        0.2543
  acc_x_dyn__approximate_entropy_0.9       0.2515
  acc_z_dyn__katz_fractal_dimension        0.2431

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4079
  acc_y_dyn__quantile_0.4                  0.3557
  acc_z_dyn__lower_complete_moment         0.3314
  acc_y_dyn__quantile_0.3                  0.2807
  acc_x_dyn__variance_of_absolute_differences 0.2796
  acc_y_dyn__harmonic_mean_of_abs          0.2696
  acc_y_dyn__tsallis_entropy               0.2454
  acc_x_dyn__approximate_entropy_0.9       0.2003

PC4
  acc_x_dyn__approximate_entropy_0.1       0.3434
  acc_x_dyn__cardinality                   0.3336
  acc_x_dyn__max                           0.2936
  acc_z_dyn__approximate_entropy_0.1       0.2817
  acc_y_dyn__variance_of_absolute_differences 0.2713
  acc_y_dyn__avg_amplitude_change          0.2507
  acc_y_dyn__katz_fractal_dimension        0.2427
  acc_x_dyn__quantile_0.4                  0.2255

PC5
  acc_y_dyn__tsallis_entropy               0.6232
  acc_x_dyn__cardinality                   0.3880
  acc_z_dyn__quantile_0.6                  0.2960
  acc_z_dyn__lower_complete_moment         0.2750
  acc_z_dyn__katz_fractal_dimension        0.2097
  acc_z_dyn__harmonic_mean_of_abs          0.1901
  acc_x_dyn__approximate_entropy_0.9       0.1648
  acc_x_dyn__max                           0.1644

PC6
  acc_x_dyn__quantile_0.4                  0.5173
  acc_x_dyn__approximate_entropy_0.1       0.2881
  acc_y_dyn__harmonic_mean_of_abs          0.2721
  acc_x_dyn__cardinality                   0.2637
  acc_x_dyn__quantile_0.6                  0.2635
  acc_z_dyn__approximate_entropy_0.1       0.2470
  acc_x_dyn__quantile_0.3                  0.2454
  acc_y_dyn__variance_of_absolute_differences 0.2085

PC7
  acc_x_dyn__variance_of_absolute_differences 0.4529
  acc_z_dyn__harmonic_mean_of_abs          0.4371
  acc_z_dyn__quantile_0.6                  0.4018
  acc_z_dyn__variance_of_absolute_differences 0.3161
  acc_z_dyn__approximate_entropy_0.1       0.2634
  acc_x_dyn__approximate_entropy_0.9       0.2095
  acc_x_dyn__approximate_entropy_0.1       0.2088
  acc_x_dyn__katz_fractal_dimension        0.1911

PC8
  acc_z_dyn__quantile_0.4                  0.7451
  acc_z_dyn__harmonic_mean_of_abs          0.2739
  acc_z_dyn__quantile_0.6                  0.2680
  acc_x_dyn__quantile_0.6                  0.2518
  acc_x_dyn__quantile_0.4                  0.2150
  acc_y_dyn__variance_of_absolute_differences 0.2004
  acc_z_dyn__lower_complete_moment         0.1391
  acc_y_dyn__harmonic_mean_of_abs          0.1381

Stage 2: PCs used to reach 90%: 11
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 11
  pcs_for_95pct: 16
  pcs_for_99pct: 24

Explained variance per PC (round 2):
   PC1: 0.4454   (cum 0.4454)
   PC2: 0.1748   (cum 0.6201)
   PC3: 0.0612   (cum 0.6813)
   PC4: 0.0445   (cum 0.7259)
   PC5: 0.0417   (cum 0.7675)
   PC6: 0.0351   (cum 0.8026)
   PC7: 0.0261   (cum 0.8287)
   PC8: 0.0253   (cum 0.8540)
   PC9: 0.0196   (cum 0.8736)
  PC10: 0.0157   (cum 0.8894)
  PC11: 0.0131   (cum 0.9024)
  PC12: 0.0127   (cum 0.9151)
  PC13: 0.0117   (cum 0.9268)
  PC14: 0.0096   (cum 0.9364)
  PC15: 0.0091   (cum 0.9455)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2478
  acc_y_dyn__avg_amplitude_change          0.2407
  acc_x_dyn__quantile_0.3                  0.2398
  acc_x_dyn__quantile_0.9                  0.2355
  acc_y_dyn__quantile_0.3                  0.2195
  acc_x_dyn__harmonic_mean_of_abs          0.2184
  acc_z_dyn__harmonic_mean_of_abs          0.2046
  acc_x_dyn__max                           0.2018

PC2
  acc_y_dyn__sample_entropy                0.3340
  acc_x_dyn__sample_entropy                0.3213
  acc_z_dyn__sample_entropy                0.3107
  acc_z_dyn__approximate_entropy_0.1       0.2758
  acc_x_dyn__approximate_entropy_0.1       0.2694
  acc_y_dyn__katz_fractal_dimension        0.2543
  acc_x_dyn__approximate_entropy_0.9       0.2515
  acc_z_dyn__katz_fractal_dimension        0.2431

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4079
  acc_y_dyn__quantile_0.4                  0.3557
  acc_z_dyn__lower_complete_moment         0.3314
  acc_y_dyn__quantile_0.3                  0.2807
  acc_x_dyn__variance_of_absolute_differences 0.2796
  acc_y_dyn__harmonic_mean_of_abs          0.2696
  acc_y_dyn__tsallis_entropy               0.2454
  acc_x_dyn__approximate_entropy_0.9       0.2003

PC4
  acc_x_dyn__approximate_entropy_0.1       0.3434
  acc_x_dyn__cardinality                   0.3336
  acc_x_dyn__max                           0.2936
  acc_z_dyn__approximate_entropy_0.1       0.2817
  acc_y_dyn__variance_of_absolute_differences 0.2713
  acc_y_dyn__avg_amplitude_change          0.2507
  acc_y_dyn__katz_fractal_dimension        0.2427
  acc_x_dyn__quantile_0.4                  0.2255

PC5
  acc_y_dyn__tsallis_entropy               0.6232
  acc_x_dyn__cardinality                   0.3880
  acc_z_dyn__quantile_0.6                  0.2960
  acc_z_dyn__lower_complete_moment         0.2750
  acc_z_dyn__katz_fractal_dimension        0.2097
  acc_z_dyn__harmonic_mean_of_abs          0.1901
  acc_x_dyn__approximate_entropy_0.9       0.1648
  acc_x_dyn__max                           0.1644

PC6
  acc_x_dyn__quantile_0.4                  0.5173
  acc_x_dyn__approximate_entropy_0.1       0.2881
  acc_y_dyn__harmonic_mean_of_abs          0.2721
  acc_x_dyn__cardinality                   0.2637
  acc_x_dyn__quantile_0.6                  0.2635
  acc_z_dyn__approximate_entropy_0.1       0.2470
  acc_x_dyn__quantile_0.3                  0.2454
  acc_y_dyn__variance_of_absolute_differences 0.2085

PC7
  acc_x_dyn__variance_of_absolute_differences 0.4529
  acc_z_dyn__harmonic_mean_of_abs          0.4371
  acc_z_dyn__quantile_0.6                  0.4018
  acc_z_dyn__variance_of_absolute_differences 0.3161
  acc_z_dyn__approximate_entropy_0.1       0.2634
  acc_x_dyn__approximate_entropy_0.9       0.2095
  acc_x_dyn__approximate_entropy_0.1       0.2088
  acc_x_dyn__katz_fractal_dimension        0.1911

PC8
  acc_z_dyn__quantile_0.4                  0.7451
  acc_z_dyn__harmonic_mean_of_abs          0.2739
  acc_z_dyn__quantile_0.6                  0.2680
  acc_x_dyn__quantile_0.6                  0.2518
  acc_x_dyn__quantile_0.4                  0.2150
  acc_y_dyn__variance_of_absolute_differences 0.2004
  acc_z_dyn__lower_complete_moment         0.1391
  acc_y_dyn__harmonic_mean_of_abs          0.1381

Saved to: data/feature_extraction/analysis/quality_imu_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_5.0s.csv | rows=793 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_5.0s.csv
Shape: (793, 51)
Selected feature columns: 44
After NaN/variance filter: (793, 43)
After correlation pruning: (793, 19)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.4440   (cum 0.4440)
   PC2: 0.1418   (cum 0.5858)
   PC3: 0.0901   (cum 0.6759)
   PC4: 0.0586   (cum 0.7345)
   PC5: 0.0554   (cum 0.7899)
   PC6: 0.0513   (cum 0.8411)
   PC7: 0.0462   (cum 0.8873)
   PC8: 0.0369   (cum 0.9242)
   PC9: 0.0198   (cum 0.9440)
  PC10: 0.0162   (cum 0.9601)
  PC11: 0.0124   (cum 0.9726)
  PC12: 0.0110   (cum 0.9835)
  PC13: 0.0066   (cum 0.9901)
  PC14: 0.0047   (cum 0.9948)
  PC15: 0.0021   (cum 0.9969)

Top PCA loadings per component (round 1):

PC1
  ppg_green_std                            0.3359
  ppg_green_clearance_factor               0.3188
  ppg_green_diff_mean_abs                  0.3185
  ppg_green_p95_p5                         0.3152
  ppg_green_shape_factor                   0.2956
  ppg_green_p90_p10                        0.2849
  ppg_green_tke_p95_abs                    0.2775
  ppg_green_iqr                            0.2496

PC2
  ppg_green_p99                            0.4184
  ppg_green_kurtosis                       0.3569
  ppg_green_mad                            0.3497
  ppg_green_iqr                            0.3411
  ppg_green_p90                            0.3072
  ppg_green_tke_std                        0.2887
  ppg_green_dx_kurtosis                    0.2797
  ppg_green_p90_p10                        0.2597

PC3
  ppg_green_p90                            0.5932
  ppg_green_mean_cross_rate                0.4558
  ppg_green_p99                            0.4258
  ppg_green_kurtosis                       0.2563
  ppg_green_skew                           0.1992
  ppg_green_iqr                            0.1722
  ppg_green_mad                            0.1516
  ppg_green_p90_p10                        0.1482

PC4
  ppg_green_ddx_kurtosis                   0.6061
  ppg_green_diff_mean                      0.4213
  ppg_green_dx_kurtosis                    0.3841
  ppg_green_ddx_mean                       0.3775
  ppg_green_skew                           0.2211
  ppg_green_tke_std                        0.1989
  ppg_green_shape_factor                   0.1876
  ppg_green_clearance_factor               0.1445

PC5
  ppg_green_diff_mean                      0.5875
  ppg_green_ddx_mean                       0.4748
  ppg_green_ddx_kurtosis                   0.3631
  ppg_green_dx_kurtosis                    0.2692
  ppg_green_mean_cross_rate                0.2076
  ppg_green_p99                            0.1775
  ppg_green_p90                            0.1754
  ppg_green_tke_std                        0.1672

PC6
  ppg_green_mean_cross_rate                0.6421
  ppg_green_ddx_mean                       0.3853
  ppg_green_tke_p95_abs                    0.3030
  ppg_green_p90                            0.2859
  ppg_green_skew                           0.2341
  ppg_green_shape_factor                   0.2238
  ppg_green_tke_std                        0.2021
  ppg_green_clearance_factor               0.1763

PC7
  ppg_green_diff_mean                      0.6433
  ppg_green_ddx_mean                       0.6384
  ppg_green_mean_cross_rate                0.3612
  ppg_green_skew                           0.1453
  ppg_green_p90                            0.1044
  ppg_green_ddx_kurtosis                   0.0632
  ppg_green_p99                            0.0627
  ppg_green_tke_std                        0.0475

PC8
  ppg_green_skew                           0.8204
  ppg_green_kurtosis                       0.2738
  ppg_green_mad                            0.2388
  ppg_green_tke_std                        0.2207
  ppg_green_shape_factor                   0.1697
  ppg_green_iqr                            0.1576
  ppg_green_ddx_mean                       0.1535
  ppg_green_diff_mean                      0.1320

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 19
Stage 2: selected features: 19 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.4440   (cum 0.4440)
   PC2: 0.1418   (cum 0.5858)
   PC3: 0.0901   (cum 0.6759)
   PC4: 0.0586   (cum 0.7345)
   PC5: 0.0554   (cum 0.7899)
   PC6: 0.0513   (cum 0.8411)
   PC7: 0.0462   (cum 0.8873)
   PC8: 0.0369   (cum 0.9242)
   PC9: 0.0198   (cum 0.9440)
  PC10: 0.0162   (cum 0.9601)
  PC11: 0.0124   (cum 0.9726)
  PC12: 0.0110   (cum 0.9835)
  PC13: 0.0066   (cum 0.9901)
  PC14: 0.0047   (cum 0.9948)
  PC15: 0.0021   (cum 0.9969)

Top PCA loadings per component (round 2):

PC1
  ppg_green_std                            0.3359
  ppg_green_clearance_factor               0.3188
  ppg_green_diff_mean_abs                  0.3185
  ppg_green_p95_p5                         0.3152
  ppg_green_shape_factor                   0.2956
  ppg_green_p90_p10                        0.2849
  ppg_green_tke_p95_abs                    0.2775
  ppg_green_iqr                            0.2496

PC2
  ppg_green_p99                            0.4184
  ppg_green_kurtosis                       0.3569
  ppg_green_mad                            0.3497
  ppg_green_iqr                            0.3411
  ppg_green_p90                            0.3072
  ppg_green_tke_std                        0.2887
  ppg_green_dx_kurtosis                    0.2797
  ppg_green_p90_p10                        0.2597

PC3
  ppg_green_p90                            0.5932
  ppg_green_mean_cross_rate                0.4558
  ppg_green_p99                            0.4258
  ppg_green_kurtosis                       0.2563
  ppg_green_skew                           0.1992
  ppg_green_iqr                            0.1722
  ppg_green_mad                            0.1516
  ppg_green_p90_p10                        0.1482

PC4
  ppg_green_ddx_kurtosis                   0.6061
  ppg_green_diff_mean                      0.4213
  ppg_green_dx_kurtosis                    0.3841
  ppg_green_ddx_mean                       0.3775
  ppg_green_skew                           0.2211
  ppg_green_tke_std                        0.1989
  ppg_green_shape_factor                   0.1876
  ppg_green_clearance_factor               0.1445

PC5
  ppg_green_diff_mean                      0.5875
  ppg_green_ddx_mean                       0.4748
  ppg_green_ddx_kurtosis                   0.3631
  ppg_green_dx_kurtosis                    0.2692
  ppg_green_mean_cross_rate                0.2076
  ppg_green_p99                            0.1775
  ppg_green_p90                            0.1754
  ppg_green_tke_std                        0.1672

PC6
  ppg_green_mean_cross_rate                0.6421
  ppg_green_ddx_mean                       0.3853
  ppg_green_tke_p95_abs                    0.3030
  ppg_green_p90                            0.2859
  ppg_green_skew                           0.2341
  ppg_green_shape_factor                   0.2238
  ppg_green_tke_std                        0.2021
  ppg_green_clearance_factor               0.1763

PC7
  ppg_green_diff_mean                      0.6433
  ppg_green_ddx_mean                       0.6384
  ppg_green_mean_cross_rate                0.3612
  ppg_green_skew                           0.1453
  ppg_green_p90                            0.1044
  ppg_green_ddx_kurtosis                   0.0632
  ppg_green_p99                            0.0627
  ppg_green_tke_std                        0.0475

PC8
  ppg_green_skew                           0.8204
  ppg_green_kurtosis                       0.2738
  ppg_green_mad                            0.2388
  ppg_green_tke_std                        0.2207
  ppg_green_shape_factor                   0.1697
  ppg_green_iqr                            0.1576
  ppg_green_ddx_mean                       0.1535
  ppg_green_diff_mean                      0.1320

Saved to: data/feature_extraction/analysis/quality_ppg_green_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_5.0s.csv
Shape: (793, 28)
Selected feature columns: 18
After NaN/variance filter: (793, 2)
After correlation pruning: (793, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7105   (cum 0.7105)
   PC2: 0.2895   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7105   (cum 0.7105)
   PC2: 0.2895   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_5.0s.csv | rows=793 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_5.0s.csv
Shape: (793, 51)
Selected feature columns: 44
After NaN/variance filter: (793, 44)
After correlation pruning: (793, 24)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3714   (cum 0.3714)
   PC2: 0.1855   (cum 0.5569)
   PC3: 0.1008   (cum 0.6578)
   PC4: 0.0823   (cum 0.7400)
   PC5: 0.0523   (cum 0.7923)
   PC6: 0.0475   (cum 0.8398)
   PC7: 0.0393   (cum 0.8791)
   PC8: 0.0277   (cum 0.9067)
   PC9: 0.0248   (cum 0.9316)
  PC10: 0.0210   (cum 0.9526)
  PC11: 0.0104   (cum 0.9630)
  PC12: 0.0073   (cum 0.9703)
  PC13: 0.0065   (cum 0.9768)
  PC14: 0.0055   (cum 0.9823)
  PC15: 0.0049   (cum 0.9873)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_diff_mean_abs                  0.3155
  ppg_infra_p1                             0.3150
  ppg_infra_p10                            0.3125
  ppg_infra_ddx_std                        0.3113
  ppg_infra_max                            0.3112
  ppg_infra_p90                            0.3077
  ppg_infra_signal_energy                  0.3054
  ppg_infra_tke_mean_abs                   0.3037

PC2
  ppg_infra_impulse_factor                 0.4474
  ppg_infra_clearance_factor               0.4384
  ppg_infra_kurtosis                       0.4340
  ppg_infra_shape_factor                   0.4272
  ppg_infra_dx_kurtosis                    0.3076
  ppg_infra_ddx_kurtosis                   0.2325
  ppg_infra_iqr                            0.1560
  ppg_infra_p90                            0.1097

PC3
  ppg_infra_trim_mean_10                   0.5761
  ppg_infra_mean                           0.5647
  ppg_infra_median                         0.4653
  ppg_infra_ddx_mean                       0.3205
  ppg_infra_skew                           0.0807
  ppg_infra_tke_std                        0.0752
  ppg_infra_tke_mean_abs                   0.0581
  ppg_infra_ddx_kurtosis                   0.0566

PC4
  ppg_infra_zcr                            0.6762
  ppg_infra_mean_cross_rate                0.6675
  ppg_infra_tke_mean_abs                   0.1187
  ppg_infra_tke_std                        0.1150
  ppg_infra_ddx_std                        0.1142
  ppg_infra_skew                           0.1018
  ppg_infra_diff_mean_abs                  0.0887
  ppg_infra_impulse_factor                 0.0852

PC5
  ppg_infra_skew                           0.7010
  ppg_infra_dx_mean                        0.3336
  ppg_infra_mean                           0.3000
  ppg_infra_dx_kurtosis                    0.2779
  ppg_infra_median                         0.2608
  ppg_infra_ddx_kurtosis                   0.2276
  ppg_infra_max                            0.2057
  ppg_infra_ddx_mean                       0.1317

PC6
  ppg_infra_dx_mean                        0.7683
  ppg_infra_ddx_mean                       0.5245
  ppg_infra_skew                           0.2007
  ppg_infra_trim_mean_10                   0.1525
  ppg_infra_tke_std                        0.1320
  ppg_infra_shape_factor                   0.1086
  ppg_infra_clearance_factor               0.0860
  ppg_infra_dx_kurtosis                    0.0814

PC7
  ppg_infra_ddx_kurtosis                   0.4810
  ppg_infra_dx_kurtosis                    0.4675
  ppg_infra_skew                           0.2890
  ppg_infra_tke_std                        0.2540
  ppg_infra_shape_factor                   0.2369
  ppg_infra_clearance_factor               0.2246
  ppg_infra_median                         0.2227
  ppg_infra_ddx_mean                       0.2115

PC8
  ppg_infra_ddx_mean                       0.4607
  ppg_infra_tke_std                        0.4305
  ppg_infra_dx_mean                        0.4087
  ppg_infra_ddx_kurtosis                   0.3395
  ppg_infra_tke_mean_abs                   0.3050
  ppg_infra_skew                           0.2032
  ppg_infra_iqr                            0.1802
  ppg_infra_p10                            0.1629

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 24
Stage 2: selected features: 24 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3714   (cum 0.3714)
   PC2: 0.1855   (cum 0.5569)
   PC3: 0.1008   (cum 0.6578)
   PC4: 0.0823   (cum 0.7400)
   PC5: 0.0523   (cum 0.7923)
   PC6: 0.0475   (cum 0.8398)
   PC7: 0.0393   (cum 0.8791)
   PC8: 0.0277   (cum 0.9067)
   PC9: 0.0248   (cum 0.9316)
  PC10: 0.0210   (cum 0.9526)
  PC11: 0.0104   (cum 0.9630)
  PC12: 0.0073   (cum 0.9703)
  PC13: 0.0065   (cum 0.9768)
  PC14: 0.0055   (cum 0.9823)
  PC15: 0.0049   (cum 0.9873)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_diff_mean_abs                  0.3155
  ppg_infra_p1                             0.3150
  ppg_infra_p10                            0.3125
  ppg_infra_ddx_std                        0.3113
  ppg_infra_max                            0.3112
  ppg_infra_p90                            0.3077
  ppg_infra_signal_energy                  0.3054
  ppg_infra_tke_mean_abs                   0.3037

PC2
  ppg_infra_impulse_factor                 0.4474
  ppg_infra_clearance_factor               0.4384
  ppg_infra_kurtosis                       0.4340
  ppg_infra_shape_factor                   0.4272
  ppg_infra_dx_kurtosis                    0.3076
  ppg_infra_ddx_kurtosis                   0.2325
  ppg_infra_iqr                            0.1560
  ppg_infra_p90                            0.1097

PC3
  ppg_infra_trim_mean_10                   0.5761
  ppg_infra_mean                           0.5647
  ppg_infra_median                         0.4653
  ppg_infra_ddx_mean                       0.3205
  ppg_infra_skew                           0.0807
  ppg_infra_tke_std                        0.0752
  ppg_infra_tke_mean_abs                   0.0581
  ppg_infra_ddx_kurtosis                   0.0566

PC4
  ppg_infra_zcr                            0.6762
  ppg_infra_mean_cross_rate                0.6675
  ppg_infra_tke_mean_abs                   0.1187
  ppg_infra_tke_std                        0.1150
  ppg_infra_ddx_std                        0.1142
  ppg_infra_skew                           0.1018
  ppg_infra_diff_mean_abs                  0.0887
  ppg_infra_impulse_factor                 0.0852

PC5
  ppg_infra_skew                           0.7010
  ppg_infra_dx_mean                        0.3336
  ppg_infra_mean                           0.3000
  ppg_infra_dx_kurtosis                    0.2779
  ppg_infra_median                         0.2608
  ppg_infra_ddx_kurtosis                   0.2276
  ppg_infra_max                            0.2057
  ppg_infra_ddx_mean                       0.1317

PC6
  ppg_infra_dx_mean                        0.7683
  ppg_infra_ddx_mean                       0.5245
  ppg_infra_skew                           0.2007
  ppg_infra_trim_mean_10                   0.1525
  ppg_infra_tke_std                        0.1320
  ppg_infra_shape_factor                   0.1086
  ppg_infra_clearance_factor               0.0860
  ppg_infra_dx_kurtosis                    0.0814

PC7
  ppg_infra_ddx_kurtosis                   0.4810
  ppg_infra_dx_kurtosis                    0.4675
  ppg_infra_skew                           0.2890
  ppg_infra_tke_std                        0.2540
  ppg_infra_shape_factor                   0.2369
  ppg_infra_clearance_factor               0.2246
  ppg_infra_median                         0.2227
  ppg_infra_ddx_mean                       0.2115

PC8
  ppg_infra_ddx_mean                       0.4607
  ppg_infra_tke_std                        0.4305
  ppg_infra_dx_mean                        0.4087
  ppg_infra_ddx_kurtosis                   0.3395
  ppg_infra_tke_mean_abs                   0.3050
  ppg_infra_skew                           0.2032
  ppg_infra_iqr                            0.1802
  ppg_infra_p10                            0.1629

Saved to: data/feature_extraction/analysis/quality_ppg_infra_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE

=== Processing dataset: elderly_sim_elderly3 ===
▶ imu_bioz: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_bioz/imu_preprocessed.csv
  Windowing imu_bioz...
    ✓ Created 327 windows (10.0s)
  Extracting features for imu_bioz...
    ✓ Features 10.0s: 327 windows, 38 features
    ✓ Features 5.0s: 654 windows, 38 features
    ✓ Features 2.0s: 1624 windows, 38 features
▶ imu_wrist: preprocessing
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_preprocessed.csv
  Windowing imu_wrist...
    ✓ Created 391 windows (10.0s)
  Extracting features for imu_wrist...
    ✓ Features 10.0s: 391 windows, 38 features
    ✓ Features 5.0s: 782 windows, 38 features
    ✓ Features 2.0s: 1943 windows, 38 features
▶ ppg_green: preprocessing
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_preprocessed.csv | rows=114240 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_preprocessed.csv
▶ ppg_infra: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_preprocessed.csv | rows=114240 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_preprocessed.csv
▶ ppg_red: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_preprocessed.csv | rows=114240 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_preprocessed.csv
▶ RR: preprocessing
✓ RR preprocessed → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/rr/rr_preprocessed.csv | rows=27866 | irregular sampling (no resample)
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/rr/rr_preprocessed.csv
▶ EDA: preprocessing
✓ EDA preprocessed → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_preprocessed.csv | rows=108833 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_preprocessed.csv

▶ Window length: 10.0s | overlap=0.1
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 391
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_aligned_10.0s.csv (391 windows | borg labeled: 141)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_10.0s.csv | windows=396 | features=21
    ✓ HRV features: 396 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_aligned_10.0s.csv (396 windows | borg labeled: 141)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_aligned_10.0s.csv (396 windows | borg labeled: 141)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_10.0s.csv | windows=396 | features=21
    ✓ HRV features: 396 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_aligned_10.0s.csv (396 windows | borg labeled: 141)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_aligned_10.0s.csv (396 windows | borg labeled: 141)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_10.0s.csv | windows=396 | features=21
    ✓ HRV features: 396 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_aligned_10.0s.csv (396 windows | borg labeled: 141)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 396
  Windows in ADL time range: 219
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_aligned_10.0s.csv (396 windows | borg labeled: 141)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_10.0s.csv | windows=377 | features=21
    ✓ Advanced EDA features: 377 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 377
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_aligned_10.0s.csv (377 windows | borg labeled: 143)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 377
  Windows in ADL time range: 220
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_aligned_10.0s.csv (377 windows | borg labeled: 143)

▶ Window length: 5.0s | overlap=0.1
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 782
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_aligned_5.0s.csv (782 windows | borg labeled: 287)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_5.0s.csv | windows=793 | features=21
    ✓ HRV features: 793 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_aligned_5.0s.csv (793 windows | borg labeled: 287)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_aligned_5.0s.csv (793 windows | borg labeled: 287)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_5.0s.csv
Shape: (793, 28)
Selected feature columns: 18
After NaN/variance filter: (793, 2)
After correlation pruning: (793, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5933   (cum 0.5933)
   PC2: 0.4067   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5933   (cum 0.5933)
   PC2: 0.4067   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_5.0s.csv | rows=793 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_5.0s.csv
Shape: (793, 51)
Selected feature columns: 44
After NaN/variance filter: (793, 44)
After correlation pruning: (793, 24)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 1):
   PC1: 0.3605   (cum 0.3605)
   PC2: 0.1795   (cum 0.5400)
   PC3: 0.1048   (cum 0.6448)
   PC4: 0.0811   (cum 0.7259)
   PC5: 0.0513   (cum 0.7772)
   PC6: 0.0441   (cum 0.8212)
   PC7: 0.0407   (cum 0.8619)
   PC8: 0.0304   (cum 0.8923)
   PC9: 0.0288   (cum 0.9211)
  PC10: 0.0224   (cum 0.9435)
  PC11: 0.0122   (cum 0.9557)
  PC12: 0.0100   (cum 0.9657)
  PC13: 0.0090   (cum 0.9747)
  PC14: 0.0061   (cum 0.9807)
  PC15: 0.0050   (cum 0.9858)

Top PCA loadings per component (round 1):

PC1
  ppg_red_p1                               0.3251
  ppg_red_diff_mean_abs                    0.3210
  ppg_red_p90                              0.3192
  ppg_red_ddx_std                          0.3153
  ppg_red_max                              0.3152
  ppg_red_p10                              0.3131
  ppg_red_signal_energy                    0.3101
  ppg_red_tke_mean                         0.3047

PC2
  ppg_red_clearance_factor                 0.4464
  ppg_red_kurtosis                         0.4397
  ppg_red_shape_factor                     0.4287
  ppg_red_crest_factor                     0.4234
  ppg_red_dx_kurtosis                      0.3076
  ppg_red_ddx_kurtosis                     0.2662
  ppg_red_iqr                              0.1379
  ppg_red_mean_cross_rate                  0.1311

PC3
  ppg_red_trim_mean_10                     0.5775
  ppg_red_mean                             0.5638
  ppg_red_median                           0.4338
  ppg_red_ddx_mean                         0.3318
  ppg_red_tke_std                          0.1337
  ppg_red_tke_mean                         0.0952
  ppg_red_diff_mean                        0.0901
  ppg_red_p10                              0.0739

PC4
  ppg_red_zcr                              0.6613
  ppg_red_mean_cross_rate                  0.6369
  ppg_red_ddx_kurtosis                     0.1422
  ppg_red_tke_mean                         0.1388
  ppg_red_crest_factor                     0.1373
  ppg_red_ddx_std                          0.1226
  ppg_red_kurtosis                         0.1213
  ppg_red_tke_std                          0.1198

PC5
  ppg_red_skew                             0.6928
  ppg_red_dx_kurtosis                      0.3981
  ppg_red_ddx_kurtosis                     0.3574
  ppg_red_ddx_mean                         0.2133
  ppg_red_median                           0.2098
  ppg_red_mean                             0.1861
  ppg_red_shape_factor                     0.1654
  ppg_red_max                              0.1500

PC6
  ppg_red_diff_mean                        0.7630
  ppg_red_skew                             0.3235
  ppg_red_dx_kurtosis                      0.2671
  ppg_red_ddx_kurtosis                     0.2512
  ppg_red_ddx_mean                         0.1986
  ppg_red_clearance_factor                 0.1550
  ppg_red_shape_factor                     0.1550
  ppg_red_mean_cross_rate                  0.1311

PC7
  ppg_red_ddx_mean                         0.4753
  ppg_red_diff_mean                        0.4511
  ppg_red_ddx_kurtosis                     0.3906
  ppg_red_dx_kurtosis                      0.3740
  ppg_red_skew                             0.3158
  ppg_red_median                           0.2210
  ppg_red_shape_factor                     0.1761
  ppg_red_clearance_factor                 0.1590

PC8
  ppg_red_tke_std                          0.5374
  ppg_red_median                           0.3673
  ppg_red_tke_mean                         0.3519
  ppg_red_iqr                              0.3262
  ppg_red_p10                              0.3151
  ppg_red_ddx_mean                         0.2650
  ppg_red_trim_mean_10                     0.1838
  ppg_red_crest_factor                     0.1694

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 24
Stage 2: selected features: 24 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 2):
   PC1: 0.3605   (cum 0.3605)
   PC2: 0.1795   (cum 0.5400)
   PC3: 0.1048   (cum 0.6448)
   PC4: 0.0811   (cum 0.7259)
   PC5: 0.0513   (cum 0.7772)
   PC6: 0.0441   (cum 0.8212)
   PC7: 0.0407   (cum 0.8619)
   PC8: 0.0304   (cum 0.8923)
   PC9: 0.0288   (cum 0.9211)
  PC10: 0.0224   (cum 0.9435)
  PC11: 0.0122   (cum 0.9557)
  PC12: 0.0100   (cum 0.9657)
  PC13: 0.0090   (cum 0.9747)
  PC14: 0.0061   (cum 0.9807)
  PC15: 0.0050   (cum 0.9858)

Top PCA loadings per component (round 2):

PC1
  ppg_red_p1                               0.3251
  ppg_red_diff_mean_abs                    0.3210
  ppg_red_p90                              0.3192
  ppg_red_ddx_std                          0.3153
  ppg_red_max                              0.3152
  ppg_red_p10                              0.3131
  ppg_red_signal_energy                    0.3101
  ppg_red_tke_mean                         0.3047

PC2
  ppg_red_clearance_factor                 0.4464
  ppg_red_kurtosis                         0.4397
  ppg_red_shape_factor                     0.4287
  ppg_red_crest_factor                     0.4234
  ppg_red_dx_kurtosis                      0.3076
  ppg_red_ddx_kurtosis                     0.2662
  ppg_red_iqr                              0.1379
  ppg_red_mean_cross_rate                  0.1311

PC3
  ppg_red_trim_mean_10                     0.5775
  ppg_red_mean                             0.5638
  ppg_red_median                           0.4338
  ppg_red_ddx_mean                         0.3318
  ppg_red_tke_std                          0.1337
  ppg_red_tke_mean                         0.0952
  ppg_red_diff_mean                        0.0901
  ppg_red_p10                              0.0739

PC4
  ppg_red_zcr                              0.6613
  ppg_red_mean_cross_rate                  0.6369
  ppg_red_ddx_kurtosis                     0.1422
  ppg_red_tke_mean                         0.1388
  ppg_red_crest_factor                     0.1373
  ppg_red_ddx_std                          0.1226
  ppg_red_kurtosis                         0.1213
  ppg_red_tke_std                          0.1198

PC5
  ppg_red_skew                             0.6928
  ppg_red_dx_kurtosis                      0.3981
  ppg_red_ddx_kurtosis                     0.3574
  ppg_red_ddx_mean                         0.2133
  ppg_red_median                           0.2098
  ppg_red_mean                             0.1861
  ppg_red_shape_factor                     0.1654
  ppg_red_max                              0.1500

PC6
  ppg_red_diff_mean                        0.7630
  ppg_red_skew                             0.3235
  ppg_red_dx_kurtosis                      0.2671
  ppg_red_ddx_kurtosis                     0.2512
  ppg_red_ddx_mean                         0.1986
  ppg_red_clearance_factor                 0.1550
  ppg_red_shape_factor                     0.1550
  ppg_red_mean_cross_rate                  0.1311

PC7
  ppg_red_ddx_mean                         0.4753
  ppg_red_diff_mean                        0.4511
  ppg_red_ddx_kurtosis                     0.3906
  ppg_red_dx_kurtosis                      0.3740
  ppg_red_skew                             0.3158
  ppg_red_median                           0.2210
  ppg_red_shape_factor                     0.1761
  ppg_red_clearance_factor                 0.1590

PC8
  ppg_red_tke_std                          0.5374
  ppg_red_median                           0.3673
  ppg_red_tke_mean                         0.3519
  ppg_red_iqr                              0.3262
  ppg_red_p10                              0.3151
  ppg_red_ddx_mean                         0.2650
  ppg_red_trim_mean_10                     0.1838
  ppg_red_crest_factor                     0.1694

Saved to: data/feature_extraction/analysis/quality_ppg_red_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_5.0s.csv
Shape: (793, 28)
Selected feature columns: 18
After NaN/variance filter: (793, 2)
After correlation pruning: (793, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5282   (cum 0.5282)
   PC2: 0.4718   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5282   (cum 0.5282)
   PC2: 0.4718   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_5.0s.csv | rows=755 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_5.0s.csv
Shape: (755, 33)
Selected feature columns: 26
After NaN/variance filter: (755, 26)
After correlation pruning: (755, 10)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.2412   (cum 0.2412)
   PC2: 0.1630   (cum 0.4042)
   PC3: 0.1312   (cum 0.5353)
   PC4: 0.1092   (cum 0.6446)
   PC5: 0.0977   (cum 0.7423)
   PC6: 0.0798   (cum 0.8221)
   PC7: 0.0717   (cum 0.8938)
   PC8: 0.0515   (cum 0.9453)
   PC9: 0.0339   (cum 0.9792)
  PC10: 0.0208   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mean_abs_diff            0.5514
  eda_stress_skin_min                      0.5117
  eda_stress_skin_slope                    0.4195
  eda_stress_skin_kurtosis                 0.3302
  eda_cc_slope                             0.2282
  eda_cc_max                               0.2127
  eda_stress_skin_skew                     0.1962
  eda_cc_kurtosis                          0.0769

PC2
  eda_stress_skin_skew                     0.5849
  eda_stress_skin_kurtosis                 0.5296
  eda_cc_kurtosis                          0.3799
  eda_cc_max                               0.2737
  eda_stress_skin_slope                    0.2489
  eda_cc_slope                             0.2353
  eda_stress_skin_mean_abs_diff            0.1264
  eda_cc_skew                              0.1259

PC3
  eda_cc_max                               0.6033
  eda_cc_slope                             0.5473
  eda_cc_kurtosis                          0.2925
  eda_cc_skew                              0.2912
  eda_stress_skin_mean_abs_diff            0.2423
  eda_stress_skin_min                      0.1892
  eda_stress_skin_skew                     0.1741
  eda_stress_skin_slope                    0.1670

PC4
  eda_cc_skew                              0.6269
  eda_cc_mean_abs_diff                     0.5045
  eda_cc_kurtosis                          0.3239
  eda_stress_skin_skew                     0.2897
  eda_cc_slope                             0.2716
  eda_stress_skin_kurtosis                 0.2078
  eda_cc_max                               0.1374
  eda_stress_skin_slope                    0.1299

PC5
  eda_cc_mean_abs_diff                     0.8297
  eda_cc_skew                              0.4343
  eda_stress_skin_slope                    0.2383
  eda_cc_kurtosis                          0.1647
  eda_cc_slope                             0.1426
  eda_stress_skin_kurtosis                 0.1328
  eda_stress_skin_skew                     0.0203
  eda_cc_max                               0.0182

PC6
  eda_cc_kurtosis                          0.7754
  eda_cc_skew                              0.4748
  eda_stress_skin_skew                     0.2151
  eda_stress_skin_kurtosis                 0.1984
  eda_cc_max                               0.1883
  eda_cc_slope                             0.1589
  eda_stress_skin_mean_abs_diff            0.1158
  eda_cc_mean_abs_diff                     0.0991

PC7
  eda_stress_skin_slope                    0.5780
  eda_cc_slope                             0.4506
  eda_cc_max                               0.3809
  eda_cc_skew                              0.2898
  eda_stress_skin_min                      0.2864
  eda_stress_skin_skew                     0.2717
  eda_stress_skin_mean_abs_diff            0.1521
  eda_stress_skin_kurtosis                 0.1451

PC8
  eda_stress_skin_min                      0.5958
  eda_cc_slope                             0.4659
  eda_cc_max                               0.4487
  eda_stress_skin_slope                    0.4287
  eda_stress_skin_mean_abs_diff            0.1350
  eda_cc_kurtosis                          0.0783
  eda_stress_skin_kurtosis                 0.0767
  eda_cc_skew                              0.0739

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.2412   (cum 0.2412)
   PC2: 0.1630   (cum 0.4042)
   PC3: 0.1312   (cum 0.5353)
   PC4: 0.1092   (cum 0.6446)
   PC5: 0.0977   (cum 0.7423)
   PC6: 0.0798   (cum 0.8221)
   PC7: 0.0717   (cum 0.8938)
   PC8: 0.0515   (cum 0.9453)
   PC9: 0.0339   (cum 0.9792)
  PC10: 0.0208   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mean_abs_diff            0.5514
  eda_stress_skin_min                      0.5117
  eda_stress_skin_slope                    0.4195
  eda_stress_skin_kurtosis                 0.3302
  eda_cc_slope                             0.2282
  eda_cc_max                               0.2127
  eda_stress_skin_skew                     0.1962
  eda_cc_kurtosis                          0.0769

PC2
  eda_stress_skin_skew                     0.5849
  eda_stress_skin_kurtosis                 0.5296
  eda_cc_kurtosis                          0.3799
  eda_cc_max                               0.2737
  eda_stress_skin_slope                    0.2489
  eda_cc_slope                             0.2353
  eda_stress_skin_mean_abs_diff            0.1264
  eda_cc_skew                              0.1259

PC3
  eda_cc_max                               0.6033
  eda_cc_slope                             0.5473
  eda_cc_kurtosis                          0.2925
  eda_cc_skew                              0.2912
  eda_stress_skin_mean_abs_diff            0.2423
  eda_stress_skin_min                      0.1892
  eda_stress_skin_skew                     0.1741
  eda_stress_skin_slope                    0.1670

PC4
  eda_cc_skew                              0.6269
  eda_cc_mean_abs_diff                     0.5045
  eda_cc_kurtosis                          0.3239
  eda_stress_skin_skew                     0.2897
  eda_cc_slope                             0.2716
  eda_stress_skin_kurtosis                 0.2078
  eda_cc_max                               0.1374
  eda_stress_skin_slope                    0.1299

PC5
  eda_cc_mean_abs_diff                     0.8297
  eda_cc_skew                              0.4343
  eda_stress_skin_slope                    0.2383
  eda_cc_kurtosis                          0.1647
  eda_cc_slope                             0.1426
  eda_stress_skin_kurtosis                 0.1328
  eda_stress_skin_skew                     0.0203
  eda_cc_max                               0.0182

PC6
  eda_cc_kurtosis                          0.7754
  eda_cc_skew                              0.4748
  eda_stress_skin_skew                     0.2151
  eda_stress_skin_kurtosis                 0.1984
  eda_cc_max                               0.1883
  eda_cc_slope                             0.1589
  eda_stress_skin_mean_abs_diff            0.1158
  eda_cc_mean_abs_diff                     0.0991

PC7
  eda_stress_skin_slope                    0.5780
  eda_cc_slope                             0.4506
  eda_cc_max                               0.3809
  eda_cc_skew                              0.2898
  eda_stress_skin_min                      0.2864
  eda_stress_skin_skew                     0.2717
  eda_stress_skin_mean_abs_diff            0.1521
  eda_stress_skin_kurtosis                 0.1451

PC8
  eda_stress_skin_min                      0.5958
  eda_cc_slope                             0.4659
  eda_cc_max                               0.4487
  eda_stress_skin_slope                    0.4287
  eda_stress_skin_mean_abs_diff            0.1350
  eda_cc_kurtosis                          0.0783
  eda_stress_skin_kurtosis                 0.0767
  eda_cc_skew                              0.0739

Saved to: data/feature_extraction/analysis/quality_eda_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_5.0s.csv
Shape: (755, 28)
Selected feature columns: 21
After NaN/variance filter: (755, 15)
After correlation pruning: (755, 5)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6012   (cum 0.6012)
   PC2: 0.2402   (cum 0.8413)
   PC3: 0.1283   (cum 0.9696)
   PC4: 0.0254   (cum 0.9950)
   PC5: 0.0050   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5612
  eda_scr_rate                             0.5525
  eda_scl_slope                            0.4682
  eda_phasic_auc                           0.2907
  eda_scl_max                              0.2760

PC2
  eda_phasic_auc                           0.7145
  eda_scl_max                              0.5659
  eda_scl_slope                            0.3753
  eda_scr_amp_sum                          0.1545
  eda_scr_rate                             0.0679

PC3
  eda_scl_max                              0.7762
  eda_scl_slope                            0.4435
  eda_phasic_auc                           0.4176
  eda_scr_rate                             0.1152
  eda_scr_amp_sum                          0.1147

PC4
  eda_scr_rate                             0.7118
  eda_scl_slope                            0.5843
  eda_phasic_auc                           0.3893
  eda_scl_max                              0.0191
  eda_scr_amp_sum                          0.0022

PC5
  eda_scr_amp_sum                          0.8050
  eda_scr_rate                             0.4127
  eda_scl_slope                            0.3191
  eda_phasic_auc                           0.2813
  eda_scl_max                              0.0267

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6012   (cum 0.6012)
   PC2: 0.2402   (cum 0.8413)
   PC3: 0.1283   (cum 0.9696)
   PC4: 0.0254   (cum 0.9950)
   PC5: 0.0050   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5612
  eda_scr_rate                             0.5525
  eda_scl_slope                            0.4682
  eda_phasic_auc                           0.2907
  eda_scl_max                              0.2760

PC2
  eda_phasic_auc                           0.7145
  eda_scl_max                              0.5659
  eda_scl_slope                            0.3753
  eda_scr_amp_sum                          0.1545
  eda_scr_rate                             0.0679

PC3
  eda_scl_max                              0.7762
  eda_scl_slope                            0.4435
  eda_phasic_auc                           0.4176
  eda_scr_rate                             0.1152
  eda_scr_amp_sum                          0.1147

PC4
  eda_scr_rate                             0.7118
  eda_scl_slope                            0.5843
  eda_phasic_auc                           0.3893
  eda_scl_max                              0.0191
  eda_scr_amp_sum                          0.0022

PC5
  eda_scr_amp_sum                          0.8050
  eda_scr_rate                             0.4127
  eda_scl_slope                            0.3191
  eda_phasic_auc                           0.2813
  eda_scl_max                              0.0267

Saved to: data/feature_extraction/analysis/quality_eda_advanced_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_features_2.0s.csv
Shape: (1943, 39)
Selected feature columns: 30
After NaN/variance filter: (1943, 30)
After correlation pruning: (1943, 30)

PCA summary (round 1):
  pcs_for_90pct: 15
  pcs_for_95pct: 19
  pcs_for_99pct: 26

Explained variance per PC (round 1):
   PC1: 0.3367   (cum 0.3367)
   PC2: 0.1537   (cum 0.4904)
   PC3: 0.0629   (cum 0.5532)
   PC4: 0.0584   (cum 0.6116)
   PC5: 0.0499   (cum 0.6615)
   PC6: 0.0393   (cum 0.7008)
   PC7: 0.0338   (cum 0.7346)
   PC8: 0.0334   (cum 0.7680)
   PC9: 0.0306   (cum 0.7986)
  PC10: 0.0276   (cum 0.8262)
  PC11: 0.0210   (cum 0.8472)
  PC12: 0.0193   (cum 0.8665)
  PC13: 0.0168   (cum 0.8834)
  PC14: 0.0136   (cum 0.8970)
  PC15: 0.0136   (cum 0.9106)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2809
  acc_y_dyn__avg_amplitude_change          0.2704
  acc_x_dyn__quantile_0.9                  0.2615
  acc_x_dyn__max                           0.2595
  acc_x_dyn__quantile_0.3                  0.2416
  acc_x_dyn__harmonic_mean_of_abs          0.2337
  acc_y_dyn__quantile_0.3                  0.2213
  acc_y_dyn__variance_of_absolute_differences 0.2176

PC2
  acc_y_dyn__sample_entropy                0.3477
  acc_x_dyn__sample_entropy                0.3457
  acc_z_dyn__sample_entropy                0.3270
  acc_x_dyn__approximate_entropy_0.9       0.3231
  acc_y_dyn__katz_fractal_dimension        0.3110
  acc_x_dyn__katz_fractal_dimension        0.2917
  acc_z_dyn__katz_fractal_dimension        0.2898
  acc_x_dyn__cardinality                   0.2620

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4002
  acc_z_dyn__approximate_entropy_0.1       0.3587
  acc_z_dyn__variance_of_absolute_differences 0.3146
  acc_y_dyn__quantile_0.4                  0.2788
  acc_y_dyn__quantile_0.3                  0.2509
  acc_x_dyn__cardinality                   0.2465
  acc_z_dyn__lower_complete_moment         0.2246
  acc_x_dyn__variance_of_absolute_differences 0.2106

PC4
  acc_z_dyn__approximate_entropy_0.1       0.3877
  acc_x_dyn__approximate_entropy_0.1       0.3618
  acc_y_dyn__quantile_0.4                  0.3386
  acc_y_dyn__quantile_0.3                  0.2990
  acc_z_dyn__quantile_0.6                  0.2952
  acc_z_dyn__lower_complete_moment         0.2586
  acc_x_dyn__cardinality                   0.2306
  acc_y_dyn__avg_amplitude_change          0.1968

PC5
  acc_x_dyn__quantile_0.4                  0.5617
  acc_x_dyn__quantile_0.3                  0.3839
  acc_z_dyn__quantile_0.4                  0.3261
  acc_x_dyn__quantile_0.6                  0.2909
  acc_z_dyn__variance_of_absolute_differences 0.2283
  acc_z_dyn__approximate_entropy_0.1       0.1888
  acc_z_dyn__lower_complete_moment         0.1787
  acc_y_dyn__variance_of_absolute_differences 0.1741

PC6
  acc_z_dyn__quantile_0.6                  0.4182
  acc_z_dyn__quantile_0.4                  0.3711
  acc_y_dyn__quantile_0.3                  0.2707
  acc_z_dyn__lower_complete_moment         0.2645
  acc_y_dyn__tsallis_entropy               0.2619
  acc_y_dyn__harmonic_mean_of_abs          0.2536
  acc_y_dyn__quantile_0.4                  0.2535
  acc_x_dyn__variance_of_absolute_differences 0.2405

PC7
  acc_y_dyn__tsallis_entropy               0.6922
  acc_y_dyn__sample_entropy                0.2707
  acc_z_dyn__quantile_0.4                  0.2540
  acc_z_dyn__harmonic_mean_of_abs          0.2223
  acc_x_dyn__quantile_0.6                  0.2204
  acc_x_dyn__cardinality                   0.2200
  acc_y_dyn__variance_of_absolute_differences 0.1784
  acc_x_dyn__approximate_entropy_0.9       0.1623

PC8
  acc_x_dyn__harmonic_mean                 0.9567
  acc_y_dyn__tsallis_entropy               0.1197
  acc_x_dyn__approximate_entropy_0.1       0.1064
  acc_z_dyn__harmonic_mean_of_abs          0.1019
  acc_x_dyn__variance_of_absolute_differences 0.0889
  acc_z_dyn__quantile_0.6                  0.0866
  acc_y_dyn__variance_of_absolute_differences 0.0846
  acc_z_dyn__variance_of_absolute_differences 0.0666

Stage 2: PCs used to reach 90%: 15
Stage 2: ranking pool size: 30
Stage 2: selected features: 30 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 15
  pcs_for_95pct: 19
  pcs_for_99pct: 26

Explained variance per PC (round 2):
   PC1: 0.3367   (cum 0.3367)
   PC2: 0.1537   (cum 0.4904)
   PC3: 0.0629   (cum 0.5532)
   PC4: 0.0584   (cum 0.6116)
   PC5: 0.0499   (cum 0.6615)
   PC6: 0.0393   (cum 0.7008)
   PC7: 0.0338   (cum 0.7346)
   PC8: 0.0334   (cum 0.7680)
   PC9: 0.0306   (cum 0.7986)
  PC10: 0.0276   (cum 0.8262)
  PC11: 0.0210   (cum 0.8472)
  PC12: 0.0193   (cum 0.8665)
  PC13: 0.0168   (cum 0.8834)
  PC14: 0.0136   (cum 0.8970)
  PC15: 0.0136   (cum 0.9106)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2809
  acc_y_dyn__avg_amplitude_change          0.2704
  acc_x_dyn__quantile_0.9                  0.2615
  acc_x_dyn__max                           0.2595
  acc_x_dyn__quantile_0.3                  0.2416
  acc_x_dyn__harmonic_mean_of_abs          0.2337
  acc_y_dyn__quantile_0.3                  0.2213
  acc_y_dyn__variance_of_absolute_differences 0.2176

PC2
  acc_y_dyn__sample_entropy                0.3477
  acc_x_dyn__sample_entropy                0.3457
  acc_z_dyn__sample_entropy                0.3270
  acc_x_dyn__approximate_entropy_0.9       0.3231
  acc_y_dyn__katz_fractal_dimension        0.3110
  acc_x_dyn__katz_fractal_dimension        0.2917
  acc_z_dyn__katz_fractal_dimension        0.2898
  acc_x_dyn__cardinality                   0.2620

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4002
  acc_z_dyn__approximate_entropy_0.1       0.3587
  acc_z_dyn__variance_of_absolute_differences 0.3146
  acc_y_dyn__quantile_0.4                  0.2788
  acc_y_dyn__quantile_0.3                  0.2509
  acc_x_dyn__cardinality                   0.2465
  acc_z_dyn__lower_complete_moment         0.2246
  acc_x_dyn__variance_of_absolute_differences 0.2106

PC4
  acc_z_dyn__approximate_entropy_0.1       0.3877
  acc_x_dyn__approximate_entropy_0.1       0.3618
  acc_y_dyn__quantile_0.4                  0.3386
  acc_y_dyn__quantile_0.3                  0.2990
  acc_z_dyn__quantile_0.6                  0.2952
  acc_z_dyn__lower_complete_moment         0.2586
  acc_x_dyn__cardinality                   0.2306
  acc_y_dyn__avg_amplitude_change          0.1968

PC5
  acc_x_dyn__quantile_0.4                  0.5617
  acc_x_dyn__quantile_0.3                  0.3839
  acc_z_dyn__quantile_0.4                  0.3261
  acc_x_dyn__quantile_0.6                  0.2909
  acc_z_dyn__variance_of_absolute_differences 0.2283
  acc_z_dyn__approximate_entropy_0.1       0.1888
  acc_z_dyn__lower_complete_moment         0.1787
  acc_y_dyn__variance_of_absolute_differences 0.1741

PC6
  acc_z_dyn__quantile_0.6                  0.4182
  acc_z_dyn__quantile_0.4                  0.3711
  acc_y_dyn__quantile_0.3                  0.2707
  acc_z_dyn__lower_complete_moment         0.2645
  acc_y_dyn__tsallis_entropy               0.2619
  acc_y_dyn__harmonic_mean_of_abs          0.2536
  acc_y_dyn__quantile_0.4                  0.2535
  acc_x_dyn__variance_of_absolute_differences 0.2405

PC7
  acc_y_dyn__tsallis_entropy               0.6922
  acc_y_dyn__sample_entropy                0.2707
  acc_z_dyn__quantile_0.4                  0.2540
  acc_z_dyn__harmonic_mean_of_abs          0.2223
  acc_x_dyn__quantile_0.6                  0.2204
  acc_x_dyn__cardinality                   0.2200
  acc_y_dyn__variance_of_absolute_differences 0.1784
  acc_x_dyn__approximate_entropy_0.9       0.1623

PC8
  acc_x_dyn__harmonic_mean                 0.9567
  acc_y_dyn__tsallis_entropy               0.1197
  acc_x_dyn__approximate_entropy_0.1       0.1064
  acc_z_dyn__harmonic_mean_of_abs          0.1019
  acc_x_dyn__variance_of_absolute_differences 0.0889
  acc_z_dyn__quantile_0.6                  0.0866
  acc_y_dyn__variance_of_absolute_differences 0.0846
  acc_z_dyn__variance_of_absolute_differences 0.0666

Saved to: data/feature_extraction/analysis/quality_imu_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_2.0s.csv | rows=1969 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_features_2.0s.csv
Shape: (1969, 51)
Selected feature columns: 44
After NaN/variance filter: (1969, 43)
After correlation pruning: (1969, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.4175   (cum 0.4175)
   PC2: 0.1216   (cum 0.5391)
   PC3: 0.1027   (cum 0.6417)
   PC4: 0.0689   (cum 0.7106)
   PC5: 0.0573   (cum 0.7679)
   PC6: 0.0531   (cum 0.8210)
   PC7: 0.0496   (cum 0.8706)
   PC8: 0.0416   (cum 0.9121)
   PC9: 0.0320   (cum 0.9441)
  PC10: 0.0158   (cum 0.9599)
  PC11: 0.0131   (cum 0.9730)
  PC12: 0.0118   (cum 0.9848)
  PC13: 0.0061   (cum 0.9909)
  PC14: 0.0043   (cum 0.9952)
  PC15: 0.0028   (cum 0.9980)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3575
  ppg_green_diff_mean_abs                  0.3446
  ppg_green_p90_p10                        0.3411
  ppg_green_clearance_factor               0.3284
  ppg_green_shape_factor                   0.3243
  ppg_green_tke_p95_abs                    0.3068
  ppg_green_tke_std                        0.2857
  ppg_green_iqr                            0.2658

PC2
  ppg_green_signal_energy                  0.5972
  ppg_green_p90                            0.5918
  ppg_green_mad                            0.2886
  ppg_green_tke_std                        0.2521
  ppg_green_iqr                            0.2285
  ppg_green_dx_kurtosis                    0.1981
  ppg_green_kurtosis                       0.1404
  ppg_green_tke_p95_abs                    0.0981

PC3
  ppg_green_kurtosis                       0.5003
  ppg_green_mean_cross_rate                0.3315
  ppg_green_iqr                            0.3234
  ppg_green_mad                            0.3137
  ppg_green_diff_mean                      0.3035
  ppg_green_p90                            0.2900
  ppg_green_signal_energy                  0.2617
  ppg_green_dx_kurtosis                    0.2212

PC4
  ppg_green_skew                           0.5400
  ppg_green_ddx_kurtosis                   0.5243
  ppg_green_ddx_mean                       0.3928
  ppg_green_dx_kurtosis                    0.3086
  ppg_green_diff_mean                      0.2095
  ppg_green_kurtosis                       0.1989
  ppg_green_tke_std                        0.1658
  ppg_green_clearance_factor               0.1583

PC5
  ppg_green_mean_cross_rate                0.7875
  ppg_green_diff_mean                      0.3554
  ppg_green_ddx_kurtosis                   0.2540
  ppg_green_ddx_mean                       0.2333
  ppg_green_dx_kurtosis                    0.2065
  ppg_green_tke_p95_abs                    0.1829
  ppg_green_diff_mean_abs                  0.1487
  ppg_green_skew                           0.1015

PC6
  ppg_green_ddx_mean                       0.7299
  ppg_green_diff_mean                      0.5287
  ppg_green_ddx_kurtosis                   0.2754
  ppg_green_dx_kurtosis                    0.1831
  ppg_green_tke_std                        0.1430
  ppg_green_skew                           0.1190
  ppg_green_signal_energy                  0.0956
  ppg_green_clearance_factor               0.0776

PC7
  ppg_green_skew                           0.5274
  ppg_green_diff_mean                      0.4835
  ppg_green_ddx_mean                       0.4422
  ppg_green_tke_p95_abs                    0.2344
  ppg_green_mean_cross_rate                0.1947
  ppg_green_kurtosis                       0.1855
  ppg_green_dx_kurtosis                    0.1654
  ppg_green_mad                            0.1562

PC8
  ppg_green_skew                           0.5039
  ppg_green_diff_mean                      0.4411
  ppg_green_ddx_kurtosis                   0.3749
  ppg_green_kurtosis                       0.2790
  ppg_green_shape_factor                   0.2712
  ppg_green_tke_std                        0.2340
  ppg_green_mean_cross_rate                0.2118
  ppg_green_mad                            0.1873

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.4175   (cum 0.4175)
   PC2: 0.1216   (cum 0.5391)
   PC3: 0.1027   (cum 0.6417)
   PC4: 0.0689   (cum 0.7106)
   PC5: 0.0573   (cum 0.7679)
   PC6: 0.0531   (cum 0.8210)
   PC7: 0.0496   (cum 0.8706)
   PC8: 0.0416   (cum 0.9121)
   PC9: 0.0320   (cum 0.9441)
  PC10: 0.0158   (cum 0.9599)
  PC11: 0.0131   (cum 0.9730)
  PC12: 0.0118   (cum 0.9848)
  PC13: 0.0061   (cum 0.9909)
  PC14: 0.0043   (cum 0.9952)
  PC15: 0.0028   (cum 0.9980)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3575
  ppg_green_diff_mean_abs                  0.3446
  ppg_green_p90_p10                        0.3411
  ppg_green_clearance_factor               0.3284
  ppg_green_shape_factor                   0.3243
  ppg_green_tke_p95_abs                    0.3068
  ppg_green_tke_std                        0.2857
  ppg_green_iqr                            0.2658

PC2
  ppg_green_signal_energy                  0.5972
  ppg_green_p90                            0.5918
  ppg_green_mad                            0.2886
  ppg_green_tke_std                        0.2521
  ppg_green_iqr                            0.2285
  ppg_green_dx_kurtosis                    0.1981
  ppg_green_kurtosis                       0.1404
  ppg_green_tke_p95_abs                    0.0981

PC3
  ppg_green_kurtosis                       0.5003
  ppg_green_mean_cross_rate                0.3315
  ppg_green_iqr                            0.3234
  ppg_green_mad                            0.3137
  ppg_green_diff_mean                      0.3035
  ppg_green_p90                            0.2900
  ppg_green_signal_energy                  0.2617
  ppg_green_dx_kurtosis                    0.2212

PC4
  ppg_green_skew                           0.5400
  ppg_green_ddx_kurtosis                   0.5243
  ppg_green_ddx_mean                       0.3928
  ppg_green_dx_kurtosis                    0.3086
  ppg_green_diff_mean                      0.2095
  ppg_green_kurtosis                       0.1989
  ppg_green_tke_std                        0.1658
  ppg_green_clearance_factor               0.1583

PC5
  ppg_green_mean_cross_rate                0.7875
  ppg_green_diff_mean                      0.3554
  ppg_green_ddx_kurtosis                   0.2540
  ppg_green_ddx_mean                       0.2333
  ppg_green_dx_kurtosis                    0.2065
  ppg_green_tke_p95_abs                    0.1829
  ppg_green_diff_mean_abs                  0.1487
  ppg_green_skew                           0.1015

PC6
  ppg_green_ddx_mean                       0.7299
  ppg_green_diff_mean                      0.5287
  ppg_green_ddx_kurtosis                   0.2754
  ppg_green_dx_kurtosis                    0.1831
  ppg_green_tke_std                        0.1430
  ppg_green_skew                           0.1190
  ppg_green_signal_energy                  0.0956
  ppg_green_clearance_factor               0.0776

PC7
  ppg_green_skew                           0.5274
  ppg_green_diff_mean                      0.4835
  ppg_green_ddx_mean                       0.4422
  ppg_green_tke_p95_abs                    0.2344
  ppg_green_mean_cross_rate                0.1947
  ppg_green_kurtosis                       0.1855
  ppg_green_dx_kurtosis                    0.1654
  ppg_green_mad                            0.1562

PC8
  ppg_green_skew                           0.5039
  ppg_green_diff_mean                      0.4411
  ppg_green_ddx_kurtosis                   0.3749
  ppg_green_kurtosis                       0.2790
  ppg_green_shape_factor                   0.2712
  ppg_green_tke_std                        0.2340
  ppg_green_mean_cross_rate                0.2118
  ppg_green_mad                            0.1873

Saved to: data/feature_extraction/analysis/quality_ppg_green_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_2.0s.csv
Shape: (1969, 28)
Selected feature columns: 15
After NaN/variance filter: (1969, 2)
After correlation pruning: (1969, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8004   (cum 0.8004)
   PC2: 0.1996   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8004   (cum 0.8004)
   PC2: 0.1996   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_2.0s.csv | rows=1969 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_features_2.0s.csv
Shape: (1969, 51)
Selected feature columns: 44
After NaN/variance filter: (1969, 44)
After correlation pruning: (1969, 23)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 1):
   PC1: 0.3444   (cum 0.3444)
   PC2: 0.2111   (cum 0.5555)
   PC3: 0.0875   (cum 0.6430)
   PC4: 0.0782   (cum 0.7212)
   PC5: 0.0499   (cum 0.7711)
   PC6: 0.0469   (cum 0.8180)
   PC7: 0.0419   (cum 0.8599)
   PC8: 0.0318   (cum 0.8917)
   PC9: 0.0273   (cum 0.9191)
  PC10: 0.0164   (cum 0.9355)
  PC11: 0.0150   (cum 0.9504)
  PC12: 0.0120   (cum 0.9624)
  PC13: 0.0084   (cum 0.9709)
  PC14: 0.0073   (cum 0.9782)
  PC15: 0.0063   (cum 0.9845)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_diff_mean_abs                  0.3373
  ppg_infra_max                            0.3327
  ppg_infra_ddx_std                        0.3295
  ppg_infra_p90                            0.3240
  ppg_infra_p5                             0.3233
  ppg_infra_signal_energy                  0.3195
  ppg_infra_tke_mean_abs                   0.3188
  ppg_infra_iqr                            0.3120

PC2
  ppg_infra_impulse_factor                 0.4377
  ppg_infra_kurtosis                       0.4113
  ppg_infra_crest_factor                   0.4069
  ppg_infra_shape_factor                   0.4043
  ppg_infra_clearance_factor               0.3953
  ppg_infra_dx_kurtosis                    0.2241
  ppg_infra_ddx_kurtosis                   0.1498
  ppg_infra_zcr                            0.1427

PC3
  ppg_infra_trim_mean_10                   0.4382
  ppg_infra_median                         0.4268
  ppg_infra_mean_cross_rate                0.4233
  ppg_infra_zcr                            0.4153
  ppg_infra_ddx_mean                       0.3104
  ppg_infra_skew                           0.2781
  ppg_infra_ddx_kurtosis                   0.1376
  ppg_infra_tke_std                        0.1367

PC4
  ppg_infra_mean_cross_rate                0.4930
  ppg_infra_zcr                            0.4850
  ppg_infra_median                         0.4302
  ppg_infra_trim_mean_10                   0.4131
  ppg_infra_ddx_mean                       0.2567
  ppg_infra_ddx_kurtosis                   0.1915
  ppg_infra_dx_kurtosis                    0.1732
  ppg_infra_diff_mean_abs                  0.1064

PC5
  ppg_infra_skew                           0.5240
  ppg_infra_dx_mean                        0.4616
  ppg_infra_ddx_mean                       0.4183
  ppg_infra_dx_kurtosis                    0.3290
  ppg_infra_ddx_kurtosis                   0.2334
  ppg_infra_trim_mean_10                   0.2137
  ppg_infra_median                         0.1909
  ppg_infra_p90                            0.1480

PC6
  ppg_infra_dx_kurtosis                    0.4977
  ppg_infra_dx_mean                        0.4488
  ppg_infra_ddx_kurtosis                   0.3759
  ppg_infra_tke_std                        0.2353
  ppg_infra_ddx_mean                       0.2318
  ppg_infra_median                         0.2228
  ppg_infra_signal_energy                  0.1826
  ppg_infra_clearance_factor               0.1760

PC7
  ppg_infra_dx_mean                        0.7058
  ppg_infra_skew                           0.5215
  ppg_infra_ddx_mean                       0.2779
  ppg_infra_dx_kurtosis                    0.1613
  ppg_infra_p5                             0.1589
  ppg_infra_ddx_kurtosis                   0.1486
  ppg_infra_clearance_factor               0.1276
  ppg_infra_trim_mean_10                   0.1212

PC8
  ppg_infra_ddx_mean                       0.5091
  ppg_infra_ddx_kurtosis                   0.3537
  ppg_infra_skew                           0.3208
  ppg_infra_trim_mean_10                   0.3137
  ppg_infra_tke_std                        0.3070
  ppg_infra_tke_mean_abs                   0.2590
  ppg_infra_median                         0.2408
  ppg_infra_dx_mean                        0.2378

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 11
  pcs_for_99pct: 17

Explained variance per PC (round 2):
   PC1: 0.3444   (cum 0.3444)
   PC2: 0.2111   (cum 0.5555)
   PC3: 0.0875   (cum 0.6430)
   PC4: 0.0782   (cum 0.7212)
   PC5: 0.0499   (cum 0.7711)
   PC6: 0.0469   (cum 0.8180)
   PC7: 0.0419   (cum 0.8599)
   PC8: 0.0318   (cum 0.8917)
   PC9: 0.0273   (cum 0.9191)
  PC10: 0.0164   (cum 0.9355)
  PC11: 0.0150   (cum 0.9504)
  PC12: 0.0120   (cum 0.9624)
  PC13: 0.0084   (cum 0.9709)
  PC14: 0.0073   (cum 0.9782)
  PC15: 0.0063   (cum 0.9845)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_diff_mean_abs                  0.3373
  ppg_infra_max                            0.3327
  ppg_infra_ddx_std                        0.3295
  ppg_infra_p90                            0.3240
  ppg_infra_p5                             0.3233
  ppg_infra_signal_energy                  0.3195
  ppg_infra_tke_mean_abs                   0.3188
  ppg_infra_iqr                            0.3120

PC2
  ppg_infra_impulse_factor                 0.4377
  ppg_infra_kurtosis                       0.4113
  ppg_infra_crest_factor                   0.4069
  ppg_infra_shape_factor                   0.4043
  ppg_infra_clearance_factor               0.3953
  ppg_infra_dx_kurtosis                    0.2241
  ppg_infra_ddx_kurtosis                   0.1498
  ppg_infra_zcr                            0.1427

PC3
  ppg_infra_trim_mean_10                   0.4382
  ppg_infra_median                         0.4268
  ppg_infra_mean_cross_rate                0.4233
  ppg_infra_zcr                            0.4153
  ppg_infra_ddx_mean                       0.3104
  ppg_infra_skew                           0.2781
  ppg_infra_ddx_kurtosis                   0.1376
  ppg_infra_tke_std                        0.1367

PC4
  ppg_infra_mean_cross_rate                0.4930
  ppg_infra_zcr                            0.4850
  ppg_infra_median                         0.4302
  ppg_infra_trim_mean_10                   0.4131
  ppg_infra_ddx_mean                       0.2567
  ppg_infra_ddx_kurtosis                   0.1915
  ppg_infra_dx_kurtosis                    0.1732
  ppg_infra_diff_mean_abs                  0.1064

PC5
  ppg_infra_skew                           0.5240
  ppg_infra_dx_mean                        0.4616
  ppg_infra_ddx_mean                       0.4183
  ppg_infra_dx_kurtosis                    0.3290
  ppg_infra_ddx_kurtosis                   0.2334
  ppg_infra_trim_mean_10                   0.2137
  ppg_infra_median                         0.1909
  ppg_infra_p90                            0.1480

PC6
  ppg_infra_dx_kurtosis                    0.4977
  ppg_infra_dx_mean                        0.4488
  ppg_infra_ddx_kurtosis                   0.3759
  ppg_infra_tke_std                        0.2353
  ppg_infra_ddx_mean                       0.2318
  ppg_infra_median                         0.2228
  ppg_infra_signal_energy                  0.1826
  ppg_infra_clearance_factor               0.1760

PC7
  ppg_infra_dx_mean                        0.7058
  ppg_infra_skew                           0.5215
  ppg_infra_ddx_mean                       0.2779
  ppg_infra_dx_kurtosis                    0.1613
  ppg_infra_p5                             0.1589
  ppg_infra_ddx_kurtosis                   0.1486
  ppg_infra_clearance_factor               0.1276
  ppg_infra_trim_mean_10                   0.1212

PC8
  ppg_infra_ddx_mean                       0.5091
  ppg_infra_ddx_kurtosis                   0.3537
  ppg_infra_skew                           0.3208
  ppg_infra_trim_mean_10                   0.3137
  ppg_infra_tke_std                        0.3070
  ppg_infra_tke_mean_abs                   0.2590
  ppg_infra_median                         0.2408
  ppg_infra_dx_mean                        0.2378

Saved to: data/feature_extraction/analysis/quality_ppg_infra_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_2.0s.csv
Shape: (1969, 28)
Selected feature columns: 15
After NaN/variance filter: (1969, 2)
After correlation pruning: (1969, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7790   (cum 0.7790)
   PC2: 0.2210   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7790   (cum 0.7790)
   PC2: 0.2210   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

PC2
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_2.0s.csv | rows=1969 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_features_2.0s.csv
Shape: (1969, 51)
Selected feature columns: 44
After NaN/variance filter: (1969, 44)
After correlation pruning: (1969, 20)

PCA summary (round 1):
  pcs_for_90pct: 9
  pcs_for_95pct: 12
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3008   (cum 0.3008)
   PC2: 0.2057   (cum 0.5065)
   PC3: 0.0985   (cum 0.6050)
   PC4: 0.0944   (cum 0.6994)
   PC5: 0.0552   (cum 0.7547)
   PC6: 0.0505   (cum 0.8052)
   PC7: 0.0449   (cum 0.8501)
   PC8: 0.0348   (cum 0.8849)
   PC9: 0.0282   (cum 0.9131)
  PC10: 0.0176   (cum 0.9307)
  PC11: 0.0172   (cum 0.9479)
  PC12: 0.0145   (cum 0.9624)
  PC13: 0.0128   (cum 0.9752)
  PC14: 0.0066   (cum 0.9818)
  PC15: 0.0063   (cum 0.9881)

Top PCA loadings per component (round 1):

PC1
  ppg_red_diff_mean_abs                    0.3853
  ppg_red_p95                              0.3785
  ppg_red_p10                              0.3752
  ppg_red_ddx_std                          0.3717
  ppg_red_iqr                              0.3668
  ppg_red_signal_energy                    0.3653
  ppg_red_tke_std                          0.3072
  ppg_red_ddx_kurtosis                     0.1946

PC2
  ppg_red_kurtosis                         0.4493
  ppg_red_clearance_factor                 0.4443
  ppg_red_crest_factor                     0.4410
  ppg_red_shape_factor                     0.4326
  ppg_red_dx_kurtosis                      0.3134
  ppg_red_ddx_kurtosis                     0.2232
  ppg_red_iqr                              0.1338
  ppg_red_zcr                              0.1281

PC3
  ppg_red_mean_cross_rate                  0.5533
  ppg_red_zcr                              0.5457
  ppg_red_median                           0.3074
  ppg_red_mean                             0.3056
  ppg_red_ddx_mean                         0.2237
  ppg_red_ddx_kurtosis                     0.2097
  ppg_red_skew                             0.2035
  ppg_red_dx_kurtosis                      0.1613

PC4
  ppg_red_mean                             0.5273
  ppg_red_median                           0.5062
  ppg_red_ddx_mean                         0.4244
  ppg_red_mean_cross_rate                  0.3504
  ppg_red_zcr                              0.3395
  ppg_red_ddx_kurtosis                     0.1040
  ppg_red_skew                             0.0987
  ppg_red_diff_mean_abs                    0.0896

PC5
  ppg_red_skew                             0.7895
  ppg_red_ddx_mean                         0.2849
  ppg_red_mean                             0.2787
  ppg_red_median                           0.2731
  ppg_red_dx_mean                          0.2161
  ppg_red_p95                              0.1784
  ppg_red_dx_kurtosis                      0.1231
  ppg_red_p10                              0.1224

PC6
  ppg_red_dx_mean                          0.9267
  ppg_red_skew                             0.2098
  ppg_red_dx_kurtosis                      0.1486
  ppg_red_ddx_kurtosis                     0.1086
  ppg_red_tke_std                          0.1068
  ppg_red_mean                             0.0839
  ppg_red_ddx_std                          0.0809
  ppg_red_crest_factor                     0.0797

PC7
  ppg_red_dx_kurtosis                      0.5214
  ppg_red_ddx_kurtosis                     0.4847
  ppg_red_shape_factor                     0.2800
  ppg_red_clearance_factor                 0.2653
  ppg_red_ddx_mean                         0.2609
  ppg_red_dx_mean                          0.2371
  ppg_red_mean_cross_rate                  0.1750
  ppg_red_signal_energy                    0.1604

PC8
  ppg_red_ddx_mean                         0.7111
  ppg_red_median                           0.3869
  ppg_red_mean                             0.3015
  ppg_red_skew                             0.2869
  ppg_red_ddx_kurtosis                     0.2544
  ppg_red_tke_std                          0.1881
  ppg_red_dx_kurtosis                      0.1400
  ppg_red_dx_mean                          0.1284

Stage 2: PCs used to reach 90%: 9
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 9
  pcs_for_95pct: 12
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3008   (cum 0.3008)
   PC2: 0.2057   (cum 0.5065)
   PC3: 0.0985   (cum 0.6050)
   PC4: 0.0944   (cum 0.6994)
   PC5: 0.0552   (cum 0.7547)
   PC6: 0.0505   (cum 0.8052)
   PC7: 0.0449   (cum 0.8501)
   PC8: 0.0348   (cum 0.8849)
   PC9: 0.0282   (cum 0.9131)
  PC10: 0.0176   (cum 0.9307)
  PC11: 0.0172   (cum 0.9479)
  PC12: 0.0145   (cum 0.9624)
  PC13: 0.0128   (cum 0.9752)
  PC14: 0.0066   (cum 0.9818)
  PC15: 0.0063   (cum 0.9881)

Top PCA loadings per component (round 2):

PC1
  ppg_red_diff_mean_abs                    0.3853
  ppg_red_p95                              0.3785
  ppg_red_p10                              0.3752
  ppg_red_ddx_std                          0.3717
  ppg_red_iqr                              0.3668
  ppg_red_signal_energy                    0.3653
  ppg_red_tke_std                          0.3072
  ppg_red_ddx_kurtosis                     0.1946

PC2
  ppg_red_kurtosis                         0.4493
  ppg_red_clearance_factor                 0.4443
  ppg_red_crest_factor                     0.4410
  ppg_red_shape_factor                     0.4326
  ppg_red_dx_kurtosis                      0.3134
  ppg_red_ddx_kurtosis                     0.2232
  ppg_red_iqr                              0.1338
  ppg_red_zcr                              0.1281

PC3
  ppg_red_mean_cross_rate                  0.5533
  ppg_red_zcr                              0.5457
  ppg_red_median                           0.3074
  ppg_red_mean                             0.3056
  ppg_red_ddx_mean                         0.2237
  ppg_red_ddx_kurtosis                     0.2097
  ppg_red_skew                             0.2035
  ppg_red_dx_kurtosis                      0.1613

PC4
  ppg_red_mean                             0.5273
  ppg_red_median                           0.5062
  ppg_red_ddx_mean                         0.4244
  ppg_red_mean_cross_rate                  0.3504
  ppg_red_zcr                              0.3395
  ppg_red_ddx_kurtosis                     0.1040
  ppg_red_skew                             0.0987
  ppg_red_diff_mean_abs                    0.0896

PC5
  ppg_red_skew                             0.7895
  ppg_red_ddx_mean                         0.2849
  ppg_red_mean                             0.2787
  ppg_red_median                           0.2731
  ppg_red_dx_mean                          0.2161
  ppg_red_p95                              0.1784
  ppg_red_dx_kurtosis                      0.1231
  ppg_red_p10                              0.1224

PC6
  ppg_red_dx_mean                          0.9267
  ppg_red_skew                             0.2098
  ppg_red_dx_kurtosis                      0.1486
  ppg_red_ddx_kurtosis                     0.1086
  ppg_red_tke_std                          0.1068
  ppg_red_mean                             0.0839
  ppg_red_ddx_std                          0.0809
  ppg_red_crest_factor                     0.0797

PC7
  ppg_red_dx_kurtosis                      0.5214
  ppg_red_ddx_kurtosis                     0.4847
  ppg_red_shape_factor                     0.2800
  ppg_red_clearance_factor                 0.2653
  ppg_red_ddx_mean                         0.2609
  ppg_red_dx_mean                          0.2371
  ppg_red_mean_cross_rate                  0.1750
  ppg_red_signal_energy                    0.1604

PC8
  ppg_red_ddx_mean                         0.7111
  ppg_red_median                           0.3869
  ppg_red_mean                             0.3015
  ppg_red_skew                             0.2869
  ppg_red_ddx_kurtosis                     0.2544
  ppg_red_tke_std                          0.1881
  ppg_red_dx_kurtosis                      0.1400
  ppg_red_dx_mean                          0.1284

Saved to: data/feature_extraction/analysis/quality_ppg_red_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_2.0s.csv
Shape: (1969, 28)
Selected feature columns: 15
After NaN/variance filter: (1969, 2)
After correlation pruning: (1969, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7896   (cum 0.7896)
   PC2: 0.2104   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7896   (cum 0.7896)
   PC2: 0.2104   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_2.0s.csv | rows=1876 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_features_2.0s.csv
Shape: (1876, 33)
Selected feature columns: 26
After NaN/variance filter: (1876, 26)
After correlation pruning: (1876, 10)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.2425   (cum 0.2425)
   PC2: 0.1629   (cum 0.4054)
   PC3: 0.1465   (cum 0.5520)
   PC4: 0.1163   (cum 0.6683)
   PC5: 0.1001   (cum 0.7684)
   PC6: 0.0751   (cum 0.8435)
   PC7: 0.0521   (cum 0.8956)
   PC8: 0.0436   (cum 0.9393)
   PC9: 0.0395   (cum 0.9787)
  PC10: 0.0213   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mad                      0.5664
  eda_stress_skin_min                      0.5227
  eda_stress_skin_slope                    0.4326
  eda_stress_skin_kurtosis                 0.3199
  eda_cc_slope                             0.2302
  eda_cc_max                               0.2047
  eda_stress_skin_skew                     0.1276
  eda_cc_mean_abs_diff                     0.0716

PC2
  eda_cc_kurtosis                          0.6521
  eda_cc_skew                              0.5835
  eda_stress_skin_skew                     0.3666
  eda_stress_skin_kurtosis                 0.2412
  eda_cc_mean_abs_diff                     0.1143
  eda_cc_slope                             0.0978
  eda_stress_skin_slope                    0.0971
  eda_cc_max                               0.0846

PC3
  eda_cc_max                               0.5511
  eda_stress_skin_kurtosis                 0.4785
  eda_cc_slope                             0.4321
  eda_stress_skin_skew                     0.3299
  eda_cc_skew                              0.3241
  eda_cc_kurtosis                          0.2190
  eda_stress_skin_slope                    0.1121
  eda_stress_skin_mad                      0.0589

PC4
  eda_stress_skin_skew                     0.5252
  eda_cc_slope                             0.4918
  eda_cc_max                               0.3875
  eda_stress_skin_slope                    0.3201
  eda_stress_skin_kurtosis                 0.2762
  eda_cc_skew                              0.2453
  eda_stress_skin_mad                      0.2292
  eda_stress_skin_min                      0.1596

PC5
  eda_cc_mean_abs_diff                     0.9701
  eda_stress_skin_skew                     0.1631
  eda_stress_skin_slope                    0.1524
  eda_cc_skew                              0.0590
  eda_cc_kurtosis                          0.0568
  eda_stress_skin_kurtosis                 0.0306
  eda_stress_skin_mad                      0.0272
  eda_stress_skin_min                      0.0242

PC6
  eda_stress_skin_slope                    0.5562
  eda_cc_slope                             0.4633
  eda_stress_skin_skew                     0.4149
  eda_cc_max                               0.3616
  eda_stress_skin_min                      0.2397
  eda_stress_skin_kurtosis                 0.2191
  eda_cc_mean_abs_diff                     0.1557
  eda_cc_skew                              0.1556

PC7
  eda_stress_skin_min                      0.5196
  eda_cc_max                               0.4955
  eda_cc_slope                             0.4901
  eda_stress_skin_slope                    0.4058
  eda_stress_skin_mad                      0.1655
  eda_cc_kurtosis                          0.1422
  eda_cc_skew                              0.1283
  eda_stress_skin_skew                     0.0804

PC8
  eda_cc_skew                              0.5717
  eda_cc_kurtosis                          0.5613
  eda_stress_skin_kurtosis                 0.4137
  eda_stress_skin_min                      0.3302
  eda_stress_skin_slope                    0.2080
  eda_stress_skin_skew                     0.1445
  eda_cc_max                               0.0852
  eda_stress_skin_mad                      0.0797

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.2425   (cum 0.2425)
   PC2: 0.1629   (cum 0.4054)
   PC3: 0.1465   (cum 0.5520)
   PC4: 0.1163   (cum 0.6683)
   PC5: 0.1001   (cum 0.7684)
   PC6: 0.0751   (cum 0.8435)
   PC7: 0.0521   (cum 0.8956)
   PC8: 0.0436   (cum 0.9393)
   PC9: 0.0395   (cum 0.9787)
  PC10: 0.0213   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mad                      0.5664
  eda_stress_skin_min                      0.5227
  eda_stress_skin_slope                    0.4326
  eda_stress_skin_kurtosis                 0.3199
  eda_cc_slope                             0.2302
  eda_cc_max                               0.2047
  eda_stress_skin_skew                     0.1276
  eda_cc_mean_abs_diff                     0.0716

PC2
  eda_cc_kurtosis                          0.6521
  eda_cc_skew                              0.5835
  eda_stress_skin_skew                     0.3666
  eda_stress_skin_kurtosis                 0.2412
  eda_cc_mean_abs_diff                     0.1143
  eda_cc_slope                             0.0978
  eda_stress_skin_slope                    0.0971
  eda_cc_max                               0.0846

PC3
  eda_cc_max                               0.5511
  eda_stress_skin_kurtosis                 0.4785
  eda_cc_slope                             0.4321
  eda_stress_skin_skew                     0.3299
  eda_cc_skew                              0.3241
  eda_cc_kurtosis                          0.2190
  eda_stress_skin_slope                    0.1121
  eda_stress_skin_mad                      0.0589

PC4
  eda_stress_skin_skew                     0.5252
  eda_cc_slope                             0.4918
  eda_cc_max                               0.3875
  eda_stress_skin_slope                    0.3201
  eda_stress_skin_kurtosis                 0.2762
  eda_cc_skew                              0.2453
  eda_stress_skin_mad                      0.2292
  eda_stress_skin_min                      0.1596

PC5
  eda_cc_mean_abs_diff                     0.9701
  eda_stress_skin_skew                     0.1631
  eda_stress_skin_slope                    0.1524
  eda_cc_skew                              0.0590
  eda_cc_kurtosis                          0.0568
  eda_stress_skin_kurtosis                 0.0306
  eda_stress_skin_mad                      0.0272
  eda_stress_skin_min                      0.0242

PC6
  eda_stress_skin_slope                    0.5562
  eda_cc_slope                             0.4633
  eda_stress_skin_skew                     0.4149
  eda_cc_max                               0.3616
  eda_stress_skin_min                      0.2397
  eda_stress_skin_kurtosis                 0.2191
  eda_cc_mean_abs_diff                     0.1557
  eda_cc_skew                              0.1556

PC7
  eda_stress_skin_min                      0.5196
  eda_cc_max                               0.4955
  eda_cc_slope                             0.4901
  eda_stress_skin_slope                    0.4058
  eda_stress_skin_mad                      0.1655
  eda_cc_kurtosis                          0.1422
  eda_cc_skew                              0.1283
  eda_stress_skin_skew                     0.0804

PC8
  eda_cc_skew                              0.5717
  eda_cc_kurtosis                          0.5613
  eda_stress_skin_kurtosis                 0.4137
  eda_stress_skin_min                      0.3302
  eda_stress_skin_slope                    0.2080
  eda_stress_skin_skew                     0.1445
  eda_cc_max                               0.0852
  eda_stress_skin_mad                      0.0797

Saved to: data/feature_extraction/analysis/quality_eda_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_2.0s.csv
Shape: (1876, 28)
Selected feature columns: 21
After NaN/variance filter: (1876, 15)
After correlation pruning: (1876, 5)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.5942   (cum 0.5942)
   PC2: 0.2268   (cum 0.8210)
   PC3: 0.1500   (cum 0.9710)
   PC4: 0.0274   (cum 0.9984)
   PC5: 0.0016   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5550
  eda_scl_slope                            0.5493
  eda_scr_count                            0.5344
  eda_scl_max                              0.2950
  eda_scl_range                            0.1328

PC2
  eda_scl_range                            0.8657
  eda_scl_max                              0.3997
  eda_scr_amp_sum                          0.2401
  eda_scl_slope                            0.1672
  eda_scr_count                            0.0720

PC3
  eda_scl_max                              0.8637
  eda_scl_range                            0.3582
  eda_scr_count                            0.2858
  eda_scl_slope                            0.1958
  eda_scr_amp_sum                          0.0757

PC4
  eda_scr_count                            0.7844
  eda_scl_slope                            0.5430
  eda_scr_amp_sum                          0.2788
  eda_scl_max                              0.0809
  eda_scl_range                            0.0751

PC5
  eda_scr_amp_sum                          0.7422
  eda_scl_slope                            0.5806
  eda_scl_range                            0.3146
  eda_scr_count                            0.1109
  eda_scl_max                              0.0272

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.5942   (cum 0.5942)
   PC2: 0.2268   (cum 0.8210)
   PC3: 0.1500   (cum 0.9710)
   PC4: 0.0274   (cum 0.9984)
   PC5: 0.0016   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5550
  eda_scl_slope                            0.5493
  eda_scr_count                            0.5344
  eda_scl_max                              0.2950
  eda_scl_range                            0.1328

PC2
  eda_scl_range                            0.8657
  eda_scl_max                              0.3997
  eda_scr_amp_sum                          0.2401
  eda_scl_slope                            0.1672
  eda_scr_count                            0.0720

PC3
  eda_scl_max                              0.8637
  eda_scl_range                            0.3582
  eda_scr_count                            0.2858
  eda_scl_slope                            0.1958
  eda_scr_amp_sum                          0.0757

PC4
  eda_scr_count                            0.7844
  eda_scl_slope                            0.5430
  eda_scr_amp_sum                          0.2788
  eda_scl_max                              0.0809
  eda_scl_range                            0.0751

PC5
  eda_scr_amp_sum                          0.7422
  eda_scl_slope                            0.5806
  eda_scl_range                            0.3146
  eda_scr_count                            0.1109
  eda_scl_max                              0.0272

Saved to: data/feature_extraction/analysis/quality_eda_advanced_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_5.0s.csv | windows=793 | features=21
    ✓ HRV features: 793 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_aligned_5.0s.csv (793 windows | borg labeled: 287)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_aligned_5.0s.csv (793 windows | borg labeled: 287)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_5.0s.csv | windows=793 | features=21
    ✓ HRV features: 793 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_aligned_5.0s.csv (793 windows | borg labeled: 287)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 793
  Windows in ADL time range: 439
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_aligned_5.0s.csv (793 windows | borg labeled: 287)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_5.0s.csv | windows=755 | features=21
    ✓ Advanced EDA features: 755 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 755
  Windows in ADL time range: 438
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_aligned_5.0s.csv (755 windows | borg labeled: 288)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 755
  Windows in ADL time range: 438
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_aligned_5.0s.csv (755 windows | borg labeled: 288)

▶ Window length: 2.0s | overlap=0.1
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1943
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/imu_wrist/imu_aligned_2.0s.csv (1943 windows | borg labeled: 706)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_features_2.0s.csv | windows=1969 | features=21
    ✓ HRV features: 1969 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_green/ppg_green_hrv_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_features_2.0s.csv | windows=1969 | features=21
    ✓ HRV features: 1969 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_infra/ppg_infra_hrv_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_features_2.0s.csv | windows=1969 | features=21
    ✓ HRV features: 1969 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1969
  Windows in ADL time range: 1089
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/ppg_red/ppg_red_hrv_aligned_2.0s.csv (1969 windows | borg labeled: 710)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_features_2.0s.csv | windows=1876 | features=21
    ✓ Advanced EDA features: 1876 windows
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1876
  Windows in ADL time range: 1090
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_aligned_2.0s.csv (1876 windows | borg labeled: 713)
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1876
  Windows in ADL time range: 1090
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/eda/eda_advanced_aligned_2.0s.csv (1876 windows | borg labeled: 713)

▶ Fusion step
  Running fusion...

▶ Fusing features for window length: 10.0s
  Loaded eda: 377 windows | t_center min=1764836868.000 max=1764840252.000 n=377
  Loaded eda_advanced: 377 windows | t_center min=1764836868.000 max=1764840252.000 n=377
  Loaded imu_bioz: 327 windows | t_center min=1764837305.000 max=1764840239.000 n=327
  Loaded imu_wrist: 391 windows | t_center min=1764836773.000 max=1764840283.000 n=391
  Loaded ppg_green: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Loaded ppg_green_hrv: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Loaded ppg_infra: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Loaded ppg_infra_hrv: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Loaded ppg_red: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Loaded ppg_red_hrv: 396 windows | t_center min=1764836701.000 max=1764840256.000 n=396
  Dropped 12 invalid feature columns
  ✓ Wrote 0 fused windows → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_features_10.0s.csv

▶ Fusing features for window length: 5.0s
  Loaded eda: 755 windows | t_center min=1764836865.500 max=1764840258.500 n=755
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
  Loaded eda_advanced: 755 windows | t_center min=1764836865.500 max=1764840258.500 n=755
  Loaded imu_bioz: 654 windows | t_center min=1764837302.500 max=1764840241.000 n=654
  Loaded imu_wrist: 782 windows | t_center min=1764836770.500 max=1764840285.000 n=782
  Loaded ppg_green: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Loaded ppg_green_hrv: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Loaded ppg_infra: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Loaded ppg_infra_hrv: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Loaded ppg_red: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Loaded ppg_red_hrv: 793 windows | t_center min=1764836698.500 max=1764840262.500 n=793
  Dropped 36 invalid feature columns
  ✓ Wrote 654 fused windows → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_features_5.0s.csv

▶ Fusing features for window length: 2.0s
  Loaded eda: 1876 windows | t_center min=1764836864.000 max=1764840262.438 n=1876
  Loaded eda_advanced: 1876 windows | t_center min=1764836864.000 max=1764840262.438 n=1876
  Loaded imu_bioz: 1624 windows | t_center min=1764837301.000 max=1764840242.688 n=1624
  Loaded imu_wrist: 1943 windows | t_center min=1764836769.000 max=1764840288.875 n=1943
  Loaded ppg_green: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Loaded ppg_green_hrv: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Loaded ppg_infra: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Loaded ppg_infra_hrv: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Loaded ppg_red: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Loaded ppg_red_hrv: 1969 windows | t_center min=1764836697.000 max=1764840264.000 n=1969
  Dropped 75 invalid feature columns
  ✓ Wrote 1626 fused windows → /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_features_2.0s.csv
  ✓ Fusion complete

▶ Aligning fused features with Borg effort labels
  Aligning fused features (10.0s windows)...
  ⚠ No data in features file (0 rows), skipping alignment
  Aligning fused features (5.0s windows)...
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 654
  Windows in ADL time range: 438
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_aligned_5.0s.csv (438 windows | borg labeled: 287)
  Aligning fused features (2.0s windows)...
  ADL recording time: 1764837982.1 to 1764839956.6
  Windows before filtering: 1624
  Windows in ADL time range: 1090
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_aligned_2.0s.csv (1090 windows | borg labeled: 712)

▶ Feature selection with correlation pruning + quality checks
  Running feature selection (5.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (5.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_aligned_5.0s.csv
  ✓ Loaded 287 labeled samples
  ✓ 248 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 229, Test: 58

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 25, IMU: 12, PPG: 63

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 4, IMU: 11, PPG: 21
  ✓ Total: 36 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 19, 'pcs_for_95pct': 24, 'pcs_for_99pct': 32}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/feature_selection_qc/qc_5.0s/features_filtered_5.0s.csv
    → 36 features + 2 metadata columns
    → 287 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_5.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (5.0s)
  Running feature selection (2.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (2.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_aligned_2.0s.csv
  ✓ Loaded 712 labeled samples
  ✓ 209 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 569, Test: 143

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 25, IMU: 11, PPG: 64

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 4, IMU: 10, PPG: 22
  ✓ Total: 36 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 19, 'pcs_for_95pct': 24, 'pcs_for_99pct': 31}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/feature_selection_qc/qc_2.0s/features_filtered_2.0s.csv
    → 36 features + 2 metadata columns
    → 712 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_2.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (2.0s)
[manual_features_imu] processed 200/244 windows
[manual_features_imu] processed 200/489 windows
[manual_features_imu] processed 400/489 windows
[manual_features_imu] processed 200/1214 windows
[manual_features_imu] processed 400/1214 windows
[manual_features_imu] processed 600/1214 windows
[manual_features_imu] processed 800/1214 windows
[manual_features_imu] processed 1000/1214 windows
[manual_features_imu] processed 1200/1214 windows
[manual_features_imu] processed 200/303 windows
[manual_features_imu] processed 200/607 windows
[manual_features_imu] processed 400/607 windows
[manual_features_imu] processed 600/607 windows
[manual_features_imu] processed 200/1507 windows
[manual_features_imu] processed 400/1507 windows
[manual_features_imu] processed 600/1507 windows
[manual_features_imu] processed 800/1507 windows
[manual_features_imu] processed 1000/1507 windows
[manual_features_imu] processed 1200/1507 windows
[manual_features_imu] processed 1400/1507 windows
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_features_10.0s.csv
Shape: (303, 39)
Selected feature columns: 30
After NaN/variance filter: (303, 29)
After correlation pruning: (303, 29)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 13
  pcs_for_99pct: 21

Explained variance per PC (round 1):
   PC1: 0.5211   (cum 0.5211)
   PC2: 0.1722   (cum 0.6933)
   PC3: 0.0573   (cum 0.7506)
   PC4: 0.0519   (cum 0.8026)
   PC5: 0.0372   (cum 0.8398)
   PC6: 0.0260   (cum 0.8657)
   PC7: 0.0211   (cum 0.8868)
   PC8: 0.0171   (cum 0.9039)
   PC9: 0.0144   (cum 0.9183)
  PC10: 0.0110   (cum 0.9293)
  PC11: 0.0105   (cum 0.9399)
  PC12: 0.0094   (cum 0.9492)
  PC13: 0.0083   (cum 0.9576)
  PC14: 0.0073   (cum 0.9649)
  PC15: 0.0066   (cum 0.9715)

Top PCA loadings per component (round 1):

PC1
  acc_y_dyn__avg_amplitude_change          0.2216
  acc_x_dyn__quantile_0.3                  0.2214
  acc_x_dyn__quantile_0.9                  0.2139
  acc_z_dyn__quantile_0.4                  0.2117
  acc_z_dyn__sum_of_absolute_changes       0.2105
  acc_y_dyn__quantile_0.3                  0.2069
  acc_z_dyn__quantile_0.6                  0.2064
  acc_x_dyn__quantile_0.4                  0.2049

PC2
  acc_y_dyn__sample_entropy                0.3155
  acc_z_dyn__sample_entropy                0.2926
  acc_z_dyn__approximate_entropy_0.1       0.2884
  acc_x_dyn__sample_entropy                0.2819
  acc_x_dyn__approximate_entropy_0.1       0.2816
  acc_y_dyn__katz_fractal_dimension        0.2427
  acc_x_dyn__approximate_entropy_0.9       0.2396
  acc_z_dyn__katz_fractal_dimension        0.2289

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4378
  acc_z_dyn__sum_of_absolute_changes       0.3695
  acc_z_dyn__harmonic_mean_of_abs          0.2906
  acc_z_dyn__lower_complete_moment         0.2748
  acc_x_dyn__harmonic_mean_of_abs          0.2286
  acc_z_dyn__quantile_0.4                  0.2211
  acc_x_dyn__quantile_0.3                  0.1955
  acc_y_dyn__quantile_0.3                  0.1863

PC4
  acc_y_dyn__tsallis_entropy               0.6260
  acc_x_dyn__cardinality                   0.4762
  acc_x_dyn__max                           0.3739
  acc_y_dyn__harmonic_mean_of_abs          0.2262
  acc_x_dyn__variance_of_absolute_differences 0.2127
  acc_x_dyn__approximate_entropy_0.9       0.1536
  acc_y_dyn__quantile_0.3                  0.1484
  acc_x_dyn__sample_entropy                0.1307

PC5
  acc_y_dyn__variance_of_absolute_differences 0.4809
  acc_y_dyn__harmonic_mean_of_abs          0.4652
  acc_y_dyn__tsallis_entropy               0.3339
  acc_y_dyn__avg_amplitude_change          0.2525
  acc_y_dyn__quantile_0.4                  0.2471
  acc_y_dyn__quantile_0.3                  0.2454
  acc_x_dyn__quantile_0.4                  0.2274
  acc_x_dyn__quantile_0.3                  0.2021

PC6
  acc_y_dyn__quantile_0.4                  0.6125
  acc_y_dyn__variance_of_absolute_differences 0.4407
  acc_x_dyn__harmonic_mean_of_abs          0.2448
  acc_y_dyn__harmonic_mean_of_abs          0.2395
  acc_x_dyn__variance_of_absolute_differences 0.2181
  acc_y_dyn__avg_amplitude_change          0.2152
  acc_z_dyn__quantile_0.6                  0.1868
  acc_x_dyn__cardinality                   0.1833

PC7
  acc_y_dyn__quantile_0.4                  0.4011
  acc_x_dyn__quantile_0.6                  0.3357
  acc_x_dyn__harmonic_mean_of_abs          0.3038
  acc_z_dyn__lower_complete_moment         0.2845
  acc_z_dyn__katz_fractal_dimension        0.2680
  acc_z_dyn__quantile_0.6                  0.2519
  acc_z_dyn__approximate_entropy_0.1       0.2366
  acc_z_dyn__harmonic_mean_of_abs          0.2320

PC8
  acc_x_dyn__quantile_0.6                  0.4714
  acc_y_dyn__tsallis_entropy               0.3787
  acc_x_dyn__max                           0.3743
  acc_x_dyn__harmonic_mean_of_abs          0.2856
  acc_z_dyn__quantile_0.6                  0.2753
  acc_y_dyn__quantile_0.4                  0.2717
  acc_y_dyn__harmonic_mean_of_abs          0.2314
  acc_x_dyn__quantile_0.4                  0.2226

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 13
  pcs_for_99pct: 21

Explained variance per PC (round 2):
   PC1: 0.5211   (cum 0.5211)
   PC2: 0.1722   (cum 0.6933)
   PC3: 0.0573   (cum 0.7506)
   PC4: 0.0519   (cum 0.8026)
   PC5: 0.0372   (cum 0.8398)
   PC6: 0.0260   (cum 0.8657)
   PC7: 0.0211   (cum 0.8868)
   PC8: 0.0171   (cum 0.9039)
   PC9: 0.0144   (cum 0.9183)
  PC10: 0.0110   (cum 0.9293)
  PC11: 0.0105   (cum 0.9399)
  PC12: 0.0094   (cum 0.9492)
  PC13: 0.0083   (cum 0.9576)
  PC14: 0.0073   (cum 0.9649)
  PC15: 0.0066   (cum 0.9715)

Top PCA loadings per component (round 2):

PC1
  acc_y_dyn__avg_amplitude_change          0.2216
  acc_x_dyn__quantile_0.3                  0.2214
  acc_x_dyn__quantile_0.9                  0.2139
  acc_z_dyn__quantile_0.4                  0.2117
  acc_z_dyn__sum_of_absolute_changes       0.2105
  acc_y_dyn__quantile_0.3                  0.2069
  acc_z_dyn__quantile_0.6                  0.2064
  acc_x_dyn__quantile_0.4                  0.2049

PC2
  acc_y_dyn__sample_entropy                0.3155
  acc_z_dyn__sample_entropy                0.2926
  acc_z_dyn__approximate_entropy_0.1       0.2884
  acc_x_dyn__sample_entropy                0.2819
  acc_x_dyn__approximate_entropy_0.1       0.2816
  acc_y_dyn__katz_fractal_dimension        0.2427
  acc_x_dyn__approximate_entropy_0.9       0.2396
  acc_z_dyn__katz_fractal_dimension        0.2289

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4378
  acc_z_dyn__sum_of_absolute_changes       0.3695
  acc_z_dyn__harmonic_mean_of_abs          0.2906
  acc_z_dyn__lower_complete_moment         0.2748
  acc_x_dyn__harmonic_mean_of_abs          0.2286
  acc_z_dyn__quantile_0.4                  0.2211
  acc_x_dyn__quantile_0.3                  0.1955
  acc_y_dyn__quantile_0.3                  0.1863

PC4
  acc_y_dyn__tsallis_entropy               0.6260
  acc_x_dyn__cardinality                   0.4762
  acc_x_dyn__max                           0.3739
  acc_y_dyn__harmonic_mean_of_abs          0.2262
  acc_x_dyn__variance_of_absolute_differences 0.2127
  acc_x_dyn__approximate_entropy_0.9       0.1536
  acc_y_dyn__quantile_0.3                  0.1484
  acc_x_dyn__sample_entropy                0.1307

PC5
  acc_y_dyn__variance_of_absolute_differences 0.4809
  acc_y_dyn__harmonic_mean_of_abs          0.4652
  acc_y_dyn__tsallis_entropy               0.3339
  acc_y_dyn__avg_amplitude_change          0.2525
  acc_y_dyn__quantile_0.4                  0.2471
  acc_y_dyn__quantile_0.3                  0.2454
  acc_x_dyn__quantile_0.4                  0.2274
  acc_x_dyn__quantile_0.3                  0.2021

PC6
  acc_y_dyn__quantile_0.4                  0.6125
  acc_y_dyn__variance_of_absolute_differences 0.4407
  acc_x_dyn__harmonic_mean_of_abs          0.2448
  acc_y_dyn__harmonic_mean_of_abs          0.2395
  acc_x_dyn__variance_of_absolute_differences 0.2181
  acc_y_dyn__avg_amplitude_change          0.2152
  acc_z_dyn__quantile_0.6                  0.1868
  acc_x_dyn__cardinality                   0.1833

PC7
  acc_y_dyn__quantile_0.4                  0.4011
  acc_x_dyn__quantile_0.6                  0.3357
  acc_x_dyn__harmonic_mean_of_abs          0.3038
  acc_z_dyn__lower_complete_moment         0.2845
  acc_z_dyn__katz_fractal_dimension        0.2680
  acc_z_dyn__quantile_0.6                  0.2519
  acc_z_dyn__approximate_entropy_0.1       0.2366
  acc_z_dyn__harmonic_mean_of_abs          0.2320

PC8
  acc_x_dyn__quantile_0.6                  0.4714
  acc_y_dyn__tsallis_entropy               0.3787
  acc_x_dyn__max                           0.3743
  acc_x_dyn__harmonic_mean_of_abs          0.2856
  acc_z_dyn__quantile_0.6                  0.2753
  acc_y_dyn__quantile_0.4                  0.2717
  acc_y_dyn__harmonic_mean_of_abs          0.2314
  acc_x_dyn__quantile_0.4                  0.2226

Saved to: data/feature_extraction/analysis/quality_imu_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_10.0s.csv | rows=302 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_10.0s.csv
Shape: (302, 51)
Selected feature columns: 44
After NaN/variance filter: (302, 43)
After correlation pruning: (302, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.4131   (cum 0.4131)
   PC2: 0.2142   (cum 0.6274)
   PC3: 0.1099   (cum 0.7372)
   PC4: 0.0561   (cum 0.7933)
   PC5: 0.0468   (cum 0.8401)
   PC6: 0.0439   (cum 0.8840)
   PC7: 0.0400   (cum 0.9240)
   PC8: 0.0227   (cum 0.9467)
   PC9: 0.0187   (cum 0.9655)
  PC10: 0.0126   (cum 0.9781)
  PC11: 0.0083   (cum 0.9863)
  PC12: 0.0045   (cum 0.9909)
  PC13: 0.0032   (cum 0.9940)
  PC14: 0.0024   (cum 0.9964)
  PC15: 0.0016   (cum 0.9981)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3289
  ppg_green_diff_mean_abs                  0.2972
  ppg_green_crest_factor                   0.2967
  ppg_green_shape_factor                   0.2896
  ppg_green_p99                            0.2864
  ppg_green_p90_p10                        0.2726
  ppg_green_tke_p95_abs                    0.2603
  ppg_green_diff_std                       0.2571

PC2
  ppg_green_p90                            0.3269
  ppg_green_dx_kurtosis                    0.3264
  ppg_green_median                         0.3253
  ppg_green_p10                            0.2952
  ppg_green_skew                           0.2894
  ppg_green_kurtosis                       0.2805
  ppg_green_tke_mean                       0.2753
  ppg_green_diff_std                       0.2299

PC3
  ppg_green_p10                            0.4642
  ppg_green_median                         0.3377
  ppg_green_iqr                            0.3281
  ppg_green_mean_cross_rate                0.3165
  ppg_green_mad                            0.3095
  ppg_green_p90_p10                        0.2673
  ppg_green_p99                            0.2337
  ppg_green_shape_factor                   0.2283

PC4
  ppg_green_mean_cross_rate                0.5614
  ppg_green_ddx_mean                       0.5519
  ppg_green_tke_p95_abs                    0.3248
  ppg_green_diff_mean_abs                  0.2325
  ppg_green_skew                           0.2061
  ppg_green_tke_mean                       0.2048
  ppg_green_median                         0.1703
  ppg_green_kurtosis                       0.1642

PC5
  ppg_green_skew                           0.4758
  ppg_green_mean_cross_rate                0.3879
  ppg_green_ddx_mean                       0.3330
  ppg_green_kurtosis                       0.3257
  ppg_green_tke_mean                       0.3173
  ppg_green_diff_std                       0.2892
  ppg_green_diff_mean_abs                  0.2690
  ppg_green_p90                            0.1646

PC6
  ppg_green_ddx_mean                       0.6908
  ppg_green_skew                           0.3743
  ppg_green_kurtosis                       0.3571
  ppg_green_diff_mean                      0.3429
  ppg_green_mean_cross_rate                0.2383
  ppg_green_tke_mean                       0.1440
  ppg_green_diff_std                       0.1114
  ppg_green_mad                            0.1038

PC7
  ppg_green_diff_mean                      0.7799
  ppg_green_tke_mean                       0.3812
  ppg_green_ddx_mean                       0.3003
  ppg_green_tke_p95_abs                    0.2227
  ppg_green_diff_std                       0.2109
  ppg_green_ddx_kurtosis                   0.1684
  ppg_green_shape_factor                   0.0883
  ppg_green_p90_p10                        0.0721

PC8
  ppg_green_ddx_kurtosis                   0.6475
  ppg_green_mean_cross_rate                0.3908
  ppg_green_dx_kurtosis                    0.2966
  ppg_green_skew                           0.2919
  ppg_green_tke_p95_abs                    0.2506
  ppg_green_diff_mean_abs                  0.2203
  ppg_green_diff_mean                      0.2096
  ppg_green_tke_mean                       0.1769

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.4131   (cum 0.4131)
   PC2: 0.2142   (cum 0.6274)
   PC3: 0.1099   (cum 0.7372)
   PC4: 0.0561   (cum 0.7933)
   PC5: 0.0468   (cum 0.8401)
   PC6: 0.0439   (cum 0.8840)
   PC7: 0.0400   (cum 0.9240)
   PC8: 0.0227   (cum 0.9467)
   PC9: 0.0187   (cum 0.9655)
  PC10: 0.0126   (cum 0.9781)
  PC11: 0.0083   (cum 0.9863)
  PC12: 0.0045   (cum 0.9909)
  PC13: 0.0032   (cum 0.9940)
  PC14: 0.0024   (cum 0.9964)
  PC15: 0.0016   (cum 0.9981)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3289
  ppg_green_diff_mean_abs                  0.2972
  ppg_green_crest_factor                   0.2967
  ppg_green_shape_factor                   0.2896
  ppg_green_p99                            0.2864
  ppg_green_p90_p10                        0.2726
  ppg_green_tke_p95_abs                    0.2603
  ppg_green_diff_std                       0.2571

PC2
  ppg_green_p90                            0.3269
  ppg_green_dx_kurtosis                    0.3264
  ppg_green_median                         0.3253
  ppg_green_p10                            0.2952
  ppg_green_skew                           0.2894
  ppg_green_kurtosis                       0.2805
  ppg_green_tke_mean                       0.2753
  ppg_green_diff_std                       0.2299

PC3
  ppg_green_p10                            0.4642
  ppg_green_median                         0.3377
  ppg_green_iqr                            0.3281
  ppg_green_mean_cross_rate                0.3165
  ppg_green_mad                            0.3095
  ppg_green_p90_p10                        0.2673
  ppg_green_p99                            0.2337
  ppg_green_shape_factor                   0.2283

PC4
  ppg_green_mean_cross_rate                0.5614
  ppg_green_ddx_mean                       0.5519
  ppg_green_tke_p95_abs                    0.3248
  ppg_green_diff_mean_abs                  0.2325
  ppg_green_skew                           0.2061
  ppg_green_tke_mean                       0.2048
  ppg_green_median                         0.1703
  ppg_green_kurtosis                       0.1642

PC5
  ppg_green_skew                           0.4758
  ppg_green_mean_cross_rate                0.3879
  ppg_green_ddx_mean                       0.3330
  ppg_green_kurtosis                       0.3257
  ppg_green_tke_mean                       0.3173
  ppg_green_diff_std                       0.2892
  ppg_green_diff_mean_abs                  0.2690
  ppg_green_p90                            0.1646

PC6
  ppg_green_ddx_mean                       0.6908
  ppg_green_skew                           0.3743
  ppg_green_kurtosis                       0.3571
  ppg_green_diff_mean                      0.3429
  ppg_green_mean_cross_rate                0.2383
  ppg_green_tke_mean                       0.1440
  ppg_green_diff_std                       0.1114
  ppg_green_mad                            0.1038

PC7
  ppg_green_diff_mean                      0.7799
  ppg_green_tke_mean                       0.3812
  ppg_green_ddx_mean                       0.3003
  ppg_green_tke_p95_abs                    0.2227
  ppg_green_diff_std                       0.2109
  ppg_green_ddx_kurtosis                   0.1684
  ppg_green_shape_factor                   0.0883
  ppg_green_p90_p10                        0.0721

PC8
  ppg_green_ddx_kurtosis                   0.6475
  ppg_green_mean_cross_rate                0.3908
  ppg_green_dx_kurtosis                    0.2966
  ppg_green_skew                           0.2919
  ppg_green_tke_p95_abs                    0.2506
  ppg_green_diff_mean_abs                  0.2203
  ppg_green_diff_mean                      0.2096
  ppg_green_tke_mean                       0.1769

Saved to: data/feature_extraction/analysis/quality_ppg_green_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_10.0s.csv
Shape: (302, 28)
Selected feature columns: 21
After NaN/variance filter: (302, 2)
After correlation pruning: (302, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8610   (cum 0.8610)
   PC2: 0.1390   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8610   (cum 0.8610)
   PC2: 0.1390   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_10.0s.csv | rows=302 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_10.0s.csv
Shape: (302, 51)
Selected feature columns: 44
After NaN/variance filter: (302, 44)
After correlation pruning: (302, 24)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3987   (cum 0.3987)
   PC2: 0.1753   (cum 0.5740)
   PC3: 0.1301   (cum 0.7041)
   PC4: 0.0684   (cum 0.7725)
   PC5: 0.0476   (cum 0.8201)
   PC6: 0.0455   (cum 0.8657)
   PC7: 0.0360   (cum 0.9016)
   PC8: 0.0293   (cum 0.9309)
   PC9: 0.0155   (cum 0.9464)
  PC10: 0.0125   (cum 0.9589)
  PC11: 0.0108   (cum 0.9697)
  PC12: 0.0083   (cum 0.9780)
  PC13: 0.0057   (cum 0.9837)
  PC14: 0.0051   (cum 0.9888)
  PC15: 0.0041   (cum 0.9929)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_range                          0.3054
  ppg_infra_min                            0.3000
  ppg_infra_p99                            0.2988
  ppg_infra_p95                            0.2781
  ppg_infra_tke_std                        0.2635
  ppg_infra_signal_energy                  0.2556
  ppg_infra_diff_mean_abs                  0.2248
  ppg_infra_diff_mean                      0.2219

PC2
  ppg_infra_impulse_factor                 0.3396
  ppg_infra_shape_factor                   0.3375
  ppg_infra_clearance_factor               0.3354
  ppg_infra_kurtosis                       0.3285
  ppg_infra_iqr                            0.3258
  ppg_infra_p90                            0.2874
  ppg_infra_crest_factor                   0.2802
  ppg_infra_diff_mean_abs                  0.2721

PC3
  ppg_infra_ddx_mean                       0.4035
  ppg_infra_trim_mean_10                   0.3566
  ppg_infra_diff_mean                      0.3410
  ppg_infra_signal_energy                  0.3154
  ppg_infra_ddx_std                        0.2735
  ppg_infra_tke_std                        0.2592
  ppg_infra_ddx_kurtosis                   0.2330
  ppg_infra_iqr                            0.2108

PC4
  ppg_infra_mean                           0.5914
  ppg_infra_median                         0.5127
  ppg_infra_trim_mean_10                   0.4562
  ppg_infra_zcr                            0.1915
  ppg_infra_diff_mean                      0.1598
  ppg_infra_ddx_std                        0.1482
  ppg_infra_diff_mean_abs                  0.1427
  ppg_infra_tke_std                        0.1176

PC5
  ppg_infra_skew                           0.6904
  ppg_infra_mean                           0.4259
  ppg_infra_zcr                            0.4052
  ppg_infra_median                         0.2166
  ppg_infra_ddx_kurtosis                   0.1761
  ppg_infra_shape_factor                   0.1440
  ppg_infra_dx_kurtosis                    0.1346
  ppg_infra_min                            0.1111

PC6
  ppg_infra_zcr                            0.6998
  ppg_infra_skew                           0.4516
  ppg_infra_ddx_kurtosis                   0.2276
  ppg_infra_iqr                            0.2005
  ppg_infra_p90                            0.1820
  ppg_infra_tke_std                        0.1780
  ppg_infra_diff_mean                      0.1609
  ppg_infra_ddx_std                        0.1574

PC7
  ppg_infra_ddx_kurtosis                   0.5793
  ppg_infra_dx_kurtosis                    0.4699
  ppg_infra_clearance_factor               0.3833
  ppg_infra_shape_factor                   0.2731
  ppg_infra_iqr                            0.2010
  ppg_infra_zcr                            0.1854
  ppg_infra_mean                           0.1713
  ppg_infra_impulse_factor                 0.1675

PC8
  ppg_infra_median                         0.7158
  ppg_infra_zcr                            0.3342
  ppg_infra_trim_mean_10                   0.3146
  ppg_infra_ddx_mean                       0.2313
  ppg_infra_mean                           0.1825
  ppg_infra_tke_std                        0.1706
  ppg_infra_ddx_std                        0.1689
  ppg_infra_skew                           0.1672

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 24
Stage 2: selected features: 24 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3987   (cum 0.3987)
   PC2: 0.1753   (cum 0.5740)
   PC3: 0.1301   (cum 0.7041)
   PC4: 0.0684   (cum 0.7725)
   PC5: 0.0476   (cum 0.8201)
   PC6: 0.0455   (cum 0.8657)
   PC7: 0.0360   (cum 0.9016)
   PC8: 0.0293   (cum 0.9309)
   PC9: 0.0155   (cum 0.9464)
  PC10: 0.0125   (cum 0.9589)
  PC11: 0.0108   (cum 0.9697)
  PC12: 0.0083   (cum 0.9780)
  PC13: 0.0057   (cum 0.9837)
  PC14: 0.0051   (cum 0.9888)
  PC15: 0.0041   (cum 0.9929)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_range                          0.3054
  ppg_infra_min                            0.3000
  ppg_infra_p99                            0.2988
  ppg_infra_p95                            0.2781
  ppg_infra_tke_std                        0.2635
  ppg_infra_signal_energy                  0.2556
  ppg_infra_diff_mean_abs                  0.2248
  ppg_infra_diff_mean                      0.2219

PC2
  ppg_infra_impulse_factor                 0.3396
  ppg_infra_shape_factor                   0.3375
  ppg_infra_clearance_factor               0.3354
  ppg_infra_kurtosis                       0.3285
  ppg_infra_iqr                            0.3258
  ppg_infra_p90                            0.2874
  ppg_infra_crest_factor                   0.2802
  ppg_infra_diff_mean_abs                  0.2721

PC3
  ppg_infra_ddx_mean                       0.4035
  ppg_infra_trim_mean_10                   0.3566
  ppg_infra_diff_mean                      0.3410
  ppg_infra_signal_energy                  0.3154
  ppg_infra_ddx_std                        0.2735
  ppg_infra_tke_std                        0.2592
  ppg_infra_ddx_kurtosis                   0.2330
  ppg_infra_iqr                            0.2108

PC4
  ppg_infra_mean                           0.5914
  ppg_infra_median                         0.5127
  ppg_infra_trim_mean_10                   0.4562
  ppg_infra_zcr                            0.1915
  ppg_infra_diff_mean                      0.1598
  ppg_infra_ddx_std                        0.1482
  ppg_infra_diff_mean_abs                  0.1427
  ppg_infra_tke_std                        0.1176

PC5
  ppg_infra_skew                           0.6904
  ppg_infra_mean                           0.4259
  ppg_infra_zcr                            0.4052
  ppg_infra_median                         0.2166
  ppg_infra_ddx_kurtosis                   0.1761
  ppg_infra_shape_factor                   0.1440
  ppg_infra_dx_kurtosis                    0.1346
  ppg_infra_min                            0.1111

PC6
  ppg_infra_zcr                            0.6998
  ppg_infra_skew                           0.4516
  ppg_infra_ddx_kurtosis                   0.2276
  ppg_infra_iqr                            0.2005
  ppg_infra_p90                            0.1820
  ppg_infra_tke_std                        0.1780
  ppg_infra_diff_mean                      0.1609
  ppg_infra_ddx_std                        0.1574

PC7
  ppg_infra_ddx_kurtosis                   0.5793
  ppg_infra_dx_kurtosis                    0.4699
  ppg_infra_clearance_factor               0.3833
  ppg_infra_shape_factor                   0.2731
  ppg_infra_iqr                            0.2010
  ppg_infra_zcr                            0.1854
  ppg_infra_mean                           0.1713
  ppg_infra_impulse_factor                 0.1675

PC8
  ppg_infra_median                         0.7158
  ppg_infra_zcr                            0.3342
  ppg_infra_trim_mean_10                   0.3146
  ppg_infra_ddx_mean                       0.2313
  ppg_infra_mean                           0.1825
  ppg_infra_tke_std                        0.1706
  ppg_infra_ddx_std                        0.1689
  ppg_infra_skew                           0.1672

Saved to: data/feature_extraction/analysis/quality_ppg_infra_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_10.0s.csv
Shape: (302, 28)
Selected feature columns: 21
After NaN/variance filter: (302, 15)
After correlation pruning: (302, 13)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.3950   (cum 0.3950)
   PC2: 0.3229   (cum 0.7179)
   PC3: 0.0953   (cum 0.8131)
   PC4: 0.0667   (cum 0.8799)
   PC5: 0.0376   (cum 0.9174)
   PC6: 0.0319   (cum 0.9493)
   PC7: 0.0254   (cum 0.9747)
   PC8: 0.0131   (cum 0.9879)
   PC9: 0.0064   (cum 0.9942)
  PC10: 0.0030   (cum 0.9973)
  PC11: 0.0026   (cum 0.9998)
  PC12: 0.0002   (cum 1.0000)
  PC13: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_min                         0.4026
  ppg_infra_mean_ibi                       0.3828
  ppg_infra_sdnn                           0.3555
  ppg_infra_rmssd                          0.3497
  ppg_infra_hr_max                         0.3459
  ppg_infra_sdsd                           0.3124
  ppg_infra_n_peaks                        0.2829
  ppg_infra_pnn50                          0.2577

PC2
  ppg_infra_hr_std                         0.4598
  ppg_infra_cv_ibi                         0.4354
  ppg_infra_hr_range                       0.4336
  ppg_infra_hr_max                         0.2922
  ppg_infra_rmssd                          0.2564
  ppg_infra_sdnn                           0.2376
  ppg_infra_pnn50                          0.2272
  ppg_infra_sdsd                           0.2009

PC3
  ppg_infra_peak_quality                   0.6903
  ppg_infra_pnn20                          0.5079
  ppg_infra_pnn50                          0.3143
  ppg_infra_n_peaks                        0.2761
  ppg_infra_mean_ibi                       0.1787
  ppg_infra_hr_min                         0.1389
  ppg_infra_sdsd                           0.1132
  ppg_infra_sdnn                           0.0861

PC4
  ppg_infra_pnn20                          0.7048
  ppg_infra_peak_quality                   0.5368
  ppg_infra_pnn50                          0.2204
  ppg_infra_n_peaks                        0.2138
  ppg_infra_cv_ibi                         0.1848
  ppg_infra_sdsd                           0.1568
  ppg_infra_sdnn                           0.1434
  ppg_infra_hr_std                         0.1378

PC5
  ppg_infra_sdsd                           0.5958
  ppg_infra_n_peaks                        0.5700
  ppg_infra_pnn50                          0.3056
  ppg_infra_cv_ibi                         0.2510
  ppg_infra_sdnn                           0.2454
  ppg_infra_peak_quality                   0.2317
  ppg_infra_hr_std                         0.1658
  ppg_infra_pnn20                          0.0857

PC6
  ppg_infra_pnn50                          0.5566
  ppg_infra_n_peaks                        0.5384
  ppg_infra_peak_quality                   0.3463
  ppg_infra_pnn20                          0.3047
  ppg_infra_sdnn                           0.2571
  ppg_infra_hr_min                         0.1955
  ppg_infra_mean_ibi                       0.1600
  ppg_infra_sdsd                           0.1485

PC7
  ppg_infra_pnn50                          0.5523
  ppg_infra_sdsd                           0.5328
  ppg_infra_n_peaks                        0.3283
  ppg_infra_pnn20                          0.3221
  ppg_infra_hr_min                         0.2737
  ppg_infra_rmssd                          0.2132
  ppg_infra_hr_max                         0.1550
  ppg_infra_cv_ibi                         0.1231

PC8
  ppg_infra_hr_range                       0.5614
  ppg_infra_hr_min                         0.4861
  ppg_infra_rmssd                          0.4636
  ppg_infra_sdnn                           0.2860
  ppg_infra_sdsd                           0.2634
  ppg_infra_n_peaks                        0.1898
  ppg_infra_pnn50                          0.1111
  ppg_infra_hr_std                         0.1051

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 13
Stage 2: selected features: 13 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 7
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.3950   (cum 0.3950)
   PC2: 0.3229   (cum 0.7179)
   PC3: 0.0953   (cum 0.8131)
   PC4: 0.0667   (cum 0.8799)
   PC5: 0.0376   (cum 0.9174)
   PC6: 0.0319   (cum 0.9493)
   PC7: 0.0254   (cum 0.9747)
   PC8: 0.0131   (cum 0.9879)
   PC9: 0.0064   (cum 0.9942)
  PC10: 0.0030   (cum 0.9973)
  PC11: 0.0026   (cum 0.9998)
  PC12: 0.0002   (cum 1.0000)
  PC13: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_min                         0.4026
  ppg_infra_mean_ibi                       0.3828
  ppg_infra_sdnn                           0.3555
  ppg_infra_rmssd                          0.3497
  ppg_infra_hr_max                         0.3459
  ppg_infra_sdsd                           0.3124
  ppg_infra_n_peaks                        0.2829
  ppg_infra_pnn50                          0.2577

PC2
  ppg_infra_hr_std                         0.4598
  ppg_infra_cv_ibi                         0.4354
  ppg_infra_hr_range                       0.4336
  ppg_infra_hr_max                         0.2922
  ppg_infra_rmssd                          0.2564
  ppg_infra_sdnn                           0.2376
  ppg_infra_pnn50                          0.2272
  ppg_infra_sdsd                           0.2009

PC3
  ppg_infra_peak_quality                   0.6903
  ppg_infra_pnn20                          0.5079
  ppg_infra_pnn50                          0.3143
  ppg_infra_n_peaks                        0.2761
  ppg_infra_mean_ibi                       0.1787
  ppg_infra_hr_min                         0.1389
  ppg_infra_sdsd                           0.1132
  ppg_infra_sdnn                           0.0861

PC4
  ppg_infra_pnn20                          0.7048
  ppg_infra_peak_quality                   0.5368
  ppg_infra_pnn50                          0.2204
  ppg_infra_n_peaks                        0.2138
  ppg_infra_cv_ibi                         0.1848
  ppg_infra_sdsd                           0.1568
  ppg_infra_sdnn                           0.1434
  ppg_infra_hr_std                         0.1378

PC5
  ppg_infra_sdsd                           0.5958
  ppg_infra_n_peaks                        0.5700
  ppg_infra_pnn50                          0.3056
  ppg_infra_cv_ibi                         0.2510
  ppg_infra_sdnn                           0.2454
  ppg_infra_peak_quality                   0.2317
  ppg_infra_hr_std                         0.1658
  ppg_infra_pnn20                          0.0857

PC6
  ppg_infra_pnn50                          0.5566
  ppg_infra_n_peaks                        0.5384
  ppg_infra_peak_quality                   0.3463
  ppg_infra_pnn20                          0.3047
  ppg_infra_sdnn                           0.2571
  ppg_infra_hr_min                         0.1955
  ppg_infra_mean_ibi                       0.1600
  ppg_infra_sdsd                           0.1485

PC7
  ppg_infra_pnn50                          0.5523
  ppg_infra_sdsd                           0.5328
  ppg_infra_n_peaks                        0.3283
  ppg_infra_pnn20                          0.3221
  ppg_infra_hr_min                         0.2737
  ppg_infra_rmssd                          0.2132
  ppg_infra_hr_max                         0.1550
  ppg_infra_cv_ibi                         0.1231

PC8
  ppg_infra_hr_range                       0.5614
  ppg_infra_hr_min                         0.4861
  ppg_infra_rmssd                          0.4636
  ppg_infra_sdnn                           0.2860
  ppg_infra_sdsd                           0.2634
  ppg_infra_n_peaks                        0.1898
  ppg_infra_pnn50                          0.1111
  ppg_infra_hr_std                         0.1051

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_10.0s.csv | rows=302 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_10.0s.csv
Shape: (302, 51)
Selected feature columns: 44
After NaN/variance filter: (302, 44)
After correlation pruning: (302, 25)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3932   (cum 0.3932)
   PC2: 0.1938   (cum 0.5870)
   PC3: 0.1113   (cum 0.6983)
   PC4: 0.0724   (cum 0.7707)
   PC5: 0.0462   (cum 0.8169)
   PC6: 0.0418   (cum 0.8586)
   PC7: 0.0399   (cum 0.8985)
   PC8: 0.0290   (cum 0.9275)
   PC9: 0.0174   (cum 0.9449)
  PC10: 0.0144   (cum 0.9593)
  PC11: 0.0104   (cum 0.9697)
  PC12: 0.0074   (cum 0.9771)
  PC13: 0.0059   (cum 0.9830)
  PC14: 0.0053   (cum 0.9883)
  PC15: 0.0041   (cum 0.9924)

Top PCA loadings per component (round 1):

PC1
  ppg_red_min                              0.3014
  ppg_red_dx_std                           0.2951
  ppg_red_p99                              0.2921
  ppg_red_tke_mean                         0.2857
  ppg_red_p95                              0.2823
  ppg_red_signal_energy                    0.2577
  ppg_red_tke_std                          0.2545
  ppg_red_p90                              0.2473

PC2
  ppg_red_impulse_factor                   0.3875
  ppg_red_clearance_factor                 0.3727
  ppg_red_shape_factor                     0.3646
  ppg_red_crest_factor                     0.3359
  ppg_red_kurtosis                         0.3184
  ppg_red_mad                              0.2917
  ppg_red_diff_mean_abs                    0.2301
  ppg_red_dx_kurtosis                      0.2299

PC3
  ppg_red_dx_mean                          0.4299
  ppg_red_ddx_mean                         0.4218
  ppg_red_signal_energy                    0.3349
  ppg_red_ddx_kurtosis                     0.3018
  ppg_red_ddx_std                          0.2852
  ppg_red_dx_kurtosis                      0.2150
  ppg_red_tke_std                          0.2085
  ppg_red_trim_mean_10                     0.2000

PC4
  ppg_red_trim_mean_10                     0.5905
  ppg_red_mean                             0.5600
  ppg_red_median                           0.4430
  ppg_red_skew                             0.2126
  ppg_red_zcr                              0.1473
  ppg_red_tke_std                          0.1304
  ppg_red_p99                              0.1108
  ppg_red_tke_mean                         0.0970

PC5
  ppg_red_skew                             0.7573
  ppg_red_mean                             0.4617
  ppg_red_shape_factor                     0.2155
  ppg_red_ddx_mean                         0.1527
  ppg_red_clearance_factor                 0.1478
  ppg_red_p99                              0.1353
  ppg_red_p90                              0.1079
  ppg_red_kurtosis                         0.1064

PC6
  ppg_red_dx_kurtosis                      0.4721
  ppg_red_ddx_kurtosis                     0.4158
  ppg_red_median                           0.3614
  ppg_red_tke_std                          0.3177
  ppg_red_shape_factor                     0.3160
  ppg_red_clearance_factor                 0.2291
  ppg_red_impulse_factor                   0.2051
  ppg_red_mean                             0.1919

PC7
  ppg_red_zcr                              0.8044
  ppg_red_ddx_std                          0.3067
  ppg_red_median                           0.1956
  ppg_red_diff_mean_abs                    0.1875
  ppg_red_tke_mean                         0.1693
  ppg_red_dx_std                           0.1491
  ppg_red_kurtosis                         0.1402
  ppg_red_mean                             0.1398

PC8
  ppg_red_median                           0.7409
  ppg_red_trim_mean_10                     0.4732
  ppg_red_skew                             0.2186
  ppg_red_dx_mean                          0.1877
  ppg_red_p90                              0.1679
  ppg_red_ddx_std                          0.1400
  ppg_red_dx_kurtosis                      0.1390
  ppg_red_mad                              0.1194

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 25
Stage 2: selected features: 25 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3932   (cum 0.3932)
   PC2: 0.1938   (cum 0.5870)
   PC3: 0.1113   (cum 0.6983)
   PC4: 0.0724   (cum 0.7707)
   PC5: 0.0462   (cum 0.8169)
   PC6: 0.0418   (cum 0.8586)
   PC7: 0.0399   (cum 0.8985)
   PC8: 0.0290   (cum 0.9275)
   PC9: 0.0174   (cum 0.9449)
  PC10: 0.0144   (cum 0.9593)
  PC11: 0.0104   (cum 0.9697)
  PC12: 0.0074   (cum 0.9771)
  PC13: 0.0059   (cum 0.9830)
  PC14: 0.0053   (cum 0.9883)
  PC15: 0.0041   (cum 0.9924)

Top PCA loadings per component (round 2):

PC1
  ppg_red_min                              0.3014
  ppg_red_dx_std                           0.2951
  ppg_red_p99                              0.2921
  ppg_red_tke_mean                         0.2857
  ppg_red_p95                              0.2823
  ppg_red_signal_energy                    0.2577
  ppg_red_tke_std                          0.2545
  ppg_red_p90                              0.2473

PC2
  ppg_red_impulse_factor                   0.3875
  ppg_red_clearance_factor                 0.3727
  ppg_red_shape_factor                     0.3646
  ppg_red_crest_factor                     0.3359
  ppg_red_kurtosis                         0.3184
  ppg_red_mad                              0.2917
  ppg_red_diff_mean_abs                    0.2301
  ppg_red_dx_kurtosis                      0.2299

PC3
  ppg_red_dx_mean                          0.4299
  ppg_red_ddx_mean                         0.4218
  ppg_red_signal_energy                    0.3349
  ppg_red_ddx_kurtosis                     0.3018
  ppg_red_ddx_std                          0.2852
  ppg_red_dx_kurtosis                      0.2150
  ppg_red_tke_std                          0.2085
  ppg_red_trim_mean_10                     0.2000

PC4
  ppg_red_trim_mean_10                     0.5905
  ppg_red_mean                             0.5600
  ppg_red_median                           0.4430
  ppg_red_skew                             0.2126
  ppg_red_zcr                              0.1473
  ppg_red_tke_std                          0.1304
  ppg_red_p99                              0.1108
  ppg_red_tke_mean                         0.0970

PC5
  ppg_red_skew                             0.7573
  ppg_red_mean                             0.4617
  ppg_red_shape_factor                     0.2155
  ppg_red_ddx_mean                         0.1527
  ppg_red_clearance_factor                 0.1478
  ppg_red_p99                              0.1353
  ppg_red_p90                              0.1079
  ppg_red_kurtosis                         0.1064

PC6
  ppg_red_dx_kurtosis                      0.4721
  ppg_red_ddx_kurtosis                     0.4158
  ppg_red_median                           0.3614
  ppg_red_tke_std                          0.3177
  ppg_red_shape_factor                     0.3160
  ppg_red_clearance_factor                 0.2291
  ppg_red_impulse_factor                   0.2051
  ppg_red_mean                             0.1919

PC7
  ppg_red_zcr                              0.8044
  ppg_red_ddx_std                          0.3067
  ppg_red_median                           0.1956
  ppg_red_diff_mean_abs                    0.1875
  ppg_red_tke_mean                         0.1693
  ppg_red_dx_std                           0.1491
  ppg_red_kurtosis                         0.1402
  ppg_red_mean                             0.1398

PC8
  ppg_red_median                           0.7409
  ppg_red_trim_mean_10                     0.4732
  ppg_red_skew                             0.2186
  ppg_red_dx_mean                          0.1877
  ppg_red_p90                              0.1679
  ppg_red_ddx_std                          0.1400
  ppg_red_dx_kurtosis                      0.1390
  ppg_red_mad                              0.1194

Saved to: data/feature_extraction/analysis/quality_ppg_red_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_10.0s.csv
Shape: (302, 28)
Selected feature columns: 21
After NaN/variance filter: (302, 14)
After correlation pruning: (302, 13)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.4265   (cum 0.4265)
   PC2: 0.2880   (cum 0.7145)
   PC3: 0.1116   (cum 0.8261)
   PC4: 0.0694   (cum 0.8955)
   PC5: 0.0399   (cum 0.9354)
   PC6: 0.0290   (cum 0.9644)
   PC7: 0.0163   (cum 0.9806)
   PC8: 0.0078   (cum 0.9884)
   PC9: 0.0058   (cum 0.9943)
  PC10: 0.0029   (cum 0.9972)
  PC11: 0.0027   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)
  PC13: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_hr_median                        0.4002
  ppg_red_hr_min                           0.3982
  ppg_red_mean_ibi                         0.3976
  ppg_red_hr_max                           0.3938
  ppg_red_sdnn                             0.2803
  ppg_red_rmssd                            0.2730
  ppg_red_n_peaks                          0.2552
  ppg_red_hr_range                         0.2318

PC2
  ppg_red_cv_ibi                           0.4944
  ppg_red_hr_std                           0.4669
  ppg_red_hr_range                         0.3750
  ppg_red_sdnn                             0.3513
  ppg_red_rmssd                            0.3477
  ppg_red_pnn50                            0.2505
  ppg_red_pnn20                            0.1944
  ppg_red_hr_max                           0.1805

PC3
  ppg_red_peak_quality                     0.6868
  ppg_red_pnn20                            0.4016
  ppg_red_n_peaks                          0.3882
  ppg_red_pnn50                            0.2815
  ppg_red_hr_range                         0.2079
  ppg_red_hr_min                           0.1939
  ppg_red_mean_ibi                         0.1486
  ppg_red_sdnn                             0.1308

PC4
  ppg_red_pnn20                            0.6914
  ppg_red_peak_quality                     0.3667
  ppg_red_pnn50                            0.3647
  ppg_red_n_peaks                          0.3439
  ppg_red_sdnn                             0.2158
  ppg_red_cv_ibi                           0.2022
  ppg_red_rmssd                            0.1326
  ppg_red_hr_std                           0.1205

PC5
  ppg_red_n_peaks                          0.7567
  ppg_red_peak_quality                     0.5730
  ppg_red_pnn20                            0.1454
  ppg_red_hr_min                           0.1367
  ppg_red_pnn50                            0.1349
  ppg_red_hr_median                        0.1322
  ppg_red_mean_ibi                         0.0945
  ppg_red_hr_max                           0.0654

PC6
  ppg_red_pnn50                            0.7621
  ppg_red_pnn20                            0.4879
  ppg_red_hr_min                           0.2033
  ppg_red_hr_range                         0.1920
  ppg_red_peak_quality                     0.1912
  ppg_red_hr_median                        0.1393
  ppg_red_rmssd                            0.1387
  ppg_red_cv_ibi                           0.0969

PC7
  ppg_red_rmssd                            0.5634
  ppg_red_hr_range                         0.5179
  ppg_red_hr_min                           0.3478
  ppg_red_pnn50                            0.2568
  ppg_red_n_peaks                          0.2528
  ppg_red_hr_median                        0.2460
  ppg_red_pnn20                            0.2141
  ppg_red_sdnn                             0.1739

PC8
  ppg_red_hr_range                         0.5222
  ppg_red_rmssd                            0.5054
  ppg_red_cv_ibi                           0.4227
  ppg_red_mean_ibi                         0.2831
  ppg_red_hr_std                           0.2725
  ppg_red_hr_max                           0.2723
  ppg_red_n_peaks                          0.1681
  ppg_red_peak_quality                     0.1252

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 13
Stage 2: selected features: 13 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.4265   (cum 0.4265)
   PC2: 0.2880   (cum 0.7145)
   PC3: 0.1116   (cum 0.8261)
   PC4: 0.0694   (cum 0.8955)
   PC5: 0.0399   (cum 0.9354)
   PC6: 0.0290   (cum 0.9644)
   PC7: 0.0163   (cum 0.9806)
   PC8: 0.0078   (cum 0.9884)
   PC9: 0.0058   (cum 0.9943)
  PC10: 0.0029   (cum 0.9972)
  PC11: 0.0027   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)
  PC13: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_hr_median                        0.4002
  ppg_red_hr_min                           0.3982
  ppg_red_mean_ibi                         0.3976
  ppg_red_hr_max                           0.3938
  ppg_red_sdnn                             0.2803
  ppg_red_rmssd                            0.2730
  ppg_red_n_peaks                          0.2552
  ppg_red_hr_range                         0.2318

PC2
  ppg_red_cv_ibi                           0.4944
  ppg_red_hr_std                           0.4669
  ppg_red_hr_range                         0.3750
  ppg_red_sdnn                             0.3513
  ppg_red_rmssd                            0.3477
  ppg_red_pnn50                            0.2505
  ppg_red_pnn20                            0.1944
  ppg_red_hr_max                           0.1805

PC3
  ppg_red_peak_quality                     0.6868
  ppg_red_pnn20                            0.4016
  ppg_red_n_peaks                          0.3882
  ppg_red_pnn50                            0.2815
  ppg_red_hr_range                         0.2079
  ppg_red_hr_min                           0.1939
  ppg_red_mean_ibi                         0.1486
  ppg_red_sdnn                             0.1308

PC4
  ppg_red_pnn20                            0.6914
  ppg_red_peak_quality                     0.3667
  ppg_red_pnn50                            0.3647
  ppg_red_n_peaks                          0.3439
  ppg_red_sdnn                             0.2158
  ppg_red_cv_ibi                           0.2022
  ppg_red_rmssd                            0.1326
  ppg_red_hr_std                           0.1205

PC5
  ppg_red_n_peaks                          0.7567
  ppg_red_peak_quality                     0.5730
  ppg_red_pnn20                            0.1454
  ppg_red_hr_min                           0.1367
  ppg_red_pnn50                            0.1349
  ppg_red_hr_median                        0.1322
  ppg_red_mean_ibi                         0.0945
  ppg_red_hr_max                           0.0654

PC6
  ppg_red_pnn50                            0.7621
  ppg_red_pnn20                            0.4879
  ppg_red_hr_min                           0.2033
  ppg_red_hr_range                         0.1920
  ppg_red_peak_quality                     0.1912
  ppg_red_hr_median                        0.1393
  ppg_red_rmssd                            0.1387
  ppg_red_cv_ibi                           0.0969

PC7
  ppg_red_rmssd                            0.5634
  ppg_red_hr_range                         0.5179
  ppg_red_hr_min                           0.3478
  ppg_red_pnn50                            0.2568
  ppg_red_n_peaks                          0.2528
  ppg_red_hr_median                        0.2460
  ppg_red_pnn20                            0.2141
  ppg_red_sdnn                             0.1739

PC8
  ppg_red_hr_range                         0.5222
  ppg_red_rmssd                            0.5054
  ppg_red_cv_ibi                           0.4227
  ppg_red_mean_ibi                         0.2831
  ppg_red_hr_std                           0.2725
  ppg_red_hr_max                           0.2723
  ppg_red_n_peaks                          0.1681
  ppg_red_peak_quality                     0.1252

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_10.0s.csv | rows=246 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_10.0s.csv
Shape: (246, 33)
Selected feature columns: 26
After NaN/variance filter: (246, 26)
After correlation pruning: (246, 9)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.2281   (cum 0.2281)
   PC2: 0.1887   (cum 0.4169)
   PC3: 0.1301   (cum 0.5469)
   PC4: 0.1210   (cum 0.6679)
   PC5: 0.0946   (cum 0.7625)
   PC6: 0.0808   (cum 0.8433)
   PC7: 0.0753   (cum 0.9185)
   PC8: 0.0492   (cum 0.9677)
   PC9: 0.0323   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_min                      0.5000
  eda_stress_skin_std                      0.4739
  eda_stress_skin_kurtosis                 0.3870
  eda_cc_max                               0.3736
  eda_stress_skin_skew                     0.3388
  eda_cc_mean_abs_diff                     0.2890
  eda_cc_kurtosis                          0.1788
  eda_stress_skin_slope                    0.0753

PC2
  eda_stress_skin_skew                     0.5143
  eda_stress_skin_kurtosis                 0.4779
  eda_cc_kurtosis                          0.4163
  eda_cc_mean_abs_diff                     0.3164
  eda_cc_max                               0.2563
  eda_stress_skin_std                      0.2504
  eda_stress_skin_slope                    0.2342
  eda_stress_skin_min                      0.2195

PC3
  eda_stress_skin_slope                    0.6028
  eda_cc_skew                              0.4860
  eda_cc_mean_abs_diff                     0.4189
  eda_cc_max                               0.2789
  eda_stress_skin_std                      0.2695
  eda_cc_kurtosis                          0.2144
  eda_stress_skin_kurtosis                 0.1331
  eda_stress_skin_skew                     0.1041

PC4
  eda_cc_skew                              0.6927
  eda_stress_skin_slope                    0.4014
  eda_cc_kurtosis                          0.3752
  eda_stress_skin_std                      0.3049
  eda_cc_mean_abs_diff                     0.2812
  eda_stress_skin_kurtosis                 0.1444
  eda_stress_skin_skew                     0.1284
  eda_stress_skin_min                      0.0905

PC5
  eda_stress_skin_min                      0.5440
  eda_cc_max                               0.5318
  eda_stress_skin_slope                    0.4585
  eda_stress_skin_std                      0.2899
  eda_cc_mean_abs_diff                     0.2377
  eda_stress_skin_kurtosis                 0.2344
  eda_stress_skin_skew                     0.0931
  eda_cc_kurtosis                          0.0815

PC6
  eda_cc_kurtosis                          0.7525
  eda_cc_skew                              0.4928
  eda_stress_skin_skew                     0.3465
  eda_cc_mean_abs_diff                     0.1905
  eda_stress_skin_min                      0.1273
  eda_stress_skin_kurtosis                 0.1077
  eda_stress_skin_slope                    0.0627
  eda_stress_skin_std                      0.0519

PC7
  eda_cc_mean_abs_diff                     0.6147
  eda_cc_max                               0.5751
  eda_stress_skin_slope                    0.3618
  eda_stress_skin_skew                     0.2551
  eda_stress_skin_std                      0.2209
  eda_cc_skew                              0.1342
  eda_stress_skin_min                      0.1258
  eda_stress_skin_kurtosis                 0.1055

PC8
  eda_stress_skin_kurtosis                 0.5821
  eda_stress_skin_skew                     0.4403
  eda_stress_skin_std                      0.3623
  eda_cc_max                               0.3192
  eda_stress_skin_min                      0.3175
  eda_cc_mean_abs_diff                     0.2564
  eda_cc_kurtosis                          0.1754
  eda_stress_skin_slope                    0.1542

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 9
Stage 2: selected features: 9 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.2281   (cum 0.2281)
   PC2: 0.1887   (cum 0.4169)
   PC3: 0.1301   (cum 0.5469)
   PC4: 0.1210   (cum 0.6679)
   PC5: 0.0946   (cum 0.7625)
   PC6: 0.0808   (cum 0.8433)
   PC7: 0.0753   (cum 0.9185)
   PC8: 0.0492   (cum 0.9677)
   PC9: 0.0323   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_min                      0.5000
  eda_stress_skin_std                      0.4739
  eda_stress_skin_kurtosis                 0.3870
  eda_cc_max                               0.3736
  eda_stress_skin_skew                     0.3388
  eda_cc_mean_abs_diff                     0.2890
  eda_cc_kurtosis                          0.1788
  eda_stress_skin_slope                    0.0753

PC2
  eda_stress_skin_skew                     0.5143
  eda_stress_skin_kurtosis                 0.4779
  eda_cc_kurtosis                          0.4163
  eda_cc_mean_abs_diff                     0.3164
  eda_cc_max                               0.2563
  eda_stress_skin_std                      0.2504
  eda_stress_skin_slope                    0.2342
  eda_stress_skin_min                      0.2195

PC3
  eda_stress_skin_slope                    0.6028
  eda_cc_skew                              0.4860
  eda_cc_mean_abs_diff                     0.4189
  eda_cc_max                               0.2789
  eda_stress_skin_std                      0.2695
  eda_cc_kurtosis                          0.2144
  eda_stress_skin_kurtosis                 0.1331
  eda_stress_skin_skew                     0.1041

PC4
  eda_cc_skew                              0.6927
  eda_stress_skin_slope                    0.4014
  eda_cc_kurtosis                          0.3752
  eda_stress_skin_std                      0.3049
  eda_cc_mean_abs_diff                     0.2812
  eda_stress_skin_kurtosis                 0.1444
  eda_stress_skin_skew                     0.1284
  eda_stress_skin_min                      0.0905

PC5
  eda_stress_skin_min                      0.5440
  eda_cc_max                               0.5318
  eda_stress_skin_slope                    0.4585
  eda_stress_skin_std                      0.2899
  eda_cc_mean_abs_diff                     0.2377
  eda_stress_skin_kurtosis                 0.2344
  eda_stress_skin_skew                     0.0931
  eda_cc_kurtosis                          0.0815

PC6
  eda_cc_kurtosis                          0.7525
  eda_cc_skew                              0.4928
  eda_stress_skin_skew                     0.3465
  eda_cc_mean_abs_diff                     0.1905
  eda_stress_skin_min                      0.1273
  eda_stress_skin_kurtosis                 0.1077
  eda_stress_skin_slope                    0.0627
  eda_stress_skin_std                      0.0519

PC7
  eda_cc_mean_abs_diff                     0.6147
  eda_cc_max                               0.5751
  eda_stress_skin_slope                    0.3618
  eda_stress_skin_skew                     0.2551
  eda_stress_skin_std                      0.2209
  eda_cc_skew                              0.1342
  eda_stress_skin_min                      0.1258
  eda_stress_skin_kurtosis                 0.1055

PC8
  eda_stress_skin_kurtosis                 0.5821
  eda_stress_skin_skew                     0.4403
  eda_stress_skin_std                      0.3623
  eda_cc_max                               0.3192
  eda_stress_skin_min                      0.3175
  eda_cc_mean_abs_diff                     0.2564
  eda_cc_kurtosis                          0.1754
  eda_stress_skin_slope                    0.1542

Saved to: data/feature_extraction/analysis/quality_eda_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_10.0s.csv
Shape: (246, 28)
Selected feature columns: 21
After NaN/variance filter: (246, 21)
After correlation pruning: (246, 6)

PCA summary (round 1):
  pcs_for_90pct: 4
  pcs_for_95pct: 5
  pcs_for_99pct: 5

Explained variance per PC (round 1):
   PC1: 0.4441   (cum 0.4441)
   PC2: 0.2440   (cum 0.6881)
   PC3: 0.1241   (cum 0.8123)
   PC4: 0.1052   (cum 0.9175)
   PC5: 0.0825   (cum 1.0000)
   PC6: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_count                            0.5937
  eda_scr_rise_std                         0.4896
  eda_scr_amp_std                          0.4894
  eda_scr_rise_mean                        0.4019
  eda_phasic_mean                          0.0723
  eda_scl_max                              0.0383

PC2
  eda_phasic_mean                          0.6850
  eda_scl_max                              0.6112
  eda_scr_rise_mean                        0.3141
  eda_scr_amp_std                          0.1894
  eda_scr_count                            0.1446
  eda_scr_rise_std                         0.0422

PC3
  eda_scl_max                              0.7377
  eda_scr_rise_mean                        0.4816
  eda_phasic_mean                          0.3932
  eda_scr_rise_std                         0.2261
  eda_scr_count                            0.1346
  eda_scr_amp_std                          0.0063

PC4
  eda_scr_amp_std                          0.6932
  eda_scr_rise_std                         0.6932
  eda_scl_max                              0.1691
  eda_scr_rise_mean                        0.0824
  eda_phasic_mean                          0.0443
  eda_scr_count                            0.0397

PC5
  eda_scr_rise_mean                        0.7079
  eda_phasic_mean                          0.6074
  eda_scl_max                              0.2286
  eda_scr_rise_std                         0.1862
  eda_scr_count                            0.1767
  eda_scr_amp_std                          0.1088

PC6
  eda_scr_count                            0.7587
  eda_scr_amp_std                          0.4818
  eda_scr_rise_std                         0.4384
  eda_scl_max                              0.0000
  eda_scr_rise_mean                        0.0000
  eda_phasic_mean                          0.0000

Stage 2: PCs used to reach 90%: 4
Stage 2: ranking pool size: 6
Stage 2: selected features: 6 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 4
  pcs_for_95pct: 5
  pcs_for_99pct: 5

Explained variance per PC (round 2):
   PC1: 0.4441   (cum 0.4441)
   PC2: 0.2440   (cum 0.6881)
   PC3: 0.1241   (cum 0.8123)
   PC4: 0.1052   (cum 0.9175)
   PC5: 0.0825   (cum 1.0000)
   PC6: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_count                            0.5937
  eda_scr_rise_std                         0.4896
  eda_scr_amp_std                          0.4894
  eda_scr_rise_mean                        0.4019
  eda_phasic_mean                          0.0723
  eda_scl_max                              0.0383

PC2
  eda_phasic_mean                          0.6850
  eda_scl_max                              0.6112
  eda_scr_rise_mean                        0.3141
  eda_scr_amp_std                          0.1894
  eda_scr_count                            0.1446
  eda_scr_rise_std                         0.0422

PC3
  eda_scl_max                              0.7377
  eda_scr_rise_mean                        0.4816
  eda_phasic_mean                          0.3932
  eda_scr_rise_std                         0.2261
  eda_scr_count                            0.1346
  eda_scr_amp_std                          0.0063

PC4
  eda_scr_amp_std                          0.6932
  eda_scr_rise_std                         0.6932
  eda_scl_max                              0.1691
  eda_scr_rise_mean                        0.0824
  eda_phasic_mean                          0.0443
  eda_scr_count                            0.0397

PC5
  eda_scr_rise_mean                        0.7079
  eda_phasic_mean                          0.6074
  eda_scl_max                              0.2286
  eda_scr_rise_std                         0.1862
  eda_scr_count                            0.1767
  eda_scr_amp_std                          0.1088

PC6
  eda_scr_count                            0.7587
  eda_scr_amp_std                          0.4818
  eda_scr_rise_std                         0.4384
  eda_scl_max                              0.0000
  eda_phasic_mean                          0.0000
  eda_scr_rise_mean                        0.0000

Saved to: data/feature_extraction/analysis/quality_eda_advanced_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_features_5.0s.csv
Shape: (607, 39)
Selected feature columns: 30
After NaN/variance filter: (607, 29)
After correlation pruning: (607, 29)

PCA summary (round 1):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 23

Explained variance per PC (round 1):
   PC1: 0.4446   (cum 0.4446)
   PC2: 0.1937   (cum 0.6383)
   PC3: 0.0628   (cum 0.7011)
   PC4: 0.0494   (cum 0.7505)
   PC5: 0.0409   (cum 0.7913)
   PC6: 0.0317   (cum 0.8230)
   PC7: 0.0246   (cum 0.8476)
   PC8: 0.0226   (cum 0.8703)
   PC9: 0.0188   (cum 0.8891)
  PC10: 0.0159   (cum 0.9050)
  PC11: 0.0134   (cum 0.9183)
  PC12: 0.0117   (cum 0.9301)
  PC13: 0.0097   (cum 0.9398)
  PC14: 0.0092   (cum 0.9489)
  PC15: 0.0078   (cum 0.9567)

Top PCA loadings per component (round 1):

PC1
  acc_y_dyn__avg_amplitude_change          0.2384
  acc_x_dyn__quantile_0.9                  0.2306
  acc_x_dyn__quantile_0.3                  0.2306
  acc_z_dyn__sum_of_absolute_changes       0.2257
  acc_y_dyn__quantile_0.3                  0.2241
  acc_z_dyn__harmonic_mean_of_abs          0.2151
  acc_z_dyn__quantile_0.6                  0.2101
  acc_z_dyn__quantile_0.4                  0.2089

PC2
  acc_y_dyn__sample_entropy                0.3219
  acc_z_dyn__sample_entropy                0.3102
  acc_x_dyn__sample_entropy                0.2993
  acc_x_dyn__approximate_entropy_0.9       0.2714
  acc_y_dyn__katz_fractal_dimension        0.2660
  acc_x_dyn__katz_fractal_dimension        0.2639
  acc_z_dyn__katz_fractal_dimension        0.2602
  acc_z_dyn__approximate_entropy_0.1       0.2562

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4079
  acc_z_dyn__sum_of_absolute_changes       0.3317
  acc_z_dyn__lower_complete_moment         0.2549
  acc_z_dyn__approximate_entropy_0.1       0.2531
  acc_z_dyn__harmonic_mean_of_abs          0.2531
  acc_x_dyn__harmonic_mean_of_abs          0.2383
  acc_x_dyn__approximate_entropy_0.1       0.2305
  acc_x_dyn__max                           0.2303

PC4
  acc_y_dyn__tsallis_entropy               0.7434
  acc_x_dyn__cardinality                   0.3713
  acc_x_dyn__max                           0.2625
  acc_x_dyn__variance_of_absolute_differences 0.2013
  acc_y_dyn__harmonic_mean_of_abs          0.1594
  acc_x_dyn__approximate_entropy_0.9       0.1385
  acc_x_dyn__harmonic_mean_of_abs          0.1367
  acc_y_dyn__sample_entropy                0.1352

PC5
  acc_y_dyn__variance_of_absolute_differences 0.5676
  acc_y_dyn__harmonic_mean_of_abs          0.4164
  acc_x_dyn__quantile_0.4                  0.3327
  acc_y_dyn__avg_amplitude_change          0.3136
  acc_y_dyn__quantile_0.3                  0.2451
  acc_x_dyn__quantile_0.3                  0.1979
  acc_x_dyn__quantile_0.9                  0.1593
  acc_x_dyn__variance_of_absolute_differences 0.1482

PC6
  acc_y_dyn__quantile_0.4                  0.5895
  acc_x_dyn__approximate_entropy_0.1       0.3558
  acc_z_dyn__approximate_entropy_0.1       0.2552
  acc_y_dyn__harmonic_mean_of_abs          0.2403
  acc_z_dyn__harmonic_mean_of_abs          0.2280
  acc_z_dyn__quantile_0.4                  0.2216
  acc_y_dyn__variance_of_absolute_differences 0.2071
  acc_x_dyn__variance_of_absolute_differences 0.1993

PC7
  acc_y_dyn__quantile_0.4                  0.5269
  acc_x_dyn__quantile_0.6                  0.4302
  acc_x_dyn__harmonic_mean_of_abs          0.2945
  acc_z_dyn__approximate_entropy_0.1       0.2884
  acc_x_dyn__approximate_entropy_0.1       0.2625
  acc_z_dyn__katz_fractal_dimension        0.2318
  acc_z_dyn__lower_complete_moment         0.2294
  acc_y_dyn__quantile_0.3                  0.1535

PC8
  acc_x_dyn__quantile_0.6                  0.6099
  acc_x_dyn__quantile_0.4                  0.4972
  acc_y_dyn__quantile_0.4                  0.2721
  acc_y_dyn__harmonic_mean_of_abs          0.2604
  acc_z_dyn__quantile_0.6                  0.1697
  acc_x_dyn__approximate_entropy_0.1       0.1686
  acc_y_dyn__variance_of_absolute_differences 0.1671
  acc_z_dyn__harmonic_mean_of_abs          0.1486

Stage 2: PCs used to reach 90%: 10
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 23

Explained variance per PC (round 2):
   PC1: 0.4446   (cum 0.4446)
   PC2: 0.1937   (cum 0.6383)
   PC3: 0.0628   (cum 0.7011)
   PC4: 0.0494   (cum 0.7505)
   PC5: 0.0409   (cum 0.7913)
   PC6: 0.0317   (cum 0.8230)
   PC7: 0.0246   (cum 0.8476)
   PC8: 0.0226   (cum 0.8703)
   PC9: 0.0188   (cum 0.8891)
  PC10: 0.0159   (cum 0.9050)
  PC11: 0.0134   (cum 0.9183)
  PC12: 0.0117   (cum 0.9301)
  PC13: 0.0097   (cum 0.9398)
  PC14: 0.0092   (cum 0.9489)
  PC15: 0.0078   (cum 0.9567)

Top PCA loadings per component (round 2):

PC1
  acc_y_dyn__avg_amplitude_change          0.2384
  acc_x_dyn__quantile_0.9                  0.2306
  acc_x_dyn__quantile_0.3                  0.2306
  acc_z_dyn__sum_of_absolute_changes       0.2257
  acc_y_dyn__quantile_0.3                  0.2241
  acc_z_dyn__harmonic_mean_of_abs          0.2151
  acc_z_dyn__quantile_0.6                  0.2101
  acc_z_dyn__quantile_0.4                  0.2089

PC2
  acc_y_dyn__sample_entropy                0.3219
  acc_z_dyn__sample_entropy                0.3102
  acc_x_dyn__sample_entropy                0.2993
  acc_x_dyn__approximate_entropy_0.9       0.2714
  acc_y_dyn__katz_fractal_dimension        0.2660
  acc_x_dyn__katz_fractal_dimension        0.2639
  acc_z_dyn__katz_fractal_dimension        0.2602
  acc_z_dyn__approximate_entropy_0.1       0.2562

PC3
  acc_z_dyn__variance_of_absolute_differences 0.4079
  acc_z_dyn__sum_of_absolute_changes       0.3317
  acc_z_dyn__lower_complete_moment         0.2549
  acc_z_dyn__approximate_entropy_0.1       0.2531
  acc_z_dyn__harmonic_mean_of_abs          0.2531
  acc_x_dyn__harmonic_mean_of_abs          0.2383
  acc_x_dyn__approximate_entropy_0.1       0.2305
  acc_x_dyn__max                           0.2303

PC4
  acc_y_dyn__tsallis_entropy               0.7434
  acc_x_dyn__cardinality                   0.3713
  acc_x_dyn__max                           0.2625
  acc_x_dyn__variance_of_absolute_differences 0.2013
  acc_y_dyn__harmonic_mean_of_abs          0.1594
  acc_x_dyn__approximate_entropy_0.9       0.1385
  acc_x_dyn__harmonic_mean_of_abs          0.1367
  acc_y_dyn__sample_entropy                0.1352

PC5
  acc_y_dyn__variance_of_absolute_differences 0.5676
  acc_y_dyn__harmonic_mean_of_abs          0.4164
  acc_x_dyn__quantile_0.4                  0.3327
  acc_y_dyn__avg_amplitude_change          0.3136
  acc_y_dyn__quantile_0.3                  0.2451
  acc_x_dyn__quantile_0.3                  0.1979
  acc_x_dyn__quantile_0.9                  0.1593
  acc_x_dyn__variance_of_absolute_differences 0.1482

PC6
  acc_y_dyn__quantile_0.4                  0.5895
  acc_x_dyn__approximate_entropy_0.1       0.3558
  acc_z_dyn__approximate_entropy_0.1       0.2552
  acc_y_dyn__harmonic_mean_of_abs          0.2403
  acc_z_dyn__harmonic_mean_of_abs          0.2280
  acc_z_dyn__quantile_0.4                  0.2216
  acc_y_dyn__variance_of_absolute_differences 0.2071
  acc_x_dyn__variance_of_absolute_differences 0.1993

PC7
  acc_y_dyn__quantile_0.4                  0.5269
  acc_x_dyn__quantile_0.6                  0.4302
  acc_x_dyn__harmonic_mean_of_abs          0.2945
  acc_z_dyn__approximate_entropy_0.1       0.2884
  acc_x_dyn__approximate_entropy_0.1       0.2625
  acc_z_dyn__katz_fractal_dimension        0.2318
  acc_z_dyn__lower_complete_moment         0.2294
  acc_y_dyn__quantile_0.3                  0.1535

PC8
  acc_x_dyn__quantile_0.6                  0.6099
  acc_x_dyn__quantile_0.4                  0.4972
  acc_y_dyn__quantile_0.4                  0.2721
  acc_y_dyn__harmonic_mean_of_abs          0.2604
  acc_z_dyn__quantile_0.6                  0.1697
  acc_x_dyn__approximate_entropy_0.1       0.1686
  acc_y_dyn__variance_of_absolute_differences 0.1671
  acc_z_dyn__harmonic_mean_of_abs          0.1486

Saved to: data/feature_extraction/analysis/quality_imu_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_5.0s.csv | rows=605 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_5.0s.csv
Shape: (605, 51)
Selected feature columns: 44
After NaN/variance filter: (605, 43)
After correlation pruning: (605, 19)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.4005   (cum 0.4005)
   PC2: 0.1509   (cum 0.5514)
   PC3: 0.1036   (cum 0.6550)
   PC4: 0.0779   (cum 0.7329)
   PC5: 0.0551   (cum 0.7880)
   PC6: 0.0525   (cum 0.8404)
   PC7: 0.0479   (cum 0.8883)
   PC8: 0.0424   (cum 0.9307)
   PC9: 0.0225   (cum 0.9532)
  PC10: 0.0214   (cum 0.9747)
  PC11: 0.0099   (cum 0.9846)
  PC12: 0.0064   (cum 0.9910)
  PC13: 0.0039   (cum 0.9948)
  PC14: 0.0021   (cum 0.9969)
  PC15: 0.0015   (cum 0.9984)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3536
  ppg_green_crest_factor                   0.3409
  ppg_green_diff_mean_abs                  0.3322
  ppg_green_shape_factor                   0.3185
  ppg_green_p90_p10                        0.3180
  ppg_green_tke_p95_abs                    0.2896
  ppg_green_iqr                            0.2838
  ppg_green_dx_std                         0.2826

PC2
  ppg_green_median                         0.3550
  ppg_green_dx_kurtosis                    0.3275
  ppg_green_tke_std                        0.3259
  ppg_green_kurtosis                       0.3218
  ppg_green_min                            0.3112
  ppg_green_skew                           0.3081
  ppg_green_mad                            0.2591
  ppg_green_iqr                            0.2583

PC3
  ppg_green_min                            0.5333
  ppg_green_median                         0.4712
  ppg_green_mean_cross_rate                0.4201
  ppg_green_kurtosis                       0.2789
  ppg_green_iqr                            0.2005
  ppg_green_ddx_kurtosis                   0.1924
  ppg_green_mad                            0.1897
  ppg_green_shape_factor                   0.1648

PC4
  ppg_green_tke_std                        0.5032
  ppg_green_dx_std                         0.3680
  ppg_green_kurtosis                       0.3574
  ppg_green_skew                           0.3423
  ppg_green_ddx_kurtosis                   0.3029
  ppg_green_ddx_mean                       0.2482
  ppg_green_shape_factor                   0.1998
  ppg_green_iqr                            0.1815

PC5
  ppg_green_dx_mean                        0.5882
  ppg_green_mean_cross_rate                0.3854
  ppg_green_dx_kurtosis                    0.3524
  ppg_green_ddx_kurtosis                   0.2944
  ppg_green_tke_p95_abs                    0.2807
  ppg_green_median                         0.2147
  ppg_green_min                            0.2131
  ppg_green_skew                           0.2051

PC6
  ppg_green_ddx_mean                       0.4513
  ppg_green_ddx_kurtosis                   0.4404
  ppg_green_skew                           0.4221
  ppg_green_dx_kurtosis                    0.3831
  ppg_green_dx_mean                        0.3784
  ppg_green_min                            0.1770
  ppg_green_tke_std                        0.1502
  ppg_green_crest_factor                   0.1489

PC7
  ppg_green_dx_mean                        0.6352
  ppg_green_ddx_mean                       0.6061
  ppg_green_mean_cross_rate                0.3839
  ppg_green_min                            0.1651
  ppg_green_median                         0.1433
  ppg_green_diff_mean_abs                  0.0983
  ppg_green_kurtosis                       0.0903
  ppg_green_tke_p95_abs                    0.0729

PC8
  ppg_green_mean_cross_rate                0.5939
  ppg_green_ddx_mean                       0.5113
  ppg_green_skew                           0.4685
  ppg_green_kurtosis                       0.2578
  ppg_green_min                            0.1992
  ppg_green_median                         0.1372
  ppg_green_dx_mean                        0.0967
  ppg_green_diff_mean_abs                  0.0887

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 19
Stage 2: selected features: 19 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.4005   (cum 0.4005)
   PC2: 0.1509   (cum 0.5514)
   PC3: 0.1036   (cum 0.6550)
   PC4: 0.0779   (cum 0.7329)
   PC5: 0.0551   (cum 0.7880)
   PC6: 0.0525   (cum 0.8404)
   PC7: 0.0479   (cum 0.8883)
   PC8: 0.0424   (cum 0.9307)
   PC9: 0.0225   (cum 0.9532)
  PC10: 0.0214   (cum 0.9747)
  PC11: 0.0099   (cum 0.9846)
  PC12: 0.0064   (cum 0.9910)
  PC13: 0.0039   (cum 0.9948)
  PC14: 0.0021   (cum 0.9969)
  PC15: 0.0015   (cum 0.9984)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3536
  ppg_green_crest_factor                   0.3409
  ppg_green_diff_mean_abs                  0.3322
  ppg_green_shape_factor                   0.3185
  ppg_green_p90_p10                        0.3180
  ppg_green_tke_p95_abs                    0.2896
  ppg_green_iqr                            0.2838
  ppg_green_dx_std                         0.2826

PC2
  ppg_green_median                         0.3550
  ppg_green_dx_kurtosis                    0.3275
  ppg_green_tke_std                        0.3259
  ppg_green_kurtosis                       0.3218
  ppg_green_min                            0.3112
  ppg_green_skew                           0.3081
  ppg_green_mad                            0.2591
  ppg_green_iqr                            0.2583

PC3
  ppg_green_min                            0.5333
  ppg_green_median                         0.4712
  ppg_green_mean_cross_rate                0.4201
  ppg_green_kurtosis                       0.2789
  ppg_green_iqr                            0.2005
  ppg_green_ddx_kurtosis                   0.1924
  ppg_green_mad                            0.1897
  ppg_green_shape_factor                   0.1648

PC4
  ppg_green_tke_std                        0.5032
  ppg_green_dx_std                         0.3680
  ppg_green_kurtosis                       0.3574
  ppg_green_skew                           0.3423
  ppg_green_ddx_kurtosis                   0.3029
  ppg_green_ddx_mean                       0.2482
  ppg_green_shape_factor                   0.1998
  ppg_green_iqr                            0.1815

PC5
  ppg_green_dx_mean                        0.5882
  ppg_green_mean_cross_rate                0.3854
  ppg_green_dx_kurtosis                    0.3524
  ppg_green_ddx_kurtosis                   0.2944
  ppg_green_tke_p95_abs                    0.2807
  ppg_green_median                         0.2147
  ppg_green_min                            0.2131
  ppg_green_skew                           0.2051

PC6
  ppg_green_ddx_mean                       0.4513
  ppg_green_ddx_kurtosis                   0.4404
  ppg_green_skew                           0.4221
  ppg_green_dx_kurtosis                    0.3831
  ppg_green_dx_mean                        0.3784
  ppg_green_min                            0.1770
  ppg_green_tke_std                        0.1502
  ppg_green_crest_factor                   0.1489

PC7
  ppg_green_dx_mean                        0.6352
  ppg_green_ddx_mean                       0.6061
  ppg_green_mean_cross_rate                0.3839
  ppg_green_min                            0.1651
  ppg_green_median                         0.1433
  ppg_green_diff_mean_abs                  0.0983
  ppg_green_kurtosis                       0.0903
  ppg_green_tke_p95_abs                    0.0729

PC8
  ppg_green_mean_cross_rate                0.5939
  ppg_green_ddx_mean                       0.5113
  ppg_green_skew                           0.4685
  ppg_green_kurtosis                       0.2578
  ppg_green_min                            0.1992
  ppg_green_median                         0.1372
  ppg_green_dx_mean                        0.0967
  ppg_green_diff_mean_abs                  0.0887

Saved to: data/feature_extraction/analysis/quality_ppg_green_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_5.0s.csv
Shape: (605, 28)
Selected feature columns: 18
After NaN/variance filter: (605, 2)
After correlation pruning: (605, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8097   (cum 0.8097)
   PC2: 0.1903   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8097   (cum 0.8097)
   PC2: 0.1903   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_5.0s.csv | rows=605 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_5.0s.csv
Shape: (605, 51)
Selected feature columns: 44
After NaN/variance filter: (605, 44)
After correlation pruning: (605, 21)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3508   (cum 0.3508)
   PC2: 0.1560   (cum 0.5068)
   PC3: 0.1223   (cum 0.6292)
   PC4: 0.0914   (cum 0.7206)
   PC5: 0.0889   (cum 0.8095)
   PC6: 0.0550   (cum 0.8645)
   PC7: 0.0349   (cum 0.8995)
   PC8: 0.0328   (cum 0.9323)
   PC9: 0.0143   (cum 0.9466)
  PC10: 0.0114   (cum 0.9580)
  PC11: 0.0099   (cum 0.9678)
  PC12: 0.0080   (cum 0.9759)
  PC13: 0.0067   (cum 0.9825)
  PC14: 0.0049   (cum 0.9874)
  PC15: 0.0044   (cum 0.9918)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_min                            0.3467
  ppg_infra_max                            0.3368
  ppg_infra_p95                            0.3341
  ppg_infra_p10                            0.3288
  ppg_infra_diff_mean_abs                  0.3127
  ppg_infra_signal_energy                  0.2826
  ppg_infra_mad                            0.2791
  ppg_infra_ddx_std                        0.2608

PC2
  ppg_infra_kurtosis                       0.4539
  ppg_infra_shape_factor                   0.4414
  ppg_infra_crest_factor                   0.3967
  ppg_infra_dx_kurtosis                    0.3826
  ppg_infra_ddx_kurtosis                   0.3160
  ppg_infra_skew                           0.1795
  ppg_infra_signal_energy                  0.1626
  ppg_infra_ddx_mean                       0.1618

PC3
  ppg_infra_ddx_mean                       0.3631
  ppg_infra_ddx_std                        0.3614
  ppg_infra_mean_cross_rate                0.3614
  ppg_infra_zcr                            0.3443
  ppg_infra_dx_mean                        0.3378
  ppg_infra_signal_energy                  0.2879
  ppg_infra_diff_mean_abs                  0.2868
  ppg_infra_mad                            0.2351

PC4
  ppg_infra_mean                           0.5823
  ppg_infra_trim_mean_10                   0.5621
  ppg_infra_median                         0.4217
  ppg_infra_zcr                            0.2412
  ppg_infra_mean_cross_rate                0.2372
  ppg_infra_p10                            0.1031
  ppg_infra_ddx_kurtosis                   0.0988
  ppg_infra_mad                            0.0966

PC5
  ppg_infra_zcr                            0.5082
  ppg_infra_mean_cross_rate                0.5046
  ppg_infra_dx_mean                        0.2745
  ppg_infra_ddx_mean                       0.2727
  ppg_infra_mean                           0.2444
  ppg_infra_mad                            0.2131
  ppg_infra_signal_energy                  0.2130
  ppg_infra_ddx_kurtosis                   0.2065

PC6
  ppg_infra_skew                           0.7830
  ppg_infra_median                         0.3850
  ppg_infra_mean                           0.3130
  ppg_infra_crest_factor                   0.2063
  ppg_infra_min                            0.1323
  ppg_infra_p95                            0.1203
  ppg_infra_dx_kurtosis                    0.1183
  ppg_infra_zcr                            0.1152

PC7
  ppg_infra_median                         0.7457
  ppg_infra_trim_mean_10                   0.4665
  ppg_infra_skew                           0.2684
  ppg_infra_p10                            0.2018
  ppg_infra_ddx_std                        0.1706
  ppg_infra_dx_mean                        0.1312
  ppg_infra_crest_factor                   0.1214
  ppg_infra_min                            0.1073

PC8
  ppg_infra_ddx_kurtosis                   0.5402
  ppg_infra_dx_kurtosis                    0.5055
  ppg_infra_shape_factor                   0.3940
  ppg_infra_kurtosis                       0.2833
  ppg_infra_crest_factor                   0.2332
  ppg_infra_dx_mean                        0.1957
  ppg_infra_mean_cross_rate                0.1392
  ppg_infra_min                            0.1311

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3508   (cum 0.3508)
   PC2: 0.1560   (cum 0.5068)
   PC3: 0.1223   (cum 0.6292)
   PC4: 0.0914   (cum 0.7206)
   PC5: 0.0889   (cum 0.8095)
   PC6: 0.0550   (cum 0.8645)
   PC7: 0.0349   (cum 0.8995)
   PC8: 0.0328   (cum 0.9323)
   PC9: 0.0143   (cum 0.9466)
  PC10: 0.0114   (cum 0.9580)
  PC11: 0.0099   (cum 0.9678)
  PC12: 0.0080   (cum 0.9759)
  PC13: 0.0067   (cum 0.9825)
  PC14: 0.0049   (cum 0.9874)
  PC15: 0.0044   (cum 0.9918)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_min                            0.3467
  ppg_infra_max                            0.3368
  ppg_infra_p95                            0.3341
  ppg_infra_p10                            0.3288
  ppg_infra_diff_mean_abs                  0.3127
  ppg_infra_signal_energy                  0.2826
  ppg_infra_mad                            0.2791
  ppg_infra_ddx_std                        0.2608

PC2
  ppg_infra_kurtosis                       0.4539
  ppg_infra_shape_factor                   0.4414
  ppg_infra_crest_factor                   0.3967
  ppg_infra_dx_kurtosis                    0.3826
  ppg_infra_ddx_kurtosis                   0.3160
  ppg_infra_skew                           0.1795
  ppg_infra_signal_energy                  0.1626
  ppg_infra_ddx_mean                       0.1618

PC3
  ppg_infra_ddx_mean                       0.3631
  ppg_infra_ddx_std                        0.3614
  ppg_infra_mean_cross_rate                0.3614
  ppg_infra_zcr                            0.3443
  ppg_infra_dx_mean                        0.3378
  ppg_infra_signal_energy                  0.2879
  ppg_infra_diff_mean_abs                  0.2868
  ppg_infra_mad                            0.2351

PC4
  ppg_infra_mean                           0.5823
  ppg_infra_trim_mean_10                   0.5621
  ppg_infra_median                         0.4217
  ppg_infra_zcr                            0.2412
  ppg_infra_mean_cross_rate                0.2372
  ppg_infra_p10                            0.1031
  ppg_infra_ddx_kurtosis                   0.0988
  ppg_infra_mad                            0.0966

PC5
  ppg_infra_zcr                            0.5082
  ppg_infra_mean_cross_rate                0.5046
  ppg_infra_dx_mean                        0.2745
  ppg_infra_ddx_mean                       0.2727
  ppg_infra_mean                           0.2444
  ppg_infra_mad                            0.2131
  ppg_infra_signal_energy                  0.2130
  ppg_infra_ddx_kurtosis                   0.2065

PC6
  ppg_infra_skew                           0.7830
  ppg_infra_median                         0.3850
  ppg_infra_mean                           0.3130
  ppg_infra_crest_factor                   0.2063
  ppg_infra_min                            0.1323
  ppg_infra_p95                            0.1203
  ppg_infra_dx_kurtosis                    0.1183
  ppg_infra_zcr                            0.1152

PC7
  ppg_infra_median                         0.7457
  ppg_infra_trim_mean_10                   0.4665
  ppg_infra_skew                           0.2684
  ppg_infra_p10                            0.2018
  ppg_infra_ddx_std                        0.1706
  ppg_infra_dx_mean                        0.1312
  ppg_infra_crest_factor                   0.1214
  ppg_infra_min                            0.1073

PC8
  ppg_infra_ddx_kurtosis                   0.5402
  ppg_infra_dx_kurtosis                    0.5055
  ppg_infra_shape_factor                   0.3940
  ppg_infra_kurtosis                       0.2833
  ppg_infra_crest_factor                   0.2332
  ppg_infra_dx_mean                        0.1957
  ppg_infra_mean_cross_rate                0.1392
  ppg_infra_min                            0.1311

Saved to: data/feature_extraction/analysis/quality_ppg_infra_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE

=== Processing dataset: elderly_sim_elderly4 ===
▶ imu_bioz: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_bioz/imu_preprocessed.csv
  Windowing imu_bioz...
    ✓ Created 244 windows (10.0s)
  Extracting features for imu_bioz...
    ✓ Features 10.0s: 244 windows, 38 features
    ✓ Features 5.0s: 489 windows, 38 features
    ✓ Features 2.0s: 1214 windows, 38 features
▶ imu_wrist: preprocessing
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_preprocessed.csv
  Windowing imu_wrist...
    ✓ Created 303 windows (10.0s)
  Extracting features for imu_wrist...
    ✓ Features 10.0s: 303 windows, 38 features
    ✓ Features 5.0s: 607 windows, 38 features
    ✓ Features 2.0s: 1507 windows, 38 features
▶ ppg_green: preprocessing
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_preprocessed.csv | rows=87264 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_preprocessed.csv
▶ ppg_infra: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_preprocessed.csv | rows=87264 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_preprocessed.csv
▶ ppg_red: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_preprocessed.csv | rows=87264 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_preprocessed.csv
▶ RR: preprocessing
✓ RR preprocessed → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/rr/rr_preprocessed.csv | rows=22134 | irregular sampling (no resample)
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/rr/rr_preprocessed.csv
▶ EDA: preprocessing
✓ EDA preprocessed → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_preprocessed.csv | rows=71041 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_preprocessed.csv

▶ Window length: 10.0s | overlap=0.1
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 303
  Windows in ADL time range: 195
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_aligned_10.0s.csv (303 windows | borg labeled: 151)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_10.0s.csv | windows=302 | features=21
    ✓ HRV features: 302 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_aligned_10.0s.csv (302 windows | borg labeled: 151)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_aligned_10.0s.csv (302 windows | borg labeled: 151)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_10.0s.csv | windows=302 | features=21
    ✓ HRV features: 302 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_aligned_10.0s.csv (302 windows | borg labeled: 151)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_aligned_10.0s.csv (302 windows | borg labeled: 151)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_10.0s.csv | windows=302 | features=21
    ✓ HRV features: 302 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_aligned_10.0s.csv (302 windows | borg labeled: 151)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 302
  Windows in ADL time range: 193
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_aligned_10.0s.csv (302 windows | borg labeled: 151)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_10.0s.csv | windows=246 | features=21
    ✓ Advanced EDA features: 246 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 246
  Windows in ADL time range: 195
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_aligned_10.0s.csv (246 windows | borg labeled: 151)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 246
  Windows in ADL time range: 195
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_aligned_10.0s.csv (246 windows | borg labeled: 151)

▶ Window length: 5.0s | overlap=0.1
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 607
  Windows in ADL time range: 390
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_aligned_5.0s.csv (607 windows | borg labeled: 303)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_5.0s.csv | windows=605 | features=21
    ✓ HRV features: 605 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_aligned_5.0s.csv (605 windows | borg labeled: 298)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_aligned_5.0s.csv (605 windows | borg labeled: 298)
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_5.0s.csv
Shape: (605, 28)
Selected feature columns: 18
After NaN/variance filter: (605, 14)
After correlation pruning: (605, 11)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.4105   (cum 0.4105)
   PC2: 0.3043   (cum 0.7148)
   PC3: 0.1094   (cum 0.8242)
   PC4: 0.0684   (cum 0.8926)
   PC5: 0.0421   (cum 0.9347)
   PC6: 0.0330   (cum 0.9677)
   PC7: 0.0190   (cum 0.9867)
   PC8: 0.0075   (cum 0.9942)
   PC9: 0.0048   (cum 0.9990)
  PC10: 0.0010   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_max                         0.4568
  ppg_infra_mean_ibi                       0.4218
  ppg_infra_hr_range                       0.4051
  ppg_infra_hr_min                         0.3848
  ppg_infra_hr_std                         0.3814
  ppg_infra_n_peaks                        0.3251
  ppg_infra_cv_ibi                         0.2179
  ppg_infra_rmssd                          0.0386

PC2
  ppg_infra_rmssd                          0.4968
  ppg_infra_cv_ibi                         0.4557
  ppg_infra_pnn50                          0.4403
  ppg_infra_hr_std                         0.2928
  ppg_infra_pnn20                          0.2890
  ppg_infra_hr_min                         0.2636
  ppg_infra_hr_range                       0.2149
  ppg_infra_mean_ibi                       0.1610

PC3
  ppg_infra_peak_quality                   0.7991
  ppg_infra_pnn20                          0.4467
  ppg_infra_n_peaks                        0.2290
  ppg_infra_mean_ibi                       0.1774
  ppg_infra_pnn50                          0.1670
  ppg_infra_hr_range                       0.1373
  ppg_infra_rmssd                          0.1227
  ppg_infra_hr_min                         0.1195

PC4
  ppg_infra_pnn20                          0.7449
  ppg_infra_peak_quality                   0.4510
  ppg_infra_cv_ibi                         0.2756
  ppg_infra_n_peaks                        0.2247
  ppg_infra_rmssd                          0.2021
  ppg_infra_pnn50                          0.1897
  ppg_infra_hr_std                         0.1695
  ppg_infra_hr_min                         0.0788

PC5
  ppg_infra_n_peaks                        0.7887
  ppg_infra_pnn50                          0.4370
  ppg_infra_peak_quality                   0.2800
  ppg_infra_pnn20                          0.1869
  ppg_infra_hr_max                         0.1369
  ppg_infra_hr_min                         0.1344
  ppg_infra_mean_ibi                       0.1188
  ppg_infra_hr_std                         0.1003

PC6
  ppg_infra_pnn50                          0.7411
  ppg_infra_n_peaks                        0.3684
  ppg_infra_pnn20                          0.3542
  ppg_infra_rmssd                          0.2384
  ppg_infra_cv_ibi                         0.1841
  ppg_infra_hr_min                         0.1833
  ppg_infra_peak_quality                   0.1716
  ppg_infra_mean_ibi                       0.1369

PC7
  ppg_infra_rmssd                          0.6406
  ppg_infra_hr_range                       0.5188
  ppg_infra_hr_min                         0.4557
  ppg_infra_hr_std                         0.2181
  ppg_infra_mean_ibi                       0.2141
  ppg_infra_peak_quality                   0.1023
  ppg_infra_hr_max                         0.0837
  ppg_infra_n_peaks                        0.0362

PC8
  ppg_infra_mean_ibi                       0.6865
  ppg_infra_hr_max                         0.3631
  ppg_infra_cv_ibi                         0.3430
  ppg_infra_hr_range                       0.3127
  ppg_infra_hr_min                         0.3058
  ppg_infra_rmssd                          0.2379
  ppg_infra_peak_quality                   0.1583
  ppg_infra_n_peaks                        0.0559

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.4105   (cum 0.4105)
   PC2: 0.3043   (cum 0.7148)
   PC3: 0.1094   (cum 0.8242)
   PC4: 0.0684   (cum 0.8926)
   PC5: 0.0421   (cum 0.9347)
   PC6: 0.0330   (cum 0.9677)
   PC7: 0.0190   (cum 0.9867)
   PC8: 0.0075   (cum 0.9942)
   PC9: 0.0048   (cum 0.9990)
  PC10: 0.0010   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_max                         0.4568
  ppg_infra_mean_ibi                       0.4218
  ppg_infra_hr_range                       0.4051
  ppg_infra_hr_min                         0.3848
  ppg_infra_hr_std                         0.3814
  ppg_infra_n_peaks                        0.3251
  ppg_infra_cv_ibi                         0.2179
  ppg_infra_rmssd                          0.0386

PC2
  ppg_infra_rmssd                          0.4968
  ppg_infra_cv_ibi                         0.4557
  ppg_infra_pnn50                          0.4403
  ppg_infra_hr_std                         0.2928
  ppg_infra_pnn20                          0.2890
  ppg_infra_hr_min                         0.2636
  ppg_infra_hr_range                       0.2149
  ppg_infra_mean_ibi                       0.1610

PC3
  ppg_infra_peak_quality                   0.7991
  ppg_infra_pnn20                          0.4467
  ppg_infra_n_peaks                        0.2290
  ppg_infra_mean_ibi                       0.1774
  ppg_infra_pnn50                          0.1670
  ppg_infra_hr_range                       0.1373
  ppg_infra_rmssd                          0.1227
  ppg_infra_hr_min                         0.1195

PC4
  ppg_infra_pnn20                          0.7449
  ppg_infra_peak_quality                   0.4510
  ppg_infra_cv_ibi                         0.2756
  ppg_infra_n_peaks                        0.2247
  ppg_infra_rmssd                          0.2021
  ppg_infra_pnn50                          0.1897
  ppg_infra_hr_std                         0.1695
  ppg_infra_hr_min                         0.0788

PC5
  ppg_infra_n_peaks                        0.7887
  ppg_infra_pnn50                          0.4370
  ppg_infra_peak_quality                   0.2800
  ppg_infra_pnn20                          0.1869
  ppg_infra_hr_max                         0.1369
  ppg_infra_hr_min                         0.1344
  ppg_infra_mean_ibi                       0.1188
  ppg_infra_hr_std                         0.1003

PC6
  ppg_infra_pnn50                          0.7411
  ppg_infra_n_peaks                        0.3684
  ppg_infra_pnn20                          0.3542
  ppg_infra_rmssd                          0.2384
  ppg_infra_cv_ibi                         0.1841
  ppg_infra_hr_min                         0.1833
  ppg_infra_peak_quality                   0.1716
  ppg_infra_mean_ibi                       0.1369

PC7
  ppg_infra_rmssd                          0.6406
  ppg_infra_hr_range                       0.5188
  ppg_infra_hr_min                         0.4557
  ppg_infra_hr_std                         0.2181
  ppg_infra_mean_ibi                       0.2141
  ppg_infra_peak_quality                   0.1023
  ppg_infra_hr_max                         0.0837
  ppg_infra_n_peaks                        0.0362

PC8
  ppg_infra_mean_ibi                       0.6865
  ppg_infra_hr_max                         0.3631
  ppg_infra_cv_ibi                         0.3430
  ppg_infra_hr_range                       0.3127
  ppg_infra_hr_min                         0.3058
  ppg_infra_rmssd                          0.2379
  ppg_infra_peak_quality                   0.1583
  ppg_infra_n_peaks                        0.0559

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_5.0s.csv | rows=605 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_5.0s.csv
Shape: (605, 51)
Selected feature columns: 44
After NaN/variance filter: (605, 44)
After correlation pruning: (605, 23)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3740   (cum 0.3740)
   PC2: 0.1773   (cum 0.5513)
   PC3: 0.1181   (cum 0.6693)
   PC4: 0.0873   (cum 0.7566)
   PC5: 0.0530   (cum 0.8096)
   PC6: 0.0442   (cum 0.8538)
   PC7: 0.0399   (cum 0.8936)
   PC8: 0.0270   (cum 0.9207)
   PC9: 0.0184   (cum 0.9390)
  PC10: 0.0133   (cum 0.9523)
  PC11: 0.0114   (cum 0.9637)
  PC12: 0.0088   (cum 0.9725)
  PC13: 0.0077   (cum 0.9802)
  PC14: 0.0062   (cum 0.9864)
  PC15: 0.0042   (cum 0.9907)

Top PCA loadings per component (round 1):

PC1
  ppg_red_max                              0.3241
  ppg_red_min                              0.3146
  ppg_red_tke_mean_abs                     0.3069
  ppg_red_p10                              0.2969
  ppg_red_p95                              0.2943
  ppg_red_signal_energy                    0.2824
  ppg_red_tke_std                          0.2748
  ppg_red_diff_mean_abs                    0.2722

PC2
  ppg_red_clearance_factor                 0.4460
  ppg_red_kurtosis                         0.4296
  ppg_red_shape_factor                     0.4265
  ppg_red_crest_factor                     0.3778
  ppg_red_dx_kurtosis                      0.3210
  ppg_red_ddx_kurtosis                     0.2413
  ppg_red_skew                             0.1838
  ppg_red_mad                              0.1737

PC3
  ppg_red_dx_mean                          0.4044
  ppg_red_ddx_mean                         0.3812
  ppg_red_ddx_std                          0.3306
  ppg_red_signal_energy                    0.3127
  ppg_red_mad                              0.2730
  ppg_red_ddx_kurtosis                     0.2544
  ppg_red_diff_mean_abs                    0.2542
  ppg_red_tke_std                          0.2298

PC4
  ppg_red_mean                             0.6375
  ppg_red_trim_mean_10                     0.6015
  ppg_red_median                           0.4108
  ppg_red_ddx_mean                         0.1916
  ppg_red_dx_mean                          0.0913
  ppg_red_tke_std                          0.0583
  ppg_red_p95                              0.0536
  ppg_red_signal_energy                    0.0460

PC5
  ppg_red_skew                             0.7531
  ppg_red_median                           0.3498
  ppg_red_mean                             0.2237
  ppg_red_crest_factor                     0.2075
  ppg_red_p95                              0.2001
  ppg_red_dx_kurtosis                      0.1980
  ppg_red_ddx_kurtosis                     0.1530
  ppg_red_mad                              0.1383

PC6
  ppg_red_mean_cross_rate                  0.8091
  ppg_red_ddx_std                          0.3034
  ppg_red_diff_mean_abs                    0.2448
  ppg_red_ddx_kurtosis                     0.2324
  ppg_red_clearance_factor                 0.1629
  ppg_red_dx_kurtosis                      0.1515
  ppg_red_ddx_mean                         0.1283
  ppg_red_tke_mean_abs                     0.1232

PC7
  ppg_red_dx_kurtosis                      0.4050
  ppg_red_ddx_kurtosis                     0.3398
  ppg_red_tke_std                          0.3386
  ppg_red_median                           0.3343
  ppg_red_shape_factor                     0.2963
  ppg_red_mean_cross_rate                  0.2301
  ppg_red_clearance_factor                 0.2183
  ppg_red_ddx_std                          0.2119

PC8
  ppg_red_median                           0.7269
  ppg_red_trim_mean_10                     0.3963
  ppg_red_skew                             0.3393
  ppg_red_crest_factor                     0.2396
  ppg_red_dx_kurtosis                      0.2073
  ppg_red_min                              0.1336
  ppg_red_ddx_kurtosis                     0.1252
  ppg_red_ddx_mean                         0.1105

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 23
Stage 2: selected features: 23 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 10
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3740   (cum 0.3740)
   PC2: 0.1773   (cum 0.5513)
   PC3: 0.1181   (cum 0.6693)
   PC4: 0.0873   (cum 0.7566)
   PC5: 0.0530   (cum 0.8096)
   PC6: 0.0442   (cum 0.8538)
   PC7: 0.0399   (cum 0.8936)
   PC8: 0.0270   (cum 0.9207)
   PC9: 0.0184   (cum 0.9390)
  PC10: 0.0133   (cum 0.9523)
  PC11: 0.0114   (cum 0.9637)
  PC12: 0.0088   (cum 0.9725)
  PC13: 0.0077   (cum 0.9802)
  PC14: 0.0062   (cum 0.9864)
  PC15: 0.0042   (cum 0.9907)

Top PCA loadings per component (round 2):

PC1
  ppg_red_max                              0.3241
  ppg_red_min                              0.3146
  ppg_red_tke_mean_abs                     0.3069
  ppg_red_p10                              0.2969
  ppg_red_p95                              0.2943
  ppg_red_signal_energy                    0.2824
  ppg_red_tke_std                          0.2748
  ppg_red_diff_mean_abs                    0.2722

PC2
  ppg_red_clearance_factor                 0.4460
  ppg_red_kurtosis                         0.4296
  ppg_red_shape_factor                     0.4265
  ppg_red_crest_factor                     0.3778
  ppg_red_dx_kurtosis                      0.3210
  ppg_red_ddx_kurtosis                     0.2413
  ppg_red_skew                             0.1838
  ppg_red_mad                              0.1737

PC3
  ppg_red_dx_mean                          0.4044
  ppg_red_ddx_mean                         0.3812
  ppg_red_ddx_std                          0.3306
  ppg_red_signal_energy                    0.3127
  ppg_red_mad                              0.2730
  ppg_red_ddx_kurtosis                     0.2544
  ppg_red_diff_mean_abs                    0.2542
  ppg_red_tke_std                          0.2298

PC4
  ppg_red_mean                             0.6375
  ppg_red_trim_mean_10                     0.6015
  ppg_red_median                           0.4108
  ppg_red_ddx_mean                         0.1916
  ppg_red_dx_mean                          0.0913
  ppg_red_tke_std                          0.0583
  ppg_red_p95                              0.0536
  ppg_red_signal_energy                    0.0460

PC5
  ppg_red_skew                             0.7531
  ppg_red_median                           0.3498
  ppg_red_mean                             0.2237
  ppg_red_crest_factor                     0.2075
  ppg_red_p95                              0.2001
  ppg_red_dx_kurtosis                      0.1980
  ppg_red_ddx_kurtosis                     0.1530
  ppg_red_mad                              0.1383

PC6
  ppg_red_mean_cross_rate                  0.8091
  ppg_red_ddx_std                          0.3034
  ppg_red_diff_mean_abs                    0.2448
  ppg_red_ddx_kurtosis                     0.2324
  ppg_red_clearance_factor                 0.1629
  ppg_red_dx_kurtosis                      0.1515
  ppg_red_ddx_mean                         0.1283
  ppg_red_tke_mean_abs                     0.1232

PC7
  ppg_red_dx_kurtosis                      0.4050
  ppg_red_ddx_kurtosis                     0.3398
  ppg_red_tke_std                          0.3386
  ppg_red_median                           0.3343
  ppg_red_shape_factor                     0.2963
  ppg_red_mean_cross_rate                  0.2301
  ppg_red_clearance_factor                 0.2183
  ppg_red_ddx_std                          0.2119

PC8
  ppg_red_median                           0.7269
  ppg_red_trim_mean_10                     0.3963
  ppg_red_skew                             0.3393
  ppg_red_crest_factor                     0.2396
  ppg_red_dx_kurtosis                      0.2073
  ppg_red_min                              0.1336
  ppg_red_ddx_kurtosis                     0.1252
  ppg_red_ddx_mean                         0.1105

Saved to: data/feature_extraction/analysis/quality_ppg_red_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_5.0s.csv
Shape: (605, 28)
Selected feature columns: 18
After NaN/variance filter: (605, 2)
After correlation pruning: (605, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.5669   (cum 0.5669)
   PC2: 0.4331   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.5669   (cum 0.5669)
   PC2: 0.4331   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_5.0s.csv | rows=493 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_5.0s.csv
Shape: (493, 33)
Selected feature columns: 26
After NaN/variance filter: (493, 26)
After correlation pruning: (493, 9)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.2278   (cum 0.2278)
   PC2: 0.1898   (cum 0.4176)
   PC3: 0.1272   (cum 0.5448)
   PC4: 0.1180   (cum 0.6627)
   PC5: 0.0936   (cum 0.7563)
   PC6: 0.0873   (cum 0.8437)
   PC7: 0.0713   (cum 0.9149)
   PC8: 0.0501   (cum 0.9651)
   PC9: 0.0349   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_min                      0.5465
  eda_stress_skin_iqr                      0.5385
  eda_cc_max                               0.4157
  eda_cc_mean_abs_diff                     0.3500
  eda_stress_skin_kurtosis                 0.2744
  eda_stress_skin_slope                    0.1515
  eda_stress_skin_skew                     0.1311
  eda_cc_skew                              0.0242

PC2
  eda_cc_kurtosis                          0.6370
  eda_cc_skew                              0.5675
  eda_stress_skin_kurtosis                 0.3715
  eda_stress_skin_skew                     0.3081
  eda_cc_mean_abs_diff                     0.1574
  eda_cc_max                               0.1089
  eda_stress_skin_min                      0.0477
  eda_stress_skin_slope                    0.0176

PC3
  eda_stress_skin_slope                    0.7599
  eda_cc_mean_abs_diff                     0.4414
  eda_stress_skin_iqr                      0.3770
  eda_cc_max                               0.2274
  eda_stress_skin_skew                     0.1443
  eda_stress_skin_kurtosis                 0.1072
  eda_stress_skin_min                      0.0380
  eda_cc_kurtosis                          0.0055

PC4
  eda_stress_skin_skew                     0.6906
  eda_cc_skew                              0.4648
  eda_cc_mean_abs_diff                     0.3088
  eda_stress_skin_kurtosis                 0.2888
  eda_cc_max                               0.2658
  eda_cc_kurtosis                          0.2044
  eda_stress_skin_min                      0.1005
  eda_stress_skin_slope                    0.0742

PC5
  eda_stress_skin_slope                    0.5125
  eda_stress_skin_min                      0.4589
  eda_cc_max                               0.4293
  eda_stress_skin_skew                     0.3331
  eda_stress_skin_iqr                      0.3148
  eda_cc_mean_abs_diff                     0.3135
  eda_cc_skew                              0.1558
  eda_cc_kurtosis                          0.0958

PC6
  eda_stress_skin_kurtosis                 0.6838
  eda_stress_skin_skew                     0.3977
  eda_cc_mean_abs_diff                     0.3432
  eda_cc_max                               0.3430
  eda_stress_skin_min                      0.2978
  eda_cc_kurtosis                          0.1572
  eda_cc_skew                              0.1134
  eda_stress_skin_slope                    0.1073

PC7
  eda_cc_max                               0.5983
  eda_cc_mean_abs_diff                     0.5393
  eda_stress_skin_kurtosis                 0.4621
  eda_stress_skin_slope                    0.2222
  eda_cc_kurtosis                          0.1965
  eda_stress_skin_skew                     0.1780
  eda_stress_skin_iqr                      0.1200
  eda_cc_skew                              0.0559

PC8
  eda_cc_kurtosis                          0.6601
  eda_cc_skew                              0.6299
  eda_stress_skin_iqr                      0.2171
  eda_stress_skin_skew                     0.2129
  eda_cc_max                               0.1614
  eda_cc_mean_abs_diff                     0.1474
  eda_stress_skin_min                      0.1242
  eda_stress_skin_slope                    0.1092

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 9
Stage 2: selected features: 9 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.2278   (cum 0.2278)
   PC2: 0.1898   (cum 0.4176)
   PC3: 0.1272   (cum 0.5448)
   PC4: 0.1180   (cum 0.6627)
   PC5: 0.0936   (cum 0.7563)
   PC6: 0.0873   (cum 0.8437)
   PC7: 0.0713   (cum 0.9149)
   PC8: 0.0501   (cum 0.9651)
   PC9: 0.0349   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_min                      0.5465
  eda_stress_skin_iqr                      0.5385
  eda_cc_max                               0.4157
  eda_cc_mean_abs_diff                     0.3500
  eda_stress_skin_kurtosis                 0.2744
  eda_stress_skin_slope                    0.1515
  eda_stress_skin_skew                     0.1311
  eda_cc_skew                              0.0242

PC2
  eda_cc_kurtosis                          0.6370
  eda_cc_skew                              0.5675
  eda_stress_skin_kurtosis                 0.3715
  eda_stress_skin_skew                     0.3081
  eda_cc_mean_abs_diff                     0.1574
  eda_cc_max                               0.1089
  eda_stress_skin_min                      0.0477
  eda_stress_skin_slope                    0.0176

PC3
  eda_stress_skin_slope                    0.7599
  eda_cc_mean_abs_diff                     0.4414
  eda_stress_skin_iqr                      0.3770
  eda_cc_max                               0.2274
  eda_stress_skin_skew                     0.1443
  eda_stress_skin_kurtosis                 0.1072
  eda_stress_skin_min                      0.0380
  eda_cc_kurtosis                          0.0055

PC4
  eda_stress_skin_skew                     0.6906
  eda_cc_skew                              0.4648
  eda_cc_mean_abs_diff                     0.3088
  eda_stress_skin_kurtosis                 0.2888
  eda_cc_max                               0.2658
  eda_cc_kurtosis                          0.2044
  eda_stress_skin_min                      0.1005
  eda_stress_skin_slope                    0.0742

PC5
  eda_stress_skin_slope                    0.5125
  eda_stress_skin_min                      0.4589
  eda_cc_max                               0.4293
  eda_stress_skin_skew                     0.3331
  eda_stress_skin_iqr                      0.3148
  eda_cc_mean_abs_diff                     0.3135
  eda_cc_skew                              0.1558
  eda_cc_kurtosis                          0.0958

PC6
  eda_stress_skin_kurtosis                 0.6838
  eda_stress_skin_skew                     0.3977
  eda_cc_mean_abs_diff                     0.3432
  eda_cc_max                               0.3430
  eda_stress_skin_min                      0.2978
  eda_cc_kurtosis                          0.1572
  eda_cc_skew                              0.1134
  eda_stress_skin_slope                    0.1073

PC7
  eda_cc_max                               0.5983
  eda_cc_mean_abs_diff                     0.5393
  eda_stress_skin_kurtosis                 0.4621
  eda_stress_skin_slope                    0.2222
  eda_cc_kurtosis                          0.1965
  eda_stress_skin_skew                     0.1780
  eda_stress_skin_iqr                      0.1200
  eda_cc_skew                              0.0559

PC8
  eda_cc_kurtosis                          0.6601
  eda_cc_skew                              0.6299
  eda_stress_skin_iqr                      0.2171
  eda_stress_skin_skew                     0.2129
  eda_cc_max                               0.1614
  eda_cc_mean_abs_diff                     0.1474
  eda_stress_skin_min                      0.1242
  eda_stress_skin_slope                    0.1092

Saved to: data/feature_extraction/analysis/quality_eda_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_5.0s.csv
Shape: (493, 28)
Selected feature columns: 21
After NaN/variance filter: (493, 16)
After correlation pruning: (493, 3)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 3

Explained variance per PC (round 1):
   PC1: 0.4552   (cum 0.4552)
   PC2: 0.3103   (cum 0.7655)
   PC3: 0.2345   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_phasic_energy                        0.6548
  eda_scl_max                              0.6404
  eda_scr_rise_mean                        0.4015

PC2
  eda_scr_rise_mean                        0.9135
  eda_scl_max                              0.3314
  eda_phasic_energy                        0.2360

PC3
  eda_phasic_energy                        0.7181
  eda_scl_max                              0.6929
  eda_scr_rise_mean                        0.0659

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 3
Stage 2: selected features: 3 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 3
  pcs_for_99pct: 3

Explained variance per PC (round 2):
   PC1: 0.4552   (cum 0.4552)
   PC2: 0.3103   (cum 0.7655)
   PC3: 0.2345   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_phasic_energy                        0.6548
  eda_scl_max                              0.6404
  eda_scr_rise_mean                        0.4015

PC2
  eda_scr_rise_mean                        0.9135
  eda_scl_max                              0.3314
  eda_phasic_energy                        0.2360

PC3
  eda_phasic_energy                        0.7181
  eda_scl_max                              0.6929
  eda_scr_rise_mean                        0.0659

Saved to: data/feature_extraction/analysis/quality_eda_advanced_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_features_2.0s.csv
Shape: (1507, 39)
Selected feature columns: 30
After NaN/variance filter: (1507, 29)
After correlation pruning: (1507, 29)

PCA summary (round 1):
  pcs_for_90pct: 13
  pcs_for_95pct: 17
  pcs_for_99pct: 25

Explained variance per PC (round 1):
   PC1: 0.3626   (cum 0.3626)
   PC2: 0.1809   (cum 0.5435)
   PC3: 0.0662   (cum 0.6096)
   PC4: 0.0478   (cum 0.6574)
   PC5: 0.0440   (cum 0.7014)
   PC6: 0.0374   (cum 0.7388)
   PC7: 0.0368   (cum 0.7756)
   PC8: 0.0319   (cum 0.8075)
   PC9: 0.0255   (cum 0.8330)
  PC10: 0.0229   (cum 0.8558)
  PC11: 0.0220   (cum 0.8779)
  PC12: 0.0160   (cum 0.8939)
  PC13: 0.0150   (cum 0.9089)
  PC14: 0.0124   (cum 0.9212)
  PC15: 0.0115   (cum 0.9327)

Top PCA loadings per component (round 1):

PC1
  acc_y_dyn__avg_amplitude_change          0.2632
  acc_x_dyn__quantile_0.9                  0.2512
  acc_x_dyn__max                           0.2498
  acc_z_dyn__sum_of_absolute_changes       0.2472
  acc_x_dyn__quantile_0.3                  0.2407
  acc_y_dyn__quantile_0.3                  0.2304
  acc_x_dyn__harmonic_mean_of_abs          0.2284
  acc_z_dyn__harmonic_mean_of_abs          0.2254

PC2
  acc_y_dyn__sample_entropy                0.3344
  acc_x_dyn__sample_entropy                0.3295
  acc_z_dyn__sample_entropy                0.3224
  acc_y_dyn__katz_fractal_dimension        0.3138
  acc_x_dyn__approximate_entropy_0.9       0.3128
  acc_x_dyn__katz_fractal_dimension        0.3079
  acc_z_dyn__katz_fractal_dimension        0.3030
  acc_x_dyn__cardinality                   0.2660

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4569
  acc_z_dyn__approximate_entropy_0.1       0.3880
  acc_z_dyn__variance_of_absolute_differences 0.3497
  acc_z_dyn__sum_of_absolute_changes       0.2950
  acc_x_dyn__cardinality                   0.2621
  acc_z_dyn__lower_complete_moment         0.2310
  acc_x_dyn__harmonic_mean_of_abs          0.1856
  acc_x_dyn__quantile_0.9                  0.1826

PC4
  acc_y_dyn__variance_of_absolute_differences 0.3812
  acc_z_dyn__quantile_0.6                  0.3734
  acc_y_dyn__quantile_0.3                  0.3378
  acc_y_dyn__quantile_0.4                  0.2860
  acc_z_dyn__lower_complete_moment         0.2753
  acc_y_dyn__harmonic_mean_of_abs          0.2642
  acc_y_dyn__avg_amplitude_change          0.2408
  acc_z_dyn__harmonic_mean_of_abs          0.2338

PC5
  acc_y_dyn__tsallis_entropy               0.4257
  acc_x_dyn__quantile_0.4                  0.4031
  acc_z_dyn__approximate_entropy_0.1       0.3246
  acc_x_dyn__quantile_0.3                  0.3200
  acc_x_dyn__approximate_entropy_0.1       0.2955
  acc_z_dyn__quantile_0.4                  0.2467
  acc_y_dyn__variance_of_absolute_differences 0.2414
  acc_x_dyn__harmonic_mean_of_abs          0.2246

PC6
  acc_y_dyn__tsallis_entropy               0.4955
  acc_x_dyn__variance_of_absolute_differences 0.3439
  acc_z_dyn__quantile_0.6                  0.3145
  acc_x_dyn__max                           0.2524
  acc_y_dyn__quantile_0.3                  0.2371
  acc_z_dyn__lower_complete_moment         0.2317
  acc_z_dyn__approximate_entropy_0.1       0.2211
  acc_y_dyn__harmonic_mean_of_abs          0.2187

PC7
  acc_x_dyn__quantile_0.6                  0.6411
  acc_x_dyn__quantile_0.4                  0.4137
  acc_y_dyn__tsallis_entropy               0.3728
  acc_y_dyn__variance_of_absolute_differences 0.2460
  acc_x_dyn__harmonic_mean_of_abs          0.1978
  acc_y_dyn__harmonic_mean_of_abs          0.1817
  acc_y_dyn__quantile_0.3                  0.1353
  acc_x_dyn__approximate_entropy_0.9       0.1309

PC8
  acc_z_dyn__quantile_0.4                  0.6416
  acc_z_dyn__quantile_0.6                  0.4496
  acc_x_dyn__quantile_0.4                  0.2582
  acc_y_dyn__quantile_0.4                  0.2435
  acc_x_dyn__variance_of_absolute_differences 0.2123
  acc_y_dyn__variance_of_absolute_differences 0.1987
  acc_y_dyn__tsallis_entropy               0.1841
  acc_x_dyn__quantile_0.6                  0.1816

Stage 2: PCs used to reach 90%: 13
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 13
  pcs_for_95pct: 17
  pcs_for_99pct: 25

Explained variance per PC (round 2):
   PC1: 0.3626   (cum 0.3626)
   PC2: 0.1809   (cum 0.5435)
   PC3: 0.0662   (cum 0.6096)
   PC4: 0.0478   (cum 0.6574)
   PC5: 0.0440   (cum 0.7014)
   PC6: 0.0374   (cum 0.7388)
   PC7: 0.0368   (cum 0.7756)
   PC8: 0.0319   (cum 0.8075)
   PC9: 0.0255   (cum 0.8330)
  PC10: 0.0229   (cum 0.8558)
  PC11: 0.0220   (cum 0.8779)
  PC12: 0.0160   (cum 0.8939)
  PC13: 0.0150   (cum 0.9089)
  PC14: 0.0124   (cum 0.9212)
  PC15: 0.0115   (cum 0.9327)

Top PCA loadings per component (round 2):

PC1
  acc_y_dyn__avg_amplitude_change          0.2632
  acc_x_dyn__quantile_0.9                  0.2512
  acc_x_dyn__max                           0.2498
  acc_z_dyn__sum_of_absolute_changes       0.2472
  acc_x_dyn__quantile_0.3                  0.2407
  acc_y_dyn__quantile_0.3                  0.2304
  acc_x_dyn__harmonic_mean_of_abs          0.2284
  acc_z_dyn__harmonic_mean_of_abs          0.2254

PC2
  acc_y_dyn__sample_entropy                0.3344
  acc_x_dyn__sample_entropy                0.3295
  acc_z_dyn__sample_entropy                0.3224
  acc_y_dyn__katz_fractal_dimension        0.3138
  acc_x_dyn__approximate_entropy_0.9       0.3128
  acc_x_dyn__katz_fractal_dimension        0.3079
  acc_z_dyn__katz_fractal_dimension        0.3030
  acc_x_dyn__cardinality                   0.2660

PC3
  acc_x_dyn__approximate_entropy_0.1       0.4569
  acc_z_dyn__approximate_entropy_0.1       0.3880
  acc_z_dyn__variance_of_absolute_differences 0.3497
  acc_z_dyn__sum_of_absolute_changes       0.2950
  acc_x_dyn__cardinality                   0.2621
  acc_z_dyn__lower_complete_moment         0.2310
  acc_x_dyn__harmonic_mean_of_abs          0.1856
  acc_x_dyn__quantile_0.9                  0.1826

PC4
  acc_y_dyn__variance_of_absolute_differences 0.3812
  acc_z_dyn__quantile_0.6                  0.3734
  acc_y_dyn__quantile_0.3                  0.3378
  acc_y_dyn__quantile_0.4                  0.2860
  acc_z_dyn__lower_complete_moment         0.2753
  acc_y_dyn__harmonic_mean_of_abs          0.2642
  acc_y_dyn__avg_amplitude_change          0.2408
  acc_z_dyn__harmonic_mean_of_abs          0.2338

PC5
  acc_y_dyn__tsallis_entropy               0.4257
  acc_x_dyn__quantile_0.4                  0.4031
  acc_z_dyn__approximate_entropy_0.1       0.3246
  acc_x_dyn__quantile_0.3                  0.3200
  acc_x_dyn__approximate_entropy_0.1       0.2955
  acc_z_dyn__quantile_0.4                  0.2467
  acc_y_dyn__variance_of_absolute_differences 0.2414
  acc_x_dyn__harmonic_mean_of_abs          0.2246

PC6
  acc_y_dyn__tsallis_entropy               0.4955
  acc_x_dyn__variance_of_absolute_differences 0.3439
  acc_z_dyn__quantile_0.6                  0.3145
  acc_x_dyn__max                           0.2524
  acc_y_dyn__quantile_0.3                  0.2371
  acc_z_dyn__lower_complete_moment         0.2317
  acc_z_dyn__approximate_entropy_0.1       0.2211
  acc_y_dyn__harmonic_mean_of_abs          0.2187

PC7
  acc_x_dyn__quantile_0.6                  0.6411
  acc_x_dyn__quantile_0.4                  0.4137
  acc_y_dyn__tsallis_entropy               0.3728
  acc_y_dyn__variance_of_absolute_differences 0.2460
  acc_x_dyn__harmonic_mean_of_abs          0.1978
  acc_y_dyn__harmonic_mean_of_abs          0.1817
  acc_y_dyn__quantile_0.3                  0.1353
  acc_x_dyn__approximate_entropy_0.9       0.1309

PC8
  acc_z_dyn__quantile_0.4                  0.6416
  acc_z_dyn__quantile_0.6                  0.4496
  acc_x_dyn__quantile_0.4                  0.2582
  acc_y_dyn__quantile_0.4                  0.2435
  acc_x_dyn__variance_of_absolute_differences 0.2123
  acc_y_dyn__variance_of_absolute_differences 0.1987
  acc_y_dyn__tsallis_entropy               0.1841
  acc_x_dyn__quantile_0.6                  0.1816

Saved to: data/feature_extraction/analysis/quality_imu_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_2.0s.csv | rows=1504 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_features_2.0s.csv
Shape: (1504, 51)
Selected feature columns: 44
After NaN/variance filter: (1504, 43)
After correlation pruning: (1504, 17)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 11

Explained variance per PC (round 1):
   PC1: 0.3842   (cum 0.3842)
   PC2: 0.1372   (cum 0.5213)
   PC3: 0.1112   (cum 0.6325)
   PC4: 0.0894   (cum 0.7219)
   PC5: 0.0601   (cum 0.7820)
   PC6: 0.0572   (cum 0.8392)
   PC7: 0.0505   (cum 0.8897)
   PC8: 0.0439   (cum 0.9336)
   PC9: 0.0307   (cum 0.9643)
  PC10: 0.0181   (cum 0.9824)
  PC11: 0.0086   (cum 0.9910)
  PC12: 0.0042   (cum 0.9952)
  PC13: 0.0027   (cum 0.9979)
  PC14: 0.0013   (cum 0.9992)
  PC15: 0.0007   (cum 0.9999)

Top PCA loadings per component (round 1):

PC1
  ppg_green_diff_mean_abs                  0.3743
  ppg_green_crest_factor                   0.3708
  ppg_green_std                            0.3699
  ppg_green_tke_p95_abs                    0.3677
  ppg_green_dx_std                         0.3352
  ppg_green_iqr                            0.2924
  ppg_green_mad                            0.2849
  ppg_green_tke_std                        0.2472

PC2
  ppg_green_dx_kurtosis                    0.3796
  ppg_green_kurtosis                       0.3673
  ppg_green_p90                            0.3629
  ppg_green_min                            0.3603
  ppg_green_skew                           0.3289
  ppg_green_mad                            0.2758
  ppg_green_iqr                            0.2659
  ppg_green_ddx_kurtosis                   0.2324

PC3
  ppg_green_min                            0.5409
  ppg_green_mean_cross_rate                0.4411
  ppg_green_p90                            0.4359
  ppg_green_kurtosis                       0.3537
  ppg_green_ddx_kurtosis                   0.2214
  ppg_green_dx_kurtosis                    0.2170
  ppg_green_iqr                            0.1619
  ppg_green_mad                            0.1529

PC4
  ppg_green_tke_std                        0.4831
  ppg_green_ddx_kurtosis                   0.3811
  ppg_green_dx_std                         0.3553
  ppg_green_iqr                            0.3378
  ppg_green_mad                            0.3307
  ppg_green_mean_cross_rate                0.2330
  ppg_green_dx_kurtosis                    0.2238
  ppg_green_skew                           0.2011

PC5
  ppg_green_dx_mean                        0.8150
  ppg_green_ddx_mean                       0.4824
  ppg_green_dx_kurtosis                    0.2030
  ppg_green_ddx_kurtosis                   0.1562
  ppg_green_tke_std                        0.0978
  ppg_green_skew                           0.0861
  ppg_green_mean_cross_rate                0.0796
  ppg_green_kurtosis                       0.0787

PC6
  ppg_green_ddx_mean                       0.5254
  ppg_green_skew                           0.5132
  ppg_green_dx_mean                        0.4986
  ppg_green_ddx_kurtosis                   0.2716
  ppg_green_dx_kurtosis                    0.2591
  ppg_green_mean_cross_rate                0.1499
  ppg_green_crest_factor                   0.1285
  ppg_green_min                            0.1105

PC7
  ppg_green_mean_cross_rate                0.5411
  ppg_green_ddx_mean                       0.4926
  ppg_green_skew                           0.3608
  ppg_green_dx_kurtosis                    0.2402
  ppg_green_min                            0.2355
  ppg_green_kurtosis                       0.2154
  ppg_green_tke_std                        0.2119
  ppg_green_p90                            0.1920

PC8
  ppg_green_skew                           0.5667
  ppg_green_mean_cross_rate                0.5472
  ppg_green_ddx_mean                       0.3861
  ppg_green_min                            0.2509
  ppg_green_dx_mean                        0.2088
  ppg_green_p90                            0.2073
  ppg_green_ddx_kurtosis                   0.2033
  ppg_green_diff_mean_abs                  0.1091

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 17
Stage 2: selected features: 17 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 11

Explained variance per PC (round 2):
   PC1: 0.3842   (cum 0.3842)
   PC2: 0.1372   (cum 0.5213)
   PC3: 0.1112   (cum 0.6325)
   PC4: 0.0894   (cum 0.7219)
   PC5: 0.0601   (cum 0.7820)
   PC6: 0.0572   (cum 0.8392)
   PC7: 0.0505   (cum 0.8897)
   PC8: 0.0439   (cum 0.9336)
   PC9: 0.0307   (cum 0.9643)
  PC10: 0.0181   (cum 0.9824)
  PC11: 0.0086   (cum 0.9910)
  PC12: 0.0042   (cum 0.9952)
  PC13: 0.0027   (cum 0.9979)
  PC14: 0.0013   (cum 0.9992)
  PC15: 0.0007   (cum 0.9999)

Top PCA loadings per component (round 2):

PC1
  ppg_green_diff_mean_abs                  0.3743
  ppg_green_crest_factor                   0.3708
  ppg_green_std                            0.3699
  ppg_green_tke_p95_abs                    0.3677
  ppg_green_dx_std                         0.3352
  ppg_green_iqr                            0.2924
  ppg_green_mad                            0.2849
  ppg_green_tke_std                        0.2472

PC2
  ppg_green_dx_kurtosis                    0.3796
  ppg_green_kurtosis                       0.3673
  ppg_green_p90                            0.3629
  ppg_green_min                            0.3603
  ppg_green_skew                           0.3289
  ppg_green_mad                            0.2758
  ppg_green_iqr                            0.2659
  ppg_green_ddx_kurtosis                   0.2324

PC3
  ppg_green_min                            0.5409
  ppg_green_mean_cross_rate                0.4411
  ppg_green_p90                            0.4359
  ppg_green_kurtosis                       0.3537
  ppg_green_ddx_kurtosis                   0.2214
  ppg_green_dx_kurtosis                    0.2170
  ppg_green_iqr                            0.1619
  ppg_green_mad                            0.1529

PC4
  ppg_green_tke_std                        0.4831
  ppg_green_ddx_kurtosis                   0.3811
  ppg_green_dx_std                         0.3553
  ppg_green_iqr                            0.3378
  ppg_green_mad                            0.3307
  ppg_green_mean_cross_rate                0.2330
  ppg_green_dx_kurtosis                    0.2238
  ppg_green_skew                           0.2011

PC5
  ppg_green_dx_mean                        0.8150
  ppg_green_ddx_mean                       0.4824
  ppg_green_dx_kurtosis                    0.2030
  ppg_green_ddx_kurtosis                   0.1562
  ppg_green_tke_std                        0.0978
  ppg_green_skew                           0.0861
  ppg_green_mean_cross_rate                0.0796
  ppg_green_kurtosis                       0.0787

PC6
  ppg_green_ddx_mean                       0.5254
  ppg_green_skew                           0.5132
  ppg_green_dx_mean                        0.4986
  ppg_green_ddx_kurtosis                   0.2716
  ppg_green_dx_kurtosis                    0.2591
  ppg_green_mean_cross_rate                0.1499
  ppg_green_crest_factor                   0.1285
  ppg_green_min                            0.1105

PC7
  ppg_green_mean_cross_rate                0.5411
  ppg_green_ddx_mean                       0.4926
  ppg_green_skew                           0.3608
  ppg_green_dx_kurtosis                    0.2402
  ppg_green_min                            0.2355
  ppg_green_kurtosis                       0.2154
  ppg_green_tke_std                        0.2119
  ppg_green_p90                            0.1920

PC8
  ppg_green_skew                           0.5667
  ppg_green_mean_cross_rate                0.5472
  ppg_green_ddx_mean                       0.3861
  ppg_green_min                            0.2509
  ppg_green_dx_mean                        0.2088
  ppg_green_p90                            0.2073
  ppg_green_ddx_kurtosis                   0.2033
  ppg_green_diff_mean_abs                  0.1091

Saved to: data/feature_extraction/analysis/quality_ppg_green_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_2.0s.csv
Shape: (1504, 28)
Selected feature columns: 15
After NaN/variance filter: (1504, 2)
After correlation pruning: (1504, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8352   (cum 0.8352)
   PC2: 0.1648   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8352   (cum 0.8352)
   PC2: 0.1648   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_2.0s.csv | rows=1504 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_features_2.0s.csv
Shape: (1504, 51)
Selected feature columns: 44
After NaN/variance filter: (1504, 44)
After correlation pruning: (1504, 22)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3267   (cum 0.3267)
   PC2: 0.1809   (cum 0.5076)
   PC3: 0.1082   (cum 0.6159)
   PC4: 0.0982   (cum 0.7140)
   PC5: 0.0864   (cum 0.8004)
   PC6: 0.0553   (cum 0.8557)
   PC7: 0.0407   (cum 0.8964)
   PC8: 0.0193   (cum 0.9157)
   PC9: 0.0173   (cum 0.9330)
  PC10: 0.0135   (cum 0.9466)
  PC11: 0.0113   (cum 0.9578)
  PC12: 0.0105   (cum 0.9683)
  PC13: 0.0080   (cum 0.9763)
  PC14: 0.0071   (cum 0.9834)
  PC15: 0.0066   (cum 0.9900)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_max                            0.3581
  ppg_infra_min                            0.3291
  ppg_infra_diff_mean_abs                  0.3226
  ppg_infra_tke_std                        0.3166
  ppg_infra_mad                            0.3101
  ppg_infra_signal_energy                  0.3084
  ppg_infra_p90                            0.3041
  ppg_infra_diff_mean                      0.2565

PC2
  ppg_infra_clearance_factor               0.4347
  ppg_infra_kurtosis                       0.4147
  ppg_infra_crest_factor                   0.4115
  ppg_infra_shape_factor                   0.4091
  ppg_infra_dx_kurtosis                    0.2909
  ppg_infra_ddx_kurtosis                   0.2334
  ppg_infra_zcr                            0.1778
  ppg_infra_mean_cross_rate                0.1481

PC3
  ppg_infra_mean                           0.5508
  ppg_infra_trim_mean_10                   0.4803
  ppg_infra_median                         0.4709
  ppg_infra_ddx_std                        0.2270
  ppg_infra_diff_mean                      0.1788
  ppg_infra_diff_mean_abs                  0.1553
  ppg_infra_min                            0.1551
  ppg_infra_signal_energy                  0.1503

PC4
  ppg_infra_trim_mean_10                   0.4071
  ppg_infra_ddx_mean                       0.3882
  ppg_infra_ddx_std                        0.3237
  ppg_infra_diff_mean                      0.3135
  ppg_infra_p90                            0.2714
  ppg_infra_signal_energy                  0.2577
  ppg_infra_mean                           0.2506
  ppg_infra_diff_mean_abs                  0.2397

PC5
  ppg_infra_mean_cross_rate                0.6220
  ppg_infra_zcr                            0.6169
  ppg_infra_ddx_kurtosis                   0.2908
  ppg_infra_dx_kurtosis                    0.2588
  ppg_infra_diff_mean_abs                  0.1037
  ppg_infra_skew                           0.1032
  ppg_infra_ddx_std                        0.1014
  ppg_infra_p90                            0.0928

PC6
  ppg_infra_skew                           0.8143
  ppg_infra_median                         0.2965
  ppg_infra_mean                           0.2149
  ppg_infra_dx_kurtosis                    0.2112
  ppg_infra_ddx_kurtosis                   0.1994
  ppg_infra_shape_factor                   0.1566
  ppg_infra_p90                            0.1324
  ppg_infra_clearance_factor               0.1239

PC7
  ppg_infra_dx_kurtosis                    0.5733
  ppg_infra_ddx_kurtosis                   0.4343
  ppg_infra_shape_factor                   0.3166
  ppg_infra_skew                           0.2824
  ppg_infra_clearance_factor               0.2514
  ppg_infra_mean_cross_rate                0.2298
  ppg_infra_min                            0.2231
  ppg_infra_zcr                            0.1764

PC8
  ppg_infra_median                         0.5518
  ppg_infra_ddx_std                        0.4785
  ppg_infra_skew                           0.2860
  ppg_infra_p90                            0.2857
  ppg_infra_crest_factor                   0.2566
  ppg_infra_mad                            0.2394
  ppg_infra_trim_mean_10                   0.2134
  ppg_infra_tke_std                        0.1762

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3267   (cum 0.3267)
   PC2: 0.1809   (cum 0.5076)
   PC3: 0.1082   (cum 0.6159)
   PC4: 0.0982   (cum 0.7140)
   PC5: 0.0864   (cum 0.8004)
   PC6: 0.0553   (cum 0.8557)
   PC7: 0.0407   (cum 0.8964)
   PC8: 0.0193   (cum 0.9157)
   PC9: 0.0173   (cum 0.9330)
  PC10: 0.0135   (cum 0.9466)
  PC11: 0.0113   (cum 0.9578)
  PC12: 0.0105   (cum 0.9683)
  PC13: 0.0080   (cum 0.9763)
  PC14: 0.0071   (cum 0.9834)
  PC15: 0.0066   (cum 0.9900)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_max                            0.3581
  ppg_infra_min                            0.3291
  ppg_infra_diff_mean_abs                  0.3226
  ppg_infra_tke_std                        0.3166
  ppg_infra_mad                            0.3101
  ppg_infra_signal_energy                  0.3084
  ppg_infra_p90                            0.3041
  ppg_infra_diff_mean                      0.2565

PC2
  ppg_infra_clearance_factor               0.4347
  ppg_infra_kurtosis                       0.4147
  ppg_infra_crest_factor                   0.4115
  ppg_infra_shape_factor                   0.4091
  ppg_infra_dx_kurtosis                    0.2909
  ppg_infra_ddx_kurtosis                   0.2334
  ppg_infra_zcr                            0.1778
  ppg_infra_mean_cross_rate                0.1481

PC3
  ppg_infra_mean                           0.5508
  ppg_infra_trim_mean_10                   0.4803
  ppg_infra_median                         0.4709
  ppg_infra_ddx_std                        0.2270
  ppg_infra_diff_mean                      0.1788
  ppg_infra_diff_mean_abs                  0.1553
  ppg_infra_min                            0.1551
  ppg_infra_signal_energy                  0.1503

PC4
  ppg_infra_trim_mean_10                   0.4071
  ppg_infra_ddx_mean                       0.3882
  ppg_infra_ddx_std                        0.3237
  ppg_infra_diff_mean                      0.3135
  ppg_infra_p90                            0.2714
  ppg_infra_signal_energy                  0.2577
  ppg_infra_mean                           0.2506
  ppg_infra_diff_mean_abs                  0.2397

PC5
  ppg_infra_mean_cross_rate                0.6220
  ppg_infra_zcr                            0.6169
  ppg_infra_ddx_kurtosis                   0.2908
  ppg_infra_dx_kurtosis                    0.2588
  ppg_infra_diff_mean_abs                  0.1037
  ppg_infra_skew                           0.1032
  ppg_infra_ddx_std                        0.1014
  ppg_infra_p90                            0.0928

PC6
  ppg_infra_skew                           0.8143
  ppg_infra_median                         0.2965
  ppg_infra_mean                           0.2149
  ppg_infra_dx_kurtosis                    0.2112
  ppg_infra_ddx_kurtosis                   0.1994
  ppg_infra_shape_factor                   0.1566
  ppg_infra_p90                            0.1324
  ppg_infra_clearance_factor               0.1239

PC7
  ppg_infra_dx_kurtosis                    0.5733
  ppg_infra_ddx_kurtosis                   0.4343
  ppg_infra_shape_factor                   0.3166
  ppg_infra_skew                           0.2824
  ppg_infra_clearance_factor               0.2514
  ppg_infra_mean_cross_rate                0.2298
  ppg_infra_min                            0.2231
  ppg_infra_zcr                            0.1764

PC8
  ppg_infra_median                         0.5518
  ppg_infra_ddx_std                        0.4785
  ppg_infra_skew                           0.2860
  ppg_infra_p90                            0.2857
  ppg_infra_crest_factor                   0.2566
  ppg_infra_mad                            0.2394
  ppg_infra_trim_mean_10                   0.2134
  ppg_infra_tke_std                        0.1762

Saved to: data/feature_extraction/analysis/quality_ppg_infra_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_2.0s.csv
Shape: (1504, 28)
Selected feature columns: 15
After NaN/variance filter: (1504, 2)
After correlation pruning: (1504, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7692   (cum 0.7692)
   PC2: 0.2308   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7692   (cum 0.7692)
   PC2: 0.2308   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_2.0s.csv | rows=1504 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_features_2.0s.csv
Shape: (1504, 51)
Selected feature columns: 44
After NaN/variance filter: (1504, 44)
After correlation pruning: (1504, 24)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 1):
   PC1: 0.3210   (cum 0.3210)
   PC2: 0.1835   (cum 0.5045)
   PC3: 0.1114   (cum 0.6159)
   PC4: 0.0992   (cum 0.7151)
   PC5: 0.0731   (cum 0.7882)
   PC6: 0.0519   (cum 0.8401)
   PC7: 0.0464   (cum 0.8865)
   PC8: 0.0211   (cum 0.9076)
   PC9: 0.0178   (cum 0.9254)
  PC10: 0.0153   (cum 0.9408)
  PC11: 0.0134   (cum 0.9542)
  PC12: 0.0116   (cum 0.9657)
  PC13: 0.0107   (cum 0.9764)
  PC14: 0.0092   (cum 0.9856)
  PC15: 0.0035   (cum 0.9892)

Top PCA loadings per component (round 1):

PC1
  ppg_red_max                              0.3478
  ppg_red_tke_mean_abs                     0.3237
  ppg_red_min                              0.3166
  ppg_red_mad                              0.3058
  ppg_red_diff_mean_abs                    0.3035
  ppg_red_signal_energy                    0.2988
  ppg_red_tke_std                          0.2952
  ppg_red_p90                              0.2919

PC2
  ppg_red_impulse_factor                   0.4555
  ppg_red_clearance_factor                 0.4231
  ppg_red_shape_factor                     0.4187
  ppg_red_crest_factor                     0.4142
  ppg_red_kurtosis                         0.3811
  ppg_red_dx_kurtosis                      0.2076
  ppg_red_ddx_kurtosis                     0.1645
  ppg_red_mad                              0.1316

PC3
  ppg_red_zcr                              0.3569
  ppg_red_mean_cross_rate                  0.3388
  ppg_red_dx_mean                          0.3329
  ppg_red_ddx_kurtosis                     0.3084
  ppg_red_ddx_mean                         0.3045
  ppg_red_signal_energy                    0.2785
  ppg_red_ddx_std                          0.2635
  ppg_red_tke_mean_abs                     0.2133

PC4
  ppg_red_trim_mean_10                     0.6223
  ppg_red_mean                             0.5816
  ppg_red_median                           0.4351
  ppg_red_ddx_mean                         0.2541
  ppg_red_skew                             0.0809
  ppg_red_p90                              0.0626
  ppg_red_dx_mean                          0.0494
  ppg_red_signal_energy                    0.0437

PC5
  ppg_red_mean_cross_rate                  0.5535
  ppg_red_zcr                              0.5404
  ppg_red_ddx_std                          0.3110
  ppg_red_diff_mean_abs                    0.2457
  ppg_red_ddx_mean                         0.2121
  ppg_red_dx_mean                          0.2013
  ppg_red_skew                             0.1742
  ppg_red_p90                              0.1684

PC6
  ppg_red_skew                             0.6638
  ppg_red_dx_kurtosis                      0.3670
  ppg_red_shape_factor                     0.2414
  ppg_red_median                           0.2359
  ppg_red_ddx_kurtosis                     0.2317
  ppg_red_mean_cross_rate                  0.2178
  ppg_red_clearance_factor                 0.1992
  ppg_red_p90                              0.1899

PC7
  ppg_red_skew                             0.5153
  ppg_red_dx_kurtosis                      0.5094
  ppg_red_ddx_kurtosis                     0.4148
  ppg_red_min                              0.2194
  ppg_red_mean                             0.2058
  ppg_red_diff_mean_abs                    0.1734
  ppg_red_median                           0.1686
  ppg_red_tke_std                          0.1568

PC8
  ppg_red_ddx_std                          0.4895
  ppg_red_ddx_kurtosis                     0.4794
  ppg_red_tke_std                          0.4253
  ppg_red_tke_mean_abs                     0.2385
  ppg_red_p90                              0.2344
  ppg_red_dx_mean                          0.2121
  ppg_red_min                              0.2016
  ppg_red_mad                              0.1885

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 24
Stage 2: selected features: 24 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 11
  pcs_for_99pct: 16

Explained variance per PC (round 2):
   PC1: 0.3210   (cum 0.3210)
   PC2: 0.1835   (cum 0.5045)
   PC3: 0.1114   (cum 0.6159)
   PC4: 0.0992   (cum 0.7151)
   PC5: 0.0731   (cum 0.7882)
   PC6: 0.0519   (cum 0.8401)
   PC7: 0.0464   (cum 0.8865)
   PC8: 0.0211   (cum 0.9076)
   PC9: 0.0178   (cum 0.9254)
  PC10: 0.0153   (cum 0.9408)
  PC11: 0.0134   (cum 0.9542)
  PC12: 0.0116   (cum 0.9657)
  PC13: 0.0107   (cum 0.9764)
  PC14: 0.0092   (cum 0.9856)
  PC15: 0.0035   (cum 0.9892)

Top PCA loadings per component (round 2):

PC1
  ppg_red_max                              0.3478
  ppg_red_tke_mean_abs                     0.3237
  ppg_red_min                              0.3166
  ppg_red_mad                              0.3058
  ppg_red_diff_mean_abs                    0.3035
  ppg_red_signal_energy                    0.2988
  ppg_red_tke_std                          0.2952
  ppg_red_p90                              0.2919

PC2
  ppg_red_impulse_factor                   0.4555
  ppg_red_clearance_factor                 0.4231
  ppg_red_shape_factor                     0.4187
  ppg_red_crest_factor                     0.4142
  ppg_red_kurtosis                         0.3811
  ppg_red_dx_kurtosis                      0.2076
  ppg_red_ddx_kurtosis                     0.1645
  ppg_red_mad                              0.1316

PC3
  ppg_red_zcr                              0.3569
  ppg_red_mean_cross_rate                  0.3388
  ppg_red_dx_mean                          0.3329
  ppg_red_ddx_kurtosis                     0.3084
  ppg_red_ddx_mean                         0.3045
  ppg_red_signal_energy                    0.2785
  ppg_red_ddx_std                          0.2635
  ppg_red_tke_mean_abs                     0.2133

PC4
  ppg_red_trim_mean_10                     0.6223
  ppg_red_mean                             0.5816
  ppg_red_median                           0.4351
  ppg_red_ddx_mean                         0.2541
  ppg_red_skew                             0.0809
  ppg_red_p90                              0.0626
  ppg_red_dx_mean                          0.0494
  ppg_red_signal_energy                    0.0437

PC5
  ppg_red_mean_cross_rate                  0.5535
  ppg_red_zcr                              0.5404
  ppg_red_ddx_std                          0.3110
  ppg_red_diff_mean_abs                    0.2457
  ppg_red_ddx_mean                         0.2121
  ppg_red_dx_mean                          0.2013
  ppg_red_skew                             0.1742
  ppg_red_p90                              0.1684

PC6
  ppg_red_skew                             0.6638
  ppg_red_dx_kurtosis                      0.3670
  ppg_red_shape_factor                     0.2414
  ppg_red_median                           0.2359
  ppg_red_ddx_kurtosis                     0.2317
  ppg_red_mean_cross_rate                  0.2178
  ppg_red_clearance_factor                 0.1992
  ppg_red_p90                              0.1899

PC7
  ppg_red_skew                             0.5153
  ppg_red_dx_kurtosis                      0.5094
  ppg_red_ddx_kurtosis                     0.4148
  ppg_red_min                              0.2194
  ppg_red_mean                             0.2058
  ppg_red_diff_mean_abs                    0.1734
  ppg_red_median                           0.1686
  ppg_red_tke_std                          0.1568

PC8
  ppg_red_ddx_std                          0.4895
  ppg_red_ddx_kurtosis                     0.4794
  ppg_red_tke_std                          0.4253
  ppg_red_tke_mean_abs                     0.2385
  ppg_red_p90                              0.2344
  ppg_red_dx_mean                          0.2121
  ppg_red_min                              0.2016
  ppg_red_mad                              0.1885

Saved to: data/feature_extraction/analysis/quality_ppg_red_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_2.0s.csv
Shape: (1504, 28)
Selected feature columns: 15
After NaN/variance filter: (1504, 2)
After correlation pruning: (1504, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7563   (cum 0.7563)
   PC2: 0.2437   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7563   (cum 0.7563)
   PC2: 0.2437   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_2.0s.csv | rows=1224 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_features_2.0s.csv
Shape: (1224, 33)
Selected feature columns: 26
After NaN/variance filter: (1224, 26)
After correlation pruning: (1224, 9)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 1):
   PC1: 0.2309   (cum 0.2309)
   PC2: 0.1980   (cum 0.4288)
   PC3: 0.1681   (cum 0.5969)
   PC4: 0.1279   (cum 0.7248)
   PC5: 0.0965   (cum 0.8214)
   PC6: 0.0751   (cum 0.8965)
   PC7: 0.0529   (cum 0.9494)
   PC8: 0.0369   (cum 0.9864)
   PC9: 0.0136   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_min                      0.4580
  eda_stress_skin_mad                      0.4543
  eda_stress_skin_kurtosis                 0.4335
  eda_stress_skin_skew                     0.4008
  eda_cc_max                               0.3583
  eda_cc_range                             0.2924
  eda_stress_skin_slope                    0.1334
  eda_cc_skew                              0.0490

PC2
  eda_stress_skin_skew                     0.5689
  eda_stress_skin_kurtosis                 0.5251
  eda_stress_skin_min                      0.3244
  eda_stress_skin_mad                      0.3112
  eda_cc_range                             0.2585
  eda_cc_max                               0.2439
  eda_cc_kurtosis                          0.1789
  eda_cc_skew                              0.1583

PC3
  eda_cc_skew                              0.6822
  eda_cc_kurtosis                          0.6804
  eda_stress_skin_kurtosis                 0.1904
  eda_stress_skin_skew                     0.1311
  eda_stress_skin_mad                      0.1022
  eda_stress_skin_slope                    0.0644
  eda_cc_max                               0.0485
  eda_stress_skin_min                      0.0275

PC4
  eda_stress_skin_slope                    0.7108
  eda_cc_range                             0.5102
  eda_stress_skin_mad                      0.3681
  eda_cc_max                               0.3004
  eda_cc_skew                              0.0878
  eda_cc_kurtosis                          0.0234
  eda_stress_skin_min                      0.0169
  eda_stress_skin_kurtosis                 0.0117

PC5
  eda_stress_skin_slope                    0.5730
  eda_stress_skin_min                      0.5131
  eda_cc_max                               0.4609
  eda_cc_range                             0.3439
  eda_stress_skin_mad                      0.2739
  eda_cc_kurtosis                          0.0318
  eda_stress_skin_kurtosis                 0.0276
  eda_cc_skew                              0.0270

PC6
  eda_cc_max                               0.6960
  eda_cc_range                             0.6476
  eda_stress_skin_slope                    0.2397
  eda_stress_skin_min                      0.1396
  eda_stress_skin_mad                      0.1204
  eda_cc_kurtosis                          0.0505
  eda_stress_skin_skew                     0.0433
  eda_cc_skew                              0.0162

PC7
  eda_cc_skew                              0.7030
  eda_cc_kurtosis                          0.7021
  eda_stress_skin_min                      0.0702
  eda_cc_range                             0.0483
  eda_cc_max                               0.0448
  eda_stress_skin_mad                      0.0442
  eda_stress_skin_slope                    0.0347
  eda_stress_skin_skew                     0.0164

PC8
  eda_stress_skin_mad                      0.6712
  eda_stress_skin_min                      0.6265
  eda_stress_skin_slope                    0.2645
  eda_cc_range                             0.2156
  eda_cc_max                               0.1416
  eda_stress_skin_kurtosis                 0.0807
  eda_cc_kurtosis                          0.0761
  eda_stress_skin_skew                     0.0747

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 9
Stage 2: selected features: 9 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 9

Explained variance per PC (round 2):
   PC1: 0.2309   (cum 0.2309)
   PC2: 0.1980   (cum 0.4288)
   PC3: 0.1681   (cum 0.5969)
   PC4: 0.1279   (cum 0.7248)
   PC5: 0.0965   (cum 0.8214)
   PC6: 0.0751   (cum 0.8965)
   PC7: 0.0529   (cum 0.9494)
   PC8: 0.0369   (cum 0.9864)
   PC9: 0.0136   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_min                      0.4580
  eda_stress_skin_mad                      0.4543
  eda_stress_skin_kurtosis                 0.4335
  eda_stress_skin_skew                     0.4008
  eda_cc_max                               0.3583
  eda_cc_range                             0.2924
  eda_stress_skin_slope                    0.1334
  eda_cc_skew                              0.0490

PC2
  eda_stress_skin_skew                     0.5689
  eda_stress_skin_kurtosis                 0.5251
  eda_stress_skin_min                      0.3244
  eda_stress_skin_mad                      0.3112
  eda_cc_range                             0.2585
  eda_cc_max                               0.2439
  eda_cc_kurtosis                          0.1789
  eda_cc_skew                              0.1583

PC3
  eda_cc_skew                              0.6822
  eda_cc_kurtosis                          0.6804
  eda_stress_skin_kurtosis                 0.1904
  eda_stress_skin_skew                     0.1311
  eda_stress_skin_mad                      0.1022
  eda_stress_skin_slope                    0.0644
  eda_cc_max                               0.0485
  eda_stress_skin_min                      0.0275

PC4
  eda_stress_skin_slope                    0.7108
  eda_cc_range                             0.5102
  eda_stress_skin_mad                      0.3681
  eda_cc_max                               0.3004
  eda_cc_skew                              0.0878
  eda_cc_kurtosis                          0.0234
  eda_stress_skin_min                      0.0169
  eda_stress_skin_kurtosis                 0.0117

PC5
  eda_stress_skin_slope                    0.5730
  eda_stress_skin_min                      0.5131
  eda_cc_max                               0.4609
  eda_cc_range                             0.3439
  eda_stress_skin_mad                      0.2739
  eda_cc_kurtosis                          0.0318
  eda_stress_skin_kurtosis                 0.0276
  eda_cc_skew                              0.0270

PC6
  eda_cc_max                               0.6960
  eda_cc_range                             0.6476
  eda_stress_skin_slope                    0.2397
  eda_stress_skin_min                      0.1396
  eda_stress_skin_mad                      0.1204
  eda_cc_kurtosis                          0.0505
  eda_stress_skin_skew                     0.0433
  eda_cc_skew                              0.0162

PC7
  eda_cc_skew                              0.7030
  eda_cc_kurtosis                          0.7021
  eda_stress_skin_min                      0.0702
  eda_cc_range                             0.0483
  eda_cc_max                               0.0448
  eda_stress_skin_mad                      0.0442
  eda_stress_skin_slope                    0.0347
  eda_stress_skin_skew                     0.0164

PC8
  eda_stress_skin_mad                      0.6712
  eda_stress_skin_min                      0.6265
  eda_stress_skin_slope                    0.2645
  eda_cc_range                             0.2156
  eda_cc_max                               0.1416
  eda_stress_skin_kurtosis                 0.0807
  eda_cc_kurtosis                          0.0761
  eda_stress_skin_skew                     0.0747

Saved to: data/feature_extraction/analysis/quality_eda_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_2.0s.csv
Shape: (1224, 28)
Selected feature columns: 21
After NaN/variance filter: (1224, 18)
After correlation pruning: (1224, 4)

PCA summary (round 1):
  pcs_for_90pct: 3
  pcs_for_95pct: 4
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.4677   (cum 0.4677)
   PC2: 0.2510   (cum 0.7187)
   PC3: 0.1882   (cum 0.9069)
   PC4: 0.0931   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_rise_mean                        0.6320
  eda_phasic_energy                        0.6115
  eda_scl_max                              0.4748
  eda_scr_rate                             0.0351

PC2
  eda_scr_rate                             0.9949
  eda_scr_rise_mean                        0.0953
  eda_phasic_energy                        0.0244
  eda_scl_max                              0.0221

PC3
  eda_scl_max                              0.8726
  eda_phasic_energy                        0.4196
  eda_scr_rise_mean                        0.2477
  eda_scr_rate                             0.0328

PC4
  eda_scr_rise_mean                        0.7281
  eda_phasic_energy                        0.6704
  eda_scl_max                              0.1124
  eda_scr_rate                             0.0887

Stage 2: PCs used to reach 90%: 3
Stage 2: ranking pool size: 4
Stage 2: selected features: 4 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 3
  pcs_for_95pct: 4
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.4677   (cum 0.4677)
   PC2: 0.2510   (cum 0.7187)
   PC3: 0.1882   (cum 0.9069)
   PC4: 0.0931   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_rise_mean                        0.6320
  eda_phasic_energy                        0.6115
  eda_scl_max                              0.4748
  eda_scr_rate                             0.0351

PC2
  eda_scr_rate                             0.9949
  eda_scr_rise_mean                        0.0953
  eda_phasic_energy                        0.0244
  eda_scl_max                              0.0221

PC3
  eda_scl_max                              0.8726
  eda_phasic_energy                        0.4196
  eda_scr_rise_mean                        0.2477
  eda_scr_rate                             0.0328

PC4
  eda_scr_rise_mean                        0.7281
  eda_phasic_energy                        0.6704
  eda_scl_max                              0.1124
  eda_scr_rate                             0.0887

Saved to: data/feature_extraction/analysis/quality_eda_advanced_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_5.0s.csv | windows=605 | features=21
    ✓ HRV features: 605 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_aligned_5.0s.csv (605 windows | borg labeled: 298)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_aligned_5.0s.csv (605 windows | borg labeled: 298)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_5.0s.csv | windows=605 | features=21
    ✓ HRV features: 605 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_aligned_5.0s.csv (605 windows | borg labeled: 298)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 605
  Windows in ADL time range: 387
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_aligned_5.0s.csv (605 windows | borg labeled: 298)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_5.0s.csv | windows=493 | features=21
    ✓ Advanced EDA features: 493 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 493
  Windows in ADL time range: 390
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_aligned_5.0s.csv (493 windows | borg labeled: 303)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 493
  Windows in ADL time range: 390
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_aligned_5.0s.csv (493 windows | borg labeled: 303)

▶ Window length: 2.0s | overlap=0.1
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1507
  Windows in ADL time range: 967
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/imu_wrist/imu_aligned_2.0s.csv (1507 windows | borg labeled: 753)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_features_2.0s.csv | windows=1504 | features=21
    ✓ HRV features: 1504 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_green/ppg_green_hrv_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_features_2.0s.csv | windows=1504 | features=21
    ✓ HRV features: 1504 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_infra/ppg_infra_hrv_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_features_2.0s.csv | windows=1504 | features=21
    ✓ HRV features: 1504 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1504
  Windows in ADL time range: 962
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/ppg_red/ppg_red_hrv_aligned_2.0s.csv (1504 windows | borg labeled: 747)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_features_2.0s.csv | windows=1224 | features=21
    ✓ Advanced EDA features: 1224 windows
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1224
  Windows in ADL time range: 968
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_aligned_2.0s.csv (1224 windows | borg labeled: 752)
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1224
  Windows in ADL time range: 968
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/eda/eda_advanced_aligned_2.0s.csv (1224 windows | borg labeled: 752)

▶ Fusion step
  Running fusion...

▶ Fusing features for window length: 10.0s
  Loaded eda: 246 windows | t_center min=1764900174.000 max=1764902379.000 n=246
  Loaded eda_advanced: 246 windows | t_center min=1764900174.000 max=1764902379.000 n=246
  Loaded imu_bioz: 244 windows | t_center min=1764900150.000 max=1764902337.000 n=244
  Loaded imu_wrist: 303 windows | t_center min=1764899508.000 max=1764902226.000 n=303
  Loaded ppg_green: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Loaded ppg_green_hrv: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Loaded ppg_infra: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Loaded ppg_infra_hrv: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Loaded ppg_red: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Loaded ppg_red_hrv: 302 windows | t_center min=1764899501.000 max=1764902210.000 n=302
  Dropped 12 invalid feature columns
  ✓ Wrote 0 fused windows → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_features_10.0s.csv

▶ Fusing features for window length: 5.0s
  Loaded eda: 493 windows | t_center min=1764900171.500 max=1764902385.500 n=493
  Loaded eda_advanced: 493 windows | t_center min=1764900171.500 max=1764902385.500 n=493
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
  Loaded imu_bioz: 489 windows | t_center min=1764900147.500 max=1764902343.500 n=489
  Loaded imu_wrist: 607 windows | t_center min=1764899505.500 max=1764902232.500 n=607
  Loaded ppg_green: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Loaded ppg_green_hrv: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Loaded ppg_infra: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Loaded ppg_infra_hrv: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Loaded ppg_red: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Loaded ppg_red_hrv: 605 windows | t_center min=1764899498.500 max=1764902216.500 n=605
  Dropped 30 invalid feature columns
  ✓ Wrote 455 fused windows → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_features_5.0s.csv

▶ Fusing features for window length: 2.0s
  Loaded eda: 1224 windows | t_center min=1764900170.000 max=1764902386.688 n=1224
  Loaded eda_advanced: 1224 windows | t_center min=1764900170.000 max=1764902386.688 n=1224
  Loaded imu_bioz: 1214 windows | t_center min=1764900146.000 max=1764902344.562 n=1214
  Loaded imu_wrist: 1507 windows | t_center min=1764899504.000 max=1764902233.625 n=1507
  Loaded ppg_green: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Loaded ppg_green_hrv: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Loaded ppg_infra: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Loaded ppg_infra_hrv: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Loaded ppg_red: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Loaded ppg_red_hrv: 1504 windows | t_center min=1764899497.000 max=1764902221.188 n=1504
  Dropped 69 invalid feature columns
  ✓ Wrote 1133 fused windows → /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_features_2.0s.csv
  ✓ Fusion complete

▶ Aligning fused features with Borg effort labels
  Aligning fused features (10.0s windows)...
  ⚠ No data in features file (0 rows), skipping alignment
  Aligning fused features (5.0s windows)...
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 489
  Windows in ADL time range: 390
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_aligned_5.0s.csv (386 windows | borg labeled: 299)
  Aligning fused features (2.0s windows)...
  ADL recording time: 1764900479.2 to 1764902233.2
  Windows before filtering: 1214
  Windows in ADL time range: 968
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_aligned_2.0s.csv (962 windows | borg labeled: 746)

▶ Feature selection with correlation pruning + quality checks
  Running feature selection (5.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (5.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_aligned_5.0s.csv
  ✓ Loaded 299 labeled samples
  ✓ 254 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 239, Test: 60

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 42, IMU: 9, PPG: 49

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 9, IMU: 9, PPG: 21
  ✓ Total: 39 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 22, 'pcs_for_95pct': 26, 'pcs_for_99pct': 35}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/feature_selection_qc/qc_5.0s/features_filtered_5.0s.csv
    → 39 features + 2 metadata columns
    → 299 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_5.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (5.0s)
  Running feature selection (2.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (2.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_aligned_2.0s.csv
  ✓ Loaded 746 labeled samples
  ✓ 215 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 596, Test: 150

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 40, IMU: 11, PPG: 49

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 7, IMU: 10, PPG: 23
  ✓ Total: 40 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 23, 'pcs_for_95pct': 28, 'pcs_for_99pct': 36}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/feature_selection_qc/qc_2.0s/features_filtered_2.0s.csv
    → 40 features + 2 metadata columns
    → 746 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_2.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (2.0s)
[manual_features_imu] processed 200/200 windows
[manual_features_imu] processed 200/401 windows
[manual_features_imu] processed 400/401 windows
[manual_features_imu] processed 200/996 windows
[manual_features_imu] processed 400/996 windows
[manual_features_imu] processed 600/996 windows
[manual_features_imu] processed 800/996 windows
[manual_features_imu] processed 200/222 windows
[manual_features_imu] processed 200/445 windows
[manual_features_imu] processed 400/445 windows
[manual_features_imu] processed 200/1106 windows
[manual_features_imu] processed 400/1106 windows
[manual_features_imu] processed 600/1106 windows
[manual_features_imu] processed 800/1106 windows
[manual_features_imu] processed 1000/1106 windows
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_features_10.0s.csv
Shape: (222, 39)
Selected feature columns: 30
After NaN/variance filter: (222, 29)
After correlation pruning: (222, 28)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 12
  pcs_for_99pct: 21

Explained variance per PC (round 1):
   PC1: 0.4893   (cum 0.4893)
   PC2: 0.2038   (cum 0.6932)
   PC3: 0.0617   (cum 0.7549)
   PC4: 0.0414   (cum 0.7963)
   PC5: 0.0396   (cum 0.8359)
   PC6: 0.0311   (cum 0.8670)
   PC7: 0.0192   (cum 0.8862)
   PC8: 0.0159   (cum 0.9021)
   PC9: 0.0148   (cum 0.9169)
  PC10: 0.0121   (cum 0.9290)
  PC11: 0.0112   (cum 0.9402)
  PC12: 0.0106   (cum 0.9508)
  PC13: 0.0080   (cum 0.9588)
  PC14: 0.0068   (cum 0.9656)
  PC15: 0.0052   (cum 0.9709)

Top PCA loadings per component (round 1):

PC1
  acc_y_dyn__avg_amplitude_change          0.2334
  acc_z_dyn__sum_of_absolute_changes       0.2302
  acc_x_dyn__quantile_0.6                  0.2280
  acc_x_dyn__quantile_0.9                  0.2239
  acc_z_dyn__harmonic_mean_of_abs          0.2223
  acc_z_dyn__quantile_0.4                  0.2219
  acc_x_dyn__harmonic_mean_of_abs          0.2149
  acc_x_dyn__quantile_0.4                  0.2120

PC2
  acc_y_dyn__sample_entropy                0.3153
  acc_z_dyn__sample_entropy                0.2947
  acc_x_dyn__sample_entropy                0.2920
  acc_z_dyn__approximate_entropy_0.1       0.2732
  acc_x_dyn__approximate_entropy_0.1       0.2701
  acc_y_dyn__katz_fractal_dimension        0.2390
  acc_x_dyn__approximate_entropy_0.9       0.2354
  acc_z_dyn__katz_fractal_dimension        0.2348

PC3
  acc_y_dyn__quantile_0.4                  0.4510
  acc_y_dyn__quantile_0.3                  0.3979
  acc_y_dyn__harmonic_mean_of_abs          0.3601
  acc_x_dyn__variance_of_absolute_differences 0.3018
  acc_z_dyn__variance_of_absolute_differences 0.2775
  acc_x_dyn__max                           0.2142
  acc_z_dyn__lower_complete_moment         0.2133
  acc_x_dyn__cardinality                   0.2127

PC4
  acc_x_dyn__cardinality                   0.5120
  acc_y_dyn__tsallis_entropy               0.5065
  acc_z_dyn__quantile_0.6                  0.2955
  acc_z_dyn__lower_complete_moment         0.2694
  acc_y_dyn__variance_of_absolute_differences 0.2207
  acc_z_dyn__harmonic_mean_of_abs          0.1992
  acc_z_dyn__katz_fractal_dimension        0.1757
  acc_x_dyn__max                           0.1604

PC5
  acc_x_dyn__quantile_0.4                  0.3451
  acc_x_dyn__harmonic_mean_of_abs          0.3390
  acc_z_dyn__variance_of_absolute_differences 0.3022
  acc_x_dyn__quantile_0.9                  0.2715
  acc_x_dyn__quantile_0.6                  0.2699
  acc_x_dyn__variance_of_absolute_differences 0.2695
  acc_x_dyn__approximate_entropy_0.9       0.2507
  acc_x_dyn__max                           0.2347

PC6
  acc_x_dyn__cardinality                   0.5657
  acc_y_dyn__variance_of_absolute_differences 0.2869
  acc_x_dyn__approximate_entropy_0.1       0.2827
  acc_z_dyn__approximate_entropy_0.1       0.2684
  acc_z_dyn__lower_complete_moment         0.2607
  acc_z_dyn__quantile_0.6                  0.2506
  acc_z_dyn__katz_fractal_dimension        0.2495
  acc_x_dyn__katz_fractal_dimension        0.2166

PC7
  acc_z_dyn__quantile_0.6                  0.5901
  acc_x_dyn__quantile_0.4                  0.2905
  acc_z_dyn__katz_fractal_dimension        0.2670
  acc_z_dyn__quantile_0.4                  0.2618
  acc_x_dyn__variance_of_absolute_differences 0.2454
  acc_z_dyn__variance_of_absolute_differences 0.2401
  acc_x_dyn__approximate_entropy_0.1       0.2330
  acc_z_dyn__lower_complete_moment         0.2204

PC8
  acc_x_dyn__variance_of_absolute_differences 0.4015
  acc_z_dyn__variance_of_absolute_differences 0.3708
  acc_y_dyn__quantile_0.4                  0.3558
  acc_x_dyn__approximate_entropy_0.9       0.2948
  acc_x_dyn__katz_fractal_dimension        0.2876
  acc_y_dyn__harmonic_mean_of_abs          0.2708
  acc_z_dyn__harmonic_mean_of_abs          0.2342
  acc_z_dyn__sum_of_absolute_changes       0.2217

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 28
Stage 2: selected features: 28 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 12
  pcs_for_99pct: 21

Explained variance per PC (round 2):
   PC1: 0.4893   (cum 0.4893)
   PC2: 0.2038   (cum 0.6932)
   PC3: 0.0617   (cum 0.7549)
   PC4: 0.0414   (cum 0.7963)
   PC5: 0.0396   (cum 0.8359)
   PC6: 0.0311   (cum 0.8670)
   PC7: 0.0192   (cum 0.8862)
   PC8: 0.0159   (cum 0.9021)
   PC9: 0.0148   (cum 0.9169)
  PC10: 0.0121   (cum 0.9290)
  PC11: 0.0112   (cum 0.9402)
  PC12: 0.0106   (cum 0.9508)
  PC13: 0.0080   (cum 0.9588)
  PC14: 0.0068   (cum 0.9656)
  PC15: 0.0052   (cum 0.9709)

Top PCA loadings per component (round 2):

PC1
  acc_y_dyn__avg_amplitude_change          0.2334
  acc_z_dyn__sum_of_absolute_changes       0.2302
  acc_x_dyn__quantile_0.6                  0.2280
  acc_x_dyn__quantile_0.9                  0.2239
  acc_z_dyn__harmonic_mean_of_abs          0.2223
  acc_z_dyn__quantile_0.4                  0.2219
  acc_x_dyn__harmonic_mean_of_abs          0.2149
  acc_x_dyn__quantile_0.4                  0.2120

PC2
  acc_y_dyn__sample_entropy                0.3153
  acc_z_dyn__sample_entropy                0.2947
  acc_x_dyn__sample_entropy                0.2920
  acc_z_dyn__approximate_entropy_0.1       0.2732
  acc_x_dyn__approximate_entropy_0.1       0.2701
  acc_y_dyn__katz_fractal_dimension        0.2390
  acc_x_dyn__approximate_entropy_0.9       0.2354
  acc_z_dyn__katz_fractal_dimension        0.2348

PC3
  acc_y_dyn__quantile_0.4                  0.4510
  acc_y_dyn__quantile_0.3                  0.3979
  acc_y_dyn__harmonic_mean_of_abs          0.3601
  acc_x_dyn__variance_of_absolute_differences 0.3018
  acc_z_dyn__variance_of_absolute_differences 0.2775
  acc_x_dyn__max                           0.2142
  acc_z_dyn__lower_complete_moment         0.2133
  acc_x_dyn__cardinality                   0.2127

PC4
  acc_x_dyn__cardinality                   0.5120
  acc_y_dyn__tsallis_entropy               0.5065
  acc_z_dyn__quantile_0.6                  0.2955
  acc_z_dyn__lower_complete_moment         0.2694
  acc_y_dyn__variance_of_absolute_differences 0.2207
  acc_z_dyn__harmonic_mean_of_abs          0.1992
  acc_z_dyn__katz_fractal_dimension        0.1757
  acc_x_dyn__max                           0.1604

PC5
  acc_x_dyn__quantile_0.4                  0.3451
  acc_x_dyn__harmonic_mean_of_abs          0.3390
  acc_z_dyn__variance_of_absolute_differences 0.3022
  acc_x_dyn__quantile_0.9                  0.2715
  acc_x_dyn__quantile_0.6                  0.2699
  acc_x_dyn__variance_of_absolute_differences 0.2695
  acc_x_dyn__approximate_entropy_0.9       0.2507
  acc_x_dyn__max                           0.2347

PC6
  acc_x_dyn__cardinality                   0.5657
  acc_y_dyn__variance_of_absolute_differences 0.2869
  acc_x_dyn__approximate_entropy_0.1       0.2827
  acc_z_dyn__approximate_entropy_0.1       0.2684
  acc_z_dyn__lower_complete_moment         0.2607
  acc_z_dyn__quantile_0.6                  0.2506
  acc_z_dyn__katz_fractal_dimension        0.2495
  acc_x_dyn__katz_fractal_dimension        0.2166

PC7
  acc_z_dyn__quantile_0.6                  0.5901
  acc_x_dyn__quantile_0.4                  0.2905
  acc_z_dyn__katz_fractal_dimension        0.2670
  acc_z_dyn__quantile_0.4                  0.2618
  acc_x_dyn__variance_of_absolute_differences 0.2454
  acc_z_dyn__variance_of_absolute_differences 0.2401
  acc_x_dyn__approximate_entropy_0.1       0.2330
  acc_z_dyn__lower_complete_moment         0.2204

PC8
  acc_x_dyn__variance_of_absolute_differences 0.4015
  acc_z_dyn__variance_of_absolute_differences 0.3708
  acc_y_dyn__quantile_0.4                  0.3558
  acc_x_dyn__approximate_entropy_0.9       0.2948
  acc_x_dyn__katz_fractal_dimension        0.2876
  acc_y_dyn__harmonic_mean_of_abs          0.2708
  acc_z_dyn__harmonic_mean_of_abs          0.2342
  acc_z_dyn__sum_of_absolute_changes       0.2217

Saved to: data/feature_extraction/analysis/quality_imu_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_10.0s.csv | rows=300 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_10.0s.csv
Shape: (300, 51)
Selected feature columns: 44
After NaN/variance filter: (300, 43)
After correlation pruning: (300, 20)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.3863   (cum 0.3863)
   PC2: 0.1712   (cum 0.5575)
   PC3: 0.1191   (cum 0.6766)
   PC4: 0.0697   (cum 0.7463)
   PC5: 0.0604   (cum 0.8067)
   PC6: 0.0514   (cum 0.8581)
   PC7: 0.0448   (cum 0.9029)
   PC8: 0.0323   (cum 0.9351)
   PC9: 0.0234   (cum 0.9585)
  PC10: 0.0182   (cum 0.9767)
  PC11: 0.0093   (cum 0.9860)
  PC12: 0.0051   (cum 0.9911)
  PC13: 0.0039   (cum 0.9950)
  PC14: 0.0020   (cum 0.9970)
  PC15: 0.0011   (cum 0.9981)

Top PCA loadings per component (round 1):

PC1
  ppg_green_p99_p1                         0.3481
  ppg_green_p90_p10                        0.3071
  ppg_green_crest_factor                   0.3059
  ppg_green_diff_mean_abs                  0.3020
  ppg_green_shape_factor                   0.2903
  ppg_green_iqr                            0.2899
  ppg_green_tke_p95_abs                    0.2740
  ppg_green_mad                            0.2735

PC2
  ppg_green_tke_std                        0.3574
  ppg_green_dx_kurtosis                    0.3519
  ppg_green_signal_energy                  0.3423
  ppg_green_kurtosis                       0.3390
  ppg_green_p1                             0.3102
  ppg_green_dx_std                         0.2717
  ppg_green_skew                           0.2526
  ppg_green_crest_factor                   0.2248

PC3
  ppg_green_p1                             0.4580
  ppg_green_mean_cross_rate                0.3519
  ppg_green_signal_energy                  0.3468
  ppg_green_iqr                            0.2834
  ppg_green_shape_factor                   0.2726
  ppg_green_p99                            0.2708
  ppg_green_mad                            0.2585
  ppg_green_kurtosis                       0.2427

PC4
  ppg_green_mean_cross_rate                0.5482
  ppg_green_tke_p95_abs                    0.3789
  ppg_green_ddx_mean                       0.3569
  ppg_green_diff_mean_abs                  0.3189
  ppg_green_p1                             0.2766
  ppg_green_signal_energy                  0.2658
  ppg_green_p99                            0.2336
  ppg_green_tke_std                        0.1919

PC5
  ppg_green_skew                           0.6088
  ppg_green_ddx_kurtosis                   0.3776
  ppg_green_dx_kurtosis                    0.3544
  ppg_green_diff_mean                      0.3451
  ppg_green_kurtosis                       0.2812
  ppg_green_crest_factor                   0.2152
  ppg_green_tke_std                        0.2115
  ppg_green_dx_std                         0.1568

PC6
  ppg_green_diff_mean                      0.6977
  ppg_green_ddx_mean                       0.4267
  ppg_green_ddx_kurtosis                   0.4219
  ppg_green_tke_std                        0.2267
  ppg_green_dx_std                         0.1881
  ppg_green_dx_kurtosis                    0.1488
  ppg_green_skew                           0.0940
  ppg_green_kurtosis                       0.0777

PC7
  ppg_green_ddx_mean                       0.6452
  ppg_green_diff_mean                      0.5572
  ppg_green_skew                           0.3028
  ppg_green_mean_cross_rate                0.2605
  ppg_green_tke_std                        0.1766
  ppg_green_tke_p95_abs                    0.1531
  ppg_green_dx_kurtosis                    0.1436
  ppg_green_dx_std                         0.1216

PC8
  ppg_green_skew                           0.4902
  ppg_green_ddx_mean                       0.4800
  ppg_green_ddx_kurtosis                   0.4728
  ppg_green_mean_cross_rate                0.2464
  ppg_green_dx_std                         0.2211
  ppg_green_diff_mean                      0.2111
  ppg_green_tke_std                        0.2038
  ppg_green_diff_mean_abs                  0.1798

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.3863   (cum 0.3863)
   PC2: 0.1712   (cum 0.5575)
   PC3: 0.1191   (cum 0.6766)
   PC4: 0.0697   (cum 0.7463)
   PC5: 0.0604   (cum 0.8067)
   PC6: 0.0514   (cum 0.8581)
   PC7: 0.0448   (cum 0.9029)
   PC8: 0.0323   (cum 0.9351)
   PC9: 0.0234   (cum 0.9585)
  PC10: 0.0182   (cum 0.9767)
  PC11: 0.0093   (cum 0.9860)
  PC12: 0.0051   (cum 0.9911)
  PC13: 0.0039   (cum 0.9950)
  PC14: 0.0020   (cum 0.9970)
  PC15: 0.0011   (cum 0.9981)

Top PCA loadings per component (round 2):

PC1
  ppg_green_p99_p1                         0.3481
  ppg_green_p90_p10                        0.3071
  ppg_green_crest_factor                   0.3059
  ppg_green_diff_mean_abs                  0.3020
  ppg_green_shape_factor                   0.2903
  ppg_green_iqr                            0.2899
  ppg_green_tke_p95_abs                    0.2740
  ppg_green_mad                            0.2735

PC2
  ppg_green_tke_std                        0.3574
  ppg_green_dx_kurtosis                    0.3519
  ppg_green_signal_energy                  0.3423
  ppg_green_kurtosis                       0.3390
  ppg_green_p1                             0.3102
  ppg_green_dx_std                         0.2717
  ppg_green_skew                           0.2526
  ppg_green_crest_factor                   0.2248

PC3
  ppg_green_p1                             0.4580
  ppg_green_mean_cross_rate                0.3519
  ppg_green_signal_energy                  0.3468
  ppg_green_iqr                            0.2834
  ppg_green_shape_factor                   0.2726
  ppg_green_p99                            0.2708
  ppg_green_mad                            0.2585
  ppg_green_kurtosis                       0.2427

PC4
  ppg_green_mean_cross_rate                0.5482
  ppg_green_tke_p95_abs                    0.3789
  ppg_green_ddx_mean                       0.3569
  ppg_green_diff_mean_abs                  0.3189
  ppg_green_p1                             0.2766
  ppg_green_signal_energy                  0.2658
  ppg_green_p99                            0.2336
  ppg_green_tke_std                        0.1919

PC5
  ppg_green_skew                           0.6088
  ppg_green_ddx_kurtosis                   0.3776
  ppg_green_dx_kurtosis                    0.3544
  ppg_green_diff_mean                      0.3451
  ppg_green_kurtosis                       0.2812
  ppg_green_crest_factor                   0.2152
  ppg_green_tke_std                        0.2115
  ppg_green_dx_std                         0.1568

PC6
  ppg_green_diff_mean                      0.6977
  ppg_green_ddx_mean                       0.4267
  ppg_green_ddx_kurtosis                   0.4219
  ppg_green_tke_std                        0.2267
  ppg_green_dx_std                         0.1881
  ppg_green_dx_kurtosis                    0.1488
  ppg_green_skew                           0.0940
  ppg_green_kurtosis                       0.0777

PC7
  ppg_green_ddx_mean                       0.6452
  ppg_green_diff_mean                      0.5572
  ppg_green_skew                           0.3028
  ppg_green_mean_cross_rate                0.2605
  ppg_green_tke_std                        0.1766
  ppg_green_tke_p95_abs                    0.1531
  ppg_green_dx_kurtosis                    0.1436
  ppg_green_dx_std                         0.1216

PC8
  ppg_green_skew                           0.4902
  ppg_green_ddx_mean                       0.4800
  ppg_green_ddx_kurtosis                   0.4728
  ppg_green_mean_cross_rate                0.2464
  ppg_green_dx_std                         0.2211
  ppg_green_diff_mean                      0.2111
  ppg_green_tke_std                        0.2038
  ppg_green_diff_mean_abs                  0.1798

Saved to: data/feature_extraction/analysis/quality_ppg_green_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_10.0s.csv
Shape: (300, 28)
Selected feature columns: 21
After NaN/variance filter: (300, 2)
After correlation pruning: (300, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8750   (cum 0.8750)
   PC2: 0.1250   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8750   (cum 0.8750)
   PC2: 0.1250   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_10.0s.csv | rows=300 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_10.0s.csv
Shape: (300, 51)
Selected feature columns: 44
After NaN/variance filter: (300, 44)
After correlation pruning: (300, 20)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.3632   (cum 0.3632)
   PC2: 0.1770   (cum 0.5401)
   PC3: 0.1194   (cum 0.6596)
   PC4: 0.0861   (cum 0.7457)
   PC5: 0.0629   (cum 0.8085)
   PC6: 0.0483   (cum 0.8568)
   PC7: 0.0457   (cum 0.9026)
   PC8: 0.0382   (cum 0.9408)
   PC9: 0.0255   (cum 0.9663)
  PC10: 0.0124   (cum 0.9787)
  PC11: 0.0076   (cum 0.9863)
  PC12: 0.0045   (cum 0.9907)
  PC13: 0.0035   (cum 0.9942)
  PC14: 0.0022   (cum 0.9964)
  PC15: 0.0020   (cum 0.9985)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_impulse_factor                 0.3124
  ppg_infra_dx_kurtosis                    0.3021
  ppg_infra_max                            0.2930
  ppg_infra_clearance_factor               0.2881
  ppg_infra_crest_factor                   0.2870
  ppg_infra_kurtosis                       0.2861
  ppg_infra_signal_energy                  0.2856
  ppg_infra_shape_factor                   0.2760

PC2
  ppg_infra_diff_mean_abs                  0.3743
  ppg_infra_p10                            0.3546
  ppg_infra_mad                            0.3379
  ppg_infra_ddx_std                        0.2817
  ppg_infra_kurtosis                       0.2687
  ppg_infra_impulse_factor                 0.2571
  ppg_infra_crest_factor                   0.2499
  ppg_infra_clearance_factor               0.2419

PC3
  ppg_infra_trim_mean_10                   0.6049
  ppg_infra_dx_mean                        0.3634
  ppg_infra_skew                           0.3053
  ppg_infra_mean                           0.2976
  ppg_infra_tke_std                        0.2863
  ppg_infra_ddx_std                        0.2720
  ppg_infra_median                         0.2384
  ppg_infra_p10                            0.1516

PC4
  ppg_infra_mad                            0.4554
  ppg_infra_dx_mean                        0.3821
  ppg_infra_signal_energy                  0.3258
  ppg_infra_max                            0.2989
  ppg_infra_ddx_kurtosis                   0.2859
  ppg_infra_mean                           0.2791
  ppg_infra_skew                           0.2411
  ppg_infra_zcr                            0.2262

PC5
  ppg_infra_median                         0.6134
  ppg_infra_mean                           0.5239
  ppg_infra_dx_mean                        0.2720
  ppg_infra_tke_std                        0.2497
  ppg_infra_zcr                            0.2196
  ppg_infra_ddx_std                        0.1862
  ppg_infra_mad                            0.1560
  ppg_infra_p10                            0.1551

PC6
  ppg_infra_zcr                            0.5572
  ppg_infra_skew                           0.5548
  ppg_infra_median                         0.4520
  ppg_infra_mean                           0.3081
  ppg_infra_dx_mean                        0.1313
  ppg_infra_trim_mean_10                   0.1090
  ppg_infra_ddx_kurtosis                   0.1061
  ppg_infra_p10                            0.1060

PC7
  ppg_infra_zcr                            0.7022
  ppg_infra_skew                           0.4640
  ppg_infra_mad                            0.2681
  ppg_infra_mean                           0.2340
  ppg_infra_dx_mean                        0.2273
  ppg_infra_p10                            0.1352
  ppg_infra_signal_energy                  0.1283
  ppg_infra_shape_factor                   0.1261

PC8
  ppg_infra_ddx_kurtosis                   0.5494
  ppg_infra_shape_factor                   0.4211
  ppg_infra_dx_kurtosis                    0.4162
  ppg_infra_clearance_factor               0.3417
  ppg_infra_impulse_factor                 0.2074
  ppg_infra_zcr                            0.2061
  ppg_infra_trim_mean_10                   0.1899
  ppg_infra_median                         0.1790

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.3632   (cum 0.3632)
   PC2: 0.1770   (cum 0.5401)
   PC3: 0.1194   (cum 0.6596)
   PC4: 0.0861   (cum 0.7457)
   PC5: 0.0629   (cum 0.8085)
   PC6: 0.0483   (cum 0.8568)
   PC7: 0.0457   (cum 0.9026)
   PC8: 0.0382   (cum 0.9408)
   PC9: 0.0255   (cum 0.9663)
  PC10: 0.0124   (cum 0.9787)
  PC11: 0.0076   (cum 0.9863)
  PC12: 0.0045   (cum 0.9907)
  PC13: 0.0035   (cum 0.9942)
  PC14: 0.0022   (cum 0.9964)
  PC15: 0.0020   (cum 0.9985)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_impulse_factor                 0.3124
  ppg_infra_dx_kurtosis                    0.3021
  ppg_infra_max                            0.2930
  ppg_infra_clearance_factor               0.2881
  ppg_infra_crest_factor                   0.2870
  ppg_infra_kurtosis                       0.2861
  ppg_infra_signal_energy                  0.2856
  ppg_infra_shape_factor                   0.2760

PC2
  ppg_infra_diff_mean_abs                  0.3743
  ppg_infra_p10                            0.3546
  ppg_infra_mad                            0.3379
  ppg_infra_ddx_std                        0.2817
  ppg_infra_kurtosis                       0.2687
  ppg_infra_impulse_factor                 0.2571
  ppg_infra_crest_factor                   0.2499
  ppg_infra_clearance_factor               0.2419

PC3
  ppg_infra_trim_mean_10                   0.6049
  ppg_infra_dx_mean                        0.3634
  ppg_infra_skew                           0.3053
  ppg_infra_mean                           0.2976
  ppg_infra_tke_std                        0.2863
  ppg_infra_ddx_std                        0.2720
  ppg_infra_median                         0.2384
  ppg_infra_p10                            0.1516

PC4
  ppg_infra_mad                            0.4554
  ppg_infra_dx_mean                        0.3821
  ppg_infra_signal_energy                  0.3258
  ppg_infra_max                            0.2989
  ppg_infra_ddx_kurtosis                   0.2859
  ppg_infra_mean                           0.2791
  ppg_infra_skew                           0.2411
  ppg_infra_zcr                            0.2262

PC5
  ppg_infra_median                         0.6134
  ppg_infra_mean                           0.5239
  ppg_infra_dx_mean                        0.2720
  ppg_infra_tke_std                        0.2497
  ppg_infra_zcr                            0.2196
  ppg_infra_ddx_std                        0.1862
  ppg_infra_mad                            0.1560
  ppg_infra_p10                            0.1551

PC6
  ppg_infra_zcr                            0.5572
  ppg_infra_skew                           0.5548
  ppg_infra_median                         0.4520
  ppg_infra_mean                           0.3081
  ppg_infra_dx_mean                        0.1313
  ppg_infra_trim_mean_10                   0.1090
  ppg_infra_ddx_kurtosis                   0.1061
  ppg_infra_p10                            0.1060

PC7
  ppg_infra_zcr                            0.7022
  ppg_infra_skew                           0.4640
  ppg_infra_mad                            0.2681
  ppg_infra_mean                           0.2340
  ppg_infra_dx_mean                        0.2273
  ppg_infra_p10                            0.1352
  ppg_infra_signal_energy                  0.1283
  ppg_infra_shape_factor                   0.1261

PC8
  ppg_infra_ddx_kurtosis                   0.5494
  ppg_infra_shape_factor                   0.4211
  ppg_infra_dx_kurtosis                    0.4162
  ppg_infra_clearance_factor               0.3417
  ppg_infra_impulse_factor                 0.2074
  ppg_infra_zcr                            0.2061
  ppg_infra_trim_mean_10                   0.1899
  ppg_infra_median                         0.1790

Saved to: data/feature_extraction/analysis/quality_ppg_infra_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_10.0s.csv
Shape: (300, 28)
Selected feature columns: 21
After NaN/variance filter: (300, 17)
After correlation pruning: (300, 16)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 11

Explained variance per PC (round 1):
   PC1: 0.3589   (cum 0.3589)
   PC2: 0.2797   (cum 0.6386)
   PC3: 0.0808   (cum 0.7194)
   PC4: 0.0620   (cum 0.7814)
   PC5: 0.0576   (cum 0.8390)
   PC6: 0.0537   (cum 0.8927)
   PC7: 0.0396   (cum 0.9323)
   PC8: 0.0261   (cum 0.9584)
   PC9: 0.0190   (cum 0.9775)
  PC10: 0.0091   (cum 0.9866)
  PC11: 0.0047   (cum 0.9913)
  PC12: 0.0037   (cum 0.9950)
  PC13: 0.0025   (cum 0.9975)
  PC14: 0.0024   (cum 0.9999)
  PC15: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_median                      0.3998
  ppg_infra_hr_min                         0.3993
  ppg_infra_hr_max                         0.3905
  ppg_infra_mean_ibi                       0.3893
  ppg_infra_n_peaks                        0.2770
  ppg_infra_hr_range                       0.2384
  ppg_infra_sdnn                           0.2304
  ppg_infra_rmssd                          0.2212

PC2
  ppg_infra_cv_ibi                         0.4509
  ppg_infra_hr_std                         0.3854
  ppg_infra_rmssd                          0.3715
  ppg_infra_sdnn                           0.3523
  ppg_infra_hr_range                       0.3356
  ppg_infra_sdsd                           0.3269
  ppg_infra_pnn50                          0.2719
  ppg_infra_hr_max                         0.1470

PC3
  ppg_infra_peak_quality                   0.6356
  ppg_infra_pnn20                          0.5252
  ppg_infra_pnn50                          0.3525
  ppg_infra_hf_power                       0.2979
  ppg_infra_hr_range                       0.2062
  ppg_infra_mean_ibi                       0.1166
  ppg_infra_hr_min                         0.1089
  ppg_infra_sdnn                           0.1089

PC4
  ppg_infra_total_power                    0.8653
  ppg_infra_hf_power                       0.2826
  ppg_infra_pnn20                          0.2048
  ppg_infra_peak_quality                   0.2027
  ppg_infra_pnn50                          0.1601
  ppg_infra_sdsd                           0.1450
  ppg_infra_hr_range                       0.1234
  ppg_infra_cv_ibi                         0.0861

PC5
  ppg_infra_hf_power                       0.7945
  ppg_infra_pnn20                          0.4662
  ppg_infra_sdnn                           0.1971
  ppg_infra_cv_ibi                         0.1477
  ppg_infra_peak_quality                   0.1447
  ppg_infra_pnn50                          0.1401
  ppg_infra_total_power                    0.1369
  ppg_infra_mean_ibi                       0.1013

PC6
  ppg_infra_peak_quality                   0.6493
  ppg_infra_total_power                    0.4230
  ppg_infra_pnn20                          0.3785
  ppg_infra_hf_power                       0.3679
  ppg_infra_pnn50                          0.2274
  ppg_infra_hr_range                       0.1542
  ppg_infra_sdnn                           0.1278
  ppg_infra_sdsd                           0.0960

PC7
  ppg_infra_n_peaks                        0.8068
  ppg_infra_pnn50                          0.4129
  ppg_infra_pnn20                          0.2281
  ppg_infra_sdsd                           0.1797
  ppg_infra_hr_std                         0.1498
  ppg_infra_cv_ibi                         0.1437
  ppg_infra_hr_range                       0.0974
  ppg_infra_hr_max                         0.0933

PC8
  ppg_infra_sdsd                           0.5243
  ppg_infra_n_peaks                        0.4205
  ppg_infra_pnn50                          0.3059
  ppg_infra_pnn20                          0.2793
  ppg_infra_sdnn                           0.2651
  ppg_infra_hr_min                         0.2476
  ppg_infra_cv_ibi                         0.2307
  ppg_infra_rmssd                          0.2143

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 16
Stage 2: selected features: 16 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 11

Explained variance per PC (round 2):
   PC1: 0.3589   (cum 0.3589)
   PC2: 0.2797   (cum 0.6386)
   PC3: 0.0808   (cum 0.7194)
   PC4: 0.0620   (cum 0.7814)
   PC5: 0.0576   (cum 0.8390)
   PC6: 0.0537   (cum 0.8927)
   PC7: 0.0396   (cum 0.9323)
   PC8: 0.0261   (cum 0.9584)
   PC9: 0.0190   (cum 0.9775)
  PC10: 0.0091   (cum 0.9866)
  PC11: 0.0047   (cum 0.9913)
  PC12: 0.0037   (cum 0.9950)
  PC13: 0.0025   (cum 0.9975)
  PC14: 0.0024   (cum 0.9999)
  PC15: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_median                      0.3998
  ppg_infra_hr_min                         0.3993
  ppg_infra_hr_max                         0.3905
  ppg_infra_mean_ibi                       0.3893
  ppg_infra_n_peaks                        0.2770
  ppg_infra_hr_range                       0.2384
  ppg_infra_sdnn                           0.2304
  ppg_infra_rmssd                          0.2212

PC2
  ppg_infra_cv_ibi                         0.4509
  ppg_infra_hr_std                         0.3854
  ppg_infra_rmssd                          0.3715
  ppg_infra_sdnn                           0.3523
  ppg_infra_hr_range                       0.3356
  ppg_infra_sdsd                           0.3269
  ppg_infra_pnn50                          0.2719
  ppg_infra_hr_max                         0.1470

PC3
  ppg_infra_peak_quality                   0.6356
  ppg_infra_pnn20                          0.5252
  ppg_infra_pnn50                          0.3525
  ppg_infra_hf_power                       0.2979
  ppg_infra_hr_range                       0.2062
  ppg_infra_mean_ibi                       0.1166
  ppg_infra_hr_min                         0.1089
  ppg_infra_sdnn                           0.1089

PC4
  ppg_infra_total_power                    0.8653
  ppg_infra_hf_power                       0.2826
  ppg_infra_pnn20                          0.2048
  ppg_infra_peak_quality                   0.2027
  ppg_infra_pnn50                          0.1601
  ppg_infra_sdsd                           0.1450
  ppg_infra_hr_range                       0.1234
  ppg_infra_cv_ibi                         0.0861

PC5
  ppg_infra_hf_power                       0.7945
  ppg_infra_pnn20                          0.4662
  ppg_infra_sdnn                           0.1971
  ppg_infra_cv_ibi                         0.1477
  ppg_infra_peak_quality                   0.1447
  ppg_infra_pnn50                          0.1401
  ppg_infra_total_power                    0.1369
  ppg_infra_mean_ibi                       0.1013

PC6
  ppg_infra_peak_quality                   0.6493
  ppg_infra_total_power                    0.4230
  ppg_infra_pnn20                          0.3785
  ppg_infra_hf_power                       0.3679
  ppg_infra_pnn50                          0.2274
  ppg_infra_hr_range                       0.1542
  ppg_infra_sdnn                           0.1278
  ppg_infra_sdsd                           0.0960

PC7
  ppg_infra_n_peaks                        0.8068
  ppg_infra_pnn50                          0.4129
  ppg_infra_pnn20                          0.2281
  ppg_infra_sdsd                           0.1797
  ppg_infra_hr_std                         0.1498
  ppg_infra_cv_ibi                         0.1437
  ppg_infra_hr_range                       0.0974
  ppg_infra_hr_max                         0.0933

PC8
  ppg_infra_sdsd                           0.5243
  ppg_infra_n_peaks                        0.4205
  ppg_infra_pnn50                          0.3059
  ppg_infra_pnn20                          0.2793
  ppg_infra_sdnn                           0.2651
  ppg_infra_hr_min                         0.2476
  ppg_infra_cv_ibi                         0.2307
  ppg_infra_rmssd                          0.2143

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_10.0s.csv | rows=300 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_10.0s.csv
Shape: (300, 51)
Selected feature columns: 44
After NaN/variance filter: (300, 44)
After correlation pruning: (300, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 1):
   PC1: 0.3729   (cum 0.3729)
   PC2: 0.2147   (cum 0.5876)
   PC3: 0.1186   (cum 0.7062)
   PC4: 0.0773   (cum 0.7835)
   PC5: 0.0528   (cum 0.8363)
   PC6: 0.0452   (cum 0.8815)
   PC7: 0.0391   (cum 0.9206)
   PC8: 0.0232   (cum 0.9438)
   PC9: 0.0163   (cum 0.9600)
  PC10: 0.0122   (cum 0.9723)
  PC11: 0.0070   (cum 0.9793)
  PC12: 0.0062   (cum 0.9855)
  PC13: 0.0050   (cum 0.9905)
  PC14: 0.0037   (cum 0.9942)
  PC15: 0.0021   (cum 0.9963)

Top PCA loadings per component (round 1):

PC1
  ppg_red_p99                              0.3236
  ppg_red_min                              0.3079
  ppg_red_signal_energy                    0.2862
  ppg_red_impulse_factor                   0.2725
  ppg_red_clearance_factor                 0.2602
  ppg_red_kurtosis                         0.2580
  ppg_red_dx_mean                          0.2490
  ppg_red_ddx_mean                         0.2470

PC2
  ppg_red_mad                              0.3812
  ppg_red_diff_mean_abs                    0.3432
  ppg_red_p90                              0.3288
  ppg_red_ddx_std                          0.3052
  ppg_red_shape_factor                     0.2829
  ppg_red_impulse_factor                   0.2647
  ppg_red_kurtosis                         0.2544
  ppg_red_clearance_factor                 0.2509

PC3
  ppg_red_ddx_mean                         0.4130
  ppg_red_dx_mean                          0.4082
  ppg_red_ddx_kurtosis                     0.3616
  ppg_red_signal_energy                    0.3405
  ppg_red_dx_kurtosis                      0.2855
  ppg_red_trim_mean_10                     0.2744
  ppg_red_ddx_std                          0.2598
  ppg_red_mad                              0.2010

PC4
  ppg_red_median                           0.5499
  ppg_red_mean                             0.4837
  ppg_red_trim_mean_10                     0.4271
  ppg_red_skew                             0.3078
  ppg_red_min                              0.2170
  ppg_red_signal_energy                    0.1605
  ppg_red_crest_factor                     0.1398
  ppg_red_p90                              0.1297

PC5
  ppg_red_skew                             0.7193
  ppg_red_mean                             0.4093
  ppg_red_ddx_kurtosis                     0.3019
  ppg_red_dx_kurtosis                      0.2985
  ppg_red_shape_factor                     0.2493
  ppg_red_clearance_factor                 0.1669
  ppg_red_impulse_factor                   0.1203
  ppg_red_min                              0.1095

PC6
  ppg_red_zcr                              0.8293
  ppg_red_crest_factor                     0.2343
  ppg_red_ddx_kurtosis                     0.2222
  ppg_red_skew                             0.2166
  ppg_red_dx_kurtosis                      0.2068
  ppg_red_impulse_factor                   0.1536
  ppg_red_kurtosis                         0.1531
  ppg_red_min                              0.1275

PC7
  ppg_red_dx_kurtosis                      0.4211
  ppg_red_zcr                              0.3773
  ppg_red_ddx_kurtosis                     0.3772
  ppg_red_skew                             0.3499
  ppg_red_shape_factor                     0.3152
  ppg_red_mean                             0.2712
  ppg_red_clearance_factor                 0.2663
  ppg_red_mad                              0.1934

PC8
  ppg_red_median                           0.7890
  ppg_red_mean                             0.4283
  ppg_red_trim_mean_10                     0.2292
  ppg_red_skew                             0.2229
  ppg_red_mad                              0.1724
  ppg_red_min                              0.1324
  ppg_red_ddx_std                          0.0938
  ppg_red_signal_energy                    0.0897

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 13

Explained variance per PC (round 2):
   PC1: 0.3729   (cum 0.3729)
   PC2: 0.2147   (cum 0.5876)
   PC3: 0.1186   (cum 0.7062)
   PC4: 0.0773   (cum 0.7835)
   PC5: 0.0528   (cum 0.8363)
   PC6: 0.0452   (cum 0.8815)
   PC7: 0.0391   (cum 0.9206)
   PC8: 0.0232   (cum 0.9438)
   PC9: 0.0163   (cum 0.9600)
  PC10: 0.0122   (cum 0.9723)
  PC11: 0.0070   (cum 0.9793)
  PC12: 0.0062   (cum 0.9855)
  PC13: 0.0050   (cum 0.9905)
  PC14: 0.0037   (cum 0.9942)
  PC15: 0.0021   (cum 0.9963)

Top PCA loadings per component (round 2):

PC1
  ppg_red_p99                              0.3236
  ppg_red_min                              0.3079
  ppg_red_signal_energy                    0.2862
  ppg_red_impulse_factor                   0.2725
  ppg_red_clearance_factor                 0.2602
  ppg_red_kurtosis                         0.2580
  ppg_red_dx_mean                          0.2490
  ppg_red_ddx_mean                         0.2470

PC2
  ppg_red_mad                              0.3812
  ppg_red_diff_mean_abs                    0.3432
  ppg_red_p90                              0.3288
  ppg_red_ddx_std                          0.3052
  ppg_red_shape_factor                     0.2829
  ppg_red_impulse_factor                   0.2647
  ppg_red_kurtosis                         0.2544
  ppg_red_clearance_factor                 0.2509

PC3
  ppg_red_ddx_mean                         0.4130
  ppg_red_dx_mean                          0.4082
  ppg_red_ddx_kurtosis                     0.3616
  ppg_red_signal_energy                    0.3405
  ppg_red_dx_kurtosis                      0.2855
  ppg_red_trim_mean_10                     0.2744
  ppg_red_ddx_std                          0.2598
  ppg_red_mad                              0.2010

PC4
  ppg_red_median                           0.5499
  ppg_red_mean                             0.4837
  ppg_red_trim_mean_10                     0.4271
  ppg_red_skew                             0.3078
  ppg_red_min                              0.2170
  ppg_red_signal_energy                    0.1605
  ppg_red_crest_factor                     0.1398
  ppg_red_p90                              0.1297

PC5
  ppg_red_skew                             0.7193
  ppg_red_mean                             0.4093
  ppg_red_ddx_kurtosis                     0.3019
  ppg_red_dx_kurtosis                      0.2985
  ppg_red_shape_factor                     0.2493
  ppg_red_clearance_factor                 0.1669
  ppg_red_impulse_factor                   0.1203
  ppg_red_min                              0.1095

PC6
  ppg_red_zcr                              0.8293
  ppg_red_crest_factor                     0.2343
  ppg_red_ddx_kurtosis                     0.2222
  ppg_red_skew                             0.2166
  ppg_red_dx_kurtosis                      0.2068
  ppg_red_impulse_factor                   0.1536
  ppg_red_kurtosis                         0.1531
  ppg_red_min                              0.1275

PC7
  ppg_red_dx_kurtosis                      0.4211
  ppg_red_zcr                              0.3773
  ppg_red_ddx_kurtosis                     0.3772
  ppg_red_skew                             0.3499
  ppg_red_shape_factor                     0.3152
  ppg_red_mean                             0.2712
  ppg_red_clearance_factor                 0.2663
  ppg_red_mad                              0.1934

PC8
  ppg_red_median                           0.7890
  ppg_red_mean                             0.4283
  ppg_red_trim_mean_10                     0.2292
  ppg_red_skew                             0.2229
  ppg_red_mad                              0.1724
  ppg_red_min                              0.1324
  ppg_red_ddx_std                          0.0938
  ppg_red_signal_energy                    0.0897

Saved to: data/feature_extraction/analysis/quality_ppg_red_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_10.0s.csv
Shape: (300, 28)
Selected feature columns: 21
After NaN/variance filter: (300, 15)
After correlation pruning: (300, 12)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.4045   (cum 0.4045)
   PC2: 0.3009   (cum 0.7055)
   PC3: 0.1009   (cum 0.8064)
   PC4: 0.0741   (cum 0.8805)
   PC5: 0.0444   (cum 0.9249)
   PC6: 0.0300   (cum 0.9549)
   PC7: 0.0278   (cum 0.9827)
   PC8: 0.0089   (cum 0.9916)
   PC9: 0.0037   (cum 0.9954)
  PC10: 0.0025   (cum 0.9978)
  PC11: 0.0020   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_rmssd                            0.4060
  ppg_red_sdnn                             0.3831
  ppg_red_sdsd                             0.3704
  ppg_red_mean_ibi                         0.3689
  ppg_red_hr_max                           0.3383
  ppg_red_pnn50                            0.3086
  ppg_red_n_peaks                          0.2941
  ppg_red_pnn20                            0.2310

PC2
  ppg_red_hr_std                           0.5056
  ppg_red_hr_range                         0.4643
  ppg_red_cv_ibi                           0.4438
  ppg_red_hr_max                           0.3295
  ppg_red_mean_ibi                         0.2438
  ppg_red_sdnn                             0.2091
  ppg_red_rmssd                            0.1866
  ppg_red_n_peaks                          0.1789

PC3
  ppg_red_peak_quality                     0.8010
  ppg_red_pnn20                            0.4110
  ppg_red_pnn50                            0.2328
  ppg_red_mean_ibi                         0.2063
  ppg_red_hr_range                         0.1652
  ppg_red_rmssd                            0.1232
  ppg_red_sdsd                             0.1231
  ppg_red_n_peaks                          0.1192

PC4
  ppg_red_pnn20                            0.6460
  ppg_red_peak_quality                     0.4129
  ppg_red_pnn50                            0.3835
  ppg_red_n_peaks                          0.3019
  ppg_red_cv_ibi                           0.2675
  ppg_red_sdnn                             0.2528
  ppg_red_hr_std                           0.1558
  ppg_red_hr_max                           0.0735

PC5
  ppg_red_n_peaks                          0.7385
  ppg_red_sdsd                             0.4178
  ppg_red_peak_quality                     0.3296
  ppg_red_pnn20                            0.2950
  ppg_red_rmssd                            0.1663
  ppg_red_cv_ibi                           0.1168
  ppg_red_hr_std                           0.1103
  ppg_red_hr_range                         0.1085

PC6
  ppg_red_sdsd                             0.6250
  ppg_red_pnn50                            0.5567
  ppg_red_n_peaks                          0.2456
  ppg_red_pnn20                            0.2411
  ppg_red_hr_max                           0.2023
  ppg_red_sdnn                             0.1927
  ppg_red_mean_ibi                         0.1786
  ppg_red_cv_ibi                           0.1702

PC7
  ppg_red_pnn50                            0.5828
  ppg_red_pnn20                            0.4540
  ppg_red_n_peaks                          0.3985
  ppg_red_sdnn                             0.3086
  ppg_red_sdsd                             0.2507
  ppg_red_mean_ibi                         0.2492
  ppg_red_cv_ibi                           0.1966
  ppg_red_hr_max                           0.1713

PC8
  ppg_red_hr_range                         0.7477
  ppg_red_mean_ibi                         0.5029
  ppg_red_peak_quality                     0.2513
  ppg_red_cv_ibi                           0.2495
  ppg_red_rmssd                            0.1666
  ppg_red_hr_std                           0.1414
  ppg_red_n_peaks                          0.0957
  ppg_red_pnn50                            0.0662

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 12
Stage 2: selected features: 12 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.4045   (cum 0.4045)
   PC2: 0.3009   (cum 0.7055)
   PC3: 0.1009   (cum 0.8064)
   PC4: 0.0741   (cum 0.8805)
   PC5: 0.0444   (cum 0.9249)
   PC6: 0.0300   (cum 0.9549)
   PC7: 0.0278   (cum 0.9827)
   PC8: 0.0089   (cum 0.9916)
   PC9: 0.0037   (cum 0.9954)
  PC10: 0.0025   (cum 0.9978)
  PC11: 0.0020   (cum 0.9999)
  PC12: 0.0001   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_rmssd                            0.4060
  ppg_red_sdnn                             0.3831
  ppg_red_sdsd                             0.3704
  ppg_red_mean_ibi                         0.3689
  ppg_red_hr_max                           0.3383
  ppg_red_pnn50                            0.3086
  ppg_red_n_peaks                          0.2941
  ppg_red_pnn20                            0.2310

PC2
  ppg_red_hr_std                           0.5056
  ppg_red_hr_range                         0.4643
  ppg_red_cv_ibi                           0.4438
  ppg_red_hr_max                           0.3295
  ppg_red_mean_ibi                         0.2438
  ppg_red_sdnn                             0.2091
  ppg_red_rmssd                            0.1866
  ppg_red_n_peaks                          0.1789

PC3
  ppg_red_peak_quality                     0.8010
  ppg_red_pnn20                            0.4110
  ppg_red_pnn50                            0.2328
  ppg_red_mean_ibi                         0.2063
  ppg_red_hr_range                         0.1652
  ppg_red_rmssd                            0.1232
  ppg_red_sdsd                             0.1231
  ppg_red_n_peaks                          0.1192

PC4
  ppg_red_pnn20                            0.6460
  ppg_red_peak_quality                     0.4129
  ppg_red_pnn50                            0.3835
  ppg_red_n_peaks                          0.3019
  ppg_red_cv_ibi                           0.2675
  ppg_red_sdnn                             0.2528
  ppg_red_hr_std                           0.1558
  ppg_red_hr_max                           0.0735

PC5
  ppg_red_n_peaks                          0.7385
  ppg_red_sdsd                             0.4178
  ppg_red_peak_quality                     0.3296
  ppg_red_pnn20                            0.2950
  ppg_red_rmssd                            0.1663
  ppg_red_cv_ibi                           0.1168
  ppg_red_hr_std                           0.1103
  ppg_red_hr_range                         0.1085

PC6
  ppg_red_sdsd                             0.6250
  ppg_red_pnn50                            0.5567
  ppg_red_n_peaks                          0.2456
  ppg_red_pnn20                            0.2411
  ppg_red_hr_max                           0.2023
  ppg_red_sdnn                             0.1927
  ppg_red_mean_ibi                         0.1786
  ppg_red_cv_ibi                           0.1702

PC7
  ppg_red_pnn50                            0.5828
  ppg_red_pnn20                            0.4540
  ppg_red_n_peaks                          0.3985
  ppg_red_sdnn                             0.3086
  ppg_red_sdsd                             0.2507
  ppg_red_mean_ibi                         0.2492
  ppg_red_cv_ibi                           0.1966
  ppg_red_hr_max                           0.1713

PC8
  ppg_red_hr_range                         0.7477
  ppg_red_mean_ibi                         0.5029
  ppg_red_peak_quality                     0.2513
  ppg_red_cv_ibi                           0.2495
  ppg_red_rmssd                            0.1666
  ppg_red_hr_std                           0.1414
  ppg_red_n_peaks                          0.0957
  ppg_red_pnn50                            0.0662

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_10.0s.csv | rows=213 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_10.0s.csv
Shape: (213, 33)
Selected feature columns: 26
After NaN/variance filter: (213, 26)
After correlation pruning: (213, 10)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.3375   (cum 0.3375)
   PC2: 0.1521   (cum 0.4896)
   PC3: 0.1294   (cum 0.6190)
   PC4: 0.0965   (cum 0.7155)
   PC5: 0.0830   (cum 0.7985)
   PC6: 0.0749   (cum 0.8734)
   PC7: 0.0670   (cum 0.9403)
   PC8: 0.0272   (cum 0.9676)
   PC9: 0.0168   (cum 0.9844)
  PC10: 0.0156   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mad                      0.4724
  eda_stress_skin_min                      0.4386
  eda_stress_skin_slope                    0.4338
  eda_cc_iqr                               0.4089
  eda_cc_slope                             0.3677
  eda_cc_min                               0.2694
  eda_cc_kurtosis                          0.1234
  eda_cc_skew                              0.0655

PC2
  eda_cc_kurtosis                          0.4956
  eda_cc_min                               0.4884
  eda_cc_skew                              0.4601
  eda_cc_iqr                               0.3401
  eda_stress_skin_min                      0.2698
  eda_cc_slope                             0.2071
  eda_stress_skin_mad                      0.1829
  eda_stress_skin_slope                    0.1808

PC3
  eda_stress_skin_kurtosis                 0.6660
  eda_stress_skin_skew                     0.5196
  eda_cc_skew                              0.3517
  eda_cc_min                               0.2022
  eda_cc_iqr                               0.1904
  eda_stress_skin_mad                      0.1776
  eda_stress_skin_min                      0.1738
  eda_cc_slope                             0.1351

PC4
  eda_stress_skin_skew                     0.6878
  eda_cc_kurtosis                          0.4338
  eda_stress_skin_kurtosis                 0.4026
  eda_cc_skew                              0.2465
  eda_cc_min                               0.1791
  eda_stress_skin_slope                    0.1748
  eda_cc_slope                             0.1551
  eda_stress_skin_min                      0.1096

PC5
  eda_cc_slope                             0.5623
  eda_cc_min                               0.4882
  eda_cc_skew                              0.4811
  eda_stress_skin_slope                    0.3421
  eda_stress_skin_skew                     0.2669
  eda_cc_kurtosis                          0.0918
  eda_cc_iqr                               0.0851
  eda_stress_skin_mad                      0.0804

PC6
  eda_cc_kurtosis                          0.7065
  eda_stress_skin_skew                     0.4131
  eda_cc_skew                              0.3292
  eda_cc_min                               0.2601
  eda_stress_skin_kurtosis                 0.2336
  eda_cc_iqr                               0.1810
  eda_cc_slope                             0.1773
  eda_stress_skin_mad                      0.1462

PC7
  eda_stress_skin_kurtosis                 0.5642
  eda_cc_skew                              0.5041
  eda_cc_iqr                               0.3847
  eda_cc_slope                             0.3760
  eda_stress_skin_slope                    0.2287
  eda_stress_skin_min                      0.2166
  eda_stress_skin_mad                      0.1399
  eda_cc_min                               0.0997

PC8
  eda_stress_skin_slope                    0.6815
  eda_stress_skin_min                      0.6264
  eda_cc_min                               0.2358
  eda_cc_slope                             0.2151
  eda_cc_kurtosis                          0.1203
  eda_stress_skin_mad                      0.1155
  eda_stress_skin_skew                     0.0866
  eda_cc_skew                              0.0747

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.3375   (cum 0.3375)
   PC2: 0.1521   (cum 0.4896)
   PC3: 0.1294   (cum 0.6190)
   PC4: 0.0965   (cum 0.7155)
   PC5: 0.0830   (cum 0.7985)
   PC6: 0.0749   (cum 0.8734)
   PC7: 0.0670   (cum 0.9403)
   PC8: 0.0272   (cum 0.9676)
   PC9: 0.0168   (cum 0.9844)
  PC10: 0.0156   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mad                      0.4724
  eda_stress_skin_min                      0.4386
  eda_stress_skin_slope                    0.4338
  eda_cc_iqr                               0.4089
  eda_cc_slope                             0.3677
  eda_cc_min                               0.2694
  eda_cc_kurtosis                          0.1234
  eda_cc_skew                              0.0655

PC2
  eda_cc_kurtosis                          0.4956
  eda_cc_min                               0.4884
  eda_cc_skew                              0.4601
  eda_cc_iqr                               0.3401
  eda_stress_skin_min                      0.2698
  eda_cc_slope                             0.2071
  eda_stress_skin_mad                      0.1829
  eda_stress_skin_slope                    0.1808

PC3
  eda_stress_skin_kurtosis                 0.6660
  eda_stress_skin_skew                     0.5196
  eda_cc_skew                              0.3517
  eda_cc_min                               0.2022
  eda_cc_iqr                               0.1904
  eda_stress_skin_mad                      0.1776
  eda_stress_skin_min                      0.1738
  eda_cc_slope                             0.1351

PC4
  eda_stress_skin_skew                     0.6878
  eda_cc_kurtosis                          0.4338
  eda_stress_skin_kurtosis                 0.4026
  eda_cc_skew                              0.2465
  eda_cc_min                               0.1791
  eda_stress_skin_slope                    0.1748
  eda_cc_slope                             0.1551
  eda_stress_skin_min                      0.1096

PC5
  eda_cc_slope                             0.5623
  eda_cc_min                               0.4882
  eda_cc_skew                              0.4811
  eda_stress_skin_slope                    0.3421
  eda_stress_skin_skew                     0.2669
  eda_cc_kurtosis                          0.0918
  eda_cc_iqr                               0.0851
  eda_stress_skin_mad                      0.0804

PC6
  eda_cc_kurtosis                          0.7065
  eda_stress_skin_skew                     0.4131
  eda_cc_skew                              0.3292
  eda_cc_min                               0.2601
  eda_stress_skin_kurtosis                 0.2336
  eda_cc_iqr                               0.1810
  eda_cc_slope                             0.1773
  eda_stress_skin_mad                      0.1462

PC7
  eda_stress_skin_kurtosis                 0.5642
  eda_cc_skew                              0.5041
  eda_cc_iqr                               0.3847
  eda_cc_slope                             0.3760
  eda_stress_skin_slope                    0.2287
  eda_stress_skin_min                      0.2166
  eda_stress_skin_mad                      0.1399
  eda_cc_min                               0.0997

PC8
  eda_stress_skin_slope                    0.6815
  eda_stress_skin_min                      0.6264
  eda_cc_min                               0.2358
  eda_cc_slope                             0.2151
  eda_cc_kurtosis                          0.1203
  eda_stress_skin_mad                      0.1155
  eda_stress_skin_skew                     0.0866
  eda_cc_skew                              0.0747

Saved to: data/feature_extraction/analysis/quality_eda_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_10.0s.csv
Shape: (213, 28)
Selected feature columns: 21
After NaN/variance filter: (213, 15)
After correlation pruning: (213, 5)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.7085   (cum 0.7085)
   PC2: 0.2346   (cum 0.9431)
   PC3: 0.0402   (cum 0.9833)
   PC4: 0.0159   (cum 0.9992)
   PC5: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5292
  eda_scl_slope                            0.4928
  eda_scr_count                            0.4745
  eda_phasic_energy                        0.4679
  eda_scl_min                              0.1817

PC2
  eda_scl_min                              0.8449
  eda_phasic_energy                        0.3322
  eda_scr_count                            0.3042
  eda_scl_slope                            0.2850
  eda_scr_amp_sum                          0.0455

PC3
  eda_phasic_energy                        0.6477
  eda_scr_count                            0.5960
  eda_scl_min                              0.4608
  eda_scr_amp_sum                          0.1132
  eda_scl_slope                            0.0071

PC4
  eda_scl_slope                            0.7433
  eda_scr_count                            0.5286
  eda_phasic_energy                        0.3558
  eda_scl_min                              0.2018
  eda_scr_amp_sum                          0.0271

PC5
  eda_scr_amp_sum                          0.8393
  eda_phasic_energy                        0.3529
  eda_scl_slope                            0.3512
  eda_scr_count                            0.2182
  eda_scl_min                              0.0131

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.7085   (cum 0.7085)
   PC2: 0.2346   (cum 0.9431)
   PC3: 0.0402   (cum 0.9833)
   PC4: 0.0159   (cum 0.9992)
   PC5: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5292
  eda_scl_slope                            0.4928
  eda_scr_count                            0.4745
  eda_phasic_energy                        0.4679
  eda_scl_min                              0.1817

PC2
  eda_scl_min                              0.8449
  eda_phasic_energy                        0.3322
  eda_scr_count                            0.3042
  eda_scl_slope                            0.2850
  eda_scr_amp_sum                          0.0455

PC3
  eda_phasic_energy                        0.6477
  eda_scr_count                            0.5960
  eda_scl_min                              0.4608
  eda_scr_amp_sum                          0.1132
  eda_scl_slope                            0.0071

PC4
  eda_scl_slope                            0.7433
  eda_scr_count                            0.5286
  eda_phasic_energy                        0.3558
  eda_scl_min                              0.2018
  eda_scr_amp_sum                          0.0271

PC5
  eda_scr_amp_sum                          0.8393
  eda_phasic_energy                        0.3529
  eda_scl_slope                            0.3512
  eda_scr_count                            0.2182
  eda_scl_min                              0.0131

Saved to: data/feature_extraction/analysis/quality_eda_advanced_10.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_features_5.0s.csv
Shape: (445, 39)
Selected feature columns: 30
After NaN/variance filter: (445, 29)
After correlation pruning: (445, 29)

PCA summary (round 1):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 23

Explained variance per PC (round 1):
   PC1: 0.4370   (cum 0.4370)
   PC2: 0.1973   (cum 0.6343)
   PC3: 0.0586   (cum 0.6929)
   PC4: 0.0518   (cum 0.7447)
   PC5: 0.0427   (cum 0.7873)
   PC6: 0.0406   (cum 0.8279)
   PC7: 0.0245   (cum 0.8524)
   PC8: 0.0198   (cum 0.8722)
   PC9: 0.0171   (cum 0.8893)
  PC10: 0.0142   (cum 0.9035)
  PC11: 0.0127   (cum 0.9161)
  PC12: 0.0121   (cum 0.9282)
  PC13: 0.0096   (cum 0.9378)
  PC14: 0.0090   (cum 0.9468)
  PC15: 0.0085   (cum 0.9553)

Top PCA loadings per component (round 1):

PC1
  acc_y_dyn__avg_amplitude_change          0.2476
  acc_z_dyn__sum_of_absolute_changes       0.2449
  acc_x_dyn__quantile_0.9                  0.2431
  acc_x_dyn__quantile_0.3                  0.2423
  acc_x_dyn__quantile_0.4                  0.2218
  acc_x_dyn__quantile_0.6                  0.2211
  acc_z_dyn__harmonic_mean_of_abs          0.2180
  acc_y_dyn__quantile_0.3                  0.2169

PC2
  acc_y_dyn__sample_entropy                0.3463
  acc_x_dyn__sample_entropy                0.3272
  acc_z_dyn__sample_entropy                0.3249
  acc_y_dyn__katz_fractal_dimension        0.2892
  acc_z_dyn__katz_fractal_dimension        0.2820
  acc_x_dyn__approximate_entropy_0.9       0.2814
  acc_x_dyn__katz_fractal_dimension        0.2743
  acc_z_dyn__approximate_entropy_0.1       0.2337

PC3
  acc_y_dyn__quantile_0.4                  0.4730
  acc_y_dyn__quantile_0.3                  0.4193
  acc_y_dyn__harmonic_mean_of_abs          0.3964
  acc_x_dyn__variance_of_absolute_differences 0.3175
  acc_y_dyn__avg_amplitude_change          0.1918
  acc_y_dyn__tsallis_entropy               0.1916
  acc_x_dyn__max                           0.1821
  acc_z_dyn__quantile_0.6                  0.1818

PC4
  acc_z_dyn__approximate_entropy_0.1       0.3690
  acc_x_dyn__approximate_entropy_0.1       0.3591
  acc_x_dyn__harmonic_mean_of_abs          0.2996
  acc_z_dyn__variance_of_absolute_differences 0.2817
  acc_x_dyn__quantile_0.4                  0.2540
  acc_z_dyn__sum_of_absolute_changes       0.2201
  acc_x_dyn__quantile_0.3                  0.2151
  acc_x_dyn__approximate_entropy_0.9       0.2130

PC5
  acc_z_dyn__lower_complete_moment         0.3787
  acc_x_dyn__approximate_entropy_0.1       0.3656
  acc_z_dyn__approximate_entropy_0.1       0.3263
  acc_z_dyn__quantile_0.6                  0.2658
  acc_z_dyn__katz_fractal_dimension        0.2537
  acc_z_dyn__harmonic_mean_of_abs          0.2498
  acc_x_dyn__quantile_0.4                  0.2254
  acc_x_dyn__cardinality                   0.2041

PC6
  acc_y_dyn__tsallis_entropy               0.6870
  acc_x_dyn__cardinality                   0.5362
  acc_z_dyn__quantile_0.6                  0.2007
  acc_y_dyn__variance_of_absolute_differences 0.1850
  acc_y_dyn__sample_entropy                0.1601
  acc_x_dyn__approximate_entropy_0.9       0.1569
  acc_z_dyn__lower_complete_moment         0.1409
  acc_x_dyn__max                           0.1268

PC7
  acc_z_dyn__quantile_0.6                  0.6495
  acc_z_dyn__quantile_0.4                  0.5111
  acc_z_dyn__lower_complete_moment         0.2589
  acc_z_dyn__harmonic_mean_of_abs          0.2442
  acc_x_dyn__variance_of_absolute_differences 0.1883
  acc_y_dyn__quantile_0.4                  0.1805
  acc_y_dyn__tsallis_entropy               0.1354
  acc_z_dyn__approximate_entropy_0.1       0.1182

PC8
  acc_z_dyn__variance_of_absolute_differences 0.4462
  acc_z_dyn__harmonic_mean_of_abs          0.3522
  acc_y_dyn__variance_of_absolute_differences 0.3288
  acc_z_dyn__quantile_0.4                  0.2622
  acc_x_dyn__approximate_entropy_0.1       0.2569
  acc_x_dyn__approximate_entropy_0.9       0.2561
  acc_z_dyn__sample_entropy                0.2461
  acc_x_dyn__katz_fractal_dimension        0.2359

Stage 2: PCs used to reach 90%: 10
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 10
  pcs_for_95pct: 15
  pcs_for_99pct: 23

Explained variance per PC (round 2):
   PC1: 0.4370   (cum 0.4370)
   PC2: 0.1973   (cum 0.6343)
   PC3: 0.0586   (cum 0.6929)
   PC4: 0.0518   (cum 0.7447)
   PC5: 0.0427   (cum 0.7873)
   PC6: 0.0406   (cum 0.8279)
   PC7: 0.0245   (cum 0.8524)
   PC8: 0.0198   (cum 0.8722)
   PC9: 0.0171   (cum 0.8893)
  PC10: 0.0142   (cum 0.9035)
  PC11: 0.0127   (cum 0.9161)
  PC12: 0.0121   (cum 0.9282)
  PC13: 0.0096   (cum 0.9378)
  PC14: 0.0090   (cum 0.9468)
  PC15: 0.0085   (cum 0.9553)

Top PCA loadings per component (round 2):

PC1
  acc_y_dyn__avg_amplitude_change          0.2476
  acc_z_dyn__sum_of_absolute_changes       0.2449
  acc_x_dyn__quantile_0.9                  0.2431
  acc_x_dyn__quantile_0.3                  0.2423
  acc_x_dyn__quantile_0.4                  0.2218
  acc_x_dyn__quantile_0.6                  0.2211
  acc_z_dyn__harmonic_mean_of_abs          0.2180
  acc_y_dyn__quantile_0.3                  0.2169

PC2
  acc_y_dyn__sample_entropy                0.3463
  acc_x_dyn__sample_entropy                0.3272
  acc_z_dyn__sample_entropy                0.3249
  acc_y_dyn__katz_fractal_dimension        0.2892
  acc_z_dyn__katz_fractal_dimension        0.2820
  acc_x_dyn__approximate_entropy_0.9       0.2814
  acc_x_dyn__katz_fractal_dimension        0.2743
  acc_z_dyn__approximate_entropy_0.1       0.2337

PC3
  acc_y_dyn__quantile_0.4                  0.4730
  acc_y_dyn__quantile_0.3                  0.4193
  acc_y_dyn__harmonic_mean_of_abs          0.3964
  acc_x_dyn__variance_of_absolute_differences 0.3175
  acc_y_dyn__avg_amplitude_change          0.1918
  acc_y_dyn__tsallis_entropy               0.1916
  acc_x_dyn__max                           0.1821
  acc_z_dyn__quantile_0.6                  0.1818

PC4
  acc_z_dyn__approximate_entropy_0.1       0.3690
  acc_x_dyn__approximate_entropy_0.1       0.3591
  acc_x_dyn__harmonic_mean_of_abs          0.2996
  acc_z_dyn__variance_of_absolute_differences 0.2817
  acc_x_dyn__quantile_0.4                  0.2540
  acc_z_dyn__sum_of_absolute_changes       0.2201
  acc_x_dyn__quantile_0.3                  0.2151
  acc_x_dyn__approximate_entropy_0.9       0.2130

PC5
  acc_z_dyn__lower_complete_moment         0.3787
  acc_x_dyn__approximate_entropy_0.1       0.3656
  acc_z_dyn__approximate_entropy_0.1       0.3263
  acc_z_dyn__quantile_0.6                  0.2658
  acc_z_dyn__katz_fractal_dimension        0.2537
  acc_z_dyn__harmonic_mean_of_abs          0.2498
  acc_x_dyn__quantile_0.4                  0.2254
  acc_x_dyn__cardinality                   0.2041

PC6
  acc_y_dyn__tsallis_entropy               0.6870
  acc_x_dyn__cardinality                   0.5362
  acc_z_dyn__quantile_0.6                  0.2007
  acc_y_dyn__variance_of_absolute_differences 0.1850
  acc_y_dyn__sample_entropy                0.1601
  acc_x_dyn__approximate_entropy_0.9       0.1569
  acc_z_dyn__lower_complete_moment         0.1409
  acc_x_dyn__max                           0.1268

PC7
  acc_z_dyn__quantile_0.6                  0.6495
  acc_z_dyn__quantile_0.4                  0.5111
  acc_z_dyn__lower_complete_moment         0.2589
  acc_z_dyn__harmonic_mean_of_abs          0.2442
  acc_x_dyn__variance_of_absolute_differences 0.1883
  acc_y_dyn__quantile_0.4                  0.1805
  acc_y_dyn__tsallis_entropy               0.1354
  acc_z_dyn__approximate_entropy_0.1       0.1182

PC8
  acc_z_dyn__variance_of_absolute_differences 0.4462
  acc_z_dyn__harmonic_mean_of_abs          0.3522
  acc_y_dyn__variance_of_absolute_differences 0.3288
  acc_z_dyn__quantile_0.4                  0.2622
  acc_x_dyn__approximate_entropy_0.1       0.2569
  acc_x_dyn__approximate_entropy_0.9       0.2561
  acc_z_dyn__sample_entropy                0.2461
  acc_x_dyn__katz_fractal_dimension        0.2359

Saved to: data/feature_extraction/analysis/quality_imu_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_5.0s.csv | rows=600 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_5.0s.csv
Shape: (600, 51)
Selected feature columns: 44
After NaN/variance filter: (600, 43)
After correlation pruning: (600, 18)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.3598   (cum 0.3598)
   PC2: 0.1638   (cum 0.5236)
   PC3: 0.1125   (cum 0.6361)
   PC4: 0.0742   (cum 0.7103)
   PC5: 0.0663   (cum 0.7766)
   PC6: 0.0588   (cum 0.8354)
   PC7: 0.0527   (cum 0.8881)
   PC8: 0.0371   (cum 0.9252)
   PC9: 0.0298   (cum 0.9550)
  PC10: 0.0207   (cum 0.9757)
  PC11: 0.0112   (cum 0.9869)
  PC12: 0.0062   (cum 0.9931)
  PC13: 0.0024   (cum 0.9955)
  PC14: 0.0019   (cum 0.9974)
  PC15: 0.0012   (cum 0.9986)

Top PCA loadings per component (round 1):

PC1
  ppg_green_clearance_factor               0.3600
  ppg_green_diff_mean_abs                  0.3461
  ppg_green_shape_factor                   0.3338
  ppg_green_p90_p10                        0.3170
  ppg_green_iqr                            0.3108
  ppg_green_diff_std                       0.3087
  ppg_green_mad                            0.2983
  ppg_green_tke_p95_abs                    0.2887

PC2
  ppg_green_median                         0.3728
  ppg_green_tke_std                        0.3657
  ppg_green_min                            0.3114
  ppg_green_kurtosis                       0.2877
  ppg_green_dx_kurtosis                    0.2846
  ppg_green_mad                            0.2632
  ppg_green_p90_p10                        0.2525
  ppg_green_tke_p95_abs                    0.2515

PC3
  ppg_green_min                            0.4851
  ppg_green_mean_cross_rate                0.4413
  ppg_green_median                         0.4193
  ppg_green_kurtosis                       0.3118
  ppg_green_iqr                            0.2708
  ppg_green_mad                            0.2429
  ppg_green_p90_p10                        0.2152
  ppg_green_diff_std                       0.1565

PC4
  ppg_green_ddx_kurtosis                   0.4147
  ppg_green_mean_cross_rate                0.4106
  ppg_green_tke_std                        0.4028
  ppg_green_min                            0.2879
  ppg_green_diff_std                       0.2605
  ppg_green_tke_p95_abs                    0.2533
  ppg_green_median                         0.2492
  ppg_green_shape_factor                   0.2408

PC5
  ppg_green_skew                           0.6009
  ppg_green_ddx_mean                       0.4502
  ppg_green_dx_kurtosis                    0.4086
  ppg_green_ddx_kurtosis                   0.3901
  ppg_green_mean_cross_rate                0.2105
  ppg_green_clearance_factor               0.1407
  ppg_green_tke_p95_abs                    0.1301
  ppg_green_diff_mean                      0.1297

PC6
  ppg_green_diff_mean                      0.6347
  ppg_green_ddx_mean                       0.5546
  ppg_green_ddx_kurtosis                   0.2591
  ppg_green_min                            0.2341
  ppg_green_median                         0.1947
  ppg_green_mean_cross_rate                0.1945
  ppg_green_tke_p95_abs                    0.1593
  ppg_green_diff_mean_abs                  0.1533

PC7
  ppg_green_diff_mean                      0.7512
  ppg_green_ddx_mean                       0.4188
  ppg_green_mean_cross_rate                0.2446
  ppg_green_ddx_kurtosis                   0.2429
  ppg_green_dx_kurtosis                    0.2003
  ppg_green_min                            0.1593
  ppg_green_median                         0.1474
  ppg_green_diff_mean_abs                  0.1345

PC8
  ppg_green_skew                           0.6186
  ppg_green_ddx_mean                       0.5224
  ppg_green_mean_cross_rate                0.3066
  ppg_green_kurtosis                       0.2176
  ppg_green_diff_mean_abs                  0.2112
  ppg_green_min                            0.2083
  ppg_green_diff_std                       0.1762
  ppg_green_tke_p95_abs                    0.1364

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 18
Stage 2: selected features: 18 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.3598   (cum 0.3598)
   PC2: 0.1638   (cum 0.5236)
   PC3: 0.1125   (cum 0.6361)
   PC4: 0.0742   (cum 0.7103)
   PC5: 0.0663   (cum 0.7766)
   PC6: 0.0588   (cum 0.8354)
   PC7: 0.0527   (cum 0.8881)
   PC8: 0.0371   (cum 0.9252)
   PC9: 0.0298   (cum 0.9550)
  PC10: 0.0207   (cum 0.9757)
  PC11: 0.0112   (cum 0.9869)
  PC12: 0.0062   (cum 0.9931)
  PC13: 0.0024   (cum 0.9955)
  PC14: 0.0019   (cum 0.9974)
  PC15: 0.0012   (cum 0.9986)

Top PCA loadings per component (round 2):

PC1
  ppg_green_clearance_factor               0.3600
  ppg_green_diff_mean_abs                  0.3461
  ppg_green_shape_factor                   0.3338
  ppg_green_p90_p10                        0.3170
  ppg_green_iqr                            0.3108
  ppg_green_diff_std                       0.3087
  ppg_green_mad                            0.2983
  ppg_green_tke_p95_abs                    0.2887

PC2
  ppg_green_median                         0.3728
  ppg_green_tke_std                        0.3657
  ppg_green_min                            0.3114
  ppg_green_kurtosis                       0.2877
  ppg_green_dx_kurtosis                    0.2846
  ppg_green_mad                            0.2632
  ppg_green_p90_p10                        0.2525
  ppg_green_tke_p95_abs                    0.2515

PC3
  ppg_green_min                            0.4851
  ppg_green_mean_cross_rate                0.4413
  ppg_green_median                         0.4193
  ppg_green_kurtosis                       0.3118
  ppg_green_iqr                            0.2708
  ppg_green_mad                            0.2429
  ppg_green_p90_p10                        0.2152
  ppg_green_diff_std                       0.1565

PC4
  ppg_green_ddx_kurtosis                   0.4147
  ppg_green_mean_cross_rate                0.4106
  ppg_green_tke_std                        0.4028
  ppg_green_min                            0.2879
  ppg_green_diff_std                       0.2605
  ppg_green_tke_p95_abs                    0.2533
  ppg_green_median                         0.2492
  ppg_green_shape_factor                   0.2408

PC5
  ppg_green_skew                           0.6009
  ppg_green_ddx_mean                       0.4502
  ppg_green_dx_kurtosis                    0.4086
  ppg_green_ddx_kurtosis                   0.3901
  ppg_green_mean_cross_rate                0.2105
  ppg_green_clearance_factor               0.1407
  ppg_green_tke_p95_abs                    0.1301
  ppg_green_diff_mean                      0.1297

PC6
  ppg_green_diff_mean                      0.6347
  ppg_green_ddx_mean                       0.5546
  ppg_green_ddx_kurtosis                   0.2591
  ppg_green_min                            0.2341
  ppg_green_median                         0.1947
  ppg_green_mean_cross_rate                0.1945
  ppg_green_tke_p95_abs                    0.1593
  ppg_green_diff_mean_abs                  0.1533

PC7
  ppg_green_diff_mean                      0.7512
  ppg_green_ddx_mean                       0.4188
  ppg_green_mean_cross_rate                0.2446
  ppg_green_ddx_kurtosis                   0.2429
  ppg_green_dx_kurtosis                    0.2003
  ppg_green_min                            0.1593
  ppg_green_median                         0.1474
  ppg_green_diff_mean_abs                  0.1345

PC8
  ppg_green_skew                           0.6186
  ppg_green_ddx_mean                       0.5224
  ppg_green_mean_cross_rate                0.3066
  ppg_green_kurtosis                       0.2176
  ppg_green_diff_mean_abs                  0.2112
  ppg_green_min                            0.2083
  ppg_green_diff_std                       0.1762
  ppg_green_tke_p95_abs                    0.1364

Saved to: data/feature_extraction/analysis/quality_ppg_green_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_5.0s.csv
Shape: (600, 28)
Selected feature columns: 18
After NaN/variance filter: (600, 2)
After correlation pruning: (600, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8530   (cum 0.8530)
   PC2: 0.1470   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8530   (cum 0.8530)
   PC2: 0.1470   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

PC2
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_5.0s.csv | rows=600 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_5.0s.csv
Shape: (600, 51)
Selected feature columns: 44
After NaN/variance filter: (600, 44)
After correlation pruning: (600, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 1):
   PC1: 0.3798   (cum 0.3798)
   PC2: 0.1761   (cum 0.5559)
   PC3: 0.1295   (cum 0.6854)
   PC4: 0.0724   (cum 0.7578)
   PC5: 0.0571   (cum 0.8150)
   PC6: 0.0534   (cum 0.8684)
   PC7: 0.0441   (cum 0.9125)
   PC8: 0.0329   (cum 0.9454)
   PC9: 0.0210   (cum 0.9664)
  PC10: 0.0114   (cum 0.9779)
  PC11: 0.0084   (cum 0.9862)
  PC12: 0.0042   (cum 0.9904)
  PC13: 0.0034   (cum 0.9938)
  PC14: 0.0022   (cum 0.9960)
  PC15: 0.0017   (cum 0.9977)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_diff_std                       0.3291
  ppg_infra_max                            0.3235
  ppg_infra_signal_energy                  0.3134
  ppg_infra_diff_mean_abs                  0.2972
  ppg_infra_ddx_std                        0.2838
  ppg_infra_p10                            0.2832
  ppg_infra_tke_std                        0.2713
  ppg_infra_trim_mean_10                   0.2259

PC2
  ppg_infra_impulse_factor                 0.4097
  ppg_infra_kurtosis                       0.4021
  ppg_infra_crest_factor                   0.3918
  ppg_infra_shape_factor                   0.3681
  ppg_infra_dx_kurtosis                    0.2970
  ppg_infra_ddx_kurtosis                   0.2960
  ppg_infra_diff_mean_abs                  0.1654
  ppg_infra_signal_energy                  0.1614

PC3
  ppg_infra_trim_mean_10                   0.4070
  ppg_infra_mean                           0.3773
  ppg_infra_ddx_mean                       0.3704
  ppg_infra_dx_mean                        0.3221
  ppg_infra_median                         0.3056
  ppg_infra_mad                            0.2911
  ppg_infra_tke_std                        0.2770
  ppg_infra_ddx_std                        0.2496

PC4
  ppg_infra_dx_mean                        0.4172
  ppg_infra_mad                            0.3973
  ppg_infra_ddx_mean                       0.3918
  ppg_infra_mean                           0.3091
  ppg_infra_diff_mean_abs                  0.2907
  ppg_infra_ddx_kurtosis                   0.2498
  ppg_infra_ddx_std                        0.2158
  ppg_infra_max                            0.1909

PC5
  ppg_infra_skew                           0.7410
  ppg_infra_median                         0.4213
  ppg_infra_zcr                            0.2992
  ppg_infra_mean                           0.2180
  ppg_infra_dx_kurtosis                    0.1603
  ppg_infra_ddx_kurtosis                   0.1398
  ppg_infra_ddx_mean                       0.1396
  ppg_infra_p10                            0.1354

PC6
  ppg_infra_zcr                            0.7299
  ppg_infra_median                         0.4407
  ppg_infra_mean                           0.2671
  ppg_infra_tke_std                        0.2041
  ppg_infra_mad                            0.2032
  ppg_infra_crest_factor                   0.1470
  ppg_infra_diff_mean_abs                  0.1388
  ppg_infra_signal_energy                  0.1204

PC7
  ppg_infra_mean                           0.4869
  ppg_infra_ddx_kurtosis                   0.4012
  ppg_infra_zcr                            0.3576
  ppg_infra_skew                           0.3493
  ppg_infra_mad                            0.3007
  ppg_infra_dx_kurtosis                    0.2258
  ppg_infra_tke_std                        0.2243
  ppg_infra_shape_factor                   0.2172

PC8
  ppg_infra_zcr                            0.4126
  ppg_infra_median                         0.4124
  ppg_infra_ddx_kurtosis                   0.3977
  ppg_infra_dx_kurtosis                    0.3694
  ppg_infra_shape_factor                   0.3555
  ppg_infra_mad                            0.2519
  ppg_infra_impulse_factor                 0.1847
  ppg_infra_skew                           0.1706

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 12

Explained variance per PC (round 2):
   PC1: 0.3798   (cum 0.3798)
   PC2: 0.1761   (cum 0.5559)
   PC3: 0.1295   (cum 0.6854)
   PC4: 0.0724   (cum 0.7578)
   PC5: 0.0571   (cum 0.8150)
   PC6: 0.0534   (cum 0.8684)
   PC7: 0.0441   (cum 0.9125)
   PC8: 0.0329   (cum 0.9454)
   PC9: 0.0210   (cum 0.9664)
  PC10: 0.0114   (cum 0.9779)
  PC11: 0.0084   (cum 0.9862)
  PC12: 0.0042   (cum 0.9904)
  PC13: 0.0034   (cum 0.9938)
  PC14: 0.0022   (cum 0.9960)
  PC15: 0.0017   (cum 0.9977)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_diff_std                       0.3291
  ppg_infra_max                            0.3235
  ppg_infra_signal_energy                  0.3134
  ppg_infra_diff_mean_abs                  0.2972
  ppg_infra_ddx_std                        0.2838
  ppg_infra_p10                            0.2832
  ppg_infra_tke_std                        0.2713
  ppg_infra_trim_mean_10                   0.2259

PC2
  ppg_infra_impulse_factor                 0.4097
  ppg_infra_kurtosis                       0.4021
  ppg_infra_crest_factor                   0.3918
  ppg_infra_shape_factor                   0.3681
  ppg_infra_dx_kurtosis                    0.2970
  ppg_infra_ddx_kurtosis                   0.2960
  ppg_infra_diff_mean_abs                  0.1654
  ppg_infra_signal_energy                  0.1614

PC3
  ppg_infra_trim_mean_10                   0.4070
  ppg_infra_mean                           0.3773
  ppg_infra_ddx_mean                       0.3704
  ppg_infra_dx_mean                        0.3221
  ppg_infra_median                         0.3056
  ppg_infra_mad                            0.2911
  ppg_infra_tke_std                        0.2770
  ppg_infra_ddx_std                        0.2496

PC4
  ppg_infra_dx_mean                        0.4172
  ppg_infra_mad                            0.3973
  ppg_infra_ddx_mean                       0.3918
  ppg_infra_mean                           0.3091
  ppg_infra_diff_mean_abs                  0.2907
  ppg_infra_ddx_kurtosis                   0.2498
  ppg_infra_ddx_std                        0.2158
  ppg_infra_max                            0.1909

PC5
  ppg_infra_skew                           0.7410
  ppg_infra_median                         0.4213
  ppg_infra_zcr                            0.2992
  ppg_infra_mean                           0.2180
  ppg_infra_dx_kurtosis                    0.1603
  ppg_infra_ddx_kurtosis                   0.1398
  ppg_infra_ddx_mean                       0.1396
  ppg_infra_p10                            0.1354

PC6
  ppg_infra_zcr                            0.7299
  ppg_infra_median                         0.4407
  ppg_infra_mean                           0.2671
  ppg_infra_tke_std                        0.2041
  ppg_infra_mad                            0.2032
  ppg_infra_crest_factor                   0.1470
  ppg_infra_diff_mean_abs                  0.1388
  ppg_infra_signal_energy                  0.1204

PC7
  ppg_infra_mean                           0.4869
  ppg_infra_ddx_kurtosis                   0.4012
  ppg_infra_zcr                            0.3576
  ppg_infra_skew                           0.3493
  ppg_infra_mad                            0.3007
  ppg_infra_dx_kurtosis                    0.2258
  ppg_infra_tke_std                        0.2243
  ppg_infra_shape_factor                   0.2172

PC8
  ppg_infra_zcr                            0.4126
  ppg_infra_median                         0.4124
  ppg_infra_ddx_kurtosis                   0.3977
  ppg_infra_dx_kurtosis                    0.3694
  ppg_infra_shape_factor                   0.3555
  ppg_infra_mad                            0.2519
  ppg_infra_impulse_factor                 0.1847
  ppg_infra_skew                           0.1706

Saved to: data/feature_extraction/analysis/quality_ppg_infra_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE

=== Processing dataset: elderly_sim_elderly5 ===
▶ imu_bioz: preprocessing
  Loaded /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_bioz/imu_preprocessed.csv
  Windowing imu_bioz...
    ✓ Created 200 windows (10.0s)
  Extracting features for imu_bioz...
    ✓ Features 10.0s: 200 windows, 38 features
    ✓ Features 5.0s: 401 windows, 38 features
    ✓ Features 2.0s: 996 windows, 38 features
▶ imu_wrist: preprocessing
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_preprocessed.csv
  Windowing imu_wrist...
    ✓ Created 222 windows (10.0s)
  Extracting features for imu_wrist...
    ✓ Features 10.0s: 222 windows, 38 features
    ✓ Features 5.0s: 445 windows, 38 features
    ✓ Features 2.0s: 1106 windows, 38 features
▶ ppg_green: preprocessing
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_preprocessed.csv | rows=86464 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_preprocessed.csv
▶ ppg_infra: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_preprocessed.csv | rows=86464 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_preprocessed.csv
▶ ppg_red: preprocessing
  ✓ Applied Butterworth HPF (0.5 Hz) to enhance signal
✓ PPG preprocessed → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_preprocessed.csv | rows=86464 | fs=32.0 | HPF=0.5Hz
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_preprocessed.csv
▶ RR: preprocessing
✓ RR preprocessed → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/rr/rr_preprocessed.csv | rows=22134 | irregular sampling (no resample)
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/rr/rr_preprocessed.csv
▶ EDA: preprocessing
✓ EDA preprocessed → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_preprocessed.csv | rows=61441 | fs=32.0
  Saved /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_preprocessed.csv

▶ Window length: 10.0s | overlap=0.1
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 222
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_aligned_10.0s.csv (222 windows | borg labeled: 130)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_10.0s.csv | windows=300 | features=21
    ✓ HRV features: 300 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_aligned_10.0s.csv (300 windows | borg labeled: 133)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_aligned_10.0s.csv (300 windows | borg labeled: 133)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_10.0s.csv | windows=300 | features=21
    ✓ HRV features: 300 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_aligned_10.0s.csv (300 windows | borg labeled: 133)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_aligned_10.0s.csv (300 windows | borg labeled: 133)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_10.0s.csv | windows=300 | features=21
    ✓ HRV features: 300 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_aligned_10.0s.csv (300 windows | borg labeled: 133)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 300
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_aligned_10.0s.csv (300 windows | borg labeled: 133)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_10.0s.csv | windows=213 | features=21
    ✓ Advanced EDA features: 213 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 213
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_aligned_10.0s.csv (213 windows | borg labeled: 136)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 213
  Windows in ADL time range: 168
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_aligned_10.0s.csv (213 windows | borg labeled: 136)

▶ Window length: 5.0s | overlap=0.1
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 445
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_aligned_5.0s.csv (445 windows | borg labeled: 269)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_5.0s.csv | windows=600 | features=21
    ✓ HRV features: 600 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_aligned_5.0s.csv (600 windows | borg labeled: 265)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_aligned_5.0s.csv (600 windows | borg labeled: 265)
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_5.0s.csv
Shape: (600, 28)
Selected feature columns: 18
After NaN/variance filter: (600, 14)
After correlation pruning: (600, 11)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.3822   (cum 0.3822)
   PC2: 0.3226   (cum 0.7049)
   PC3: 0.1041   (cum 0.8089)
   PC4: 0.0717   (cum 0.8806)
   PC5: 0.0500   (cum 0.9306)
   PC6: 0.0354   (cum 0.9659)
   PC7: 0.0206   (cum 0.9865)
   PC8: 0.0076   (cum 0.9941)
   PC9: 0.0049   (cum 0.9990)
  PC10: 0.0010   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_hr_max                         0.4793
  ppg_infra_mean_ibi                       0.4541
  ppg_infra_hr_min                         0.4316
  ppg_infra_n_peaks                        0.3388
  ppg_infra_hr_range                       0.3342
  ppg_infra_hr_std                         0.3027
  ppg_infra_rmssd                          0.1314
  ppg_infra_pnn50                          0.1198

PC2
  ppg_infra_cv_ibi                         0.4971
  ppg_infra_rmssd                          0.4579
  ppg_infra_hr_std                         0.3978
  ppg_infra_pnn50                          0.3871
  ppg_infra_hr_range                       0.3365
  ppg_infra_pnn20                          0.2683
  ppg_infra_hr_min                         0.1880
  ppg_infra_n_peaks                        0.0881

PC3
  ppg_infra_peak_quality                   0.8124
  ppg_infra_pnn20                          0.4551
  ppg_infra_pnn50                          0.2272
  ppg_infra_hr_range                       0.1856
  ppg_infra_mean_ibi                       0.1371
  ppg_infra_hr_min                         0.1038
  ppg_infra_rmssd                          0.0982
  ppg_infra_cv_ibi                         0.0707

PC4
  ppg_infra_pnn20                          0.6477
  ppg_infra_peak_quality                   0.5067
  ppg_infra_pnn50                          0.3175
  ppg_infra_n_peaks                        0.2606
  ppg_infra_cv_ibi                         0.2573
  ppg_infra_rmssd                          0.2285
  ppg_infra_hr_std                         0.1491
  ppg_infra_mean_ibi                       0.0776

PC5
  ppg_infra_n_peaks                        0.8725
  ppg_infra_pnn20                          0.2136
  ppg_infra_rmssd                          0.1946
  ppg_infra_mean_ibi                       0.1869
  ppg_infra_pnn50                          0.1838
  ppg_infra_hr_max                         0.1580
  ppg_infra_peak_quality                   0.1411
  ppg_infra_hr_min                         0.1348

PC6
  ppg_infra_pnn50                          0.8023
  ppg_infra_pnn20                          0.4842
  ppg_infra_n_peaks                        0.2010
  ppg_infra_mean_ibi                       0.1547
  ppg_infra_rmssd                          0.1323
  ppg_infra_cv_ibi                         0.1292
  ppg_infra_hr_min                         0.1073
  ppg_infra_hr_range                       0.0599

PC7
  ppg_infra_rmssd                          0.6390
  ppg_infra_hr_range                       0.4966
  ppg_infra_hr_min                         0.4712
  ppg_infra_hr_std                         0.1967
  ppg_infra_peak_quality                   0.1684
  ppg_infra_mean_ibi                       0.1631
  ppg_infra_hr_max                         0.1309
  ppg_infra_pnn20                          0.0762

PC8
  ppg_infra_mean_ibi                       0.7207
  ppg_infra_hr_max                         0.3786
  ppg_infra_hr_min                         0.3154
  ppg_infra_cv_ibi                         0.3098
  ppg_infra_hr_range                       0.3055
  ppg_infra_rmssd                          0.1406
  ppg_infra_peak_quality                   0.1213
  ppg_infra_hr_std                         0.0895

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.3822   (cum 0.3822)
   PC2: 0.3226   (cum 0.7049)
   PC3: 0.1041   (cum 0.8089)
   PC4: 0.0717   (cum 0.8806)
   PC5: 0.0500   (cum 0.9306)
   PC6: 0.0354   (cum 0.9659)
   PC7: 0.0206   (cum 0.9865)
   PC8: 0.0076   (cum 0.9941)
   PC9: 0.0049   (cum 0.9990)
  PC10: 0.0010   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_hr_max                         0.4793
  ppg_infra_mean_ibi                       0.4541
  ppg_infra_hr_min                         0.4316
  ppg_infra_n_peaks                        0.3388
  ppg_infra_hr_range                       0.3342
  ppg_infra_hr_std                         0.3027
  ppg_infra_rmssd                          0.1314
  ppg_infra_pnn50                          0.1198

PC2
  ppg_infra_cv_ibi                         0.4971
  ppg_infra_rmssd                          0.4579
  ppg_infra_hr_std                         0.3978
  ppg_infra_pnn50                          0.3871
  ppg_infra_hr_range                       0.3365
  ppg_infra_pnn20                          0.2683
  ppg_infra_hr_min                         0.1880
  ppg_infra_n_peaks                        0.0881

PC3
  ppg_infra_peak_quality                   0.8124
  ppg_infra_pnn20                          0.4551
  ppg_infra_pnn50                          0.2272
  ppg_infra_hr_range                       0.1856
  ppg_infra_mean_ibi                       0.1371
  ppg_infra_hr_min                         0.1038
  ppg_infra_rmssd                          0.0982
  ppg_infra_cv_ibi                         0.0707

PC4
  ppg_infra_pnn20                          0.6477
  ppg_infra_peak_quality                   0.5067
  ppg_infra_pnn50                          0.3175
  ppg_infra_n_peaks                        0.2606
  ppg_infra_cv_ibi                         0.2573
  ppg_infra_rmssd                          0.2285
  ppg_infra_hr_std                         0.1491
  ppg_infra_mean_ibi                       0.0776

PC5
  ppg_infra_n_peaks                        0.8725
  ppg_infra_pnn20                          0.2136
  ppg_infra_rmssd                          0.1946
  ppg_infra_mean_ibi                       0.1869
  ppg_infra_pnn50                          0.1838
  ppg_infra_hr_max                         0.1580
  ppg_infra_peak_quality                   0.1411
  ppg_infra_hr_min                         0.1348

PC6
  ppg_infra_pnn50                          0.8023
  ppg_infra_pnn20                          0.4842
  ppg_infra_n_peaks                        0.2010
  ppg_infra_mean_ibi                       0.1547
  ppg_infra_rmssd                          0.1323
  ppg_infra_cv_ibi                         0.1292
  ppg_infra_hr_min                         0.1073
  ppg_infra_hr_range                       0.0599

PC7
  ppg_infra_rmssd                          0.6390
  ppg_infra_hr_range                       0.4966
  ppg_infra_hr_min                         0.4712
  ppg_infra_hr_std                         0.1967
  ppg_infra_peak_quality                   0.1684
  ppg_infra_mean_ibi                       0.1631
  ppg_infra_hr_max                         0.1309
  ppg_infra_pnn20                          0.0762

PC8
  ppg_infra_mean_ibi                       0.7207
  ppg_infra_hr_max                         0.3786
  ppg_infra_hr_min                         0.3154
  ppg_infra_cv_ibi                         0.3098
  ppg_infra_hr_range                       0.3055
  ppg_infra_rmssd                          0.1406
  ppg_infra_peak_quality                   0.1213
  ppg_infra_hr_std                         0.0895

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_5.0s.csv | rows=600 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_5.0s.csv
Shape: (600, 51)
Selected feature columns: 44
After NaN/variance filter: (600, 44)
After correlation pruning: (600, 20)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.3321   (cum 0.3321)
   PC2: 0.1677   (cum 0.4998)
   PC3: 0.1322   (cum 0.6319)
   PC4: 0.1077   (cum 0.7396)
   PC5: 0.0838   (cum 0.8234)
   PC6: 0.0528   (cum 0.8762)
   PC7: 0.0366   (cum 0.9128)
   PC8: 0.0251   (cum 0.9379)
   PC9: 0.0158   (cum 0.9537)
  PC10: 0.0127   (cum 0.9663)
  PC11: 0.0089   (cum 0.9753)
  PC12: 0.0065   (cum 0.9818)
  PC13: 0.0046   (cum 0.9863)
  PC14: 0.0041   (cum 0.9905)
  PC15: 0.0038   (cum 0.9942)

Top PCA loadings per component (round 1):

PC1
  ppg_red_min                              0.3577
  ppg_red_p10                              0.3484
  ppg_red_tke_std                          0.3245
  ppg_red_signal_energy                    0.3189
  ppg_red_diff_mean_abs                    0.3082
  ppg_red_diff_mean                        0.2884
  ppg_red_ddx_mean                         0.2861
  ppg_red_mad                              0.2735

PC2
  ppg_red_kurtosis                         0.4175
  ppg_red_shape_factor                     0.4054
  ppg_red_crest_factor                     0.3646
  ppg_red_dx_kurtosis                      0.3373
  ppg_red_ddx_kurtosis                     0.2864
  ppg_red_mad                              0.2523
  ppg_red_diff_mean_abs                    0.2166
  ppg_red_trim_mean_10                     0.1915

PC3
  ppg_red_trim_mean_10                     0.3259
  ppg_red_signal_energy                    0.3150
  ppg_red_diff_mean                        0.3055
  ppg_red_ddx_std                          0.2783
  ppg_red_tke_std                          0.2751
  ppg_red_ddx_mean                         0.2690
  ppg_red_ddx_kurtosis                     0.2537
  ppg_red_zcr                              0.2458

PC4
  ppg_red_mean                             0.4528
  ppg_red_trim_mean_10                     0.4324
  ppg_red_zcr                              0.4139
  ppg_red_mean_cross_rate                  0.4116
  ppg_red_median                           0.4109
  ppg_red_ddx_std                          0.1739
  ppg_red_ddx_mean                         0.1400
  ppg_red_diff_mean_abs                    0.1392

PC5
  ppg_red_zcr                              0.4226
  ppg_red_mean_cross_rate                  0.4139
  ppg_red_ddx_kurtosis                     0.2732
  ppg_red_skew                             0.2687
  ppg_red_ddx_mean                         0.2559
  ppg_red_diff_mean                        0.2340
  ppg_red_mad                              0.2287
  ppg_red_ddx_std                          0.2144

PC6
  ppg_red_skew                             0.8100
  ppg_red_mean                             0.4555
  ppg_red_mean_cross_rate                  0.1592
  ppg_red_mad                              0.1536
  ppg_red_zcr                              0.1520
  ppg_red_shape_factor                     0.1069
  ppg_red_dx_kurtosis                      0.1048
  ppg_red_diff_mean_abs                    0.0918

PC7
  ppg_red_dx_kurtosis                      0.5244
  ppg_red_ddx_kurtosis                     0.4868
  ppg_red_shape_factor                     0.4376
  ppg_red_kurtosis                         0.2338
  ppg_red_mean_cross_rate                  0.1861
  ppg_red_ddx_mean                         0.1778
  ppg_red_crest_factor                     0.1769
  ppg_red_diff_mean                        0.1687

PC8
  ppg_red_median                           0.6931
  ppg_red_trim_mean_10                     0.3921
  ppg_red_tke_std                          0.2783
  ppg_red_p10                              0.2457
  ppg_red_mad                              0.2306
  ppg_red_min                              0.2181
  ppg_red_ddx_mean                         0.2080
  ppg_red_diff_mean                        0.1813

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 20
Stage 2: selected features: 20 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.3321   (cum 0.3321)
   PC2: 0.1677   (cum 0.4998)
   PC3: 0.1322   (cum 0.6319)
   PC4: 0.1077   (cum 0.7396)
   PC5: 0.0838   (cum 0.8234)
   PC6: 0.0528   (cum 0.8762)
   PC7: 0.0366   (cum 0.9128)
   PC8: 0.0251   (cum 0.9379)
   PC9: 0.0158   (cum 0.9537)
  PC10: 0.0127   (cum 0.9663)
  PC11: 0.0089   (cum 0.9753)
  PC12: 0.0065   (cum 0.9818)
  PC13: 0.0046   (cum 0.9863)
  PC14: 0.0041   (cum 0.9905)
  PC15: 0.0038   (cum 0.9942)

Top PCA loadings per component (round 2):

PC1
  ppg_red_min                              0.3577
  ppg_red_p10                              0.3484
  ppg_red_tke_std                          0.3245
  ppg_red_signal_energy                    0.3189
  ppg_red_diff_mean_abs                    0.3082
  ppg_red_diff_mean                        0.2884
  ppg_red_ddx_mean                         0.2861
  ppg_red_mad                              0.2735

PC2
  ppg_red_kurtosis                         0.4175
  ppg_red_shape_factor                     0.4054
  ppg_red_crest_factor                     0.3646
  ppg_red_dx_kurtosis                      0.3373
  ppg_red_ddx_kurtosis                     0.2864
  ppg_red_mad                              0.2523
  ppg_red_diff_mean_abs                    0.2166
  ppg_red_trim_mean_10                     0.1915

PC3
  ppg_red_trim_mean_10                     0.3259
  ppg_red_signal_energy                    0.3150
  ppg_red_diff_mean                        0.3055
  ppg_red_ddx_std                          0.2783
  ppg_red_tke_std                          0.2751
  ppg_red_ddx_mean                         0.2690
  ppg_red_ddx_kurtosis                     0.2537
  ppg_red_zcr                              0.2458

PC4
  ppg_red_mean                             0.4528
  ppg_red_trim_mean_10                     0.4324
  ppg_red_zcr                              0.4139
  ppg_red_mean_cross_rate                  0.4116
  ppg_red_median                           0.4109
  ppg_red_ddx_std                          0.1739
  ppg_red_ddx_mean                         0.1400
  ppg_red_diff_mean_abs                    0.1392

PC5
  ppg_red_zcr                              0.4226
  ppg_red_mean_cross_rate                  0.4139
  ppg_red_ddx_kurtosis                     0.2732
  ppg_red_skew                             0.2687
  ppg_red_ddx_mean                         0.2559
  ppg_red_diff_mean                        0.2340
  ppg_red_mad                              0.2287
  ppg_red_ddx_std                          0.2144

PC6
  ppg_red_skew                             0.8100
  ppg_red_mean                             0.4555
  ppg_red_mean_cross_rate                  0.1592
  ppg_red_mad                              0.1536
  ppg_red_zcr                              0.1520
  ppg_red_shape_factor                     0.1069
  ppg_red_dx_kurtosis                      0.1048
  ppg_red_diff_mean_abs                    0.0918

PC7
  ppg_red_dx_kurtosis                      0.5244
  ppg_red_ddx_kurtosis                     0.4868
  ppg_red_shape_factor                     0.4376
  ppg_red_kurtosis                         0.2338
  ppg_red_mean_cross_rate                  0.1861
  ppg_red_ddx_mean                         0.1778
  ppg_red_crest_factor                     0.1769
  ppg_red_diff_mean                        0.1687

PC8
  ppg_red_median                           0.6931
  ppg_red_trim_mean_10                     0.3921
  ppg_red_tke_std                          0.2783
  ppg_red_p10                              0.2457
  ppg_red_mad                              0.2306
  ppg_red_min                              0.2181
  ppg_red_ddx_mean                         0.2080
  ppg_red_diff_mean                        0.1813

Saved to: data/feature_extraction/analysis/quality_ppg_red_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_5.0s.csv
Shape: (600, 28)
Selected feature columns: 18
After NaN/variance filter: (600, 14)
After correlation pruning: (600, 11)

PCA summary (round 1):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 1):
   PC1: 0.3950   (cum 0.3950)
   PC2: 0.3203   (cum 0.7154)
   PC3: 0.1039   (cum 0.8193)
   PC4: 0.0754   (cum 0.8947)
   PC5: 0.0445   (cum 0.9393)
   PC6: 0.0321   (cum 0.9713)
   PC7: 0.0159   (cum 0.9872)
   PC8: 0.0074   (cum 0.9946)
   PC9: 0.0044   (cum 0.9990)
  PC10: 0.0009   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_hr_max                           0.4721
  ppg_red_mean_ibi                         0.4518
  ppg_red_hr_min                           0.4326
  ppg_red_n_peaks                          0.3475
  ppg_red_hr_range                         0.3454
  ppg_red_hr_std                           0.2949
  ppg_red_rmssd                            0.1578
  ppg_red_pnn50                            0.1443

PC2
  ppg_red_cv_ibi                           0.4979
  ppg_red_rmssd                            0.4631
  ppg_red_hr_std                           0.3980
  ppg_red_pnn50                            0.3976
  ppg_red_hr_range                         0.3216
  ppg_red_pnn20                            0.2896
  ppg_red_hr_min                           0.1619
  ppg_red_mean_ibi                         0.0685

PC3
  ppg_red_peak_quality                     0.8601
  ppg_red_pnn20                            0.3491
  ppg_red_n_peaks                          0.1875
  ppg_red_hr_range                         0.1628
  ppg_red_mean_ibi                         0.1578
  ppg_red_pnn50                            0.1485
  ppg_red_hr_min                           0.1321
  ppg_red_rmssd                            0.1062

PC4
  ppg_red_pnn20                            0.7332
  ppg_red_peak_quality                     0.3419
  ppg_red_pnn50                            0.3077
  ppg_red_cv_ibi                           0.3042
  ppg_red_n_peaks                          0.2603
  ppg_red_hr_std                           0.2125
  ppg_red_rmssd                            0.1865
  ppg_red_hr_min                           0.0702

PC5
  ppg_red_n_peaks                          0.8659
  ppg_red_peak_quality                     0.3013
  ppg_red_mean_ibi                         0.2019
  ppg_red_hr_min                           0.1813
  ppg_red_pnn20                            0.1531
  ppg_red_hr_max                           0.1524
  ppg_red_rmssd                            0.1387
  ppg_red_pnn50                            0.0988

PC6
  ppg_red_pnn50                            0.8311
  ppg_red_pnn20                            0.4684
  ppg_red_cv_ibi                           0.1479
  ppg_red_hr_min                           0.1417
  ppg_red_rmssd                            0.1219
  ppg_red_mean_ibi                         0.0990
  ppg_red_n_peaks                          0.0861
  ppg_red_hr_max                           0.0781

PC7
  ppg_red_rmssd                            0.6020
  ppg_red_hr_range                         0.5840
  ppg_red_hr_min                           0.4697
  ppg_red_hr_max                           0.1386
  ppg_red_hr_std                           0.1312
  ppg_red_peak_quality                     0.1241
  ppg_red_mean_ibi                         0.1031
  ppg_red_cv_ibi                           0.0893

PC8
  ppg_red_mean_ibi                         0.5104
  ppg_red_hr_range                         0.4682
  ppg_red_cv_ibi                           0.3739
  ppg_red_rmssd                            0.3366
  ppg_red_hr_max                           0.3228
  ppg_red_hr_std                           0.2539
  ppg_red_hr_min                           0.2273
  ppg_red_peak_quality                     0.1746

Stage 2: PCs used to reach 90%: 5
Stage 2: ranking pool size: 11
Stage 2: selected features: 11 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 5
  pcs_for_95pct: 6
  pcs_for_99pct: 8

Explained variance per PC (round 2):
   PC1: 0.3950   (cum 0.3950)
   PC2: 0.3203   (cum 0.7154)
   PC3: 0.1039   (cum 0.8193)
   PC4: 0.0754   (cum 0.8947)
   PC5: 0.0445   (cum 0.9393)
   PC6: 0.0321   (cum 0.9713)
   PC7: 0.0159   (cum 0.9872)
   PC8: 0.0074   (cum 0.9946)
   PC9: 0.0044   (cum 0.9990)
  PC10: 0.0009   (cum 1.0000)
  PC11: 0.0000   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_hr_max                           0.4721
  ppg_red_mean_ibi                         0.4518
  ppg_red_hr_min                           0.4326
  ppg_red_n_peaks                          0.3475
  ppg_red_hr_range                         0.3454
  ppg_red_hr_std                           0.2949
  ppg_red_rmssd                            0.1578
  ppg_red_pnn50                            0.1443

PC2
  ppg_red_cv_ibi                           0.4979
  ppg_red_rmssd                            0.4631
  ppg_red_hr_std                           0.3980
  ppg_red_pnn50                            0.3976
  ppg_red_hr_range                         0.3216
  ppg_red_pnn20                            0.2896
  ppg_red_hr_min                           0.1619
  ppg_red_mean_ibi                         0.0685

PC3
  ppg_red_peak_quality                     0.8601
  ppg_red_pnn20                            0.3491
  ppg_red_n_peaks                          0.1875
  ppg_red_hr_range                         0.1628
  ppg_red_mean_ibi                         0.1578
  ppg_red_pnn50                            0.1485
  ppg_red_hr_min                           0.1321
  ppg_red_rmssd                            0.1062

PC4
  ppg_red_pnn20                            0.7332
  ppg_red_peak_quality                     0.3419
  ppg_red_pnn50                            0.3077
  ppg_red_cv_ibi                           0.3042
  ppg_red_n_peaks                          0.2603
  ppg_red_hr_std                           0.2125
  ppg_red_rmssd                            0.1865
  ppg_red_hr_min                           0.0702

PC5
  ppg_red_n_peaks                          0.8659
  ppg_red_peak_quality                     0.3013
  ppg_red_mean_ibi                         0.2019
  ppg_red_hr_min                           0.1813
  ppg_red_pnn20                            0.1531
  ppg_red_hr_max                           0.1524
  ppg_red_rmssd                            0.1387
  ppg_red_pnn50                            0.0988

PC6
  ppg_red_pnn50                            0.8311
  ppg_red_pnn20                            0.4684
  ppg_red_cv_ibi                           0.1479
  ppg_red_hr_min                           0.1417
  ppg_red_rmssd                            0.1219
  ppg_red_mean_ibi                         0.0990
  ppg_red_n_peaks                          0.0861
  ppg_red_hr_max                           0.0781

PC7
  ppg_red_rmssd                            0.6020
  ppg_red_hr_range                         0.5840
  ppg_red_hr_min                           0.4697
  ppg_red_hr_max                           0.1386
  ppg_red_hr_std                           0.1312
  ppg_red_peak_quality                     0.1241
  ppg_red_mean_ibi                         0.1031
  ppg_red_cv_ibi                           0.0893

PC8
  ppg_red_mean_ibi                         0.5104
  ppg_red_hr_range                         0.4682
  ppg_red_cv_ibi                           0.3739
  ppg_red_rmssd                            0.3366
  ppg_red_hr_max                           0.3228
  ppg_red_hr_std                           0.2539
  ppg_red_hr_min                           0.2273
  ppg_red_peak_quality                     0.1746

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_5.0s.csv | rows=426 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_5.0s.csv
Shape: (426, 33)
Selected feature columns: 26
After NaN/variance filter: (426, 26)
After correlation pruning: (426, 10)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.3377   (cum 0.3377)
   PC2: 0.1538   (cum 0.4915)
   PC3: 0.1351   (cum 0.6266)
   PC4: 0.0935   (cum 0.7201)
   PC5: 0.0816   (cum 0.8018)
   PC6: 0.0793   (cum 0.8811)
   PC7: 0.0584   (cum 0.9395)
   PC8: 0.0280   (cum 0.9675)
   PC9: 0.0167   (cum 0.9841)
  PC10: 0.0159   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mean_abs_diff            0.4779
  eda_stress_skin_min                      0.4430
  eda_stress_skin_slope                    0.4364
  eda_cc_mean_abs_diff                     0.4047
  eda_cc_slope                             0.3684
  eda_cc_min                               0.2653
  eda_cc_kurtosis                          0.1154
  eda_cc_skew                              0.0274

PC2
  eda_stress_skin_kurtosis                 0.5021
  eda_cc_skew                              0.4722
  eda_stress_skin_skew                     0.4515
  eda_cc_min                               0.3430
  eda_cc_kurtosis                          0.2573
  eda_cc_mean_abs_diff                     0.2253
  eda_stress_skin_min                      0.2072
  eda_stress_skin_mean_abs_diff            0.1278

PC3
  eda_stress_skin_kurtosis                 0.4658
  eda_cc_kurtosis                          0.4569
  eda_cc_min                               0.4528
  eda_stress_skin_skew                     0.3636
  eda_cc_mean_abs_diff                     0.3357
  eda_stress_skin_min                      0.2125
  eda_stress_skin_mean_abs_diff            0.1701
  eda_cc_slope                             0.1532

PC4
  eda_cc_skew                              0.6795
  eda_stress_skin_skew                     0.5183
  eda_cc_kurtosis                          0.4161
  eda_cc_slope                             0.1802
  eda_cc_min                               0.1740
  eda_stress_skin_slope                    0.1605
  eda_cc_mean_abs_diff                     0.0731
  eda_stress_skin_kurtosis                 0.0407

PC5
  eda_cc_kurtosis                          0.5059
  eda_cc_min                               0.5034
  eda_cc_skew                              0.3680
  eda_cc_slope                             0.3668
  eda_stress_skin_skew                     0.3184
  eda_stress_skin_slope                    0.2891
  eda_stress_skin_min                      0.1568
  eda_stress_skin_kurtosis                 0.0936

PC6
  eda_cc_slope                             0.6061
  eda_cc_kurtosis                          0.4873
  eda_cc_mean_abs_diff                     0.3991
  eda_stress_skin_slope                    0.3115
  eda_stress_skin_mean_abs_diff            0.2480
  eda_stress_skin_min                      0.1975
  eda_stress_skin_kurtosis                 0.1569
  eda_stress_skin_skew                     0.0950

PC7
  eda_stress_skin_kurtosis                 0.7029
  eda_stress_skin_skew                     0.5313
  eda_cc_skew                              0.4048
  eda_cc_min                               0.1522
  eda_cc_mean_abs_diff                     0.0973
  eda_stress_skin_min                      0.0919
  eda_cc_kurtosis                          0.0769
  eda_stress_skin_mean_abs_diff            0.0760

PC8
  eda_stress_skin_slope                    0.6706
  eda_stress_skin_min                      0.6441
  eda_cc_slope                             0.2327
  eda_cc_min                               0.2255
  eda_cc_kurtosis                          0.1379
  eda_stress_skin_mean_abs_diff            0.0933
  eda_cc_skew                              0.0423
  eda_stress_skin_skew                     0.0261

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.3377   (cum 0.3377)
   PC2: 0.1538   (cum 0.4915)
   PC3: 0.1351   (cum 0.6266)
   PC4: 0.0935   (cum 0.7201)
   PC5: 0.0816   (cum 0.8018)
   PC6: 0.0793   (cum 0.8811)
   PC7: 0.0584   (cum 0.9395)
   PC8: 0.0280   (cum 0.9675)
   PC9: 0.0167   (cum 0.9841)
  PC10: 0.0159   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mean_abs_diff            0.4779
  eda_stress_skin_min                      0.4430
  eda_stress_skin_slope                    0.4364
  eda_cc_mean_abs_diff                     0.4047
  eda_cc_slope                             0.3684
  eda_cc_min                               0.2653
  eda_cc_kurtosis                          0.1154
  eda_cc_skew                              0.0274

PC2
  eda_stress_skin_kurtosis                 0.5021
  eda_cc_skew                              0.4722
  eda_stress_skin_skew                     0.4515
  eda_cc_min                               0.3430
  eda_cc_kurtosis                          0.2573
  eda_cc_mean_abs_diff                     0.2253
  eda_stress_skin_min                      0.2072
  eda_stress_skin_mean_abs_diff            0.1278

PC3
  eda_stress_skin_kurtosis                 0.4658
  eda_cc_kurtosis                          0.4569
  eda_cc_min                               0.4528
  eda_stress_skin_skew                     0.3636
  eda_cc_mean_abs_diff                     0.3357
  eda_stress_skin_min                      0.2125
  eda_stress_skin_mean_abs_diff            0.1701
  eda_cc_slope                             0.1532

PC4
  eda_cc_skew                              0.6795
  eda_stress_skin_skew                     0.5183
  eda_cc_kurtosis                          0.4161
  eda_cc_slope                             0.1802
  eda_cc_min                               0.1740
  eda_stress_skin_slope                    0.1605
  eda_cc_mean_abs_diff                     0.0731
  eda_stress_skin_kurtosis                 0.0407

PC5
  eda_cc_kurtosis                          0.5059
  eda_cc_min                               0.5034
  eda_cc_skew                              0.3680
  eda_cc_slope                             0.3668
  eda_stress_skin_skew                     0.3184
  eda_stress_skin_slope                    0.2891
  eda_stress_skin_min                      0.1568
  eda_stress_skin_kurtosis                 0.0936

PC6
  eda_cc_slope                             0.6061
  eda_cc_kurtosis                          0.4873
  eda_cc_mean_abs_diff                     0.3991
  eda_stress_skin_slope                    0.3115
  eda_stress_skin_mean_abs_diff            0.2480
  eda_stress_skin_min                      0.1975
  eda_stress_skin_kurtosis                 0.1569
  eda_stress_skin_skew                     0.0950

PC7
  eda_stress_skin_kurtosis                 0.7029
  eda_stress_skin_skew                     0.5313
  eda_cc_skew                              0.4048
  eda_cc_min                               0.1522
  eda_cc_mean_abs_diff                     0.0973
  eda_stress_skin_min                      0.0919
  eda_cc_kurtosis                          0.0769
  eda_stress_skin_mean_abs_diff            0.0760

PC8
  eda_stress_skin_slope                    0.6706
  eda_stress_skin_min                      0.6441
  eda_cc_slope                             0.2327
  eda_cc_min                               0.2255
  eda_cc_kurtosis                          0.1379
  eda_stress_skin_mean_abs_diff            0.0933
  eda_cc_skew                              0.0423
  eda_stress_skin_skew                     0.0261

Saved to: data/feature_extraction/analysis/quality_eda_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_5.0s.csv
Shape: (426, 28)
Selected feature columns: 21
After NaN/variance filter: (426, 15)
After correlation pruning: (426, 5)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6983   (cum 0.6983)
   PC2: 0.2444   (cum 0.9428)
   PC3: 0.0423   (cum 0.9851)
   PC4: 0.0141   (cum 0.9992)
   PC5: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5328
  eda_scl_slope                            0.5020
  eda_scr_rate                             0.4663
  eda_phasic_energy                        0.4654
  eda_scl_min                              0.1737

PC2
  eda_scl_min                              0.8287
  eda_phasic_energy                        0.3536
  eda_scr_rate                             0.3449
  eda_scl_slope                            0.2612
  eda_scr_amp_sum                          0.0313

PC3
  eda_phasic_energy                        0.6105
  eda_scr_rate                             0.5978
  eda_scl_min                              0.5000
  eda_scr_amp_sum                          0.1409
  eda_scl_slope                            0.0127

PC4
  eda_scl_slope                            0.7162
  eda_scr_rate                             0.5309
  eda_phasic_energy                        0.4061
  eda_scl_min                              0.1813
  eda_scr_amp_sum                          0.0855

PC5
  eda_scr_amp_sum                          0.8294
  eda_scl_slope                            0.4083
  eda_phasic_energy                        0.3475
  eda_scr_rate                             0.1562
  eda_scl_min                              0.0141

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6983   (cum 0.6983)
   PC2: 0.2444   (cum 0.9428)
   PC3: 0.0423   (cum 0.9851)
   PC4: 0.0141   (cum 0.9992)
   PC5: 0.0008   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5328
  eda_scl_slope                            0.5020
  eda_scr_rate                             0.4663
  eda_phasic_energy                        0.4654
  eda_scl_min                              0.1737

PC2
  eda_scl_min                              0.8287
  eda_phasic_energy                        0.3536
  eda_scr_rate                             0.3449
  eda_scl_slope                            0.2612
  eda_scr_amp_sum                          0.0313

PC3
  eda_phasic_energy                        0.6105
  eda_scr_rate                             0.5978
  eda_scl_min                              0.5000
  eda_scr_amp_sum                          0.1409
  eda_scl_slope                            0.0127

PC4
  eda_scl_slope                            0.7162
  eda_scr_rate                             0.5309
  eda_phasic_energy                        0.4061
  eda_scl_min                              0.1813
  eda_scr_amp_sum                          0.0855

PC5
  eda_scr_amp_sum                          0.8294
  eda_scl_slope                            0.4083
  eda_phasic_energy                        0.3475
  eda_scr_rate                             0.1562
  eda_scl_min                              0.0141

Saved to: data/feature_extraction/analysis/quality_eda_advanced_5.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_features_2.0s.csv
Shape: (1106, 39)
Selected feature columns: 30
After NaN/variance filter: (1106, 29)
After correlation pruning: (1106, 29)

PCA summary (round 1):
  pcs_for_90pct: 13
  pcs_for_95pct: 18
  pcs_for_99pct: 24

Explained variance per PC (round 1):
   PC1: 0.3529   (cum 0.3529)
   PC2: 0.1644   (cum 0.5174)
   PC3: 0.0648   (cum 0.5822)
   PC4: 0.0580   (cum 0.6402)
   PC5: 0.0475   (cum 0.6877)
   PC6: 0.0425   (cum 0.7302)
   PC7: 0.0374   (cum 0.7675)
   PC8: 0.0324   (cum 0.7999)
   PC9: 0.0264   (cum 0.8263)
  PC10: 0.0224   (cum 0.8488)
  PC11: 0.0203   (cum 0.8691)
  PC12: 0.0184   (cum 0.8875)
  PC13: 0.0146   (cum 0.9021)
  PC14: 0.0124   (cum 0.9145)
  PC15: 0.0118   (cum 0.9263)

Top PCA loadings per component (round 1):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2740
  acc_y_dyn__avg_amplitude_change          0.2705
  acc_x_dyn__quantile_0.9                  0.2702
  acc_x_dyn__max                           0.2692
  acc_x_dyn__quantile_0.3                  0.2516
  acc_x_dyn__harmonic_mean_of_abs          0.2329
  acc_y_dyn__variance_of_absolute_differences 0.2320
  acc_y_dyn__quantile_0.3                  0.2314

PC2
  acc_x_dyn__sample_entropy                0.3497
  acc_y_dyn__sample_entropy                0.3486
  acc_x_dyn__approximate_entropy_0.9       0.3458
  acc_x_dyn__katz_fractal_dimension        0.3449
  acc_z_dyn__sample_entropy                0.3400
  acc_y_dyn__katz_fractal_dimension        0.3388
  acc_z_dyn__katz_fractal_dimension        0.3241
  acc_x_dyn__cardinality                   0.2439

PC3
  acc_z_dyn__approximate_entropy_0.1       0.5884
  acc_x_dyn__approximate_entropy_0.1       0.5751
  acc_x_dyn__cardinality                   0.4459
  acc_z_dyn__katz_fractal_dimension        0.1375
  acc_y_dyn__tsallis_entropy               0.1357
  acc_y_dyn__variance_of_absolute_differences 0.1222
  acc_y_dyn__avg_amplitude_change          0.1068
  acc_z_dyn__sum_of_absolute_changes       0.0985

PC4
  acc_y_dyn__quantile_0.4                  0.4858
  acc_y_dyn__quantile_0.3                  0.4550
  acc_y_dyn__harmonic_mean_of_abs          0.3561
  acc_x_dyn__variance_of_absolute_differences 0.2456
  acc_z_dyn__lower_complete_moment         0.2403
  acc_y_dyn__variance_of_absolute_differences 0.2261
  acc_y_dyn__avg_amplitude_change          0.2178
  acc_z_dyn__quantile_0.6                  0.2072

PC5
  acc_x_dyn__quantile_0.4                  0.3785
  acc_z_dyn__quantile_0.4                  0.3616
  acc_z_dyn__harmonic_mean_of_abs          0.3452
  acc_x_dyn__quantile_0.3                  0.3274
  acc_z_dyn__variance_of_absolute_differences 0.2978
  acc_z_dyn__lower_complete_moment         0.2959
  acc_x_dyn__harmonic_mean_of_abs          0.2459
  acc_z_dyn__sample_entropy                0.2177

PC6
  acc_z_dyn__quantile_0.6                  0.5729
  acc_z_dyn__quantile_0.4                  0.4569
  acc_x_dyn__quantile_0.6                  0.3912
  acc_z_dyn__lower_complete_moment         0.2924
  acc_x_dyn__quantile_0.4                  0.2162
  acc_y_dyn__quantile_0.4                  0.1967
  acc_z_dyn__harmonic_mean_of_abs          0.1398
  acc_y_dyn__tsallis_entropy               0.1392

PC7
  acc_y_dyn__tsallis_entropy               0.7354
  acc_x_dyn__quantile_0.6                  0.3441
  acc_y_dyn__sample_entropy                0.2617
  acc_x_dyn__approximate_entropy_0.9       0.1879
  acc_x_dyn__katz_fractal_dimension        0.1877
  acc_y_dyn__variance_of_absolute_differences 0.1846
  acc_x_dyn__cardinality                   0.1630
  acc_x_dyn__quantile_0.4                  0.1610

PC8
  acc_x_dyn__quantile_0.6                  0.5255
  acc_x_dyn__quantile_0.4                  0.4547
  acc_z_dyn__quantile_0.4                  0.3971
  acc_z_dyn__quantile_0.6                  0.3062
  acc_y_dyn__tsallis_entropy               0.2596
  acc_z_dyn__harmonic_mean_of_abs          0.1755
  acc_x_dyn__quantile_0.3                  0.1667
  acc_y_dyn__sample_entropy                0.1568

Stage 2: PCs used to reach 90%: 13
Stage 2: ranking pool size: 29
Stage 2: selected features: 29 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 13
  pcs_for_95pct: 18
  pcs_for_99pct: 24

Explained variance per PC (round 2):
   PC1: 0.3529   (cum 0.3529)
   PC2: 0.1644   (cum 0.5174)
   PC3: 0.0648   (cum 0.5822)
   PC4: 0.0580   (cum 0.6402)
   PC5: 0.0475   (cum 0.6877)
   PC6: 0.0425   (cum 0.7302)
   PC7: 0.0374   (cum 0.7675)
   PC8: 0.0324   (cum 0.7999)
   PC9: 0.0264   (cum 0.8263)
  PC10: 0.0224   (cum 0.8488)
  PC11: 0.0203   (cum 0.8691)
  PC12: 0.0184   (cum 0.8875)
  PC13: 0.0146   (cum 0.9021)
  PC14: 0.0124   (cum 0.9145)
  PC15: 0.0118   (cum 0.9263)

Top PCA loadings per component (round 2):

PC1
  acc_z_dyn__sum_of_absolute_changes       0.2740
  acc_y_dyn__avg_amplitude_change          0.2705
  acc_x_dyn__quantile_0.9                  0.2702
  acc_x_dyn__max                           0.2692
  acc_x_dyn__quantile_0.3                  0.2516
  acc_x_dyn__harmonic_mean_of_abs          0.2329
  acc_y_dyn__variance_of_absolute_differences 0.2320
  acc_y_dyn__quantile_0.3                  0.2314

PC2
  acc_x_dyn__sample_entropy                0.3497
  acc_y_dyn__sample_entropy                0.3486
  acc_x_dyn__approximate_entropy_0.9       0.3458
  acc_x_dyn__katz_fractal_dimension        0.3449
  acc_z_dyn__sample_entropy                0.3400
  acc_y_dyn__katz_fractal_dimension        0.3388
  acc_z_dyn__katz_fractal_dimension        0.3241
  acc_x_dyn__cardinality                   0.2439

PC3
  acc_z_dyn__approximate_entropy_0.1       0.5884
  acc_x_dyn__approximate_entropy_0.1       0.5751
  acc_x_dyn__cardinality                   0.4459
  acc_z_dyn__katz_fractal_dimension        0.1375
  acc_y_dyn__tsallis_entropy               0.1357
  acc_y_dyn__variance_of_absolute_differences 0.1222
  acc_y_dyn__avg_amplitude_change          0.1068
  acc_z_dyn__sum_of_absolute_changes       0.0985

PC4
  acc_y_dyn__quantile_0.4                  0.4858
  acc_y_dyn__quantile_0.3                  0.4550
  acc_y_dyn__harmonic_mean_of_abs          0.3561
  acc_x_dyn__variance_of_absolute_differences 0.2456
  acc_z_dyn__lower_complete_moment         0.2403
  acc_y_dyn__variance_of_absolute_differences 0.2261
  acc_y_dyn__avg_amplitude_change          0.2178
  acc_z_dyn__quantile_0.6                  0.2072

PC5
  acc_x_dyn__quantile_0.4                  0.3785
  acc_z_dyn__quantile_0.4                  0.3616
  acc_z_dyn__harmonic_mean_of_abs          0.3452
  acc_x_dyn__quantile_0.3                  0.3274
  acc_z_dyn__variance_of_absolute_differences 0.2978
  acc_z_dyn__lower_complete_moment         0.2959
  acc_x_dyn__harmonic_mean_of_abs          0.2459
  acc_z_dyn__sample_entropy                0.2177

PC6
  acc_z_dyn__quantile_0.6                  0.5729
  acc_z_dyn__quantile_0.4                  0.4569
  acc_x_dyn__quantile_0.6                  0.3912
  acc_z_dyn__lower_complete_moment         0.2924
  acc_x_dyn__quantile_0.4                  0.2162
  acc_y_dyn__quantile_0.4                  0.1967
  acc_z_dyn__harmonic_mean_of_abs          0.1398
  acc_y_dyn__tsallis_entropy               0.1392

PC7
  acc_y_dyn__tsallis_entropy               0.7354
  acc_x_dyn__quantile_0.6                  0.3441
  acc_y_dyn__sample_entropy                0.2617
  acc_x_dyn__approximate_entropy_0.9       0.1879
  acc_x_dyn__katz_fractal_dimension        0.1877
  acc_y_dyn__variance_of_absolute_differences 0.1846
  acc_x_dyn__cardinality                   0.1630
  acc_x_dyn__quantile_0.4                  0.1610

PC8
  acc_x_dyn__quantile_0.6                  0.5255
  acc_x_dyn__quantile_0.4                  0.4547
  acc_z_dyn__quantile_0.4                  0.3971
  acc_z_dyn__quantile_0.6                  0.3062
  acc_y_dyn__tsallis_entropy               0.2596
  acc_z_dyn__harmonic_mean_of_abs          0.1755
  acc_x_dyn__quantile_0.3                  0.1667
  acc_y_dyn__sample_entropy                0.1568

Saved to: data/feature_extraction/analysis/quality_imu_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_2.0s.csv | rows=1490 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_features_2.0s.csv
Shape: (1490, 51)
Selected feature columns: 44
After NaN/variance filter: (1490, 43)
After correlation pruning: (1490, 17)

PCA summary (round 1):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 11

Explained variance per PC (round 1):
   PC1: 0.3728   (cum 0.3728)
   PC2: 0.1255   (cum 0.4983)
   PC3: 0.1074   (cum 0.6057)
   PC4: 0.0860   (cum 0.6917)
   PC5: 0.0730   (cum 0.7648)
   PC6: 0.0583   (cum 0.8230)
   PC7: 0.0538   (cum 0.8769)
   PC8: 0.0443   (cum 0.9212)
   PC9: 0.0386   (cum 0.9597)
  PC10: 0.0199   (cum 0.9796)
  PC11: 0.0140   (cum 0.9936)
  PC12: 0.0030   (cum 0.9966)
  PC13: 0.0016   (cum 0.9982)
  PC14: 0.0009   (cum 0.9991)
  PC15: 0.0008   (cum 0.9999)

Top PCA loadings per component (round 1):

PC1
  ppg_green_diff_mean_abs                  0.3734
  ppg_green_crest_factor                   0.3716
  ppg_green_std                            0.3631
  ppg_green_diff_std                       0.3466
  ppg_green_tke_p95_abs                    0.3438
  ppg_green_shape_factor                   0.3291
  ppg_green_tke_std                        0.2703
  ppg_green_iqr                            0.2540

PC2
  ppg_green_min                            0.5661
  ppg_green_p90                            0.5282
  ppg_green_tke_std                        0.3194
  ppg_green_shape_factor                   0.2516
  ppg_green_iqr                            0.2402
  ppg_green_diff_std                       0.2005
  ppg_green_skew                           0.1852
  ppg_green_tke_p95_abs                    0.1385

PC3
  ppg_green_kurtosis                       0.4893
  ppg_green_mean_cross_rate                0.4545
  ppg_green_ddx_kurtosis                   0.4148
  ppg_green_dx_kurtosis                    0.3978
  ppg_green_skew                           0.2697
  ppg_green_iqr                            0.1871
  ppg_green_shape_factor                   0.1704
  ppg_green_std                            0.1646

PC4
  ppg_green_iqr                            0.4756
  ppg_green_tke_std                        0.4156
  ppg_green_min                            0.3381
  ppg_green_ddx_kurtosis                   0.3289
  ppg_green_diff_std                       0.2910
  ppg_green_mean_cross_rate                0.2573
  ppg_green_p90                            0.2520
  ppg_green_std                            0.2195

PC5
  ppg_green_ddx_mean                       0.5844
  ppg_green_skew                           0.4841
  ppg_green_dx_kurtosis                    0.4441
  ppg_green_ddx_kurtosis                   0.3597
  ppg_green_crest_factor                   0.1462
  ppg_green_mean_cross_rate                0.1400
  ppg_green_kurtosis                       0.1257
  ppg_green_tke_std                        0.1058

PC6
  ppg_green_diff_mean                      0.9342
  ppg_green_mean_cross_rate                0.2269
  ppg_green_ddx_mean                       0.1780
  ppg_green_min                            0.1154
  ppg_green_p90                            0.0986
  ppg_green_diff_mean_abs                  0.0812
  ppg_green_skew                           0.0655
  ppg_green_tke_p95_abs                    0.0576

PC7
  ppg_green_mean_cross_rate                0.4408
  ppg_green_ddx_mean                       0.4204
  ppg_green_diff_mean                      0.2872
  ppg_green_dx_kurtosis                    0.2859
  ppg_green_min                            0.2828
  ppg_green_kurtosis                       0.2599
  ppg_green_tke_p95_abs                    0.2572
  ppg_green_ddx_kurtosis                   0.2498

PC8
  ppg_green_skew                           0.7446
  ppg_green_ddx_mean                       0.6092
  ppg_green_kurtosis                       0.1789
  ppg_green_diff_mean                      0.1288
  ppg_green_mean_cross_rate                0.0835
  ppg_green_crest_factor                   0.0820
  ppg_green_min                            0.0608
  ppg_green_dx_kurtosis                    0.0509

Stage 2: PCs used to reach 90%: 8
Stage 2: ranking pool size: 17
Stage 2: selected features: 17 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 8
  pcs_for_95pct: 9
  pcs_for_99pct: 11

Explained variance per PC (round 2):
   PC1: 0.3728   (cum 0.3728)
   PC2: 0.1255   (cum 0.4983)
   PC3: 0.1074   (cum 0.6057)
   PC4: 0.0860   (cum 0.6917)
   PC5: 0.0730   (cum 0.7648)
   PC6: 0.0583   (cum 0.8230)
   PC7: 0.0538   (cum 0.8769)
   PC8: 0.0443   (cum 0.9212)
   PC9: 0.0386   (cum 0.9597)
  PC10: 0.0199   (cum 0.9796)
  PC11: 0.0140   (cum 0.9936)
  PC12: 0.0030   (cum 0.9966)
  PC13: 0.0016   (cum 0.9982)
  PC14: 0.0009   (cum 0.9991)
  PC15: 0.0008   (cum 0.9999)

Top PCA loadings per component (round 2):

PC1
  ppg_green_diff_mean_abs                  0.3734
  ppg_green_crest_factor                   0.3716
  ppg_green_std                            0.3631
  ppg_green_diff_std                       0.3466
  ppg_green_tke_p95_abs                    0.3438
  ppg_green_shape_factor                   0.3291
  ppg_green_tke_std                        0.2703
  ppg_green_iqr                            0.2540

PC2
  ppg_green_min                            0.5661
  ppg_green_p90                            0.5282
  ppg_green_tke_std                        0.3194
  ppg_green_shape_factor                   0.2516
  ppg_green_iqr                            0.2402
  ppg_green_diff_std                       0.2005
  ppg_green_skew                           0.1852
  ppg_green_tke_p95_abs                    0.1385

PC3
  ppg_green_kurtosis                       0.4893
  ppg_green_mean_cross_rate                0.4545
  ppg_green_ddx_kurtosis                   0.4148
  ppg_green_dx_kurtosis                    0.3978
  ppg_green_skew                           0.2697
  ppg_green_iqr                            0.1871
  ppg_green_shape_factor                   0.1704
  ppg_green_std                            0.1646

PC4
  ppg_green_iqr                            0.4756
  ppg_green_tke_std                        0.4156
  ppg_green_min                            0.3381
  ppg_green_ddx_kurtosis                   0.3289
  ppg_green_diff_std                       0.2910
  ppg_green_mean_cross_rate                0.2573
  ppg_green_p90                            0.2520
  ppg_green_std                            0.2195

PC5
  ppg_green_ddx_mean                       0.5844
  ppg_green_skew                           0.4841
  ppg_green_dx_kurtosis                    0.4441
  ppg_green_ddx_kurtosis                   0.3597
  ppg_green_crest_factor                   0.1462
  ppg_green_mean_cross_rate                0.1400
  ppg_green_kurtosis                       0.1257
  ppg_green_tke_std                        0.1058

PC6
  ppg_green_diff_mean                      0.9342
  ppg_green_mean_cross_rate                0.2269
  ppg_green_ddx_mean                       0.1780
  ppg_green_min                            0.1154
  ppg_green_p90                            0.0986
  ppg_green_diff_mean_abs                  0.0812
  ppg_green_skew                           0.0655
  ppg_green_tke_p95_abs                    0.0576

PC7
  ppg_green_mean_cross_rate                0.4408
  ppg_green_ddx_mean                       0.4204
  ppg_green_diff_mean                      0.2872
  ppg_green_dx_kurtosis                    0.2859
  ppg_green_min                            0.2828
  ppg_green_kurtosis                       0.2599
  ppg_green_tke_p95_abs                    0.2572
  ppg_green_ddx_kurtosis                   0.2498

PC8
  ppg_green_skew                           0.7446
  ppg_green_ddx_mean                       0.6092
  ppg_green_kurtosis                       0.1789
  ppg_green_diff_mean                      0.1288
  ppg_green_mean_cross_rate                0.0835
  ppg_green_crest_factor                   0.0820
  ppg_green_min                            0.0608
  ppg_green_dx_kurtosis                    0.0509

Saved to: data/feature_extraction/analysis/quality_ppg_green_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_2.0s.csv
Shape: (1490, 28)
Selected feature columns: 15
After NaN/variance filter: (1490, 2)
After correlation pruning: (1490, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.8209   (cum 0.8209)
   PC2: 0.1791   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.8209   (cum 0.8209)
   PC2: 0.1791   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_green_n_peaks                        0.7071
  ppg_green_peak_quality                   0.7071

PC2
  ppg_green_peak_quality                   0.7071
  ppg_green_n_peaks                        0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_green_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_2.0s.csv | rows=1490 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_features_2.0s.csv
Shape: (1490, 51)
Selected feature columns: 44
After NaN/variance filter: (1490, 44)
After correlation pruning: (1490, 22)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 1):
   PC1: 0.3819   (cum 0.3819)
   PC2: 0.1956   (cum 0.5774)
   PC3: 0.1122   (cum 0.6897)
   PC4: 0.0849   (cum 0.7746)
   PC5: 0.0586   (cum 0.8331)
   PC6: 0.0496   (cum 0.8828)
   PC7: 0.0371   (cum 0.9199)
   PC8: 0.0217   (cum 0.9416)
   PC9: 0.0132   (cum 0.9548)
  PC10: 0.0090   (cum 0.9638)
  PC11: 0.0082   (cum 0.9720)
  PC12: 0.0075   (cum 0.9795)
  PC13: 0.0072   (cum 0.9867)
  PC14: 0.0060   (cum 0.9927)
  PC15: 0.0028   (cum 0.9955)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_max                            0.3257
  ppg_infra_p10                            0.3236
  ppg_infra_signal_energy                  0.3221
  ppg_infra_diff_mean_abs                  0.3199
  ppg_infra_p90                            0.3152
  ppg_infra_iqr                            0.2950
  ppg_infra_ddx_std                        0.2867
  ppg_infra_tke_std                        0.2820

PC2
  ppg_infra_clearance_factor               0.4474
  ppg_infra_crest_factor                   0.4232
  ppg_infra_kurtosis                       0.4231
  ppg_infra_shape_factor                   0.4045
  ppg_infra_dx_kurtosis                    0.3581
  ppg_infra_ddx_kurtosis                   0.3030
  ppg_infra_zcr                            0.1124
  ppg_infra_signal_energy                  0.0818

PC3
  ppg_infra_trim_mean_10                   0.5021
  ppg_infra_ddx_mean                       0.4848
  ppg_infra_diff_mean                      0.3957
  ppg_infra_mean                           0.2640
  ppg_infra_ddx_std                        0.2456
  ppg_infra_tke_std                        0.2413
  ppg_infra_iqr                            0.2268
  ppg_infra_median                         0.2088

PC4
  ppg_infra_mean_cross_rate                0.6755
  ppg_infra_zcr                            0.6729
  ppg_infra_ddx_kurtosis                   0.1912
  ppg_infra_dx_kurtosis                    0.1818
  ppg_infra_diff_mean_abs                  0.0779
  ppg_infra_kurtosis                       0.0672
  ppg_infra_skew                           0.0482
  ppg_infra_crest_factor                   0.0398

PC5
  ppg_infra_mean                           0.5217
  ppg_infra_diff_mean                      0.3783
  ppg_infra_ddx_std                        0.2941
  ppg_infra_ddx_mean                       0.2914
  ppg_infra_trim_mean_10                   0.2722
  ppg_infra_median                         0.2683
  ppg_infra_diff_mean_abs                  0.2424
  ppg_infra_ddx_kurtosis                   0.2309

PC6
  ppg_infra_skew                           0.8971
  ppg_infra_mean                           0.2275
  ppg_infra_dx_kurtosis                    0.1952
  ppg_infra_median                         0.1541
  ppg_infra_shape_factor                   0.1341
  ppg_infra_trim_mean_10                   0.1159
  ppg_infra_ddx_kurtosis                   0.0927
  ppg_infra_mean_cross_rate                0.0912

PC7
  ppg_infra_ddx_kurtosis                   0.6176
  ppg_infra_dx_kurtosis                    0.4021
  ppg_infra_shape_factor                   0.3324
  ppg_infra_mean                           0.2467
  ppg_infra_clearance_factor               0.2425
  ppg_infra_tke_std                        0.2130
  ppg_infra_mean_cross_rate                0.1693
  ppg_infra_kurtosis                       0.1560

PC8
  ppg_infra_tke_std                        0.4349
  ppg_infra_p90                            0.3717
  ppg_infra_signal_energy                  0.3600
  ppg_infra_dx_kurtosis                    0.3125
  ppg_infra_iqr                            0.3105
  ppg_infra_skew                           0.2621
  ppg_infra_shape_factor                   0.2101
  ppg_infra_mean                           0.1866

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 22
Stage 2: selected features: 22 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 9
  pcs_for_99pct: 14

Explained variance per PC (round 2):
   PC1: 0.3819   (cum 0.3819)
   PC2: 0.1956   (cum 0.5774)
   PC3: 0.1122   (cum 0.6897)
   PC4: 0.0849   (cum 0.7746)
   PC5: 0.0586   (cum 0.8331)
   PC6: 0.0496   (cum 0.8828)
   PC7: 0.0371   (cum 0.9199)
   PC8: 0.0217   (cum 0.9416)
   PC9: 0.0132   (cum 0.9548)
  PC10: 0.0090   (cum 0.9638)
  PC11: 0.0082   (cum 0.9720)
  PC12: 0.0075   (cum 0.9795)
  PC13: 0.0072   (cum 0.9867)
  PC14: 0.0060   (cum 0.9927)
  PC15: 0.0028   (cum 0.9955)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_max                            0.3257
  ppg_infra_p10                            0.3236
  ppg_infra_signal_energy                  0.3221
  ppg_infra_diff_mean_abs                  0.3199
  ppg_infra_p90                            0.3152
  ppg_infra_iqr                            0.2950
  ppg_infra_ddx_std                        0.2867
  ppg_infra_tke_std                        0.2820

PC2
  ppg_infra_clearance_factor               0.4474
  ppg_infra_crest_factor                   0.4232
  ppg_infra_kurtosis                       0.4231
  ppg_infra_shape_factor                   0.4045
  ppg_infra_dx_kurtosis                    0.3581
  ppg_infra_ddx_kurtosis                   0.3030
  ppg_infra_zcr                            0.1124
  ppg_infra_signal_energy                  0.0818

PC3
  ppg_infra_trim_mean_10                   0.5021
  ppg_infra_ddx_mean                       0.4848
  ppg_infra_diff_mean                      0.3957
  ppg_infra_mean                           0.2640
  ppg_infra_ddx_std                        0.2456
  ppg_infra_tke_std                        0.2413
  ppg_infra_iqr                            0.2268
  ppg_infra_median                         0.2088

PC4
  ppg_infra_mean_cross_rate                0.6755
  ppg_infra_zcr                            0.6729
  ppg_infra_ddx_kurtosis                   0.1912
  ppg_infra_dx_kurtosis                    0.1818
  ppg_infra_diff_mean_abs                  0.0779
  ppg_infra_kurtosis                       0.0672
  ppg_infra_skew                           0.0482
  ppg_infra_crest_factor                   0.0398

PC5
  ppg_infra_mean                           0.5217
  ppg_infra_diff_mean                      0.3783
  ppg_infra_ddx_std                        0.2941
  ppg_infra_ddx_mean                       0.2914
  ppg_infra_trim_mean_10                   0.2722
  ppg_infra_median                         0.2683
  ppg_infra_diff_mean_abs                  0.2424
  ppg_infra_ddx_kurtosis                   0.2309

PC6
  ppg_infra_skew                           0.8971
  ppg_infra_mean                           0.2275
  ppg_infra_dx_kurtosis                    0.1952
  ppg_infra_median                         0.1541
  ppg_infra_shape_factor                   0.1341
  ppg_infra_trim_mean_10                   0.1159
  ppg_infra_ddx_kurtosis                   0.0927
  ppg_infra_mean_cross_rate                0.0912

PC7
  ppg_infra_ddx_kurtosis                   0.6176
  ppg_infra_dx_kurtosis                    0.4021
  ppg_infra_shape_factor                   0.3324
  ppg_infra_mean                           0.2467
  ppg_infra_clearance_factor               0.2425
  ppg_infra_tke_std                        0.2130
  ppg_infra_mean_cross_rate                0.1693
  ppg_infra_kurtosis                       0.1560

PC8
  ppg_infra_tke_std                        0.4349
  ppg_infra_p90                            0.3717
  ppg_infra_signal_energy                  0.3600
  ppg_infra_dx_kurtosis                    0.3125
  ppg_infra_iqr                            0.3105
  ppg_infra_skew                           0.2621
  ppg_infra_shape_factor                   0.2101
  ppg_infra_mean                           0.1866

Saved to: data/feature_extraction/analysis/quality_ppg_infra_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_2.0s.csv
Shape: (1490, 28)
Selected feature columns: 15
After NaN/variance filter: (1490, 2)
After correlation pruning: (1490, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7275   (cum 0.7275)
   PC2: 0.2725   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7275   (cum 0.7275)
   PC2: 0.2725   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_infra_peak_quality                   0.7071
  ppg_infra_n_peaks                        0.7071

PC2
  ppg_infra_n_peaks                        0.7071
  ppg_infra_peak_quality                   0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_infra_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote PPG features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_2.0s.csv | rows=1490 | cols=50
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_features_2.0s.csv
Shape: (1490, 51)
Selected feature columns: 44
After NaN/variance filter: (1490, 44)
After correlation pruning: (1490, 21)

PCA summary (round 1):
  pcs_for_90pct: 7
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 1):
   PC1: 0.3291   (cum 0.3291)
   PC2: 0.1981   (cum 0.5272)
   PC3: 0.1095   (cum 0.6368)
   PC4: 0.0974   (cum 0.7342)
   PC5: 0.0830   (cum 0.8172)
   PC6: 0.0516   (cum 0.8687)
   PC7: 0.0370   (cum 0.9057)
   PC8: 0.0159   (cum 0.9217)
   PC9: 0.0140   (cum 0.9357)
  PC10: 0.0132   (cum 0.9489)
  PC11: 0.0124   (cum 0.9613)
  PC12: 0.0103   (cum 0.9716)
  PC13: 0.0091   (cum 0.9807)
  PC14: 0.0070   (cum 0.9877)
  PC15: 0.0064   (cum 0.9941)

Top PCA loadings per component (round 1):

PC1
  ppg_red_max                              0.3635
  ppg_red_min                              0.3376
  ppg_red_tke_std                          0.3365
  ppg_red_signal_energy                    0.3267
  ppg_red_p90                              0.3198
  ppg_red_diff_mean_abs                    0.3108
  ppg_red_dx_mean                          0.2815
  ppg_red_ddx_mean                         0.2537

PC2
  ppg_red_clearance_factor                 0.4405
  ppg_red_kurtosis                         0.4119
  ppg_red_crest_factor                     0.4090
  ppg_red_shape_factor                     0.4031
  ppg_red_dx_kurtosis                      0.3013
  ppg_red_ddx_kurtosis                     0.2609
  ppg_red_signal_energy                    0.1452
  ppg_red_zcr                              0.1369

PC3
  ppg_red_mean                             0.5186
  ppg_red_trim_mean_10                     0.4971
  ppg_red_median                           0.4348
  ppg_red_ddx_std                          0.2848
  ppg_red_diff_mean_abs                    0.2404
  ppg_red_zcr                              0.1572
  ppg_red_min                              0.1448
  ppg_red_p90                              0.1448

PC4
  ppg_red_trim_mean_10                     0.4171
  ppg_red_ddx_std                          0.3894
  ppg_red_ddx_mean                         0.3589
  ppg_red_dx_mean                          0.3011
  ppg_red_zcr                              0.3002
  ppg_red_mean_cross_rate                  0.2843
  ppg_red_diff_mean_abs                    0.2649
  ppg_red_signal_energy                    0.2237

PC5
  ppg_red_mean_cross_rate                  0.5399
  ppg_red_zcr                              0.5283
  ppg_red_ddx_kurtosis                     0.3941
  ppg_red_dx_kurtosis                      0.2915
  ppg_red_p90                              0.1695
  ppg_red_dx_mean                          0.1691
  ppg_red_ddx_mean                         0.1573
  ppg_red_ddx_std                          0.1560

PC6
  ppg_red_skew                             0.8721
  ppg_red_dx_kurtosis                      0.2330
  ppg_red_mean                             0.2252
  ppg_red_median                           0.2175
  ppg_red_ddx_kurtosis                     0.1625
  ppg_red_p90                              0.1315
  ppg_red_trim_mean_10                     0.1092
  ppg_red_min                              0.0930

PC7
  ppg_red_dx_kurtosis                      0.5014
  ppg_red_ddx_kurtosis                     0.4602
  ppg_red_mean_cross_rate                  0.3623
  ppg_red_shape_factor                     0.3087
  ppg_red_skew                             0.2542
  ppg_red_clearance_factor                 0.2191
  ppg_red_min                              0.1980
  ppg_red_crest_factor                     0.1907

PC8
  ppg_red_zcr                              0.5271
  ppg_red_kurtosis                         0.4393
  ppg_red_mean_cross_rate                  0.4344
  ppg_red_shape_factor                     0.3554
  ppg_red_ddx_kurtosis                     0.3479
  ppg_red_dx_kurtosis                      0.1490
  ppg_red_tke_std                          0.1223
  ppg_red_ddx_std                          0.1090

Stage 2: PCs used to reach 90%: 7
Stage 2: ranking pool size: 21
Stage 2: selected features: 21 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 7
  pcs_for_95pct: 11
  pcs_for_99pct: 15

Explained variance per PC (round 2):
   PC1: 0.3291   (cum 0.3291)
   PC2: 0.1981   (cum 0.5272)
   PC3: 0.1095   (cum 0.6368)
   PC4: 0.0974   (cum 0.7342)
   PC5: 0.0830   (cum 0.8172)
   PC6: 0.0516   (cum 0.8687)
   PC7: 0.0370   (cum 0.9057)
   PC8: 0.0159   (cum 0.9217)
   PC9: 0.0140   (cum 0.9357)
  PC10: 0.0132   (cum 0.9489)
  PC11: 0.0124   (cum 0.9613)
  PC12: 0.0103   (cum 0.9716)
  PC13: 0.0091   (cum 0.9807)
  PC14: 0.0070   (cum 0.9877)
  PC15: 0.0064   (cum 0.9941)

Top PCA loadings per component (round 2):

PC1
  ppg_red_max                              0.3635
  ppg_red_min                              0.3376
  ppg_red_tke_std                          0.3365
  ppg_red_signal_energy                    0.3267
  ppg_red_p90                              0.3198
  ppg_red_diff_mean_abs                    0.3108
  ppg_red_dx_mean                          0.2815
  ppg_red_ddx_mean                         0.2537

PC2
  ppg_red_clearance_factor                 0.4405
  ppg_red_kurtosis                         0.4119
  ppg_red_crest_factor                     0.4090
  ppg_red_shape_factor                     0.4031
  ppg_red_dx_kurtosis                      0.3013
  ppg_red_ddx_kurtosis                     0.2609
  ppg_red_signal_energy                    0.1452
  ppg_red_zcr                              0.1369

PC3
  ppg_red_mean                             0.5186
  ppg_red_trim_mean_10                     0.4971
  ppg_red_median                           0.4348
  ppg_red_ddx_std                          0.2848
  ppg_red_diff_mean_abs                    0.2404
  ppg_red_zcr                              0.1572
  ppg_red_min                              0.1448
  ppg_red_p90                              0.1448

PC4
  ppg_red_trim_mean_10                     0.4171
  ppg_red_ddx_std                          0.3894
  ppg_red_ddx_mean                         0.3589
  ppg_red_dx_mean                          0.3011
  ppg_red_zcr                              0.3002
  ppg_red_mean_cross_rate                  0.2843
  ppg_red_diff_mean_abs                    0.2649
  ppg_red_signal_energy                    0.2237

PC5
  ppg_red_mean_cross_rate                  0.5399
  ppg_red_zcr                              0.5283
  ppg_red_ddx_kurtosis                     0.3941
  ppg_red_dx_kurtosis                      0.2915
  ppg_red_p90                              0.1695
  ppg_red_dx_mean                          0.1691
  ppg_red_ddx_mean                         0.1573
  ppg_red_ddx_std                          0.1560

PC6
  ppg_red_skew                             0.8721
  ppg_red_dx_kurtosis                      0.2330
  ppg_red_mean                             0.2252
  ppg_red_median                           0.2175
  ppg_red_ddx_kurtosis                     0.1625
  ppg_red_p90                              0.1315
  ppg_red_trim_mean_10                     0.1092
  ppg_red_min                              0.0930

PC7
  ppg_red_dx_kurtosis                      0.5014
  ppg_red_ddx_kurtosis                     0.4602
  ppg_red_mean_cross_rate                  0.3623
  ppg_red_shape_factor                     0.3087
  ppg_red_skew                             0.2542
  ppg_red_clearance_factor                 0.2191
  ppg_red_min                              0.1980
  ppg_red_crest_factor                     0.1907

PC8
  ppg_red_zcr                              0.5271
  ppg_red_kurtosis                         0.4393
  ppg_red_mean_cross_rate                  0.4344
  ppg_red_shape_factor                     0.3554
  ppg_red_ddx_kurtosis                     0.3479
  ppg_red_dx_kurtosis                      0.1490
  ppg_red_tke_std                          0.1223
  ppg_red_ddx_std                          0.1090

Saved to: data/feature_extraction/analysis/quality_ppg_red_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
/Users/pascalschlegel/effort-estimator/features/hrv_features.py:164: RuntimeWarning: All-NaN slice encountered
  ibi_median = np.nanmedian(ibi_clean)
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_2.0s.csv
Shape: (1490, 28)
Selected feature columns: 15
After NaN/variance filter: (1490, 2)
After correlation pruning: (1490, 2)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 1):
   PC1: 0.7719   (cum 0.7719)
   PC2: 0.2281   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

PC2
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 2
Stage 2: selected features: 2 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 2
  pcs_for_99pct: 2

Explained variance per PC (round 2):
   PC1: 0.7719   (cum 0.7719)
   PC2: 0.2281   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  ppg_red_n_peaks                          0.7071
  ppg_red_peak_quality                     0.7071

PC2
  ppg_red_peak_quality                     0.7071
  ppg_red_n_peaks                          0.7071

Saved to: data/feature_extraction/analysis/quality_ppg_red_hrv_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
✓ Wrote EDA features → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_2.0s.csv | rows=1059 | cols=32
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_features_2.0s.csv
Shape: (1059, 33)
Selected feature columns: 26
After NaN/variance filter: (1059, 26)
After correlation pruning: (1059, 10)

PCA summary (round 1):
  pcs_for_90pct: 6
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 1):
   PC1: 0.3405   (cum 0.3405)
   PC2: 0.1623   (cum 0.5028)
   PC3: 0.1390   (cum 0.6419)
   PC4: 0.1110   (cum 0.7528)
   PC5: 0.0832   (cum 0.8360)
   PC6: 0.0786   (cum 0.9146)
   PC7: 0.0281   (cum 0.9427)
   PC8: 0.0255   (cum 0.9682)
   PC9: 0.0161   (cum 0.9842)
  PC10: 0.0158   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_stress_skin_mean_abs_diff            0.4769
  eda_stress_skin_min                      0.4456
  eda_stress_skin_slope                    0.4371
  eda_cc_mean_abs_diff                     0.4032
  eda_cc_slope                             0.3668
  eda_cc_min                               0.2673
  eda_cc_kurtosis                          0.1134
  eda_stress_skin_kurtosis                 0.0247

PC2
  eda_stress_skin_skew                     0.7068
  eda_stress_skin_kurtosis                 0.7039
  eda_stress_skin_min                      0.0569
  eda_stress_skin_mean_abs_diff            0.0226
  eda_stress_skin_slope                    0.0220
  eda_cc_min                               0.0178
  eda_cc_slope                             0.0123
  eda_cc_kurtosis                          0.0111

PC3
  eda_cc_min                               0.5660
  eda_cc_kurtosis                          0.5106
  eda_cc_mean_abs_diff                     0.4012
  eda_stress_skin_min                      0.2860
  eda_cc_skew                              0.2375
  eda_stress_skin_mean_abs_diff            0.2128
  eda_cc_slope                             0.1958
  eda_stress_skin_slope                    0.1707

PC4
  eda_cc_skew                              0.8784
  eda_cc_kurtosis                          0.3023
  eda_stress_skin_kurtosis                 0.2578
  eda_stress_skin_skew                     0.2367
  eda_cc_mean_abs_diff                     0.0798
  eda_stress_skin_min                      0.0566
  eda_stress_skin_slope                    0.0522
  eda_cc_min                               0.0352

PC5
  eda_cc_kurtosis                          0.5683
  eda_cc_min                               0.5440
  eda_cc_slope                             0.4567
  eda_stress_skin_slope                    0.3357
  eda_cc_skew                              0.1681
  eda_stress_skin_min                      0.1268
  eda_cc_mean_abs_diff                     0.0680
  eda_stress_skin_skew                     0.0640

PC6
  eda_cc_slope                             0.5796
  eda_cc_kurtosis                          0.5234
  eda_cc_mean_abs_diff                     0.4112
  eda_stress_skin_slope                    0.2907
  eda_stress_skin_mean_abs_diff            0.2535
  eda_stress_skin_min                      0.2237
  eda_cc_min                               0.1170
  eda_stress_skin_kurtosis                 0.0649

PC7
  eda_stress_skin_min                      0.5353
  eda_stress_skin_slope                    0.5329
  eda_stress_skin_kurtosis                 0.3906
  eda_stress_skin_skew                     0.3634
  eda_cc_skew                              0.2506
  eda_cc_min                               0.1948
  eda_cc_slope                             0.1717
  eda_cc_kurtosis                          0.1155

PC8
  eda_stress_skin_skew                     0.5400
  eda_stress_skin_kurtosis                 0.5205
  eda_stress_skin_slope                    0.4357
  eda_stress_skin_min                      0.3337
  eda_cc_skew                              0.2739
  eda_stress_skin_mean_abs_diff            0.1588
  eda_cc_slope                             0.1483
  eda_cc_min                               0.0945

Stage 2: PCs used to reach 90%: 6
Stage 2: ranking pool size: 10
Stage 2: selected features: 10 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 6
  pcs_for_95pct: 8
  pcs_for_99pct: 10

Explained variance per PC (round 2):
   PC1: 0.3405   (cum 0.3405)
   PC2: 0.1623   (cum 0.5028)
   PC3: 0.1390   (cum 0.6419)
   PC4: 0.1110   (cum 0.7528)
   PC5: 0.0832   (cum 0.8360)
   PC6: 0.0786   (cum 0.9146)
   PC7: 0.0281   (cum 0.9427)
   PC8: 0.0255   (cum 0.9682)
   PC9: 0.0161   (cum 0.9842)
  PC10: 0.0158   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_stress_skin_mean_abs_diff            0.4769
  eda_stress_skin_min                      0.4456
  eda_stress_skin_slope                    0.4371
  eda_cc_mean_abs_diff                     0.4032
  eda_cc_slope                             0.3668
  eda_cc_min                               0.2673
  eda_cc_kurtosis                          0.1134
  eda_stress_skin_kurtosis                 0.0247

PC2
  eda_stress_skin_skew                     0.7068
  eda_stress_skin_kurtosis                 0.7039
  eda_stress_skin_min                      0.0569
  eda_stress_skin_mean_abs_diff            0.0226
  eda_stress_skin_slope                    0.0220
  eda_cc_min                               0.0178
  eda_cc_slope                             0.0123
  eda_cc_kurtosis                          0.0111

PC3
  eda_cc_min                               0.5660
  eda_cc_kurtosis                          0.5106
  eda_cc_mean_abs_diff                     0.4012
  eda_stress_skin_min                      0.2860
  eda_cc_skew                              0.2375
  eda_stress_skin_mean_abs_diff            0.2128
  eda_cc_slope                             0.1958
  eda_stress_skin_slope                    0.1707

PC4
  eda_cc_skew                              0.8784
  eda_cc_kurtosis                          0.3023
  eda_stress_skin_kurtosis                 0.2578
  eda_stress_skin_skew                     0.2367
  eda_cc_mean_abs_diff                     0.0798
  eda_stress_skin_min                      0.0566
  eda_stress_skin_slope                    0.0522
  eda_cc_min                               0.0352

PC5
  eda_cc_kurtosis                          0.5683
  eda_cc_min                               0.5440
  eda_cc_slope                             0.4567
  eda_stress_skin_slope                    0.3357
  eda_cc_skew                              0.1681
  eda_stress_skin_min                      0.1268
  eda_cc_mean_abs_diff                     0.0680
  eda_stress_skin_skew                     0.0640

PC6
  eda_cc_slope                             0.5796
  eda_cc_kurtosis                          0.5234
  eda_cc_mean_abs_diff                     0.4112
  eda_stress_skin_slope                    0.2907
  eda_stress_skin_mean_abs_diff            0.2535
  eda_stress_skin_min                      0.2237
  eda_cc_min                               0.1170
  eda_stress_skin_kurtosis                 0.0649

PC7
  eda_stress_skin_min                      0.5353
  eda_stress_skin_slope                    0.5329
  eda_stress_skin_kurtosis                 0.3906
  eda_stress_skin_skew                     0.3634
  eda_cc_skew                              0.2506
  eda_cc_min                               0.1948
  eda_cc_slope                             0.1717
  eda_cc_kurtosis                          0.1155

PC8
  eda_stress_skin_skew                     0.5400
  eda_stress_skin_kurtosis                 0.5205
  eda_stress_skin_slope                    0.4357
  eda_stress_skin_min                      0.3337
  eda_cc_skew                              0.2739
  eda_stress_skin_mean_abs_diff            0.1588
  eda_cc_slope                             0.1483
  eda_cc_min                               0.0945

Saved to: data/feature_extraction/analysis/quality_eda_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
Loaded CSV: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_2.0s.csv
Shape: (1059, 28)
Selected feature columns: 21
After NaN/variance filter: (1059, 15)
After correlation pruning: (1059, 5)

PCA summary (round 1):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 1):
   PC1: 0.6991   (cum 0.6991)
   PC2: 0.2441   (cum 0.9431)
   PC3: 0.0421   (cum 0.9852)
   PC4: 0.0140   (cum 0.9991)
   PC5: 0.0009   (cum 1.0000)

Top PCA loadings per component (round 1):

PC1
  eda_scr_amp_sum                          0.5325
  eda_scl_slope                            0.5018
  eda_phasic_energy                        0.4657
  eda_scr_rate                             0.4654
  eda_scl_min                              0.1765

PC2
  eda_scl_min                              0.8277
  eda_phasic_energy                        0.3526
  eda_scr_rate                             0.3481
  eda_scl_slope                            0.2615
  eda_scr_amp_sum                          0.0321

PC3
  eda_phasic_energy                        0.6089
  eda_scr_rate                             0.5980
  eda_scl_min                              0.5010
  eda_scr_amp_sum                          0.1431
  eda_scl_slope                            0.0139

PC4
  eda_scl_slope                            0.7147
  eda_scr_rate                             0.5304
  eda_phasic_energy                        0.4094
  eda_scl_min                              0.1805
  eda_scr_amp_sum                          0.0883

PC5
  eda_scr_amp_sum                          0.8290
  eda_scl_slope                            0.4109
  eda_phasic_energy                        0.3470
  eda_scr_rate                             0.1528
  eda_scl_min                              0.0141

Stage 2: PCs used to reach 90%: 2
Stage 2: ranking pool size: 5
Stage 2: selected features: 5 (topN=30)

PCA summary (round 2 / reduced):
  pcs_for_90pct: 2
  pcs_for_95pct: 3
  pcs_for_99pct: 4

Explained variance per PC (round 2):
   PC1: 0.6991   (cum 0.6991)
   PC2: 0.2441   (cum 0.9431)
   PC3: 0.0421   (cum 0.9852)
   PC4: 0.0140   (cum 0.9991)
   PC5: 0.0009   (cum 1.0000)

Top PCA loadings per component (round 2):

PC1
  eda_scr_amp_sum                          0.5325
  eda_scl_slope                            0.5018
  eda_phasic_energy                        0.4657
  eda_scr_rate                             0.4654
  eda_scl_min                              0.1765

PC2
  eda_scl_min                              0.8277
  eda_phasic_energy                        0.3526
  eda_scr_rate                             0.3481
  eda_scl_slope                            0.2615
  eda_scr_amp_sum                          0.0321

PC3
  eda_phasic_energy                        0.6089
  eda_scr_rate                             0.5980
  eda_scl_min                              0.5010
  eda_scr_amp_sum                          0.1431
  eda_scl_slope                            0.0139

PC4
  eda_scl_slope                            0.7147
  eda_scr_rate                             0.5304
  eda_phasic_energy                        0.4094
  eda_scl_min                              0.1805
  eda_scr_amp_sum                          0.0883

PC5
  eda_scr_amp_sum                          0.8290
  eda_scl_slope                            0.4109
  eda_phasic_energy                        0.3470
  eda_scr_rate                             0.1528
  eda_scl_min                              0.0141

Saved to: data/feature_extraction/analysis/quality_eda_advanced_2.0s_10ol
 - feature_quality_metrics.csv
 - features_* (basic + correlation)
 - corr_matrix_abs.csv
 - pca_variance_round1.csv / pca_loadings_round1.csv / pca_top_loadings_round1.csv
 - pca_energy_ranking_round1.csv / features_selected_pca_energy_top30.csv
 - pca_variance_round2.csv / pca_loadings_round2.csv / pca_top_loadings_round2.csv
DONE
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_5.0s.csv | windows=600 | features=21
    ✓ HRV features: 600 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_aligned_5.0s.csv (600 windows | borg labeled: 265)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_aligned_5.0s.csv (600 windows | borg labeled: 265)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_5.0s.csv | windows=600 | features=21
    ✓ HRV features: 600 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_aligned_5.0s.csv (600 windows | borg labeled: 265)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 600
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_aligned_5.0s.csv (600 windows | borg labeled: 265)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_5.0s.csv | windows=426 | features=21
    ✓ Advanced EDA features: 426 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 426
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_aligned_5.0s.csv (426 windows | borg labeled: 264)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 426
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_aligned_5.0s.csv (426 windows | borg labeled: 264)

▶ Window length: 2.0s | overlap=0.1
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1106
  Windows in ADL time range: 836
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/imu_wrist/imu_aligned_2.0s.csv (1106 windows | borg labeled: 659)
  Extracting HRV features from ppg_green...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_features_2.0s.csv | windows=1490 | features=21
    ✓ HRV features: 1490 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_green/ppg_green_hrv_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  Extracting HRV features from ppg_infra...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_features_2.0s.csv | windows=1490 | features=21
    ✓ HRV features: 1490 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_infra/ppg_infra_hrv_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  Extracting HRV features from ppg_red...
✓ HRV features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_features_2.0s.csv | windows=1490 | features=21
    ✓ HRV features: 1490 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1490
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/ppg_red/ppg_red_hrv_aligned_2.0s.csv (1490 windows | borg labeled: 661)
  Extracting advanced EDA features (SCL, SCR)...
✓ Advanced EDA features extracted → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_features_2.0s.csv | windows=1059 | features=21
    ✓ Advanced EDA features: 1059 windows
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1059
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_aligned_2.0s.csv (1059 windows | borg labeled: 660)
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 1059
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/eda/eda_advanced_aligned_2.0s.csv (1059 windows | borg labeled: 660)

▶ Fusion step
  Running fusion...

▶ Fusing features for window length: 10.0s
  Loaded eda: 213 windows | t_center min=1764912971.000 max=1764914879.000 n=213
  Loaded eda_advanced: 213 windows | t_center min=1764912971.000 max=1764914879.000 n=213
  Loaded imu_bioz: 200 windows | t_center min=1764912977.000 max=1764914768.000 n=200
  Loaded imu_wrist: 222 windows | t_center min=1764912941.000 max=1764914930.000 n=222
  Loaded ppg_green: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Loaded ppg_green_hrv: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Loaded ppg_infra: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Loaded ppg_infra_hrv: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Loaded ppg_red: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Loaded ppg_red_hrv: 300 windows | t_center min=1764912045.000 max=1764914736.000 n=300
  Dropped 12 invalid feature columns
  ✓ Wrote 0 fused windows → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_features_10.0s.csv

▶ Fusing features for window length: 5.0s
  Loaded eda: 426 windows | t_center min=1764912968.500 max=1764914881.000 n=426
  Loaded eda_advanced: 426 windows | t_center min=1764912968.500 max=1764914881.000 n=426
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
  Loaded imu_bioz: 401 windows | t_center min=1764912974.500 max=1764914774.500 n=401
  Loaded imu_wrist: 445 windows | t_center min=1764912938.500 max=1764914936.500 n=445
  Loaded ppg_green: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Loaded ppg_green_hrv: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Loaded ppg_infra: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Loaded ppg_infra_hrv: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Loaded ppg_red: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Loaded ppg_red_hrv: 600 windows | t_center min=1764912042.500 max=1764914738.000 n=600
  Dropped 30 invalid feature columns
  ✓ Wrote 393 fused windows → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_features_5.0s.csv

▶ Fusing features for window length: 2.0s
  Loaded eda: 1059 windows | t_center min=1764912967.000 max=1764914884.625 n=1059
  Loaded eda_advanced: 1059 windows | t_center min=1764912967.000 max=1764914884.625 n=1059
  Loaded imu_bioz: 996 windows | t_center min=1764912973.000 max=1764914776.438 n=996
  Loaded imu_wrist: 1106 windows | t_center min=1764912937.000 max=1764914939.812 n=1106
  Loaded ppg_green: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Loaded ppg_green_hrv: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Loaded ppg_infra: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Loaded ppg_infra_hrv: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Loaded ppg_red: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Loaded ppg_red_hrv: 1490 windows | t_center min=1764912041.000 max=1764914739.812 n=1490
  Dropped 75 invalid feature columns
  ✓ Wrote 977 fused windows → /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_features_2.0s.csv
  ✓ Fusion complete

▶ Aligning fused features with Borg effort labels
  Aligning fused features (10.0s windows)...
  ⚠ No data in features file (0 rows), skipping alignment
  Aligning fused features (5.0s windows)...
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 401
  Windows in ADL time range: 336
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_aligned_5.0s.csv (336 windows | borg labeled: 269)
  Aligning fused features (2.0s windows)...
  ADL recording time: 1764913217.8 to 1764914731.7
  Windows before filtering: 996
  Windows in ADL time range: 835
Saved aligned dataset to /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_aligned_2.0s.csv (835 windows | borg labeled: 657)

▶ Feature selection with correlation pruning + quality checks
  Running feature selection (5.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (5.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_aligned_5.0s.csv
  ✓ Loaded 269 labeled samples
  ✓ 254 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 215, Test: 54

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 20, IMU: 7, PPG: 73

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 5, IMU: 7, PPG: 15
  ✓ Total: 27 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 15, 'pcs_for_95pct': 18, 'pcs_for_99pct': 23}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/feature_selection_qc/qc_5.0s/features_filtered_5.0s.csv
    → 27 features + 2 metadata columns
    → 269 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_5.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (5.0s)
  Running feature selection (2.0s windows)...

====================================================================================================
FEATURE SELECTION + QUALITY CHECKS (2.0s windows)
====================================================================================================

📂 Loading data from: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_aligned_2.0s.csv
  ✓ Loaded 657 labeled samples
  ✓ 209 features (after metadata removal)

🔀 Train-test split (80/20)...
  ✓ Train: 525, Test: 132

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 25, IMU: 7, PPG: 68

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 6, IMU: 7, PPG: 6
  ✓ Total: 19 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 11, 'pcs_for_95pct': 14, 'pcs_for_99pct': 17}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Saved filtered dataset: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/feature_selection_qc/qc_2.0s/features_filtered_2.0s.csv
    → 19 features + 2 metadata columns
    → 657 samples

====================================================================================================
✅ FEATURE SELECTION + QC COMPLETE
   → Use 'features_filtered_2.0s.csv' for ML training
====================================================================================================
  ✓ Feature selection complete (2.0s)
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/Users/pascalschlegel/effort-estimator/.venv/lib/python3.9/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
======================================================================
ELDERLY PATIENTS PIPELINE
Subjects: sim_elderly3, sim_elderly4, sim_elderly5
======================================================================

======================================================================
SUBJECT: sim_elderly1 (from /Users/pascalschlegel/data/interim/parsingsim1)
======================================================================
  Found files for sim_elderly1:
    ADL (with Borg): /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/scai_app/ADLs_1.csv
✓ Config: /tmp/pipeline_sim_elderly1.yaml
▶ Running pipeline...
✓ Pipeline completed for sim_elderly1

======================================================================
SUBJECT: sim_elderly2 (from /Users/pascalschlegel/data/interim/parsingsim2)
======================================================================
  Found files for sim_elderly2:
    ADL (with Borg): /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/scai_app/ADLs_1.csv
✓ Config: /tmp/pipeline_sim_elderly2.yaml
▶ Running pipeline...
✓ Pipeline completed for sim_elderly2

======================================================================
SUBJECT: sim_elderly3 (from /Users/pascalschlegel/data/interim/parsingsim3)
======================================================================
  Found files for sim_elderly3:
    ADL (with Borg): /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/scai_app/ADLs_1.csv
✓ Config: /tmp/pipeline_sim_elderly3.yaml
▶ Running pipeline...
✓ Pipeline completed for sim_elderly3

======================================================================
SUBJECT: sim_elderly4 (from /Users/pascalschlegel/data/interim/parsingsim4)
======================================================================
  Found files for sim_elderly4:
    ADL (with Borg): /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/scai_app/ADLs_1.csv
✓ Config: /tmp/pipeline_sim_elderly4.yaml
▶ Running pipeline...
✓ Pipeline completed for sim_elderly4

======================================================================
SUBJECT: sim_elderly5 (from /Users/pascalschlegel/data/interim/parsingsim5)
======================================================================
  Found files for sim_elderly5:
    ADL (with Borg): /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/scai_app/ADLs_1-5.csv
✓ Config: /tmp/pipeline_sim_elderly5.yaml
▶ Running pipeline...
✓ Pipeline completed for sim_elderly5

✓ Completed: 5/5 subjects

======================================================================
COMBINING DATASETS (window=10.0s)
======================================================================
  ⚠ Missing: /Users/pascalschlegel/data/interim/parsingsim1/sim_elderly1/effort_estimation_output/elderly_sim_elderly1/fused_aligned_10.0s.csv
  ⚠ Missing: /Users/pascalschlegel/data/interim/parsingsim2/sim_elderly2/effort_estimation_output/elderly_sim_elderly2/fused_aligned_10.0s.csv
  ⚠ Missing: /Users/pascalschlegel/data/interim/parsingsim3/sim_elderly3/effort_estimation_output/elderly_sim_elderly3/fused_aligned_10.0s.csv
  ⚠ Missing: /Users/pascalschlegel/data/interim/parsingsim4/sim_elderly4/effort_estimation_output/elderly_sim_elderly4/fused_aligned_10.0s.csv
  ⚠ Missing: /Users/pascalschlegel/data/interim/parsingsim5/sim_elderly5/effort_estimation_output/elderly_sim_elderly5/fused_aligned_10.0s.csv
✗ No data to combine!
  (No valid data at 10.0s, trying next...)

======================================================================
COMBINING DATASETS (window=5.0s)
======================================================================
  ✓ sim_elderly1: 439 samples, 293 labeled
  ✓ sim_elderly2: 366 samples, 273 labeled
  ✓ sim_elderly3: 438 samples, 287 labeled
  ✓ sim_elderly4: 386 samples, 299 labeled
  ✓ sim_elderly5: 336 samples, 269 labeled

✓ Combined: 1965 total samples
  Labeled: 1421

✓ Saved combined dataset: /Users/pascalschlegel/data/interim/elderly_combined/elderly_aligned_5.0s.csv

======================================================================
FEATURE SELECTION + QC
======================================================================
  ✓ 260 features (after metadata removal)
  ✓ 1421 labeled samples for feature selection

  Selecting top 100 features by correlation...

🎯 Feature Selection (top 100 by correlation with target)...
  ✓ Before pruning - EDA: 12, IMU: 9, PPG: 79

🔪 Pruning redundant features (correlation threshold=0.9)...
  ✓ After pruning - EDA: 3, IMU: 9, PPG: 22
  ✓ Total: 34 features (from 100)

📊 PCA Analysis...
  ✓ PCA variance targets: {'pcs_for_90pct': 16, 'pcs_for_95pct': 21, 'pcs_for_99pct': 28}

💾 Saving feature selection and QC outputs...
  ✓ Saved: features_selected_pruned.csv
  ✓ Saved: pca_variance_explained.csv
  ✓ Saved: pca_loadings.csv
  ✓ Saved: pca_top_loadings.csv
  ✓ Feature selection complete: 34 features selected
  ✓ QC outputs saved to /Users/pascalschlegel/data/interim/elderly_combined/qc_5.0s

======================================================================
TRAINING: XGBoost with GroupKFold CV
======================================================================
  Activities detected: 108
  Samples: 1421

  Results (GroupKFold CV, 5 folds):
    Pearson r: 0.578 (p=1.46e-127)
    RMSE: 1.51
    MAE: 1.21

  Top 10 features by importance:
    ppg_green_max: 0.2126
    ppg_red_tke_std: 0.0795
    acc_z_dyn__sum_of_absolute_changes: 0.0554
    ppg_green_rms: 0.0456
    acc_z_dyn__lower_complete_moment: 0.0431
    ppg_red_max: 0.0384
    ppg_green_n_peaks: 0.0376
    eda_stress_skin_mean_abs_diff: 0.0363
    acc_y_dyn__sample_entropy: 0.0355
    ppg_green_p10: 0.0344

  ✓ Results saved to /Users/pascalschlegel/data/interim/elderly_combined/xgboost_results

======================================================================
FINAL SUMMARY
======================================================================
  sim_elderly1: 439 samples (293 labeled)
  sim_elderly2: 366 samples (273 labeled)
  sim_elderly3: 438 samples (287 labeled)
  sim_elderly4: 386 samples (299 labeled)
  sim_elderly5: 336 samples (269 labeled)

Total: 1965 samples (1421 labeled)
Features before selection: 260
Features after selection: 34

Output directory: /Users/pascalschlegel/data/interim/elderly_combined
